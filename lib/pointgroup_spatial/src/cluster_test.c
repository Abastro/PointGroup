// Generated by Futhark 0.20.0
#ifndef _GNU_SOURCE
#define _GNU_SOURCE
#endif
#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>
#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation

struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg,
                                        const char *path);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg,
                                          const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg,
                                                 int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *ctx);
int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);

// Arrays

struct futhark_f32_2d ;
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0,
                                          int64_t dim1);
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0, int64_t dim1);
int futhark_free_f32_2d(struct futhark_context *ctx,
                        struct futhark_f32_2d *arr);
int futhark_values_f32_2d(struct futhark_context *ctx,
                          struct futhark_f32_2d *arr, float *data);
CUdeviceptr futhark_values_raw_f32_2d(struct futhark_context *ctx,
                                      struct futhark_f32_2d *arr);
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx,
                                    struct futhark_f32_2d *arr);
struct futhark_i32_1d ;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const
                                          int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx,
                        struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx,
                          struct futhark_i32_1d *arr, int32_t *data);
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx,
                                      struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx,
                                    struct futhark_i32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                      struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_test_ballQuery(struct futhark_context *ctx,
                                 struct futhark_i32_1d **out0, const float in0,
                                 const struct futhark_f32_2d *in1, const
                                 struct futhark_i32_1d *in2);
int futhark_entry_test_clusterWith(struct futhark_context *ctx,
                                   struct futhark_i32_1d **out0, const
                                   int32_t in0, const int64_t in1, const
                                   struct futhark_i32_1d *in2, const
                                   struct futhark_i32_1d *in3);
int futhark_entry_test_elimDupesWith(struct futhark_context *ctx,
                                     struct futhark_i32_1d **out0, const
                                     struct futhark_i32_1d *in0);
int futhark_entry_test_mkSegsFromSort_segInd(struct futhark_context *ctx,
                                             struct futhark_i64_1d **out0, const
                                             int64_t in0, const
                                             struct futhark_i32_1d *in1, const
                                             struct futhark_i32_1d *in2);
int futhark_entry_test_mkSegsFromSort_segSize(struct futhark_context *ctx,
                                              struct futhark_i64_1d **out0,
                                              const int64_t in0, const
                                              struct futhark_i32_1d *in1, const
                                              struct futhark_i32_1d *in2);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#ifdef __cplusplus
}
#endif
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  size_t start = ftell(f);
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.

#include <getopt.h>
#include <ctype.h>
#include <inttypes.h>
static const char *entry_point = "main";
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces(FILE *f) {
  int c;
  do {
    c = getc(f);
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, f);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(FILE *f, char *buf, int bufsize) {
 start:
  skipspaces(f);

  int i = 0;
  while (i < bufsize) {
    int c = getc(f);
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getc(f));
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, f);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(FILE *f, char *buf, int bufsize, const char* expected) {
  next_token(f, buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(FILE *f,
                                char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(f, buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(f, buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(FILE *f, char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(f, buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(f, buf, bufsize, "[")) {
      return 1;
    }

    next_token(f, buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(f, buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(f, buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(f, buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(FILE *f,
                          int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(f, buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(f, buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(f, buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(FILE *f, void* dest) {
  int num_elems_read = fread(dest, 1, 1, f);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary(FILE *f) {
  skipspaces(f);
  int c = getc(f);
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(f, &bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, f);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum(FILE *f) {
  char read_binname[4];

  int num_matched = fscanf(f, "%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(FILE *f, const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum(f);
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(FILE *f,
                          const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum(f);
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, f);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, f);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(FILE *f, const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary(f)) {
    return read_str_array(f, expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(f, expected_type, data, shape, dims);
  }
}

static int end_of_input(FILE *f) {
  skipspaces(f);
  char token[2];
  next_token(f, token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      fprintf(out, "empty(");
      for (int64_t i = 0; i < rank; i++) {
        fprintf(out, "[%"PRIi64"]", shape[i]);
      }
      fprintf(out, "%s", elem_type->type_name);
      fprintf(out, ")");
    } else if (rank==1) {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    } else {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fwrite(elem_type->binname, 4, 1, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(FILE *f,
                       const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary(f)) {
    char buf[100];
    next_token(f, buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(f, expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, f);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

// Start of server.h.

// Forward declarations of things that we technically don't know until
// the application header file is included, but which we need.
struct futhark_context;
char *futhark_context_get_error(struct futhark_context *ctx);
int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);

typedef int (*restore_fn)(const void*, FILE *, struct futhark_context*, void*);
typedef void (*store_fn)(const void*, FILE *, struct futhark_context*, void*);
typedef int (*free_fn)(const void*, struct futhark_context*, void*);

struct type {
  const char *name;
  restore_fn restore;
  store_fn store;
  free_fn free;
  const void *aux;
};

int free_scalar(const void *aux, struct futhark_context *ctx, void *p) {
  (void)aux;
  (void)ctx;
  (void)p;
  // Nothing to do.
  return 0;
}

#define DEF_SCALAR_TYPE(T)                                              \
  int restore_##T(const void *aux, FILE *f,                             \
                  struct futhark_context *ctx, void *p) {               \
    (void)aux;                                                          \
    (void)ctx;                                                          \
    return read_scalar(f, &T##_info, p);                                \
  }                                                                     \
                                                                        \
  void store_##T(const void *aux, FILE *f,                              \
                 struct futhark_context *ctx, void *p) {                \
    (void)aux;                                                          \
    (void)ctx;                                                          \
    write_scalar(f, 1, &T##_info, p);                                   \
  }                                                                     \
                                                                        \
  struct type type_##T =                                                \
    { .name = #T,                                                       \
      .restore = restore_##T,                                           \
      .store = store_##T,                                               \
      .free = free_scalar                                               \
    }                                                                   \

DEF_SCALAR_TYPE(i8);
DEF_SCALAR_TYPE(i16);
DEF_SCALAR_TYPE(i32);
DEF_SCALAR_TYPE(i64);
DEF_SCALAR_TYPE(u8);
DEF_SCALAR_TYPE(u16);
DEF_SCALAR_TYPE(u32);
DEF_SCALAR_TYPE(u64);
DEF_SCALAR_TYPE(f32);
DEF_SCALAR_TYPE(f64);
DEF_SCALAR_TYPE(bool);

struct value {
  struct type *type;
  union {
    void *v_ptr;
    int8_t  v_i8;
    int16_t v_i16;
    int32_t v_i32;
    int64_t v_i64;

    uint8_t  v_u8;
    uint16_t v_u16;
    uint32_t v_u32;
    uint64_t v_u64;

    float v_f32;
    double v_f64;

    bool v_bool;
  } value;
};

void* value_ptr(struct value *v) {
  if (v->type == &type_i8) {
    return &v->value.v_i8;
  }
  if (v->type == &type_i16) {
    return &v->value.v_i16;
  }
  if (v->type == &type_i32) {
    return &v->value.v_i32;
  }
  if (v->type == &type_i64) {
    return &v->value.v_i64;
  }
  if (v->type == &type_u8) {
    return &v->value.v_u8;
  }
  if (v->type == &type_u16) {
    return &v->value.v_u16;
  }
  if (v->type == &type_u32) {
    return &v->value.v_u32;
  }
  if (v->type == &type_u64) {
    return &v->value.v_u64;
  }
  if (v->type == &type_f32) {
    return &v->value.v_f32;
  }
  if (v->type == &type_f64) {
    return &v->value.v_f64;
  }
  if (v->type == &type_bool) {
    return &v->value.v_bool;
  }
  return &v->value.v_ptr;
}

struct variable {
  // NULL name indicates free slot.  Name is owned by this struct.
  char *name;
  struct value value;
};

typedef int (*entry_point_fn)(struct futhark_context*, void**, void**);

struct entry_point {
  const char *name;
  entry_point_fn f;
  struct type **out_types;
  struct type **in_types;
};

int entry_num_ins(struct entry_point *e) {
  int count = 0;
  while (e->in_types[count]) {
    count++;
  }
  return count;
}

int entry_num_outs(struct entry_point *e) {
  int count = 0;
  while (e->out_types[count]) {
    count++;
  }
  return count;
}

struct futhark_prog {
  // Last entry point identified by NULL name.
  struct entry_point *entry_points;
  // Last type identified by NULL name.
  struct type **types;
};

struct server_state {
  struct futhark_prog prog;
  struct futhark_context *ctx;
  int variables_capacity;
  struct variable *variables;
};

struct variable* get_variable(struct server_state *s,
                              const char *name) {
  for (int i = 0; i < s->variables_capacity; i++) {
    if (s->variables[i].name != NULL &&
        strcmp(s->variables[i].name, name) == 0) {
      return &s->variables[i];
    }
  }

  return NULL;
}

struct variable* create_variable(struct server_state *s,
                                 const char *name,
                                 struct type *type) {
  int found = -1;
  for (int i = 0; i < s->variables_capacity; i++) {
    if (found == -1 && s->variables[i].name == NULL) {
      found = i;
    } else if (s->variables[i].name != NULL &&
               strcmp(s->variables[i].name, name) == 0) {
      return NULL;
    }
  }

  if (found != -1) {
    // Found a free spot.
    s->variables[found].name = strdup(name);
    s->variables[found].value.type = type;
    return &s->variables[found];
  }

  // Need to grow the buffer.
  found = s->variables_capacity;
  s->variables_capacity *= 2;
  s->variables = realloc(s->variables,
                         s->variables_capacity * sizeof(struct variable));

  s->variables[found].name = strdup(name);
  s->variables[found].value.type = type;

  for (int i = found+1; i < s->variables_capacity; i++) {
    s->variables[i].name = NULL;
  }

  return &s->variables[found];
}

void drop_variable(struct variable *v) {
  free(v->name);
  v->name = NULL;
}

int arg_exists(const char *args[], int i) {
  return args[i] != NULL;
}

const char* get_arg(const char *args[], int i) {
  if (!arg_exists(args, i)) {
    futhark_panic(1, "Insufficient command args.\n");
  }
  return args[i];
}

struct type* get_type(struct server_state *s, const char *name) {
  for (int i = 0; s->prog.types[i]; i++) {
    if (strcmp(s->prog.types[i]->name, name) == 0) {
      return s->prog.types[i];
    }
  }

  futhark_panic(1, "Unknown type %s\n", name);
  return NULL;
}

struct entry_point* get_entry_point(struct server_state *s, const char *name) {
  for (int i = 0; s->prog.entry_points[i].name; i++) {
    if (strcmp(s->prog.entry_points[i].name, name) == 0) {
      return &s->prog.entry_points[i];
    }
  }

  return NULL;
}

// Print the command-done marker, indicating that we are ready for
// more input.
void ok() {
  printf("%%%%%% OK\n");
  fflush(stdout);
}

// Print the failure marker.  Output is now an error message until the
// next ok().
void failure() {
  printf("%%%%%% FAILURE\n");
}

void error_check(struct server_state *s, int err) {
  if (err != 0) {
    failure();
    char *error = futhark_context_get_error(s->ctx);
    puts(error);
    free(error);
  }
}

void cmd_call(struct server_state *s, const char *args[]) {
  const char *name = get_arg(args, 0);

  struct entry_point *e = get_entry_point(s, name);

  if (e == NULL) {
    failure();
    printf("Unknown entry point: %s\n", name);
    return;
  }

  int num_outs = entry_num_outs(e);
  int num_ins = entry_num_ins(e);
  void* outs[num_outs];
  void* ins[num_ins];

  for (int i = 0; i < num_ins; i++) {
    const char *in_name = get_arg(args, 1+num_outs+i);
    struct variable *v = get_variable(s, in_name);
    if (v == NULL) {
      failure();
      printf("Unknown variable: %s\n", in_name);
      return;
    }
    if (v->value.type != e->in_types[i]) {
      failure();
      printf("Wrong input type.  Expected %s, got %s.\n",
             e->in_types[i]->name, v->value.type->name);
      return;
    }
    ins[i] = value_ptr(&v->value);
  }

  for (int i = 0; i < num_outs; i++) {
    const char *out_name = get_arg(args, 1+i);
    struct variable *v = create_variable(s, out_name, e->out_types[i]);
    if (v == NULL) {
      failure();
      printf("Variable already exists: %s\n", out_name);
      return;
    }
    outs[i] = value_ptr(&v->value);
  }

  int64_t t_start = get_wall_time();
  int err = e->f(s->ctx, outs, ins);
  err |= futhark_context_sync(s->ctx);
  int64_t t_end = get_wall_time();
  long long int elapsed_usec = t_end - t_start;
  printf("runtime: %lld\n", elapsed_usec);

  error_check(s, err);
  if (err != 0) {
    // Need to uncreate the output variables, which would otherwise be left
    // in an uninitialised state.
    for (int i = 0; i < num_outs; i++) {
      const char *out_name = get_arg(args, 1+i);
      struct variable *v = get_variable(s, out_name);
      if (v) {
        drop_variable(v);
      }
    }
  }
}

void cmd_restore(struct server_state *s, const char *args[]) {
  const char *fname = get_arg(args, 0);

  FILE *f = fopen(fname, "rb");
  if (f == NULL) {
    failure();
    printf("Failed to open %s: %s\n", fname, strerror(errno));
  } else {
    int values = 0;
    for (int i = 1; arg_exists(args, i); i+=2, values++) {
      const char *vname = get_arg(args, i);
      const char *type = get_arg(args, i+1);

      struct type *t = get_type(s, type);
      struct variable *v = create_variable(s, vname, t);

      if (v == NULL) {
        failure();
        printf("Variable already exists: %s\n", vname);
        return;
      }

      if (t->restore(t->aux, f, s->ctx, value_ptr(&v->value)) != 0) {
        failure();
        printf("Failed to restore variable %s.\n"
               "Possibly malformed data in %s (errno: %s)\n",
               vname, fname, strerror(errno));
        drop_variable(v);
        break;
      }
    }

    if (end_of_input(f) != 0) {
      failure();
      printf("Expected EOF after reading %d values from %s\n",
             values, fname);
    }

    fclose(f);
  }

  int err = futhark_context_sync(s->ctx);
  error_check(s, err);
}

void cmd_store(struct server_state *s, const char *args[]) {
  const char *fname = get_arg(args, 0);

  FILE *f = fopen(fname, "wb");
  if (f == NULL) {
    failure();
    printf("Failed to open %s: %s\n", fname, strerror(errno));
  } else {
    for (int i = 1; arg_exists(args, i); i++) {
      const char *vname = get_arg(args, i);
      struct variable *v = get_variable(s, vname);

      if (v == NULL) {
        failure();
        printf("Unknown variable: %s\n", vname);
        return;
      }

      struct type *t = v->value.type;
      t->store(t->aux, f, s->ctx, value_ptr(&v->value));
    }
    fclose(f);
  }
}

void cmd_free(struct server_state *s, const char *args[]) {
  for (int i = 0; arg_exists(args, i); i++) {
    const char *name = get_arg(args, i);
    struct variable *v = get_variable(s, name);

    if (v == NULL) {
      failure();
      printf("Unknown variable: %s\n", name);
      return;
    }

    struct type *t = v->value.type;

    int err = t->free(t->aux, s->ctx, value_ptr(&v->value));
    error_check(s, err);
    drop_variable(v);
  }
}

void cmd_rename(struct server_state *s, const char *args[]) {
  const char *oldname = get_arg(args, 0);
  const char *newname = get_arg(args, 1);
  struct variable *old = get_variable(s, oldname);
  struct variable *new = get_variable(s, newname);

  if (old == NULL) {
    failure();
    printf("Unknown variable: %s\n", oldname);
    return;
  }

  if (new != NULL) {
    failure();
    printf("Variable already exists: %s\n", newname);
    return;
  }

  free(old->name);
  old->name = strdup(newname);
}

void cmd_inputs(struct server_state *s, const char *args[]) {
  const char *name = get_arg(args, 0);
  struct entry_point *e = get_entry_point(s, name);

  if (e == NULL) {
    failure();
    printf("Unknown entry point: %s\n", name);
    return;
  }

  int num_ins = entry_num_ins(e);
  for (int i = 0; i < num_ins; i++) {
    puts(e->in_types[i]->name);
  }
}

void cmd_outputs(struct server_state *s, const char *args[]) {
  const char *name = get_arg(args, 0);
  struct entry_point *e = get_entry_point(s, name);

  if (e == NULL) {
    failure();
    printf("Unknown entry point: %s\n", name);
    return;
  }

  int num_outs = entry_num_outs(e);
  for (int i = 0; i < num_outs; i++) {
    puts(e->out_types[i]->name);
  }
}

void cmd_clear(struct server_state *s, const char *args[]) {
  (void)args;
  int err = 0;
  for (int i = 0; i < s->variables_capacity; i++) {
    struct variable *v = &s->variables[i];
    if (v->name != NULL) {
      err |= v->value.type->free(v->value.type->aux, s->ctx, value_ptr(&v->value));
      drop_variable(v);
    }
  }
  err |= futhark_context_clear_caches(s->ctx);
  error_check(s, err);
}

void cmd_pause_profiling(struct server_state *s, const char *args[]) {
  (void)args;
  futhark_context_pause_profiling(s->ctx);
}

void cmd_unpause_profiling(struct server_state *s, const char *args[]) {
  (void)args;
  futhark_context_unpause_profiling(s->ctx);
}

void cmd_report(struct server_state *s, const char *args[]) {
  (void)args;
  char *report = futhark_context_report(s->ctx);
  puts(report);
  free(report);
}

char *next_word(char **line) {
  char *p = *line;

  while (isspace(*p)) {
    p++;
  }

  if (*p == 0) {
    return NULL;
  }

  if (*p == '"') {
    char *save = p+1;
    // Skip ahead till closing quote.
    p++;

    while (*p && *p != '"') {
      p++;
    }

    if (*p == '"') {
      *p = 0;
      *line = p+1;
      return save;
    } else {
      return NULL;
    }
  } else {
    char *save = p;
    // Skip ahead till next whitespace.

    while (*p && !isspace(*p)) {
      p++;
    }

    if (*p) {
      *p = 0;
      *line = p+1;
    } else {
      *line = p;
    }
    return save;
  }
}

void process_line(struct server_state *s, char *line) {
  int max_num_tokens = 1000;
  const char* tokens[max_num_tokens];
  int num_tokens = 0;

  while ((tokens[num_tokens] = next_word(&line)) != NULL) {
    num_tokens++;
    if (num_tokens == max_num_tokens) {
      futhark_panic(1, "Line too long.\n");
    }
  }

  const char *command = tokens[0];

  if (command == NULL) {
    failure();
    printf("Empty line\n");
  } else if (strcmp(command, "call") == 0) {
    cmd_call(s, tokens+1);
  } else if (strcmp(command, "restore") == 0) {
    cmd_restore(s, tokens+1);
  } else if (strcmp(command, "store") == 0) {
    cmd_store(s, tokens+1);
  } else if (strcmp(command, "free") == 0) {
    cmd_free(s, tokens+1);
  } else if (strcmp(command, "rename") == 0) {
    cmd_rename(s, tokens+1);
  } else if (strcmp(command, "inputs") == 0) {
    cmd_inputs(s, tokens+1);
  } else if (strcmp(command, "outputs") == 0) {
    cmd_outputs(s, tokens+1);
  } else if (strcmp(command, "clear") == 0) {
    cmd_clear(s, tokens+1);
  } else if (strcmp(command, "pause_profiling") == 0) {
    cmd_pause_profiling(s, tokens+1);
  } else if (strcmp(command, "unpause_profiling") == 0) {
    cmd_unpause_profiling(s, tokens+1);
  } else if (strcmp(command, "report") == 0) {
    cmd_report(s, tokens+1);
  } else {
    futhark_panic(1, "Unknown command: %s\n", command);
  }
}

void run_server(struct futhark_prog *prog, struct futhark_context *ctx) {
  char *line = NULL;
  size_t buflen = 0;
  ssize_t linelen;

  struct server_state s = {
    .ctx = ctx,
    .variables_capacity = 100,
    .prog = *prog
  };

  s.variables = malloc(s.variables_capacity * sizeof(struct variable));

  for (int i = 0; i < s.variables_capacity; i++) {
    s.variables[i].name = NULL;
  }

  ok();
  while ((linelen = getline(&line, &buflen, stdin)) > 0) {
    process_line(&s, line);
    ok();
  }

  free(line);
}

// The aux struct lets us write generic method implementations without
// code duplication.

typedef void* (*array_new_fn)(struct futhark_context *, const void*, const int64_t*);
typedef const int64_t* (*array_shape_fn)(struct futhark_context*, void*);
typedef int (*array_values_fn)(struct futhark_context*, void*, void*);
typedef int (*array_free_fn)(struct futhark_context*, void*);

struct array_aux {
  int rank;
  const struct primtype_info_t* info;
  const char *name;
  array_new_fn new;
  array_shape_fn shape;
  array_values_fn values;
  array_free_fn free;
};

int restore_array(const struct array_aux *aux, FILE *f,
                  struct futhark_context *ctx, void *p) {
  void *data = NULL;
  int64_t shape[aux->rank];
  if (read_array(f, aux->info, &data, shape, aux->rank) != 0) {
    return 1;
  }

  void *arr = aux->new(ctx, data, shape);
  if (arr == NULL) {
    return 1;
  }

  *(void**)p = arr;
  free(data);
  return 0;
}

void store_array(const struct array_aux *aux, FILE *f,
                 struct futhark_context *ctx, void *p) {
  void *arr = *(void**)p;
  const int64_t *shape = aux->shape(ctx, arr);
  int64_t size = sizeof(aux->info->size);
  for (int i = 0; i < aux->rank; i++) {
    size *= shape[i];
  }
  int32_t *data = malloc(size);
  assert(aux->values(ctx, arr, data) == 0);
  assert(futhark_context_sync(ctx) == 0);
  assert(write_array(f, 1, aux->info, data, shape, aux->rank) == 0);
  free(data);
}

int free_array(const struct array_aux *aux,
                struct futhark_context *ctx, void *p) {
  void *arr = *(void**)p;
  return aux->free(ctx, arr);
}

typedef void* (*opaque_restore_fn)(struct futhark_context*, void*);
typedef int (*opaque_store_fn)(struct futhark_context*, const void*, void **, size_t *);
typedef int (*opaque_free_fn)(struct futhark_context*, void*);

struct opaque_aux {
  opaque_restore_fn restore;
  opaque_store_fn store;
  opaque_free_fn free;
};

int restore_opaque(const struct opaque_aux *aux, FILE *f,
                   struct futhark_context *ctx, void *p) {
  // We have a problem: we need to load data from 'f', since the
  // restore function takes a pointer, but we don't know how much we
  // need (and cannot possibly).  So we do something hacky: we read
  // *all* of the file, pass all of the data to the restore function
  // (which doesn't care if there's extra at the end), then we compute
  // how much space the the object actually takes in serialised form
  // and rewind the file to that position.  The only downside is more IO.
  size_t start = ftell(f);
  size_t size;
  char *bytes = fslurp_file(f, &size);
  void *obj = aux->restore(ctx, bytes);
  free(bytes);
  if (obj != NULL) {
    *(void**)p = obj;
    size_t obj_size;
    (void)aux->store(ctx, obj, NULL, &obj_size);
    fseek(f, start+obj_size, SEEK_SET);
    return 0;
  } else {
    fseek(f, start, SEEK_SET);
    return 1;
  }
}

void store_opaque(const struct opaque_aux *aux, FILE *f,
                  struct futhark_context *ctx, void *p) {
  void *obj = *(void**)p;
  size_t obj_size;
  void *data = NULL;
  (void)aux->store(ctx, obj, &data, &obj_size);
  fwrite(data, sizeof(char), obj_size, f);
  free(data);
}

int free_opaque(const struct opaque_aux *aux,
                 struct futhark_context *ctx, void *p) {
  void *obj = *(void**)p;
  return aux->free(ctx, obj);
}

// End of server.h.

// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        char* err = (char*) malloc(max_line_len + 50);
        snprintf(err, max_line_len + 50, "Unknown name '%s' on line %d.", line, lineno);
        free(line);
        return err;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

void *futhark_new_f32_2d_wrap(struct futhark_context *ctx, const void *p, const
                              int64_t *shape)
{
    return futhark_new_f32_2d(ctx, p, shape[0], shape[1]);
}
struct array_aux type_f32_2d_aux = {.name ="[][]f32", .rank =2, .info =
                                    &f32_info, .new =
                                    (array_new_fn) futhark_new_f32_2d_wrap,
                                    .free =(array_free_fn) futhark_free_f32_2d,
                                    .shape =
                                    (array_shape_fn) futhark_shape_f32_2d,
                                    .values =
                                    (array_values_fn) futhark_values_f32_2d};
struct type type_f32_2d = {.name ="[][]f32", .restore =
                           (restore_fn) restore_array, .store =
                           (store_fn) store_array, .free =(free_fn) free_array,
                           .aux =&type_f32_2d_aux};
void *futhark_new_i32_1d_wrap(struct futhark_context *ctx, const void *p, const
                              int64_t *shape)
{
    return futhark_new_i32_1d(ctx, p, shape[0]);
}
struct array_aux type_i32_1d_aux = {.name ="[]i32", .rank =1, .info =&i32_info,
                                    .new =
                                    (array_new_fn) futhark_new_i32_1d_wrap,
                                    .free =(array_free_fn) futhark_free_i32_1d,
                                    .shape =
                                    (array_shape_fn) futhark_shape_i32_1d,
                                    .values =
                                    (array_values_fn) futhark_values_i32_1d};
struct type type_i32_1d = {.name ="[]i32", .restore =(restore_fn) restore_array,
                           .store =(store_fn) store_array, .free =
                           (free_fn) free_array, .aux =&type_i32_1d_aux};
void *futhark_new_i64_1d_wrap(struct futhark_context *ctx, const void *p, const
                              int64_t *shape)
{
    return futhark_new_i64_1d(ctx, p, shape[0]);
}
struct array_aux type_i64_1d_aux = {.name ="[]i64", .rank =1, .info =&i64_info,
                                    .new =
                                    (array_new_fn) futhark_new_i64_1d_wrap,
                                    .free =(array_free_fn) futhark_free_i64_1d,
                                    .shape =
                                    (array_shape_fn) futhark_shape_i64_1d,
                                    .values =
                                    (array_values_fn) futhark_values_i64_1d};
struct type type_i64_1d = {.name ="[]i64", .restore =(restore_fn) restore_array,
                           .store =(store_fn) store_array, .free =
                           (free_fn) free_array, .aux =&type_i64_1d_aux};
struct type *entry_test_ballQuery_out_types[] = {&type_i32_1d, NULL};
struct type *entry_test_ballQuery_in_types[] = {&type_f32, &type_f32_2d,
                                                &type_i32_1d, NULL};
int call_entry_test_ballQuery(struct futhark_context *ctx, void **outs,
                              void **ins)
{
    struct futhark_i32_1d **out0 = outs[0];
    float in0 = *(float *) ins[0];
    struct futhark_f32_2d *in1 = *(struct futhark_f32_2d **) ins[1];
    struct futhark_i32_1d *in2 = *(struct futhark_i32_1d **) ins[2];
    
    return futhark_entry_test_ballQuery(ctx, out0, in0, in1, in2);
}
struct type *entry_test_clusterWith_out_types[] = {&type_i32_1d, NULL};
struct type *entry_test_clusterWith_in_types[] = {&type_i32, &type_i64,
                                                  &type_i32_1d, &type_i32_1d,
                                                  NULL};
int call_entry_test_clusterWith(struct futhark_context *ctx, void **outs,
                                void **ins)
{
    struct futhark_i32_1d **out0 = outs[0];
    int32_t in0 = *(int32_t *) ins[0];
    int64_t in1 = *(int64_t *) ins[1];
    struct futhark_i32_1d *in2 = *(struct futhark_i32_1d **) ins[2];
    struct futhark_i32_1d *in3 = *(struct futhark_i32_1d **) ins[3];
    
    return futhark_entry_test_clusterWith(ctx, out0, in0, in1, in2, in3);
}
struct type *entry_test_elimDupesWith_out_types[] = {&type_i32_1d, NULL};
struct type *entry_test_elimDupesWith_in_types[] = {&type_i32_1d, NULL};
int call_entry_test_elimDupesWith(struct futhark_context *ctx, void **outs,
                                  void **ins)
{
    struct futhark_i32_1d **out0 = outs[0];
    struct futhark_i32_1d *in0 = *(struct futhark_i32_1d **) ins[0];
    
    return futhark_entry_test_elimDupesWith(ctx, out0, in0);
}
struct type *entry_test_mkSegsFromSort_segInd_out_types[] = {&type_i64_1d,
                                                             NULL};
struct type *entry_test_mkSegsFromSort_segInd_in_types[] = {&type_i64,
                                                            &type_i32_1d,
                                                            &type_i32_1d, NULL};
int call_entry_test_mkSegsFromSort_segInd(struct futhark_context *ctx,
                                          void **outs, void **ins)
{
    struct futhark_i64_1d **out0 = outs[0];
    int64_t in0 = *(int64_t *) ins[0];
    struct futhark_i32_1d *in1 = *(struct futhark_i32_1d **) ins[1];
    struct futhark_i32_1d *in2 = *(struct futhark_i32_1d **) ins[2];
    
    return futhark_entry_test_mkSegsFromSort_segInd(ctx, out0, in0, in1, in2);
}
struct type *entry_test_mkSegsFromSort_segSize_out_types[] = {&type_i64_1d,
                                                              NULL};
struct type *entry_test_mkSegsFromSort_segSize_in_types[] = {&type_i64,
                                                             &type_i32_1d,
                                                             &type_i32_1d,
                                                             NULL};
int call_entry_test_mkSegsFromSort_segSize(struct futhark_context *ctx,
                                           void **outs, void **ins)
{
    struct futhark_i64_1d **out0 = outs[0];
    int64_t in0 = *(int64_t *) ins[0];
    struct futhark_i32_1d *in1 = *(struct futhark_i32_1d **) ins[1];
    struct futhark_i32_1d *in2 = *(struct futhark_i32_1d **) ins[2];
    
    return futhark_entry_test_mkSegsFromSort_segSize(ctx, out0, in0, in1, in2);
}
struct type *types[] = {&type_f32, &type_f32_2d, &type_i32, &type_i32_1d,
                        &type_i64, &type_i64_1d, NULL};
struct entry_point entry_points[] = {{.name ="test_ballQuery", .f =
                                      call_entry_test_ballQuery, .in_types =
                                      entry_test_ballQuery_in_types,
                                      .out_types =
                                      entry_test_ballQuery_out_types}, {.name =
                                                                        "test_clusterWith",
                                                                        .f =
                                                                        call_entry_test_clusterWith,
                                                                        .in_types =
                                                                        entry_test_clusterWith_in_types,
                                                                        .out_types =
                                                                        entry_test_clusterWith_out_types},
                                     {.name ="test_elimDupesWith", .f =
                                      call_entry_test_elimDupesWith, .in_types =
                                      entry_test_elimDupesWith_in_types,
                                      .out_types =
                                      entry_test_elimDupesWith_out_types},
                                     {.name ="test_mkSegsFromSort_segInd", .f =
                                      call_entry_test_mkSegsFromSort_segInd,
                                      .in_types =
                                      entry_test_mkSegsFromSort_segInd_in_types,
                                      .out_types =
                                      entry_test_mkSegsFromSort_segInd_out_types},
                                     {.name ="test_mkSegsFromSort_segSize", .f =
                                      call_entry_test_mkSegsFromSort_segSize,
                                      .in_types =
                                      entry_test_mkSegsFromSort_segSize_in_types,
                                      .out_types =
                                      entry_test_mkSegsFromSort_segSize_out_types},
                                     {.name =NULL}};
struct futhark_prog prog = {.types =types, .entry_points =entry_points};
int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"debugging", no_argument, NULL, 1},
                                           {"log", no_argument, NULL, 2},
                                           {"help", no_argument, NULL, 3},
                                           {"print-sizes", no_argument, NULL,
                                            4}, {"size", required_argument,
                                                 NULL, 5}, {"tuning",
                                                            required_argument,
                                                            NULL, 6}, {"device",
                                                                       required_argument,
                                                                       NULL, 7},
                                           {"default-group-size",
                                            required_argument, NULL, 8},
                                           {"default-num-groups",
                                            required_argument, NULL, 9},
                                           {"default-tile-size",
                                            required_argument, NULL, 10},
                                           {"default-reg-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"dump-cuda", required_argument,
                                            NULL, 13}, {"load-cuda",
                                                        required_argument, NULL,
                                                        14}, {"dump-ptx",
                                                              required_argument,
                                                              NULL, 15},
                                           {"load-ptx", required_argument, NULL,
                                            16}, {"nvrtc-option",
                                                  required_argument, NULL, 17},
                                           {"profile", no_argument, NULL, 18},
                                           {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -D/--debugging              Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                    Print various low-overhead logging information while running.\n  -h/--help                   Print help information and exit.\n  --print-sizes               Print all sizes that can be set with --size or --tuning.\n  --size ASSIGNMENT           Set a configurable run-time parameter to the given value.\n  --tuning FILE               Read size=value assignments from the given file.\n  -d/--device NAME            Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT    The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT    The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT     The default tile size used when performing two-dimensional tiling.\n  --default-reg-tile-size INT The default register tile size used when performing two-dimensional tiling.\n  --default-threshold INT     The default parallelism threshold.\n  --dump-cuda FILE            Dump the embedded CUDA kernels to the indicated file.\n  --load-cuda FILE            Instead of using the embedded CUDA kernels, load them from the indicated file.\n  --dump-ptx FILE             Dump the PTX-compiled version of the embedded kernels to the indicated file.\n  --load-ptx FILE             Load PTX code from the indicated file.\n  --nvrtc-option OPT          Add an additional build option to the string passed to NVRTC.\n  -P/--profile                Gather profiling data while executing and print out a summary at the end.\n";
    
    while ((ch = getopt_long(argc, argv, ":DLhd:P", long_options, NULL)) !=
           -1) {
        if (ch == 1 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 2 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 3 || ch == 'h') {
            printf("Usage: %s [OPTIONS]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 4) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 5) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 6) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 7 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 8)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 9)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_reg_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 14)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 15) {
            futhark_context_config_dump_ptx_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 16)
            futhark_context_config_load_ptx_from(cfg, optarg);
        if (ch == 17)
            futhark_context_config_add_nvrtc_option(cfg, optarg);
        if (ch == 18 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s [OPTIONS]...\nOptions:\n\n%s\n",
                    fut_progname,
                    "  -D/--debugging              Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                    Print various low-overhead logging information while running.\n  -h/--help                   Print help information and exit.\n  --print-sizes               Print all sizes that can be set with --size or --tuning.\n  --size ASSIGNMENT           Set a configurable run-time parameter to the given value.\n  --tuning FILE               Read size=value assignments from the given file.\n  -d/--device NAME            Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT    The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT    The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT     The default tile size used when performing two-dimensional tiling.\n  --default-reg-tile-size INT The default register tile size used when performing two-dimensional tiling.\n  --default-threshold INT     The default parallelism threshold.\n  --dump-cuda FILE            Dump the embedded CUDA kernels to the indicated file.\n  --load-cuda FILE            Instead of using the embedded CUDA kernels, load them from the indicated file.\n  --dump-ptx FILE             Dump the PTX-compiled version of the embedded kernels to the indicated file.\n  --load-ptx FILE             Load PTX code from the indicated file.\n  --nvrtc-option OPT          Add an additional build option to the string passed to NVRTC.\n  -P/--profile                Gather profiling data while executing and print out a summary at the end.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    futhark_context_set_logging_file(ctx, stdout);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "Error during context initialisation:\n%s", error);
    if (entry_point != NULL)
        run_server(&prog, ctx);
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>
#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzll(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
#ifdef __OPENCL_VERSION__
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_hypot32(float x, float y)
{
    return hypot(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float futrts_log32(float x)
{
    return logf(x);
}
static inline float futrts_log2_32(float x)
{
    return log2f(x);
}
static inline float futrts_log10_32(float x)
{
    return log10f(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrtf(x);
}
static inline float futrts_exp32(float x)
{
    return expf(x);
}
static inline float futrts_cos32(float x)
{
    return cosf(x);
}
static inline float futrts_sin32(float x)
{
    return sinf(x);
}
static inline float futrts_tan32(float x)
{
    return tanf(x);
}
static inline float futrts_acos32(float x)
{
    return acosf(x);
}
static inline float futrts_asin32(float x)
{
    return asinf(x);
}
static inline float futrts_atan32(float x)
{
    return atanf(x);
}
static inline float futrts_cosh32(float x)
{
    return coshf(x);
}
static inline float futrts_sinh32(float x)
{
    return sinhf(x);
}
static inline float futrts_tanh32(float x)
{
    return tanhf(x);
}
static inline float futrts_acosh32(float x)
{
    return acoshf(x);
}
static inline float futrts_asinh32(float x)
{
    return asinhf(x);
}
static inline float futrts_atanh32(float x)
{
    return atanhf(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2f(x, y);
}
static inline float futrts_hypot32(float x, float y)
{
    return hypotf(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgammaf(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgammaf(x);
}
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float fsignum32(float x)
{
    return futrts_isnan32(x) ? x : (x > 0) - (x < 0);
}
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_hypot64(double x, double y)
{
    return hypot(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
static inline double fsignum64(double x)
{
    return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
static int init_constants(struct futhark_context *);
static int free_constants(struct futhark_context *);
static int32_t test_ballQueryziid_counter_mem_realtype_35388[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35439[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35454[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35474[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35515[1];
static int32_t test_ballQueryzicounter_mem_realtype_35529[10] = {0, 0, 0, 0, 0,
                                                                 0, 0, 0, 0, 0};
static int32_t test_ballQueryzicounter_mem_realtype_35561[10240];
static int32_t test_ballQueryziid_counter_mem_realtype_35573[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35594[1];
static int32_t test_ballQueryziid_counter_mem_realtype_35621[1];
static int32_t test_ballQueryzicounter_mem_realtype_35658[10] = {0, 0, 0, 0, 0,
                                                                 0, 0, 0, 0, 0};
static int32_t test_clusterWithziid_counter_mem_realtype_35679[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35731[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35746[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35766[1];
static int32_t test_clusterWithzicounter_mem_realtype_35792[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_35806[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_35819[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithziid_counter_mem_realtype_35832[1];
static int32_t test_clusterWithzicounter_mem_realtype_35849[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_35881[10240];
static int32_t test_clusterWithziid_counter_mem_realtype_35893[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35908[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35934[1];
static int32_t test_clusterWithziid_counter_mem_realtype_35986[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36001[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36021[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36054[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36069[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36089[1];
static int32_t test_clusterWithzicounter_mem_realtype_36115[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_36129[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_36143[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_36156[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithziid_counter_mem_realtype_36169[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36190[1];
static int32_t test_clusterWithzicounter_mem_realtype_36204[10] = {0, 0, 0, 0,
                                                                   0, 0, 0, 0,
                                                                   0, 0};
static int32_t test_clusterWithzicounter_mem_realtype_36236[10240];
static int32_t test_clusterWithziid_counter_mem_realtype_36248[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36269[1];
static int32_t test_clusterWithziid_counter_mem_realtype_36287[1];
static int32_t test_elimDupesWithziid_counter_mem_realtype_36324[1];
static int32_t test_elimDupesWithziid_counter_mem_realtype_36339[1];
static int32_t test_elimDupesWithziid_counter_mem_realtype_36359[1];
static int32_t test_mkSegsFromSort_segIndziid_counter_mem_realtype_36395[1];
static int32_t test_mkSegsFromSort_segIndziid_counter_mem_realtype_36410[1];
static int32_t test_mkSegsFromSort_segIndziid_counter_mem_realtype_36430[1];
static int32_t test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36466[1];
static int32_t test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36481[1];
static int32_t test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36501[1];
struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
#include <cuda.h>
#include <nvrtc.h>
typedef CUdeviceptr fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of cuda.h.

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED(x) nvrtc_api_succeed(x, #x, __FILE__, __LINE__)

#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
    const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
        file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
    const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
        file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed(nvrtcResult res, const char *call,
                                     const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
        file, line, call, res, err_str);
  }
}

struct cuda_config {
  int debugging;
  int logging;
  const char *preferred_device;
  int preferred_device_num;

  const char *dump_program_to;
  const char *load_program_from;

  const char *dump_ptx_to;
  const char *load_ptx_from;

  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  int64_t *size_values;
  const char **size_classes;
};

static void cuda_config_init(struct cuda_config *cfg,
                             int num_sizes,
                             const char *size_names[],
                             const char *size_vars[],
                             int64_t *size_values,
                             const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_device = "";
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->default_block_size = 256;
  cfg->default_grid_size = 0; // Set properly later.
  cfg->default_tile_size = 32;
  cfg->default_reg_tile_size = 2;
  cfg->default_threshold = 32*1024;

  cfg->default_block_size_changed = 0;
  cfg->default_grid_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  int *runs;
  int64_t *runtime;
};

struct cuda_context {
  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;

  struct cuda_config cfg;

  struct free_list free_list;

  size_t max_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static void set_preferred_device(struct cuda_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
}

static int cuda_device_setup(struct cuda_context *ctx) {
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best, cc_minor_best;
  int cc_major, cc_minor;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
          i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, ctx->cfg.preferred_device) != NULL &&
        num_device_matches++ == ctx->cfg.preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static char *concat_fragments(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  struct {
    int major;
    int minor;
    const char *arch_str;
  } static const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  for (int i = 0; i < sizeof(x)/sizeof(x[0]); i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static char *cuda_nvrtc_build(struct cuda_context *ctx, const char *src,
                              const char *extra_opts[]) {
  nvrtcProgram prog;
  NVRTC_SUCCEED(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));
  int arch_set = 0, num_extra_opts;

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t n_opts, i = 0, i_dyn, n_opts_alloc = 20 + num_extra_opts + ctx->cfg.num_sizes;
  const char **opts = (const char**) malloc(n_opts_alloc * sizeof(const char *));
  if (!arch_set) {
    opts[i++] = "-arch";
    opts[i++] = cuda_nvrtc_get_arch(ctx->dev);
  }
  opts[i++] = "-default-device";
  if (ctx->cfg.debugging) {
    opts[i++] = "-G";
    opts[i++] = "-lineinfo";
  } else {
    opts[i++] = "--disable-warnings";
  }
  i_dyn = i;
  for (size_t j = 0; j < ctx->cfg.num_sizes; j++) {
    opts[i++] = msgprintf("-D%s=%zu", ctx->cfg.size_vars[j],
        ctx->cfg.size_values[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_block_size);

  // It is crucial that the extra_opts are last, so that the free()
  // logic below does not cause problems.
  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = extra_opts[j];
  }

  n_opts = i;

  if (ctx->cfg.debugging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        fprintf(stderr,"Compilation log:\n%s\n", log);
      }
      free(log);
    }
    NVRTC_SUCCEED(res);
  }

  for (i = i_dyn; i < n_opts-num_extra_opts; i++) { free((char *)opts[i]); }
  free(opts);

  char *ptx;
  size_t ptx_size;
  NVRTC_SUCCEED(nvrtcGetPTXSize(prog, &ptx_size));
  ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED(nvrtcGetPTX(prog, ptx));

  NVRTC_SUCCEED(nvrtcDestroyProgram(&prog));

  return ptx;
}

static void cuda_size_setup(struct cuda_context *ctx)
{
  if (ctx->cfg.default_block_size > ctx->max_block_size) {
    if (ctx->cfg.default_block_size_changed) {
      fprintf(stderr,
          "Note: Device limits default block size to %zu (down from %zu).\n",
          ctx->max_block_size, ctx->cfg.default_block_size);
    }
    ctx->cfg.default_block_size = ctx->max_block_size;
  }
  if (ctx->cfg.default_grid_size > ctx->max_grid_size) {
    if (ctx->cfg.default_grid_size_changed) {
      fprintf(stderr,
          "Note: Device limits default grid size to %zu (down from %zu).\n",
          ctx->max_grid_size, ctx->cfg.default_grid_size);
    }
    ctx->cfg.default_grid_size = ctx->max_grid_size;
  }
  if (ctx->cfg.default_tile_size > ctx->max_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr,
          "Note: Device limits default tile size to %zu (down from %zu).\n",
          ctx->max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = ctx->max_tile_size;
  }

  if (!ctx->cfg.default_grid_size_changed) {
    ctx->cfg.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / ctx->cfg.default_block_size;
  }

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    int64_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "group_size") == size_class) {
      max_value = ctx->max_block_size;
      default_value = ctx->cfg.default_block_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = ctx->cfg.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = ctx->cfg.default_reg_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static void cuda_module_setup(struct cuda_context *ctx,
                              const char *src_fragments[],
                              const char *extra_opts[]) {
  char *ptx = NULL, *src = NULL;

  if (ctx->cfg.load_program_from == NULL) {
    src = concat_fragments(src_fragments);
  } else {
    src = slurp_file(ctx->cfg.load_program_from, NULL);
  }

  if (ctx->cfg.load_ptx_from) {
    if (ctx->cfg.load_program_from != NULL) {
      fprintf(stderr,
              "WARNING: Using PTX from %s instead of C code from %s\n",
              ctx->cfg.load_ptx_from, ctx->cfg.load_program_from);
    }
    ptx = slurp_file(ctx->cfg.load_ptx_from, NULL);
  }

  if (ctx->cfg.dump_program_to != NULL) {
    dump_file(ctx->cfg.dump_program_to, src, strlen(src));
  }

  if (ptx == NULL) {
    ptx = cuda_nvrtc_build(ctx, src, extra_opts);
  }

  if (ctx->cfg.dump_ptx_to != NULL) {
    dump_file(ctx->cfg.dump_ptx_to, ptx, strlen(ptx));
  }

  CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));

  free(ptx);
  if (src != NULL) {
    free(src);
  }
}

static void cuda_setup(struct cuda_context *ctx, const char *src_fragments[], const char *extra_opts[]) {
  CUDA_SUCCEED_FATAL(cuInit(0));

  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->free_list);

  ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK);
  ctx->max_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_block_size);
  ctx->max_threshold = 0;
  ctx->max_bespoke = 0;
  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);

  cuda_size_setup(ctx);
  cuda_module_setup(ctx, src_fragments, extra_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cudaError_t cuda_tally_profiling_records(struct cuda_context *ctx) {
  cudaError_t err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    float ms;
    if ((err = cudaEventElapsedTime(&ms, record.events[0], record.events[1])) != cudaSuccess) {
      return err;
    }

    // CUDA provides milisecond resolution, but we want microseconds.
    *record.runs += 1;
    *record.runtime += ms*1000;

    if ((err = cudaEventDestroy(record.events[0])) != cudaSuccess) {
      return err;
    }
    if ((err = cudaEventDestroy(record.events[1])) != cudaSuccess) {
      return err;
    }

    free(record.events);
  }

  ctx->profiling_records_used = 0;

  return cudaSuccess;
}

// Returns pointer to two events.
static cudaEvent_t* cuda_get_events(struct cuda_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cudaEvent_t *events = calloc(2, sizeof(cudaEvent_t));
    cudaEventCreate(&events[0]);
    cudaEventCreate(&events[1]);
    ctx->profiling_records[ctx->profiling_records_used].events = events;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return events;
}

static CUresult cuda_free_all(struct cuda_context *ctx);

static void cuda_cleanup(struct cuda_context *ctx) {
  CUDA_SUCCEED_FATAL(cuda_free_all(ctx));
  (void)cuda_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
  CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
}

static CUresult cuda_alloc(struct cuda_context *ctx, size_t min_size,
                           const char *tag, CUdeviceptr *mem_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;
  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    if (size >= min_size) {
      return CUDA_SUCCESS;
    } else {
      CUresult res = cuMemFree(*mem_out);
      if (res != CUDA_SUCCESS) {
        return res;
      }
    }
  }

  CUresult res = cuMemAlloc(mem_out, min_size);
  while (res == CUDA_ERROR_OUT_OF_MEMORY) {
    CUdeviceptr mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      res = cuMemFree(mem);
      if (res != CUDA_SUCCESS) {
        return res;
      }
    } else {
      break;
    }
    res = cuMemAlloc(mem_out, min_size);
  }

  return res;
}

static CUresult cuda_free(struct cuda_context *ctx, CUdeviceptr mem,
                          const char *tag) {
  size_t size;
  CUdeviceptr existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    CUresult res = cuMemFree(existing_mem);
    if (res != CUDA_SUCCESS) {
      return res;
    }
  }

  CUresult res = cuMemGetAddressRange(NULL, &size, mem);
  if (res == CUDA_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return res;
}

static CUresult cuda_free_all(struct cuda_context *ctx) {
  CUdeviceptr mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    CUresult res = cuMemFree(mem);
    if (res != CUDA_SUCCESS) {
      return res;
    }
  }

  return CUDA_SUCCESS;
}

// End of cuda.h.

const char *cuda_program[] =
           {"#define FUTHARK_CUDA\n#define FUTHARK_F64_ENABLED\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\ntypedef uint8_t uchar;\ntypedef uint16_t ushort;\ntypedef uint32_t uint;\ntypedef uint64_t ulong;\n#define __kernel extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\nstatic inline int get_group_id_fn(int block_dim0, int block_dim1,\n                                  int block_dim2, int d)\n{\n    switch (d) {\n        \n      case 0:\n        d = block_dim0;\n        break;\n        \n      case 1:\n        d = block_dim1;\n        break;\n        \n      case 2:\n        d = block_dim2;\n        break;\n    }\n    switch (d) {\n        \n      case 0:\n        return blockIdx.x;\n        \n      case 1:\n        return blockIdx.y;\n        \n      case 2:\n        return blockIdx.z;\n        \n      default:\n        return 0;\n    }\n}\n#define get_group_id(d) get_group_id_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_num_groups_fn(int block_dim0, int block_dim1,\n                                    int block_dim2, int d)\n{\n    switch (d) {\n        \n      case 0:\n        d = block_dim0;\n        break;\n        \n      case 1:\n        d = block_dim1;\n        break;\n        \n      case 2:\n        d = block_dim2;\n        break;\n    }\n    switch (d) {\n        \n      case 0:\n        return gridDim.x;\n        \n      case 1:\n        return gridDim.y;\n        \n      case 2:\n        return gridDim.z;\n        \n      default:\n        return 0;\n    }\n}\n#define get_num_groups(d) get_num_groups_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_local_id(int d)\n{\n    switch (d) {\n        \n      case 0:\n        return threadIdx.x;\n        \n      case 1:\n        return threadIdx.y;\n        \n      ca",
            "se 2:\n        return threadIdx.z;\n        \n      default:\n        return 0;\n    }\n}\nstatic inline int get_local_size(int d)\n{\n    switch (d) {\n        \n      case 0:\n        return blockDim.x;\n        \n      case 1:\n        return blockDim.y;\n        \n      case 2:\n        return blockDim.z;\n        \n      default:\n        return 0;\n    }\n}\nstatic inline int get_global_id_fn(int block_dim0, int block_dim1,\n                                   int block_dim2, int d)\n{\n    return get_group_id(d) * get_local_size(d) + get_local_id(d);\n}\n#define get_global_id(d) get_global_id_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_global_size(int block_dim0, int block_dim1,\n                                  int block_dim2, int d)\n{\n    return get_num_groups(d) * get_local_size(d);\n}\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline void barrier(int x)\n{\n    __syncthreads();\n}\nstatic inline void mem_fence_local()\n{\n    __threadfence_block();\n}\nstatic inline void mem_fence_global()\n{\n    __threadfence();\n}\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ char shared_mem[];\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint",
            "64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uin",
            "t32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_",
            "t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int1",
            "6_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smin16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inli",
            "ne uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n",
            "    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#d",
            "efine sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#define sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n   ",
            "     x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic u",
            "int32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n",
            "    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzll(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    retu",
            "rn pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    retu",
            "rn tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline float futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_hypot32(float x, float y)\n{\n    return hypot(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float futrts_log32(float x)\n{\n    return logf(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2f(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10f(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrtf(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return expf(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cosf(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sinf(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    ",
            "return tanf(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acosf(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asinf(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atanf(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return coshf(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinhf(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanhf(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acoshf(x);\n}\nstatic inline float futrts_asinh32(float x)\n{\n    return asinhf(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanhf(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2f(x, y);\n}\nstatic inline float futrts_hypot32(float x, float y)\n{\n    return hypotf(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgammaf(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgammaf(x);\n}\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float fsignum32(float x)\n{\n    return futrts_isnan32(x) ? x : (x > 0) - (x < 0);\n}\nstatic inline double fdiv64(double x, double y)\n{\n    return x / y;\n}\nstatic inline double fadd64(double x, do",
            "uble y)\n{\n    return x + y;\n}\nstatic inline double fsub64(double x, double y)\n{\n    return x - y;\n}\nstatic inline double fmul64(double x, double y)\n{\n    return x * y;\n}\nstatic inline double fmin64(double x, double y)\n{\n    return fmin(x, y);\n}\nstatic inline double fmax64(double x, double y)\n{\n    return fmax(x, y);\n}\nstatic inline double fpow64(double x, double y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt64(double x, double y)\n{\n    return x < y;\n}\nstatic inline bool cmple64(double x, double y)\n{\n    return x <= y;\n}\nstatic inline double sitofp_i8_f64(int8_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i16_f64(int16_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i32_f64(int32_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i64_f64(int64_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i8_f64(uint8_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i16_f64(uint16_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i32_f64(uint32_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i64_f64(uint64_t x)\n{\n    return (double) x;\n}\nstatic inline int8_t fptosi_f64_i8(double x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f64_i16(double x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f64_i32(double x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f64_i64(double x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f64_i8(double x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f64_i16(double x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f64_i32(double x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f64_i64(double x)\n{\n    return (uint64_t) x;\n}\nstatic inline double futrts_log64(double x)\n{\n    return log(x);\n}\nstatic inline double futrts_log2_64(double x)\n{\n    return log2(x);\n}\nstatic inline double futrts_log10_64(double x)\n{\n    return log10(x);\n}\nstatic inline double futrts_sqrt64(double x)\n{\n    return sqrt(x",
            ");\n}\nstatic inline double futrts_exp64(double x)\n{\n    return exp(x);\n}\nstatic inline double futrts_cos64(double x)\n{\n    return cos(x);\n}\nstatic inline double futrts_sin64(double x)\n{\n    return sin(x);\n}\nstatic inline double futrts_tan64(double x)\n{\n    return tan(x);\n}\nstatic inline double futrts_acos64(double x)\n{\n    return acos(x);\n}\nstatic inline double futrts_asin64(double x)\n{\n    return asin(x);\n}\nstatic inline double futrts_atan64(double x)\n{\n    return atan(x);\n}\nstatic inline double futrts_cosh64(double x)\n{\n    return cosh(x);\n}\nstatic inline double futrts_sinh64(double x)\n{\n    return sinh(x);\n}\nstatic inline double futrts_tanh64(double x)\n{\n    return tanh(x);\n}\nstatic inline double futrts_acosh64(double x)\n{\n    return acosh(x);\n}\nstatic inline double futrts_asinh64(double x)\n{\n    return asinh(x);\n}\nstatic inline double futrts_atanh64(double x)\n{\n    return atanh(x);\n}\nstatic inline double futrts_atan2_64(double x, double y)\n{\n    return atan2(x, y);\n}\nstatic inline double futrts_hypot64(double x, double y)\n{\n    return hypot(x, y);\n}\nstatic inline double futrts_gamma64(double x)\n{\n    return tgamma(x);\n}\nstatic inline double futrts_lgamma64(double x)\n{\n    return lgamma(x);\n}\nstatic inline double futrts_fma64(double a, double b, double c)\n{\n    return fma(a, b, c);\n}\nstatic inline double futrts_round64(double x)\n{\n    return rint(x);\n}\nstatic inline double futrts_ceil64(double x)\n{\n    return ceil(x);\n}\nstatic inline double futrts_floor64(double x)\n{\n    return floor(x);\n}\nstatic inline bool futrts_isnan64(double x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf64(double x)\n{\n    return isinf(x);\n}\nstatic inline int64_t futrts_to_bits64(double x)\n{\n    union {\n        double f;\n        int64_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline double futrts_from_bits64(int64_t x)\n{\n    union {\n        int64_t f;\n        double t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline double fmod64(double x, double y)\n{\n   ",
            " return fmod(x, y);\n}\nstatic inline double fsignum64(double x)\n{\n    return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n#ifdef __OPENCL_VERSION__\nstatic inline double futrts_lerp64(double v0, double v1, double t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline double futrts_mad64(double a, double b, double c)\n{\n    return mad(a, b, c);\n}\n#else\nstatic inline double futrts_lerp64(double v0, double v1, double t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline double futrts_mad64(double a, double b, double c)\n{\n    return a * b + c;\n}\n#endif\nstatic inline float fpconv_f32_f32(float x)\n{\n    return (float) x;\n}\nstatic inline double fpconv_f32_f64(float x)\n{\n    return (double) x;\n}\nstatic inline float fpconv_f64_f32(double x)\n{\n    return (float) x;\n}\nstatic inline double fpconv_f64_f64(double x)\n{\n    return (double) x;\n}\n// Start of atomics.h\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                        int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n",
            "  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_global((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_local((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#",
            "endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\ninline int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\ninline int64_t atomic_xchg_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\ninline int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                         int64_t cmp, int64_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCA",
            "S((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int64_t atomic_cmpxchg_i64_local(volatile __local int64_t *p,\n                                        int64_t cmp, int64_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\ninline int64_t atomic_add_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\ninline double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  union { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline double atomic_fadd_f64_local(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  union { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_local((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\ninline int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\ninline int64_t atomic_smax_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\ninli",
            "ne int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\ninline int64_t atomic_smin_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\ninline uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\ninline uint64_t atomic_umax_i64_local(volatile __local uint64_t *p, uint64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\ninline uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\ninline uint64_t atomic_umin_i64_local(volatile __local uint64_t *p, uint64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\ninline int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\ninline int64_t atomic_and_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\ninline int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\ninline int64_t atomic_or_i64_local(volatile __local int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\ninline int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\ninline int64_t atomic_xor_i64_local(volatile __loca",
            "l int64_t *p, int64_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhiota_i64ziiota_i64_32449(int32_t n_32445,\n                                                int64_t x_32446,\n                                                int64_t s_32447, __global\n                                                unsigned char *mem_32444)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t iota_gtid_32449;\n    int32_t iota_ltid_32450;\n    int32_t iota_gid_32451;\n    \n    iota_gtid_32449 = get_global_id(0);\n    iota_ltid_32450 = get_local_id(0);\n    iota_gid_32451 = get_group_id(0);\n    if (slt64(iota_gtid_32449, n_32445)) {\n        ((__global int64_t *) mem_32444)[sext_i32_i64(iota_gtid_32449)] =\n            add64(mul64(sext_i32_i64(iota_gtid_32449), s_32447), x_32446);\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i32zireplicate_33027(int32_t num_elems_33024,\n                                                      int32_t val_33025,\n                                                      __global\n                                                      unsigned char *mem_33023)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_33027;\n    int32_t replicate_ltid_33028;\n    int32_t replicate_gid_33029;\n    \n    replicate_gtid_33027 = get_global_id(0);\n    replicate_ltid_33028 = get_local_id(0);\n    replicate_gid_33029 = get_group_id(0);\n    if (slt64(replicate_gtid_33027, num_elems_33024)) {\n        ((__global int32_t *) mem_33023)[sext_i32_i64(replicate_gtid_33027)] =\n            val_33025;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_32925(int32_t num_elems_32922,\n                                                      int64_t val_32923,\n                                                      __global\n            ",
            "                                          unsigned char *mem_32921)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_32925;\n    int32_t replicate_ltid_32926;\n    int32_t replicate_gid_32927;\n    \n    replicate_gtid_32925 = get_global_id(0);\n    replicate_ltid_32926 = get_local_id(0);\n    replicate_gid_32927 = get_group_id(0);\n    if (slt64(replicate_gtid_32925, num_elems_32922)) {\n        ((__global int64_t *) mem_32921)[sext_i32_i64(replicate_gtid_32925)] =\n            val_32923;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i8zireplicate_32495(int32_t num_elems_32492,\n                                                     int8_t val_32493, __global\n                                                     unsigned char *mem_32491)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_32495;\n    int32_t replicate_ltid_32496;\n    int32_t replicate_gid_32497;\n    \n    replicate_gtid_32495 = get_global_id(0);\n    replicate_ltid_32496 = get_local_id(0);\n    replicate_gid_32497 = get_group_id(0);\n    if (slt64(replicate_gtid_32495, num_elems_32492)) {\n        ((__global int8_t *) mem_32491)[sext_i32_i64(replicate_gtid_32495)] =\n            val_32493;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_ballQueryzicopy_33017(int64_t num_segments_29894, __global\n                                         unsigned char *mem_32024, __global\n                                         unsigned char *mem_32026)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_33017;\n    int32_t copy_ltid_33018;\n    int32_t copy_gid_33019;\n    \n    copy_gtid_33017 = get_global_id(0);\n    copy_ltid_33018 = get_local_id(0);\n    copy_gid_33019 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_33017), num_segments_29894)) {\n        ((__global int64_t *) mem_32026)[sext_i32_i64(copy_",
            "gtid_33017)] =\n            ((__global\n              int64_t *) mem_32024)[smod64(sext_i32_i64(copy_gtid_33017) +\n                                           (int64_t) -1, num_segments_29894)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_ballQueryziseghist_global_31628(__global int *global_failure,\n                                                   int64_t defunc_2_reduce_res_29982,\n                                                   int64_t num_groups_31625,\n                                                   int64_t bytes_31948,\n                                                   int32_t num_subhistos_33156,\n                                                   int32_t chk_i_33223,\n                                                   int64_t hist_H_chk_33224,\n                                                   __global\n                                                   unsigned char *mem_32047,\n                                                   __global\n                                                   unsigned char *defunc_1_map_res_subhistos_mem_33157)\n{\n    #define seghist_group_sizze_31623 (test_ballQueryziseghist_group_sizze_31622)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33225;\n    int32_t local_tid_33226;\n    int64_t group_sizze_33229;\n    int32_t wave_sizze_33228;\n    int32_t group_tid_33227;\n    \n    global_tid_33225 = get_global_id(0);\n    local_tid_33226 = get_local_id(0);\n    group_sizze_33229 = get_local_size(0);\n    wave_sizze_33228 = LOCKSTEP_WIDTH;\n    group_tid_33227 = get_group_id(0);\n    \n    int32_t phys_tid_31628;\n    \n    phys_tid_31628 = global_tid_33225;\n    \n    int32_t subhisto_ind_33230;\n    \n    subhisto_ind_33230 = squot32(global_tid_33225,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_31623 *\n                                           num_groups_31625),\n                    ",
            "                       num_subhistos_33156));\n    for (int64_t i_33231 = 0; i_33231 < sdiv_up64(bytes_31948 -\n                                                  sext_i32_i64(global_tid_33225),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_31623 *\n                                                  num_groups_31625)));\n         i_33231++) {\n        int32_t gtid_31627 = sext_i64_i32(i_33231 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_31623 *\n                num_groups_31625)) + sext_i32_i64(global_tid_33225));\n        \n        if (slt64(i_33231 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_31623 *\n                  num_groups_31625)) + sext_i32_i64(global_tid_33225),\n                  bytes_31948)) {\n            int64_t i_p_o_31876 = add64((int64_t) -1, gtid_31627);\n            int64_t rot_i_31877 = smod64(i_p_o_31876, bytes_31948);\n            bool cond_31634 = gtid_31627 == (int64_t) 0;\n            int64_t defunc_1_f_res_31635;\n            \n            if (cond_31634) {\n                defunc_1_f_res_31635 = (int64_t) 0;\n            } else {\n                int64_t x_31633 = ((__global int64_t *) mem_32047)[rot_i_31877];\n                \n                defunc_1_f_res_31635 = x_31633;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_33223) * hist_H_chk_33224,\n                          defunc_1_f_res_31635) && (slt64(defunc_1_f_res_31635,\n                                                          sext_i32_i64(chk_i_33223) *\n                                                          hist_H_chk_33224 +\n                                                          hist_H_chk_33224) &&\n                                                    slt64(defunc_1_f_res_31635,\n                                                          defunc_2_reduce_res_29982))) {\n                    int64_t ",
            "x_31629;\n                    int64_t x_31630;\n                    \n                    x_31630 = gtid_31627;\n                    \n                    int64_t old_33232;\n                    \n                    old_33232 = atomic_smax_i64_global(&((volatile __global\n                                                          int64_t *) defunc_1_map_res_subhistos_mem_33157)[sext_i32_i64(subhisto_ind_33230) *\n                                                                                                           defunc_2_reduce_res_29982 +\n                                                                                                           defunc_1_f_res_31635],\n                                                       (int64_t) x_31630);\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_31623\n}\n__kernel void test_ballQueryziseghist_local_31628(__global int *global_failure,\n                                                  uint subhistogram_local_mem_33195_backing_offset_0,\n                                                  int64_t defunc_2_reduce_res_29982,\n                                                  int64_t bytes_31948,\n                                                  int32_t max_group_sizze_33166,\n                                                  int64_t num_groups_33167,\n                                                  int32_t hist_M_33173,\n                                                  int32_t chk_i_33178,\n                                                  int64_t num_segments_33179,\n                                                  int64_t hist_H_chk_33180,\n                                                  int64_t histo_sizze_33181,\n                                                  int32_t init_per_thread_33182,\n                                                  __global\n                                                  unsigned char *mem_32047,\n                                                  __",
            "global\n                                                  unsigned char *defunc_1_map_res_subhistos_mem_33157)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *subhistogram_local_mem_33195_backing_0 =\n                  &shared_mem[subhistogram_local_mem_33195_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33183;\n    int32_t local_tid_33184;\n    int64_t group_sizze_33187;\n    int32_t wave_sizze_33186;\n    int32_t group_tid_33185;\n    \n    global_tid_33183 = get_global_id(0);\n    local_tid_33184 = get_local_id(0);\n    group_sizze_33187 = get_local_size(0);\n    wave_sizze_33186 = LOCKSTEP_WIDTH;\n    group_tid_33185 = get_group_id(0);\n    \n    int32_t phys_tid_31628;\n    \n    phys_tid_31628 = global_tid_33183;\n    \n    int32_t phys_group_id_33188;\n    \n    phys_group_id_33188 = get_group_id(0);\n    for (int32_t i_33189 = 0; i_33189 <\n         sdiv_up32(sext_i64_i32(num_groups_33167 * num_segments_33179) -\n                   phys_group_id_33188, sext_i64_i32(num_groups_33167));\n         i_33189++) {\n        int32_t virt_group_id_33190 = phys_group_id_33188 + i_33189 *\n                sext_i64_i32(num_groups_33167);\n        int32_t flat_segment_id_33191 = squot32(virt_group_id_33190,\n                                                sext_i64_i32(num_groups_33167));\n        int32_t gid_in_segment_33192 = srem32(virt_group_id_33190,\n                                              sext_i64_i32(num_groups_33167));\n        int32_t pgtid_in_segment_33193 = gid_in_segment_33192 *\n                sext_i64_i32(max_group_sizze_33166) + local_tid_33184;\n        int32_t threads_per_segment_33194 = sext_i64_i32(num_groups_33167 *\n                max_group_sizze_33166);\n        __local char *subhistogram_local_mem_33195;\n        \n        subhistogram_local_mem_33195 = (__local\n                                        char *) subhistogram_local_mem_33195_backing_0;\n        \n       ",
            " int32_t thread_local_subhisto_i_33197;\n        \n        thread_local_subhisto_i_33197 = srem32(local_tid_33184, hist_M_33173);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_33198 = 0; local_i_33198 <\n                 init_per_thread_33182; local_i_33198++) {\n                int32_t j_33199 = local_i_33198 *\n                        sext_i64_i32(max_group_sizze_33166) + local_tid_33184;\n                int32_t j_offset_33200 = hist_M_33173 *\n                        sext_i64_i32(histo_sizze_33181) * gid_in_segment_33192 +\n                        j_33199;\n                int32_t local_subhisto_i_33201 = squot32(j_33199,\n                                                         sext_i64_i32(histo_sizze_33181));\n                int32_t global_subhisto_i_33202 = squot32(j_offset_33200,\n                                                          sext_i64_i32(histo_sizze_33181));\n                \n                if (slt32(j_33199, hist_M_33173 *\n                          sext_i64_i32(histo_sizze_33181))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_33202 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_33195)[sext_i32_i64(local_subhisto_i_33201) *\n                                                                       hist_H_chk_33180 +\n                                                                       sext_i32_i64(srem32(j_33199,\n                                                                                           sext_i64_i32(histo_sizze_33181)))] =\n                                ((__global\n                                  int64_t *) defunc_1_map_res_subhistos_mem_33157)[sext_i32_i64(srem32(j_33199,\n                                                                                                       sext_i64_i32(histo_sizze_33181)",
            ")) +\n                                                                                   sext_i32_i64(chk_i_33178) *\n                                                                                   hist_H_chk_33180];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_33195)[sext_i32_i64(local_subhisto_i_33201) *\n                                                                       hist_H_chk_33180 +\n                                                                       sext_i32_i64(srem32(j_33199,\n                                                                                           sext_i64_i32(histo_sizze_33181)))] =\n                                (int64_t) 0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33203 = 0; i_33203 <\n             sdiv_up32(sext_i64_i32(bytes_31948) - pgtid_in_segment_33193,\n                       threads_per_segment_33194); i_33203++) {\n            int32_t gtid_31627 = i_33203 * threads_per_segment_33194 +\n                    pgtid_in_segment_33193;\n            int64_t i_p_o_31876 = add64((int64_t) -1, gtid_31627);\n            int64_t rot_i_31877 = smod64(i_p_o_31876, bytes_31948);\n            bool cond_31634 = gtid_31627 == (int64_t) 0;\n            int64_t defunc_1_f_res_31635;\n            \n            if (cond_31634) {\n                defunc_1_f_res_31635 = (int64_t) 0;\n            } else {\n                int64_t x_31633 = ((__global int64_t *) mem_32047)[rot_i_31877];\n                \n                defunc_1_f_res_31635 = x_31633;\n            }\n            if (chk_i_33178 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(defunc_1_f_res_31635, defunc_2_reduce_res_29982) &&\n                    (sle64(sext_i32_i64(chk_i_33178) * hist_H_",
            "chk_33180,\n                           defunc_1_f_res_31635) && slt64(defunc_1_f_res_31635,\n                                                          sext_i32_i64(chk_i_33178) *\n                                                          hist_H_chk_33180 +\n                                                          hist_H_chk_33180))) {\n                    int64_t x_31629;\n                    int64_t x_31630;\n                    \n                    x_31630 = gtid_31627;\n                    \n                    int64_t old_33204;\n                    \n                    old_33204 = atomic_smax_i64_local(&((volatile __local\n                                                         int64_t *) subhistogram_local_mem_33195)[sext_i32_i64(thread_local_subhisto_i_33197) *\n                                                                                                  hist_H_chk_33180 +\n                                                                                                  (defunc_1_f_res_31635 -\n                                                                                                   sext_i32_i64(chk_i_33178) *\n                                                                                                   hist_H_chk_33180)],\n                                                      (int64_t) x_31630);\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_33205 = smin64(hist_H_chk_33180,\n                                           defunc_2_reduce_res_29982 -\n                                           sext_i32_i64(chk_i_33178) *\n                                           hist_H_chk_33180);\n            int32_t histo_sizze_33206 = sext_i64_i32(trunc_H_33205);\n            \n            for (int32_t local_i_33207 = 0; local_i_33207 <\n                 init_per_thread_33182; local_i_33207++) {\n                int32_t j_332",
            "08 = local_i_33207 *\n                        sext_i64_i32(max_group_sizze_33166) + local_tid_33184;\n                \n                if (slt32(j_33208, histo_sizze_33206)) {\n                    int64_t x_31629;\n                    int64_t x_31630;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_31629 = ((__local\n                                    int64_t *) subhistogram_local_mem_33195)[sext_i32_i64(j_33208)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_33209 = 0; subhisto_id_33209 <\n                             hist_M_33173 - 1; subhisto_id_33209++) {\n                            x_31630 = ((__local\n                                        int64_t *) subhistogram_local_mem_33195)[(sext_i32_i64(subhisto_id_33209) +\n                                                                                  (int64_t) 1) *\n                                                                                 hist_H_chk_33180 +\n                                                                                 sext_i32_i64(j_33208)];\n                            \n                            int64_t defunc_1_f_res_31631;\n                            \n                            defunc_1_f_res_31631 = smax64(x_31629, x_31630);\n                            x_31629 = defunc_1_f_res_31631;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_33157)[srem64(sext_i32_i64(virt_group_id_33190),\n                                                                                  num_groups_33167) *\n                                                                           defunc_2_reduce_res_29982 +\n                              ",
            "                                             (sext_i32_i64(j_33208) +\n                                                                            sext_i32_i64(chk_i_33178) *\n                                                                            hist_H_chk_33180)] =\n                            x_31629;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void test_ballQueryzisegmap_31159(__global int *global_failure,\n                                           int64_t implz2081U_29737, __global\n                                           unsigned char *mem_31953, __global\n                                           unsigned char *mem_31956)\n{\n    #define segmap_group_sizze_31219 (test_ballQueryzisegmap_group_sizze_31161)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32459;\n    int32_t local_tid_32460;\n    int64_t group_sizze_32463;\n    int32_t wave_sizze_32462;\n    int32_t group_tid_32461;\n    \n    global_tid_32459 = get_global_id(0);\n    local_tid_32460 = get_local_id(0);\n    group_sizze_32463 = get_local_size(0);\n    wave_sizze_32462 = LOCKSTEP_WIDTH;\n    group_tid_32461 = get_group_id(0);\n    \n    int32_t phys_tid_31159;\n    \n    phys_tid_31159 = global_tid_32459;\n    \n    int64_t gtid_31158;\n    \n    gtid_31158 = sext_i32_i64(group_tid_32461) * segmap_group_sizze_31219 +\n        sext_i32_i64(local_tid_32460);\n    if (slt64(gtid_31158, implz2081U_29737)) {\n        int32_t x_31223 = ((__global int32_t *) mem_31953)[gtid_31158 *\n                                                           (int64_t) 3 +\n                                                           (int64_t) 2];\n        int32_t x_31224 = x_31223 << 4;\n        int32_t y_31225 = ((__global int32_t *) mem_31953)[gtid_31158 *\n                                          ",
            "                 (int64_t) 3 +\n                                                           (int64_t) 1];\n        int32_t x_31226 = x_31224 | y_31225;\n        int32_t x_31227 = x_31226 << 4;\n        int32_t y_31228 = ((__global int32_t *) mem_31953)[gtid_31158 *\n                                                           (int64_t) 3];\n        int32_t defunc_0_f_res_31229 = x_31227 | y_31228;\n        \n        ((__global int32_t *) mem_31956)[gtid_31158] = defunc_0_f_res_31229;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31219\n}\n__kernel void test_ballQueryzisegmap_31182(__global int *global_failure,\n                                           int64_t implz2081U_29737,\n                                           float radius_29738, __global\n                                           unsigned char *pos_mem_31946,\n                                           __global unsigned char *mem_31953)\n{\n    #define segmap_group_sizze_31209 (test_ballQueryzisegmap_group_sizze_31185)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32454;\n    int32_t local_tid_32455;\n    int64_t group_sizze_32458;\n    int32_t wave_sizze_32457;\n    int32_t group_tid_32456;\n    \n    global_tid_32454 = get_global_id(0);\n    local_tid_32455 = get_local_id(0);\n    group_sizze_32458 = get_local_size(0);\n    wave_sizze_32457 = LOCKSTEP_WIDTH;\n    group_tid_32456 = get_group_id(0);\n    \n    int32_t phys_tid_31182;\n    \n    phys_tid_31182 = global_tid_32454;\n    \n    int64_t gtid_31180;\n    \n    gtid_31180 = squot64(sext_i32_i64(group_tid_32456) *\n                         segmap_group_sizze_31209 +\n                         sext_i32_i64(local_tid_32455), (int64_t) 3);\n    \n    int64_t gtid_31181;\n    \n    gtid_31181 = sext_i32_i64(group_tid_32456) * segmap_group_sizze_31209 +\n        sext_i32_i64(local_tid_32455) - squot64(sext_i32_i64(group_tid_32456) *\n                 ",
            "                               segmap_group_sizze_31209 +\n                                                sext_i32_i64(local_tid_32455),\n                                                (int64_t) 3) * (int64_t) 3;\n    if (slt64(gtid_31180, implz2081U_29737) && slt64(gtid_31181, (int64_t) 3)) {\n        float x_31212 = ((__global float *) pos_mem_31946)[gtid_31180 *\n                                                           (int64_t) 3 +\n                                                           gtid_31181];\n        float binop_p_31213 = x_31212 / radius_29738;\n        float defunc_0_f_res_31214;\n        \n        defunc_0_f_res_31214 = futrts_floor32(binop_p_31213);\n        \n        int32_t f32_res_31215 = fptosi_f32_i32(defunc_0_f_res_31214);\n        int32_t defunc_0_f_res_31216 = 15 & f32_res_31215;\n        \n        ((__global int32_t *) mem_31953)[gtid_31180 * (int64_t) 3 +\n                                         gtid_31181] = defunc_0_f_res_31216;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31209\n}\n__kernel void test_ballQueryzisegmap_31239(__global int *global_failure,\n                                           int64_t implz2081U_29737,\n                                           int64_t last_res_29824,\n                                           int64_t last_res_29825,\n                                           int64_t last_res_29826, __global\n                                           unsigned char *mem_param_31961,\n                                           __global\n                                           unsigned char *mem_param_31966,\n                                           __global unsigned char *mem_31973,\n                                           __global unsigned char *mem_31975,\n                                           __global unsigned char *mem_31977,\n                                           __global unsigned char *mem_31979,\n                                           __global unsigned char *mem_31981,\n                    ",
            "                       __global unsigned char *mem_31983,\n                                           __global unsigned char *mem_31985)\n{\n    #define segmap_group_sizze_31242 (test_ballQueryzisegmap_group_sizze_31241)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32691;\n    int32_t local_tid_32692;\n    int64_t group_sizze_32695;\n    int32_t wave_sizze_32694;\n    int32_t group_tid_32693;\n    \n    global_tid_32691 = get_global_id(0);\n    local_tid_32692 = get_local_id(0);\n    group_sizze_32695 = get_local_size(0);\n    wave_sizze_32694 = LOCKSTEP_WIDTH;\n    group_tid_32693 = get_group_id(0);\n    \n    int32_t phys_tid_31239;\n    \n    phys_tid_31239 = global_tid_32691;\n    \n    int64_t write_i_31238;\n    \n    write_i_31238 = sext_i32_i64(group_tid_32693) * segmap_group_sizze_31242 +\n        sext_i32_i64(local_tid_32692);\n    if (slt64(write_i_31238, implz2081U_29737)) {\n        int32_t x_29831 = ((__global int32_t *) mem_31981)[write_i_31238];\n        int32_t write_value_29836 = ((__global\n                                      int32_t *) mem_param_31961)[write_i_31238];\n        int64_t write_value_29837 = ((__global\n                                      int64_t *) mem_param_31966)[write_i_31238];\n        bool match_lit_29838 = 0 == x_29831;\n        int64_t defunc_1_f_res_29839;\n        \n        if (match_lit_29838) {\n            int64_t x_29832 = ((__global int64_t *) mem_31973)[write_i_31238];\n            int64_t case_res_29840 = sub64(x_29832, (int64_t) 1);\n            \n            defunc_1_f_res_29839 = case_res_29840;\n        } else {\n            bool match_lit_29841 = 1 == x_29831;\n            int64_t x_29842;\n            \n            if (match_lit_29841) {\n                int64_t x_29833 = ((__global\n                                    int64_t *) mem_31975)[write_i_31238];\n                int64_t x_29843 = add64(last_res_29824, x_29833);\n ",
            "               int64_t case_res_29844 = sub64(x_29843, (int64_t) 1);\n                \n                x_29842 = case_res_29844;\n            } else {\n                bool match_lit_29845 = 2 == x_29831;\n                int64_t x_29846;\n                \n                if (match_lit_29845) {\n                    int64_t x_29834 = ((__global\n                                        int64_t *) mem_31977)[write_i_31238];\n                    int64_t x_29847 = add64(last_res_29824, last_res_29825);\n                    int64_t x_29848 = add64(x_29834, x_29847);\n                    int64_t case_res_29849 = sub64(x_29848, (int64_t) 1);\n                    \n                    x_29846 = case_res_29849;\n                } else {\n                    int64_t x_29835 = ((__global\n                                        int64_t *) mem_31979)[write_i_31238];\n                    int64_t x_29850 = add64(last_res_29824, last_res_29825);\n                    int64_t x_29851 = add64(last_res_29826, x_29850);\n                    int64_t x_29852 = add64(x_29835, x_29851);\n                    int64_t defunc_1_f_res_res_29853 = sub64(x_29852,\n                                                             (int64_t) 1);\n                    \n                    x_29846 = defunc_1_f_res_res_29853;\n                }\n                x_29842 = x_29846;\n            }\n            defunc_1_f_res_29839 = x_29842;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29839) &&\n            slt64(defunc_1_f_res_29839, implz2081U_29737)) {\n            ((__global int32_t *) mem_31983)[defunc_1_f_res_29839] =\n                write_value_29836;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29839) &&\n            slt64(defunc_1_f_res_29839, implz2081U_29737)) {\n            ((__global int64_t *) mem_31985)[defunc_1_f_res_29839] =\n                write_value_29837;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31242\n}\n__kernel void test_ballQueryzisegmap_31245(__global int *globa",
            "l_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           int64_t implz2081U_29737, __global\n                                           unsigned char *mem_31956, __global\n                                           unsigned char *defunc_0_f_res_mem_32000,\n                                           __global unsigned char *mem_32003,\n                                           __global unsigned char *mem_32005,\n                                           __global unsigned char *mem_32007)\n{\n    #define segmap_group_sizze_31260 (test_ballQueryzisegmap_group_sizze_31247)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32696;\n    int32_t local_tid_32697;\n    int64_t group_sizze_32700;\n    int32_t wave_sizze_32699;\n    int32_t group_tid_32698;\n    \n    global_tid_32696 = get_global_id(0);\n    local_tid_32697 = get_local_id(0);\n    group_sizze_32700 = get_local_size(0);\n    wave_sizze_32699 = LOCKSTEP_WIDTH;\n    group_tid_32698 = get_group_id(0);\n    \n    int32_t phys_tid_31245;\n    \n    phys_tid_31245 = global_tid_32696;\n    \n    int64_t gtid_31244;\n    \n    gtid_31244 = sext_i32_i64(group_tid_32698) * segmap_group_sizze_31260 +\n        sext_i32_i64(local_tid_32697);\n    if (slt64(gtid_31244, implz2081U_29737)) {\n        int64_t x_31265 = ((__global\n                            int64_t *) defunc_0_f_res_mem_32000)[gtid_31244];\n        bool x_31266 = sle64((int64_t) 0, x_31265);\n        bool y_31267 = slt64(x_31265, implz2081U_29737);\n        bool bounds_check_31268 = x_31266 && y_31267;\n        bool index_certs_31269;\n        \n        if (!bounds_check_31268) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = x_31265;\n   ",
            "                 global_failure_args[1] = implz2081U_29737;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_0_f_res_31270 = ((__global\n                                         int32_t *) mem_31956)[x_31265];\n        int32_t index_primexp_31271 = sext_i64_i32(x_31265);\n        int32_t defunc_0_f_res_elem_31272 = index_primexp_31271;\n        int64_t defunc_0_f_res_31273 = sext_i32_i64(defunc_0_f_res_31270);\n        \n        ((__global int64_t *) mem_32003)[gtid_31244] = defunc_0_f_res_31273;\n        ((__global int32_t *) mem_32005)[gtid_31244] = defunc_0_f_res_31270;\n        ((__global int32_t *) mem_32007)[gtid_31244] =\n            defunc_0_f_res_elem_31272;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31260\n}\n__kernel void test_ballQueryzisegmap_31275(__global int *global_failure,\n                                           int64_t implz2081U_29737, __global\n                                           unsigned char *mem_32003, __global\n                                           unsigned char *mem_32010)\n{\n    #define segmap_group_sizze_31285 (test_ballQueryzisegmap_group_sizze_31277)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32701;\n    int32_t local_tid_32702;\n    int64_t group_sizze_32705;\n    int32_t wave_sizze_32704;\n    int32_t group_tid_32703;\n    \n    global_tid_32701 = get_global_id(0);\n    local_tid_32702 = get_local_id(0);\n    group_sizze_32705 = get_local_size(0);\n    wave_sizze_32704 = LOCKSTEP_WIDTH;\n    group_tid_32703 = get_group_id(0);\n    \n    int32_t phys_tid_31275;\n    \n    phys_tid_31275 = global_tid_32701;\n    \n    int64_t gtid_31274;\n    \n    gtid_31274 = sext_i32_i64(group_tid_32703) * segmap_group_sizze_31285 +\n        sext_i32_i64(local_tid_32702);\n    if (slt64(gtid_31274, implz2081U_29737)) {\n        int64_t x_31288 = ((__g",
            "lobal int64_t *) mem_32003)[gtid_31274];\n        int64_t i_p_o_31848 = add64((int64_t) -1, gtid_31274);\n        int64_t rot_i_31849 = smod64(i_p_o_31848, implz2081U_29737);\n        int64_t x_31289 = ((__global int64_t *) mem_32003)[rot_i_31849];\n        bool defunc_1_f_res_31290 = x_31288 == x_31289;\n        bool defunc_1_f_res_31291 = !defunc_1_f_res_31290;\n        \n        ((__global bool *) mem_32010)[gtid_31274] = defunc_1_f_res_31291;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31285\n}\n__kernel void test_ballQueryzisegmap_31309(__global int *global_failure,\n                                           int64_t implz2081U_29737,\n                                           int64_t num_segments_29894, __global\n                                           unsigned char *mem_32010, __global\n                                           unsigned char *mem_32015, __global\n                                           unsigned char *mem_32018, __global\n                                           unsigned char *mem_32020)\n{\n    #define segmap_group_sizze_31312 (test_ballQueryzisegmap_group_sizze_31311)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32930;\n    int32_t local_tid_32931;\n    int64_t group_sizze_32934;\n    int32_t wave_sizze_32933;\n    int32_t group_tid_32932;\n    \n    global_tid_32930 = get_global_id(0);\n    local_tid_32931 = get_local_id(0);\n    group_sizze_32934 = get_local_size(0);\n    wave_sizze_32933 = LOCKSTEP_WIDTH;\n    group_tid_32932 = get_group_id(0);\n    \n    int32_t phys_tid_31309;\n    \n    phys_tid_31309 = global_tid_32930;\n    \n    int64_t write_i_31308;\n    \n    write_i_31308 = sext_i32_i64(group_tid_32932) * segmap_group_sizze_31312 +\n        sext_i32_i64(local_tid_32931);\n    if (slt64(write_i_31308, implz2081U_29737)) {\n        int64_t i_p_o_31852 = add64((int64_t) 1, write_i_31308);\n        int64_t rot_i_31",
            "853 = smod64(i_p_o_31852, implz2081U_29737);\n        bool x_29903 = ((__global bool *) mem_32010)[rot_i_31853];\n        int64_t write_value_29904 = ((__global\n                                      int64_t *) mem_32015)[write_i_31308];\n        int64_t defunc_1_f_res_29905;\n        \n        if (x_29903) {\n            int64_t x_29902 = ((__global int64_t *) mem_32018)[write_i_31308];\n            int64_t defunc_1_f_res_t_res_29906 = sub64(x_29902, (int64_t) 1);\n            \n            defunc_1_f_res_29905 = defunc_1_f_res_t_res_29906;\n        } else {\n            defunc_1_f_res_29905 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29905) &&\n            slt64(defunc_1_f_res_29905, num_segments_29894)) {\n            ((__global int64_t *) mem_32020)[defunc_1_f_res_29905] =\n                write_value_29904;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31312\n}\n__kernel void test_ballQueryzisegmap_31323(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           int64_t implz2081U_29737,\n                                           int64_t num_segments_29894, __global\n                                           unsigned char *mem_32005, __global\n                                           unsigned char *mem_32020, __global\n                                           unsigned char *mem_32026, __global\n                                           unsigned char *mem_32028, __global\n                                           unsigned char *mem_32030)\n{\n    #define segmap_group_sizze_31326 (test_ballQueryzisegmap_group_sizze_31325)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33022;\n    int32_t local_tid_33023;\n    int64_t group_sizze_33026;\n    ",
            "int32_t wave_sizze_33025;\n    int32_t group_tid_33024;\n    \n    global_tid_33022 = get_global_id(0);\n    local_tid_33023 = get_local_id(0);\n    group_sizze_33026 = get_local_size(0);\n    wave_sizze_33025 = LOCKSTEP_WIDTH;\n    group_tid_33024 = get_group_id(0);\n    \n    int32_t phys_tid_31323;\n    \n    phys_tid_31323 = global_tid_33022;\n    \n    int64_t write_i_31322;\n    \n    write_i_31322 = sext_i32_i64(group_tid_33024) * segmap_group_sizze_31326 +\n        sext_i32_i64(local_tid_33023);\n    if (slt64(write_i_31322, num_segments_29894)) {\n        int64_t x_29921 = ((__global int64_t *) mem_32026)[write_i_31322];\n        int64_t write_value_29922 = ((__global\n                                      int64_t *) mem_32020)[write_i_31322];\n        bool x_29923 = sle64((int64_t) 0, x_29921);\n        bool y_29924 = slt64(x_29921, implz2081U_29737);\n        bool bounds_check_29925 = x_29923 && y_29924;\n        bool index_certs_29926;\n        \n        if (!bounds_check_29925) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = x_29921;\n                    global_failure_args[1] = implz2081U_29737;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t i32_arg_29927 = ((__global int32_t *) mem_32005)[x_29921];\n        int64_t i32_res_29928 = sext_i32_i64(i32_arg_29927);\n        \n        if (sle64((int64_t) 0, i32_res_29928) && slt64(i32_res_29928,\n                                                       (int64_t) 4096)) {\n            ((__global int64_t *) mem_32028)[i32_res_29928] = write_value_29922;\n        }\n        if (sle64((int64_t) 0, i32_res_29928) && slt64(i32_res_29928,\n                                                       (int64_t) 4096)) {\n            ((__global int64_t *) mem_32030)[i32_res_29928] = x_29921;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31326\n}\n__kernel void test_ballQueryzisegma",
            "p_31420(__global int *global_failure,\n                                           int64_t implz2081U_29737, __global\n                                           unsigned char *mem_32040, __global\n                                           unsigned char *mem_32044)\n{\n    #define segmap_group_sizze_31579 (test_ballQueryzisegmap_group_sizze_31423)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33037;\n    int32_t local_tid_33038;\n    int64_t group_sizze_33041;\n    int32_t wave_sizze_33040;\n    int32_t group_tid_33039;\n    \n    global_tid_33037 = get_global_id(0);\n    local_tid_33038 = get_local_id(0);\n    group_sizze_33041 = get_local_size(0);\n    wave_sizze_33040 = LOCKSTEP_WIDTH;\n    group_tid_33039 = get_group_id(0);\n    \n    int32_t phys_tid_31420;\n    \n    phys_tid_31420 = global_tid_33037;\n    \n    int64_t gtid_31418;\n    \n    gtid_31418 = squot64(sext_i32_i64(group_tid_33039) *\n                         segmap_group_sizze_31579 +\n                         sext_i32_i64(local_tid_33038), (int64_t) 8);\n    \n    int64_t gtid_31419;\n    \n    gtid_31419 = sext_i32_i64(group_tid_33039) * segmap_group_sizze_31579 +\n        sext_i32_i64(local_tid_33038) - squot64(sext_i32_i64(group_tid_33039) *\n                                                segmap_group_sizze_31579 +\n                                                sext_i32_i64(local_tid_33038),\n                                                (int64_t) 8) * (int64_t) 8;\n    if (slt64(gtid_31418, implz2081U_29737) && slt64(gtid_31419, (int64_t) 8)) {\n        int32_t x_31583 = ((__global int32_t *) mem_32040)[gtid_31418 *\n                                                           (int64_t) 24 +\n                                                           gtid_31419 *\n                                                           (int64_t) 3 +\n                                                           (int64_t",
            ") 2];\n        int32_t x_31584 = x_31583 << 4;\n        int32_t y_31585 = ((__global int32_t *) mem_32040)[gtid_31418 *\n                                                           (int64_t) 24 +\n                                                           gtid_31419 *\n                                                           (int64_t) 3 +\n                                                           (int64_t) 1];\n        int32_t x_31586 = x_31584 | y_31585;\n        int32_t x_31587 = x_31586 << 4;\n        int32_t y_31588 = ((__global int32_t *) mem_32040)[gtid_31418 *\n                                                           (int64_t) 24 +\n                                                           gtid_31419 *\n                                                           (int64_t) 3];\n        int32_t defunc_0_f_res_31589 = x_31587 | y_31588;\n        \n        ((__global int32_t *) mem_32044)[gtid_31418 * (int64_t) 8 +\n                                         gtid_31419] = defunc_0_f_res_31589;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31579\n}\n__kernel void test_ballQueryzisegmap_31447(__global int *global_failure,\n                                           int64_t implz2081U_29737, __global\n                                           unsigned char *mem_32035, __global\n                                           unsigned char *mem_32040)\n{\n    #define segmap_group_sizze_31569 (test_ballQueryzisegmap_group_sizze_31451)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33032;\n    int32_t local_tid_33033;\n    int64_t group_sizze_33036;\n    int32_t wave_sizze_33035;\n    int32_t group_tid_33034;\n    \n    global_tid_33032 = get_global_id(0);\n    local_tid_33033 = get_local_id(0);\n    group_sizze_33036 = get_local_size(0);\n    wave_sizze_33035 = LOCKSTEP_WIDTH;\n    group_tid_33034 = get_group_id(0);\n    \n    int32_t phys_tid_31447;\n    \n    ph",
            "ys_tid_31447 = global_tid_33032;\n    \n    int64_t gtid_31444;\n    \n    gtid_31444 = squot64(sext_i32_i64(group_tid_33034) *\n                         segmap_group_sizze_31569 +\n                         sext_i32_i64(local_tid_33033), (int64_t) 24);\n    \n    int64_t gtid_31445;\n    \n    gtid_31445 = squot64(sext_i32_i64(group_tid_33034) *\n                         segmap_group_sizze_31569 +\n                         sext_i32_i64(local_tid_33033) -\n                         squot64(sext_i32_i64(group_tid_33034) *\n                                 segmap_group_sizze_31569 +\n                                 sext_i32_i64(local_tid_33033), (int64_t) 24) *\n                         (int64_t) 24, (int64_t) 3);\n    \n    int64_t gtid_31446;\n    \n    gtid_31446 = sext_i32_i64(group_tid_33034) * segmap_group_sizze_31569 +\n        sext_i32_i64(local_tid_33033) - squot64(sext_i32_i64(group_tid_33034) *\n                                                segmap_group_sizze_31569 +\n                                                sext_i32_i64(local_tid_33033),\n                                                (int64_t) 24) * (int64_t) 24 -\n        squot64(sext_i32_i64(group_tid_33034) * segmap_group_sizze_31569 +\n                sext_i32_i64(local_tid_33033) -\n                squot64(sext_i32_i64(group_tid_33034) *\n                        segmap_group_sizze_31569 +\n                        sext_i32_i64(local_tid_33033), (int64_t) 24) *\n                (int64_t) 24, (int64_t) 3) * (int64_t) 3;\n    if ((slt64(gtid_31444, implz2081U_29737) && slt64(gtid_31445,\n                                                      (int64_t) 8)) &&\n        slt64(gtid_31446, (int64_t) 3)) {\n        int32_t x_31572 = ((__global int32_t *) mem_32035)[gtid_31444 *\n                                                           (int64_t) 3 +\n                                                           gtid_31446];\n        int32_t convop_x_31864 = sext_i64_i32(gtid_31446);\n        int64_t binop_y_31865 = sext_i32_i64(convop_x_3186",
            "4);\n        int64_t binop_y_31866 = ashr64(gtid_31445, binop_y_31865);\n        int64_t convop_x_31867 = (int64_t) 1 & binop_y_31866;\n        int32_t index_primexp_31868 = sext_i64_i32(convop_x_31867);\n        int32_t defunc_1_f_res_31574 = add32(x_31572, index_primexp_31868);\n        int32_t defunc_0_f_res_31575 = 15 & defunc_1_f_res_31574;\n        \n        ((__global int32_t *) mem_32040)[gtid_31444 * (int64_t) 24 +\n                                         gtid_31445 * (int64_t) 3 +\n                                         gtid_31446] = defunc_0_f_res_31575;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31569\n}\n__kernel void test_ballQueryzisegmap_31507(__global int *global_failure,\n                                           int64_t implz2081U_29737,\n                                           float radius_29738, __global\n                                           unsigned char *pos_mem_31946,\n                                           __global unsigned char *mem_32035)\n{\n    #define segmap_group_sizze_31548 (test_ballQueryzisegmap_group_sizze_31510)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33027;\n    int32_t local_tid_33028;\n    int64_t group_sizze_33031;\n    int32_t wave_sizze_33030;\n    int32_t group_tid_33029;\n    \n    global_tid_33027 = get_global_id(0);\n    local_tid_33028 = get_local_id(0);\n    group_sizze_33031 = get_local_size(0);\n    wave_sizze_33030 = LOCKSTEP_WIDTH;\n    group_tid_33029 = get_group_id(0);\n    \n    int32_t phys_tid_31507;\n    \n    phys_tid_31507 = global_tid_33027;\n    \n    int64_t gtid_31505;\n    \n    gtid_31505 = squot64(sext_i32_i64(group_tid_33029) *\n                         segmap_group_sizze_31548 +\n                         sext_i32_i64(local_tid_33028), (int64_t) 3);\n    \n    int64_t gtid_31506;\n    \n    gtid_31506 = sext_i32_i64(group_tid_33029) * segmap_group_sizze_31548 +\n        s",
            "ext_i32_i64(local_tid_33028) - squot64(sext_i32_i64(group_tid_33029) *\n                                                segmap_group_sizze_31548 +\n                                                sext_i32_i64(local_tid_33028),\n                                                (int64_t) 3) * (int64_t) 3;\n    if (slt64(gtid_31505, implz2081U_29737) && slt64(gtid_31506, (int64_t) 3)) {\n        float x_31551 = ((__global float *) pos_mem_31946)[gtid_31505 *\n                                                           (int64_t) 3 +\n                                                           gtid_31506];\n        float binop_p_31552 = x_31551 / radius_29738;\n        float defunc_0_f_res_31553 = -0.5F + binop_p_31552;\n        float defunc_0_f_res_31554;\n        \n        defunc_0_f_res_31554 = futrts_floor32(defunc_0_f_res_31553);\n        \n        int32_t f32_res_31555 = fptosi_f32_i32(defunc_0_f_res_31554);\n        \n        ((__global int32_t *) mem_32035)[gtid_31505 * (int64_t) 3 +\n                                         gtid_31506] = f32_res_31555;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31548\n}\n__kernel void test_ballQueryzisegmap_31645(__global int *global_failure,\n                                           int64_t defunc_2_reduce_res_29982,\n                                           __global unsigned char *mem_32060,\n                                           __global unsigned char *mem_32063)\n{\n    #define segmap_group_sizze_31655 (test_ballQueryzisegmap_group_sizze_31647)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33429;\n    int32_t local_tid_33430;\n    int64_t group_sizze_33433;\n    int32_t wave_sizze_33432;\n    int32_t group_tid_33431;\n    \n    global_tid_33429 = get_global_id(0);\n    local_tid_33430 = get_local_id(0);\n    group_sizze_33433 = get_local_size(0);\n    wave_sizze_33432 = LOCKSTEP_WIDTH;\n    group_tid_33431",
            " = get_group_id(0);\n    \n    int32_t phys_tid_31645;\n    \n    phys_tid_31645 = global_tid_33429;\n    \n    int64_t gtid_31644;\n    \n    gtid_31644 = sext_i32_i64(group_tid_33431) * segmap_group_sizze_31655 +\n        sext_i32_i64(local_tid_33430);\n    if (slt64(gtid_31644, defunc_2_reduce_res_29982)) {\n        int64_t x_31658 = ((__global int64_t *) mem_32060)[gtid_31644];\n        int64_t i_p_o_31880 = add64((int64_t) -1, gtid_31644);\n        int64_t rot_i_31881 = smod64(i_p_o_31880, defunc_2_reduce_res_29982);\n        int64_t x_31659 = ((__global int64_t *) mem_32060)[rot_i_31881];\n        bool defunc_1_f_res_31660 = x_31658 == x_31659;\n        bool defunc_1_f_res_31661 = !defunc_1_f_res_31660;\n        \n        ((__global bool *) mem_32063)[gtid_31644] = defunc_1_f_res_31661;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31655\n}\n__kernel void test_ballQueryzisegmap_31688(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           int64_t implz2081U_29737,\n                                           float radius_29738,\n                                           int64_t defunc_2_reduce_res_29982,\n                                           int64_t bytes_31948, __global\n                                           unsigned char *pos_mem_31946,\n                                           __global\n                                           unsigned char *labels_mem_31947,\n                                           __global unsigned char *mem_32007,\n                                           __global unsigned char *mem_32030,\n                                           __global unsigned char *mem_32044,\n                                           __global unsigned char *mem_32060,\n                                           __global unsigned char *mem_32068,\n                                           _",
            "_global unsigned char *mem_32071,\n                                           __global unsigned char *mem_32073)\n{\n    #define segmap_group_sizze_31756 (test_ballQueryzisegmap_group_sizze_31690)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33567;\n    int32_t local_tid_33568;\n    int64_t group_sizze_33571;\n    int32_t wave_sizze_33570;\n    int32_t group_tid_33569;\n    \n    global_tid_33567 = get_global_id(0);\n    local_tid_33568 = get_local_id(0);\n    group_sizze_33571 = get_local_size(0);\n    wave_sizze_33570 = LOCKSTEP_WIDTH;\n    group_tid_33569 = get_group_id(0);\n    \n    int32_t phys_tid_31688;\n    \n    phys_tid_31688 = global_tid_33567;\n    \n    int64_t gtid_31687;\n    \n    gtid_31687 = sext_i32_i64(group_tid_33569) * segmap_group_sizze_31756 +\n        sext_i32_i64(local_tid_33568);\n    if (slt64(gtid_31687, defunc_2_reduce_res_29982)) {\n        int64_t x_31761 = ((__global int64_t *) mem_32068)[gtid_31687];\n        int64_t x_31762 = ((__global int64_t *) mem_32060)[gtid_31687];\n        int64_t defunc_0_f_res_31765 = sub64(x_31761, (int64_t) 1);\n        bool x_31766 = sle64((int64_t) 0, x_31762);\n        bool y_31767 = slt64(x_31762, bytes_31948);\n        bool bounds_check_31768 = x_31766 && y_31767;\n        bool index_certs_31769;\n        \n        if (!bounds_check_31768) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = x_31762;\n                    global_failure_args[1] = bytes_31948;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t new_index_31770 = squot64(x_31762, (int64_t) 8);\n        int64_t binop_y_31771 = (int64_t) 8 * new_index_31770;\n        int64_t new_index_31772 = x_31762 - binop_y_31771;\n        int32_t index_primexp_31884 = sext_i64_i32(new_index_31770);\n        int32_t",
            " defunc_0_get_arg_31774 = ((__global\n                                           int32_t *) mem_32044)[new_index_31770 *\n                                                                 (int64_t) 8 +\n                                                                 new_index_31772];\n        int64_t s_31775 = sext_i32_i64(defunc_0_get_arg_31774);\n        bool x_31776 = sle64((int64_t) 0, s_31775);\n        bool y_31777 = slt64(s_31775, (int64_t) 4096);\n        bool bounds_check_31778 = x_31776 && y_31777;\n        bool index_certs_31779;\n        \n        if (!bounds_check_31778) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = s_31775;\n                    global_failure_args[1] = (int64_t) 4096;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t x_31780 = ((__global int64_t *) mem_32030)[s_31775];\n        int64_t i_31781 = add64(defunc_0_f_res_31765, x_31780);\n        bool x_31782 = sle64((int64_t) 0, i_31781);\n        bool y_31783 = slt64(i_31781, implz2081U_29737);\n        bool bounds_check_31784 = x_31782 && y_31783;\n        bool index_certs_31785;\n        \n        if (!bounds_check_31784) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = i_31781;\n                    global_failure_args[1] = implz2081U_29737;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t getEntry_res_31786 = ((__global int32_t *) mem_32007)[i_31781];\n        bool cond_31787 = getEntry_res_31786 == -1;\n        int32_t lifted_filterFn_res_31788;\n        \n        if (cond_31787) {\n            lifted_filterFn_res_31788 = -1;\n        } else {\n            float lifted_sqr_res_31789 = radius_29738 * radius_29738;\n            int64_t pzq_31790 = sext_i32_i64(getEntry_res_31786);\n            bool x_31791 = s",
            "le64((int64_t) 0, pzq_31790);\n            bool y_31792 = slt64(pzq_31790, implz2081U_29737);\n            bool bounds_check_31793 = x_31791 && y_31792;\n            bool index_certs_31794;\n            \n            if (!bounds_check_31793) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 6) ==\n                        -1) {\n                        global_failure_args[0] = pzq_31790;\n                        global_failure_args[1] = implz2081U_29737;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int64_t p_31796 = sext_i32_i64(index_primexp_31884);\n            bool x_31797 = sle64((int64_t) 0, p_31796);\n            bool y_31798 = slt64(p_31796, implz2081U_29737);\n            bool bounds_check_31799 = x_31797 && y_31798;\n            bool index_certs_31800;\n            \n            if (!bounds_check_31799) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 7) ==\n                        -1) {\n                        global_failure_args[0] = p_31796;\n                        global_failure_args[1] = implz2081U_29737;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            float defunc_2_reduce_res_31802;\n            float redout_31943 = 0.0F;\n            \n            for (int32_t i_31945 = 0; i_31945 < 3; i_31945++) {\n                int64_t i_31944 = sext_i32_i64(i_31945);\n                float x_31806 = ((__global float *) pos_mem_31946)[p_31796 *\n                                                                   (int64_t) 3 +\n                                                                   i_31944];\n                float x_31807 = ((__global float *) pos_mem_31946)[pzq_31790 *\n                                                                   (int64_t) 3 +\n                                                                   i_31944];\n ",
            "               float defunc_1_f_res_31808 = x_31806 - x_31807;\n                float defunc_0_f_res_31809 = defunc_1_f_res_31808 *\n                      defunc_1_f_res_31808;\n                float defunc_1_op_res_31805 = defunc_0_f_res_31809 +\n                      redout_31943;\n                float redout_tmp_33572 = defunc_1_op_res_31805;\n                \n                redout_31943 = redout_tmp_33572;\n            }\n            defunc_2_reduce_res_31802 = redout_31943;\n            \n            bool cond_31810 = defunc_2_reduce_res_31802 <= lifted_sqr_res_31789;\n            bool lifted_isNeighbor_res_31811;\n            \n            if (cond_31810) {\n                int32_t x_31812 = ((__global\n                                    int32_t *) labels_mem_31947)[p_31796];\n                int32_t y_31813 = ((__global\n                                    int32_t *) labels_mem_31947)[pzq_31790];\n                bool lifted_isNeighbor_res_t_res_31814 = x_31812 == y_31813;\n                \n                lifted_isNeighbor_res_31811 = lifted_isNeighbor_res_t_res_31814;\n            } else {\n                lifted_isNeighbor_res_31811 = 0;\n            }\n            \n            int32_t lifted_filterFn_res_f_res_31815;\n            \n            if (lifted_isNeighbor_res_31811) {\n                lifted_filterFn_res_f_res_31815 = getEntry_res_31786;\n            } else {\n                lifted_filterFn_res_f_res_31815 = -1;\n            }\n            lifted_filterFn_res_31788 = lifted_filterFn_res_f_res_31815;\n        }\n        \n        bool cond_31816 = lifted_filterFn_res_31788 == -1;\n        int64_t defunc_0_f_res_31817;\n        \n        if (cond_31816) {\n            defunc_0_f_res_31817 = (int64_t) -1;\n        } else {\n            int64_t unsign_arg_31818 = zext_i32_i64(index_primexp_31884);\n            int64_t x_31819 = unsign_arg_31818 << (int64_t) 32;\n            int64_t unsign_arg_31820 = zext_i32_i64(lifted_filterFn_res_31788);\n            int64_t binop_p_31821 = x_31819 |",
            " unsign_arg_31820;\n            \n            defunc_0_f_res_31817 = binop_p_31821;\n        }\n        ((__global int64_t *) mem_32071)[gtid_31687] = defunc_0_f_res_31817;\n        ((__global int32_t *) mem_32073)[gtid_31687] =\n            lifted_filterFn_res_31788;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31756\n}\n__kernel void test_ballQueryzisegmap_31831(__global int *global_failure,\n                                           int64_t defunc_2_reduce_res_29982,\n                                           int64_t last_res_30188,\n                                           int64_t last_res_30189,\n                                           int64_t last_res_30190, __global\n                                           unsigned char *mem_param_32080,\n                                           __global\n                                           unsigned char *mem_param_32085,\n                                           __global unsigned char *mem_32092,\n                                           __global unsigned char *mem_32094,\n                                           __global unsigned char *mem_32096,\n                                           __global unsigned char *mem_32098,\n                                           __global unsigned char *mem_32100,\n                                           __global unsigned char *mem_32102,\n                                           __global unsigned char *mem_32104)\n{\n    #define segmap_group_sizze_31834 (test_ballQueryzisegmap_group_sizze_31833)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33791;\n    int32_t local_tid_33792;\n    int64_t group_sizze_33795;\n    int32_t wave_sizze_33794;\n    int32_t group_tid_33793;\n    \n    global_tid_33791 = get_global_id(0);\n    local_tid_33792 = get_local_id(0);\n    group_sizze_33795 = get_local_size(0);\n    wave_sizze_33794 = LOCKSTEP_WIDTH;\n    gro",
            "up_tid_33793 = get_group_id(0);\n    \n    int32_t phys_tid_31831;\n    \n    phys_tid_31831 = global_tid_33791;\n    \n    int64_t write_i_31830;\n    \n    write_i_31830 = sext_i32_i64(group_tid_33793) * segmap_group_sizze_31834 +\n        sext_i32_i64(local_tid_33792);\n    if (slt64(write_i_31830, defunc_2_reduce_res_29982)) {\n        int32_t x_30195 = ((__global int32_t *) mem_32100)[write_i_31830];\n        int64_t write_value_30200 = ((__global\n                                      int64_t *) mem_param_32080)[write_i_31830];\n        int64_t write_value_30201 = ((__global\n                                      int64_t *) mem_param_32085)[write_i_31830];\n        bool match_lit_30202 = 0 == x_30195;\n        int64_t defunc_1_f_res_30203;\n        \n        if (match_lit_30202) {\n            int64_t x_30196 = ((__global int64_t *) mem_32092)[write_i_31830];\n            int64_t case_res_30204 = sub64(x_30196, (int64_t) 1);\n            \n            defunc_1_f_res_30203 = case_res_30204;\n        } else {\n            bool match_lit_30205 = 1 == x_30195;\n            int64_t x_30206;\n            \n            if (match_lit_30205) {\n                int64_t x_30197 = ((__global\n                                    int64_t *) mem_32094)[write_i_31830];\n                int64_t x_30207 = add64(last_res_30188, x_30197);\n                int64_t case_res_30208 = sub64(x_30207, (int64_t) 1);\n                \n                x_30206 = case_res_30208;\n            } else {\n                bool match_lit_30209 = 2 == x_30195;\n                int64_t x_30210;\n                \n                if (match_lit_30209) {\n                    int64_t x_30198 = ((__global\n                                        int64_t *) mem_32096)[write_i_31830];\n                    int64_t x_30211 = add64(last_res_30188, last_res_30189);\n                    int64_t x_30212 = add64(x_30198, x_30211);\n                    int64_t case_res_30213 = sub64(x_30212, (int64_t) 1);\n                    \n                    x_30210 = ",
            "case_res_30213;\n                } else {\n                    int64_t x_30199 = ((__global\n                                        int64_t *) mem_32098)[write_i_31830];\n                    int64_t x_30214 = add64(last_res_30188, last_res_30189);\n                    int64_t x_30215 = add64(last_res_30190, x_30214);\n                    int64_t x_30216 = add64(x_30199, x_30215);\n                    int64_t defunc_1_f_res_res_30217 = sub64(x_30216,\n                                                             (int64_t) 1);\n                    \n                    x_30210 = defunc_1_f_res_res_30217;\n                }\n                x_30206 = x_30210;\n            }\n            defunc_1_f_res_30203 = x_30206;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_30203) &&\n            slt64(defunc_1_f_res_30203, defunc_2_reduce_res_29982)) {\n            ((__global int64_t *) mem_32102)[defunc_1_f_res_30203] =\n                write_value_30200;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_30203) &&\n            slt64(defunc_1_f_res_30203, defunc_2_reduce_res_29982)) {\n            ((__global int64_t *) mem_32104)[defunc_1_f_res_30203] =\n                write_value_30201;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31834\n}\n__kernel void test_ballQueryzisegred_large_33235(__global int *global_failure,\n                                                 uint sync_arr_mem_33273_backing_offset_0,\n                                                 uint red_arr_mem_33271_backing_offset_1,\n                                                 int64_t defunc_2_reduce_res_29982,\n                                                 int64_t num_groups_31625,\n                                                 int32_t num_subhistos_33156,\n                                                 int64_t groups_per_segment_33257,\n                                                 int64_t elements_per_thread_33258,\n                                                 int64_t virt_n",
            "um_groups_33259,\n                                                 int64_t threads_per_segment_33261,\n                                                 __global\n                                                 unsigned char *mem_32054,\n                                                 __global\n                                                 unsigned char *defunc_1_map_res_subhistos_mem_33157,\n                                                 __global\n                                                 unsigned char *group_res_arr_mem_33262,\n                                                 __global\n                                                 unsigned char *test_ballQueryzicounter_mem_33264)\n{\n    #define seghist_group_sizze_31623 (test_ballQueryziseghist_group_sizze_31622)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *sync_arr_mem_33273_backing_1 =\n                  &shared_mem[sync_arr_mem_33273_backing_offset_0];\n    volatile char *red_arr_mem_33271_backing_0 =\n                  &shared_mem[red_arr_mem_33271_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33266;\n    int32_t local_tid_33267;\n    int64_t group_sizze_33270;\n    int32_t wave_sizze_33269;\n    int32_t group_tid_33268;\n    \n    global_tid_33266 = get_global_id(0);\n    local_tid_33267 = get_local_id(0);\n    group_sizze_33270 = get_local_size(0);\n    wave_sizze_33269 = LOCKSTEP_WIDTH;\n    group_tid_33268 = get_group_id(0);\n    \n    int32_t flat_gtid_33235;\n    \n    flat_gtid_33235 = global_tid_33266;\n    \n    __local char *red_arr_mem_33271;\n    \n    red_arr_mem_33271 = (__local char *) red_arr_mem_33271_backing_0;\n    \n    __local char *sync_arr_mem_33273;\n    \n    sync_arr_mem_33273 = (__local char *) sync_arr_mem_33273_backing_1;\n    \n    int32_t phys_group_id_33275;\n    \n    phys_group_id_33275 = get_group_id(0);\n    for (int32_t i_33276 = 0; i_33276 <\n         sdiv_up32(sext_i64_i32(virt",
            "_num_groups_33259) - phys_group_id_33275,\n                   sext_i64_i32(num_groups_31625)); i_33276++) {\n        int32_t virt_group_id_33277 = phys_group_id_33275 + i_33276 *\n                sext_i64_i32(num_groups_31625);\n        int32_t flat_segment_id_33278 = squot32(virt_group_id_33277,\n                                                sext_i64_i32(groups_per_segment_33257));\n        int64_t global_tid_33279 = srem64(sext_i32_i64(virt_group_id_33277) *\n                                          seghist_group_sizze_31623 +\n                                          sext_i32_i64(local_tid_33267),\n                                          seghist_group_sizze_31623 *\n                                          groups_per_segment_33257);\n        int64_t bucket_id_33233 = sext_i32_i64(flat_segment_id_33278);\n        int64_t subhistogram_id_33234;\n        int64_t x_acc_33280;\n        int64_t chunk_sizze_33281;\n        \n        chunk_sizze_33281 = smin64(elements_per_thread_33258,\n                                   sdiv_up64(num_subhistos_33156 -\n                                             global_tid_33279,\n                                             threads_per_segment_33261));\n        \n        int64_t x_31629;\n        int64_t x_31630;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_33280 = (int64_t) 0;\n        }\n        for (int64_t i_33285 = 0; i_33285 < chunk_sizze_33281; i_33285++) {\n            subhistogram_id_33234 = global_tid_33279 +\n                threads_per_segment_33261 * i_33285;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_31629 = x_acc_33280;\n                }\n                // load new values\n                {\n                    x_31630 = ((__global\n                                int64_t *) defunc_1_map_res_subhistos_mem_33157)[subhistogram_id_33234 *\n                                                                                 defunc_",
            "2_reduce_res_29982 +\n                                                                                 bucket_id_33233];\n                }\n                // apply reduction operator\n                {\n                    int64_t defunc_1_f_res_31631 = smax64(x_31629, x_31630);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_33280 = defunc_1_f_res_31631;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_31629 = x_acc_33280;\n            ((__local\n              int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                x_31629;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_33286;\n        int32_t skip_waves_33287;\n        \n        skip_waves_33287 = 1;\n        \n        int64_t x_33282;\n        int64_t x_33283;\n        \n        offset_33286 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_33267,\n                      sext_i64_i32(seghist_group_sizze_31623))) {\n                x_33282 = ((__local\n                            int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                          offset_33286)];\n            }\n        }\n        offset_33286 = 1;\n        while (slt32(offset_33286, wave_sizze_33269)) {\n            if (slt32(local_tid_33267 + offset_33286,\n                      sext_i64_i32(seghist_group_sizze_31623)) &&\n                ((local_tid_33267 - squot32(local_tid_33267, wave_sizze_33269) *\n                  wave_sizze_33269) & (2 * offset_33286 - 1)) == 0) {\n                // read array element\n                {\n                    x_33283 = ((volatile __local\n                                int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                              offset_3328",
            "6)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_33284 = smax64(x_33282, x_33283);\n                    \n                    x_33282 = defunc_1_f_res_33284;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                        x_33282;\n                }\n            }\n            offset_33286 *= 2;\n        }\n        while (slt32(skip_waves_33287,\n                     squot32(sext_i64_i32(seghist_group_sizze_31623) +\n                             wave_sizze_33269 - 1, wave_sizze_33269))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_33286 = skip_waves_33287 * wave_sizze_33269;\n            if (slt32(local_tid_33267 + offset_33286,\n                      sext_i64_i32(seghist_group_sizze_31623)) &&\n                ((local_tid_33267 - squot32(local_tid_33267, wave_sizze_33269) *\n                  wave_sizze_33269) == 0 && (squot32(local_tid_33267,\n                                                     wave_sizze_33269) & (2 *\n                                                                          skip_waves_33287 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_33283 = ((__local\n                                int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                              offset_33286)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_33284 = smax64(x_33282, x_33283);\n                    \n                    x_33282 = defunc_1_f_res_33284;\n                }\n                // write result of operation\n                {\n                    ((__local\n         ",
            "             int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                        x_33282;\n                }\n            }\n            skip_waves_33287 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_33267) == (int64_t) 0) {\n                x_acc_33280 = x_33282;\n            }\n        }\n        if (groups_per_segment_33257 == (int64_t) 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_33267 == 0) {\n                    ((__global int64_t *) mem_32054)[bucket_id_33233] =\n                        x_acc_33280;\n                }\n            }\n        } else {\n            int32_t old_counter_33288;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_33267 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_33262)[sext_i32_i64(virt_group_id_33277) *\n                                                          seghist_group_sizze_31623] =\n                        x_acc_33280;\n                    mem_fence_global();\n                    old_counter_33288 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_ballQueryzicounter_mem_33264)[sext_i32_i64(srem32(flat_segment_id_33278,\n                                                                                                               10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_33273)[(int64_t) 0] =\n                        old_counter_33288 == groups_per_segment_33257 -\n                        (int64_t) 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_33289;\n            \n            i",
            "s_last_group_33289 = ((__local\n                                    bool *) sync_arr_mem_33273)[(int64_t) 0];\n            if (is_last_group_33289) {\n                if (local_tid_33267 == 0) {\n                    old_counter_33288 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_ballQueryzicounter_mem_33264)[sext_i32_i64(srem32(flat_segment_id_33278,\n                                                                                                               10240))],\n                                              (int) ((int64_t) 0 -\n                                                     groups_per_segment_33257));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_33290 =\n                            sdiv_up64(groups_per_segment_33257,\n                                      seghist_group_sizze_31623);\n                    \n                    x_31629 = (int64_t) 0;\n                    for (int64_t i_33291 = 0; i_33291 < read_per_thread_33290;\n                         i_33291++) {\n                        int64_t group_res_id_33292 =\n                                sext_i32_i64(local_tid_33267) *\n                                read_per_thread_33290 + i_33291;\n                        int64_t index_of_group_res_33293 =\n                                sext_i32_i64(flat_segment_id_33278) *\n                                groups_per_segment_33257 + group_res_id_33292;\n                        \n                        if (slt64(group_res_id_33292,\n                                  groups_per_segment_33257)) {\n                            x_31630 = ((__global\n                                        int64_t *) group_res_arr_mem_33262)[index_of_group_res_33293 *\n                                                                            seghist_group_sizze_31623];\n                            \n                            int64",
            "_t defunc_1_f_res_31631;\n                            \n                            defunc_1_f_res_31631 = smax64(x_31629, x_31630);\n                            x_31629 = defunc_1_f_res_31631;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                    x_31629;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_33294;\n                    int32_t skip_waves_33295;\n                    \n                    skip_waves_33295 = 1;\n                    \n                    int64_t x_33282;\n                    int64_t x_33283;\n                    \n                    offset_33294 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_33267,\n                                  sext_i64_i32(seghist_group_sizze_31623))) {\n                            x_33282 = ((__local\n                                        int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                                      offset_33294)];\n                        }\n                    }\n                    offset_33294 = 1;\n                    while (slt32(offset_33294, wave_sizze_33269)) {\n                        if (slt32(local_tid_33267 + offset_33294,\n                                  sext_i64_i32(seghist_group_sizze_31623)) &&\n                            ((local_tid_33267 - squot32(local_tid_33267,\n                                                        wave_sizze_33269) *\n                              wave_sizze_33269) & (2 * offset_33294 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_33283 = ((volatile __local\n                                    ",
            "        int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                                          offset_33294)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_33284 = smax64(x_33282,\n                                                                      x_33283);\n                                \n                                x_33282 = defunc_1_f_res_33284;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                                    x_33282;\n                            }\n                        }\n                        offset_33294 *= 2;\n                    }\n                    while (slt32(skip_waves_33295,\n                                 squot32(sext_i64_i32(seghist_group_sizze_31623) +\n                                         wave_sizze_33269 - 1,\n                                         wave_sizze_33269))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_33294 = skip_waves_33295 * wave_sizze_33269;\n                        if (slt32(local_tid_33267 + offset_33294,\n                                  sext_i64_i32(seghist_group_sizze_31623)) &&\n                            ((local_tid_33267 - squot32(local_tid_33267,\n                                                        wave_sizze_33269) *\n                              wave_sizze_33269) == 0 &&\n                             (squot32(local_tid_33267, wave_sizze_33269) & (2 *\n                                                                            skip_waves_33295 -\n                                                                            1)) ==\n                             0)) {\n     ",
            "                       // read array element\n                            {\n                                x_33283 = ((__local\n                                            int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267 +\n                                                                          offset_33294)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_33284 = smax64(x_33282,\n                                                                      x_33283);\n                                \n                                x_33282 = defunc_1_f_res_33284;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_33271)[sext_i32_i64(local_tid_33267)] =\n                                    x_33282;\n                            }\n                        }\n                        skip_waves_33295 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_33267 == 0) {\n                            ((__global int64_t *) mem_32054)[bucket_id_33233] =\n                                x_33282;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_31623\n}\n__kernel void test_ballQueryzisegred_nonseg_31620(__global int *global_failure,\n                                                  uint red_arr_mem_33137_backing_offset_0,\n                                                  uint sync_arr_mem_33135_backing_offset_1,\n                                                  int64_t num_groups_31615,\n                                                  int64_t",
            " bytes_31948,\n                                                  int64_t num_threads_33129,\n                                                  __global\n                                                  unsigned char *mem_32049,\n                                                  __global\n                                                  unsigned char *mem_32052,\n                                                  __global\n                                                  unsigned char *test_ballQueryzicounter_mem_33125,\n                                                  __global\n                                                  unsigned char *group_res_arr_mem_33127)\n{\n    #define segred_group_sizze_31613 (test_ballQueryzisegred_group_sizze_31612)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33137_backing_1 =\n                  &shared_mem[red_arr_mem_33137_backing_offset_0];\n    volatile char *sync_arr_mem_33135_backing_0 =\n                  &shared_mem[sync_arr_mem_33135_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33130;\n    int32_t local_tid_33131;\n    int64_t group_sizze_33134;\n    int32_t wave_sizze_33133;\n    int32_t group_tid_33132;\n    \n    global_tid_33130 = get_global_id(0);\n    local_tid_33131 = get_local_id(0);\n    group_sizze_33134 = get_local_size(0);\n    wave_sizze_33133 = LOCKSTEP_WIDTH;\n    group_tid_33132 = get_group_id(0);\n    \n    int32_t phys_tid_31620;\n    \n    phys_tid_31620 = global_tid_33130;\n    \n    __local char *sync_arr_mem_33135;\n    \n    sync_arr_mem_33135 = (__local char *) sync_arr_mem_33135_backing_0;\n    \n    __local char *red_arr_mem_33137;\n    \n    red_arr_mem_33137 = (__local char *) red_arr_mem_33137_backing_1;\n    \n    int64_t dummy_31618;\n    \n    dummy_31618 = (int64_t) 0;\n    \n    int64_t gtid_31619;\n    \n    gtid_31619 = (int64_t) 0;\n    \n    int64_t x_acc_33139;\n    int64_t chunk_sizze_33140;\n    ",
            "\n    chunk_sizze_33140 = smin64(sdiv_up64(bytes_31948,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_31613 *\n                                         num_groups_31615))),\n                               sdiv_up64(bytes_31948 - phys_tid_31620,\n                                         num_threads_33129));\n    \n    int64_t x_29983;\n    int64_t x_29984;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_33139 = (int64_t) 0;\n    }\n    for (int64_t i_33144 = 0; i_33144 < chunk_sizze_33140; i_33144++) {\n        gtid_31619 = phys_tid_31620 + num_threads_33129 * i_33144;\n        // apply map function\n        {\n            int64_t x_29986 = ((__global int64_t *) mem_32049)[gtid_31619];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29983 = x_acc_33139;\n            }\n            // load new values\n            {\n                x_29984 = x_29986;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29985 = add64(x_29983, x_29984);\n                \n                // store in accumulator\n                {\n                    x_acc_33139 = defunc_1_op_res_29985;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29983 = x_acc_33139;\n        ((__local int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n            x_29983;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33145;\n    int32_t skip_waves_33146;\n    \n    skip_waves_33146 = 1;\n    \n    int64_t x_33141;\n    int64_t x_33142;\n    \n    offset_33145 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33131, sext_i64_i32(segred_group_sizze_31613))) {\n            x_33141 = ((__local\n                        int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                             ",
            "                         offset_33145)];\n        }\n    }\n    offset_33145 = 1;\n    while (slt32(offset_33145, wave_sizze_33133)) {\n        if (slt32(local_tid_33131 + offset_33145,\n                  sext_i64_i32(segred_group_sizze_31613)) && ((local_tid_33131 -\n                                                               squot32(local_tid_33131,\n                                                                       wave_sizze_33133) *\n                                                               wave_sizze_33133) &\n                                                              (2 *\n                                                               offset_33145 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_33142 = ((volatile __local\n                            int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                                                          offset_33145)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33143 = add64(x_33141, x_33142);\n                \n                x_33141 = defunc_1_op_res_33143;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n                    x_33141;\n            }\n        }\n        offset_33145 *= 2;\n    }\n    while (slt32(skip_waves_33146,\n                 squot32(sext_i64_i32(segred_group_sizze_31613) +\n                         wave_sizze_33133 - 1, wave_sizze_33133))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33145 = skip_waves_33146 * wave_sizze_33133;\n        if (slt32(local_tid_33131 + offset_33145,\n                  sext_i64_i32(segred_group_sizze_31613)) && ((local_tid_33131 -\n                                                               squot32(local_tid_33131,\n                                  ",
            "                                     wave_sizze_33133) *\n                                                               wave_sizze_33133) ==\n                                                              0 &&\n                                                              (squot32(local_tid_33131,\n                                                                       wave_sizze_33133) &\n                                                               (2 *\n                                                                skip_waves_33146 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_33142 = ((__local\n                            int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                                                          offset_33145)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33143 = add64(x_33141, x_33142);\n                \n                x_33141 = defunc_1_op_res_33143;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n                    x_33141;\n            }\n        }\n        skip_waves_33146 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33131) == (int64_t) 0) {\n            x_acc_33139 = x_33141;\n        }\n    }\n    \n    int32_t old_counter_33147;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33131 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_33127)[sext_i32_i64(group_tid_33132) *\n                                                  segred_group_sizze_31613] =\n                x_acc_33139;\n            mem_fence_global();\n            old_counter_33147 = atomic_add_i32_global(&((volatile __g",
            "lobal\n                                                         int *) test_ballQueryzicounter_mem_33125)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33135)[(int64_t) 0] =\n                old_counter_33147 == num_groups_31615 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33148;\n    \n    is_last_group_33148 = ((__local bool *) sync_arr_mem_33135)[(int64_t) 0];\n    if (is_last_group_33148) {\n        if (local_tid_33131 == 0) {\n            old_counter_33147 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_ballQueryzicounter_mem_33125)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_31615));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33149 = sdiv_up64(num_groups_31615,\n                                                      segred_group_sizze_31613);\n            \n            x_29983 = (int64_t) 0;\n            for (int64_t i_33150 = 0; i_33150 < read_per_thread_33149;\n                 i_33150++) {\n                int64_t group_res_id_33151 = sext_i32_i64(local_tid_33131) *\n                        read_per_thread_33149 + i_33150;\n                int64_t index_of_group_res_33152 = group_res_id_33151;\n                \n                if (slt64(group_res_id_33151, num_groups_31615)) {\n                    x_29984 = ((__global\n                                int64_t *) group_res_arr_mem_33127)[index_of_group_res_33152 *\n                                                                    segred_group_sizze_31613];\n                    \n                    int64_t defunc_1_op_res_29985;\n                    \n                    defunc_1_op_res_29985 = add64(x_29983, x_29984);\n                    x_29983 = defunc",
            "_1_op_res_29985;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n            x_29983;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33153;\n            int32_t skip_waves_33154;\n            \n            skip_waves_33154 = 1;\n            \n            int64_t x_33141;\n            int64_t x_33142;\n            \n            offset_33153 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33131,\n                          sext_i64_i32(segred_group_sizze_31613))) {\n                    x_33141 = ((__local\n                                int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                                                              offset_33153)];\n                }\n            }\n            offset_33153 = 1;\n            while (slt32(offset_33153, wave_sizze_33133)) {\n                if (slt32(local_tid_33131 + offset_33153,\n                          sext_i64_i32(segred_group_sizze_31613)) &&\n                    ((local_tid_33131 - squot32(local_tid_33131,\n                                                wave_sizze_33133) *\n                      wave_sizze_33133) & (2 * offset_33153 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_33142 = ((volatile __local\n                                    int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                                                                  offset_33153)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33143 = add64(x_33141, x_33142);\n                        \n                        x_33141 = defunc_1_op_res_33143;\n                    }\n                    // write result of operation\n                    {\n                  ",
            "      ((volatile __local\n                          int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n                            x_33141;\n                    }\n                }\n                offset_33153 *= 2;\n            }\n            while (slt32(skip_waves_33154,\n                         squot32(sext_i64_i32(segred_group_sizze_31613) +\n                                 wave_sizze_33133 - 1, wave_sizze_33133))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33153 = skip_waves_33154 * wave_sizze_33133;\n                if (slt32(local_tid_33131 + offset_33153,\n                          sext_i64_i32(segred_group_sizze_31613)) &&\n                    ((local_tid_33131 - squot32(local_tid_33131,\n                                                wave_sizze_33133) *\n                      wave_sizze_33133) == 0 && (squot32(local_tid_33131,\n                                                         wave_sizze_33133) &\n                                                 (2 * skip_waves_33154 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33142 = ((__local\n                                    int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131 +\n                                                                  offset_33153)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33143 = add64(x_33141, x_33142);\n                        \n                        x_33141 = defunc_1_op_res_33143;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_33137)[sext_i32_i64(local_tid_33131)] =\n                            x_33141;\n                    }\n                }\n                skip_waves_33154 *= 2;\n            }\n            // and back to memory with the fi",
            "nal result\n            {\n                if (local_tid_33131 == 0) {\n                    ((__global int64_t *) mem_32052)[(int64_t) 0] = x_33141;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_31613\n}\n__kernel void test_ballQueryzisegred_nonseg_31846(__global int *global_failure,\n                                                  int failure_is_an_option,\n                                                  __global\n                                                  int64_t *global_failure_args,\n                                                  uint red_arr_mem_33809_backing_offset_0,\n                                                  uint sync_arr_mem_33807_backing_offset_1,\n                                                  int64_t defunc_2_reduce_res_29982,\n                                                  int64_t num_groups_31840,\n                                                  int64_t num_threads_33801,\n                                                  __global\n                                                  unsigned char *mem_32073,\n                                                  __global\n                                                  unsigned char *defunc_0_f_res_mem_32119,\n                                                  __global\n                                                  unsigned char *mem_32122,\n                                                  __global\n                                                  unsigned char *mem_32124,\n                                                  __global\n                                                  unsigned char *test_ballQueryzicounter_mem_33797,\n                                                  __global\n                                                  unsigned char *group_res_arr_mem_33799)\n{\n    #define segred_group_sizze_31838 (test_ballQueryzisegred_group_sizze_31837)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int ",
            "block_dim2 = 2;\n    volatile char *red_arr_mem_33809_backing_1 =\n                  &shared_mem[red_arr_mem_33809_backing_offset_0];\n    volatile char *sync_arr_mem_33807_backing_0 =\n                  &shared_mem[sync_arr_mem_33807_backing_offset_1];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_33802;\n    int32_t local_tid_33803;\n    int64_t group_sizze_33806;\n    int32_t wave_sizze_33805;\n    int32_t group_tid_33804;\n    \n    global_tid_33802 = get_global_id(0);\n    local_tid_33803 = get_local_id(0);\n    group_sizze_33806 = get_local_size(0);\n    wave_sizze_33805 = LOCKSTEP_WIDTH;\n    group_tid_33804 = get_group_id(0);\n    \n    int32_t phys_tid_31846;\n    \n    phys_tid_31846 = global_tid_33802;\n    \n    __local char *sync_arr_mem_33807;\n    \n    sync_arr_mem_33807 = (__local char *) sync_arr_mem_33807_backing_0;\n    \n    __local char *red_arr_mem_33809;\n    \n    red_arr_mem_33809 = (__local char *) red_arr_mem_33809_backing_1;\n    \n    int64_t dummy_31844;\n    \n    dummy_31844 = (int64_t) 0;\n    \n    int64_t gtid_31845;\n    \n    gtid_31845 = (int64_t) 0;\n    \n    int32_t x_acc_33811;\n    int64_t chunk_sizze_33812;\n    \n    chunk_sizze_33812 = smin64(sdiv_up64(defunc_2_reduce_res_29982,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_31838 *\n                                         num_groups_31840))),\n                               sdiv_up64(defunc_2_reduce_res_29982 -\n                                         phys_tid_31846, num_threads_33801));\n    \n    int32_t x_30227;\n    int32_t x_30228;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_33811 = 0;\n    }\n    for (int64_t i_33816 = 0; i_33816 < chunk_sizze_33812; i_33816++) {\n        gtid_31845 = phys_tid_31846 + num_threads_33801 * i_33816;\n ",
            "       // apply map function\n        {\n            int64_t x_30230 = ((__global\n                                int64_t *) defunc_0_f_res_mem_32119)[gtid_31845];\n            bool x_30231 = sle64((int64_t) 0, x_30230);\n            bool y_30232 = slt64(x_30230, defunc_2_reduce_res_29982);\n            bool bounds_check_30233 = x_30231 && y_30232;\n            bool index_certs_30234;\n            \n            if (!bounds_check_30233) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 8) ==\n                        -1) {\n                        global_failure_args[0] = x_30230;\n                        global_failure_args[1] = defunc_2_reduce_res_29982;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int32_t defunc_0_f_res_30235 = ((__global\n                                             int32_t *) mem_32073)[x_30230];\n            bool bool_arg_30236 = defunc_0_f_res_30235 == -1;\n            bool bool_arg_30237 = !bool_arg_30236;\n            int32_t bool_res_30238 = btoi_bool_i32(bool_arg_30237);\n            \n            // save map-out results\n            {\n                ((__global int32_t *) mem_32124)[dummy_31844 *\n                                                 defunc_2_reduce_res_29982 +\n                                                 gtid_31845] =\n                    defunc_0_f_res_30235;\n            }\n            // load accumulator\n            {\n                x_30227 = x_acc_33811;\n            }\n            // load new values\n            {\n                x_30228 = bool_res_30238;\n            }\n            // apply reduction operator\n            {\n                int32_t defunc_1_op_res_30229 = add32(x_30227, x_30228);\n                \n                // store in accumulator\n                {\n                    x_acc_33811 = defunc_1_op_res_30229;\n                }\n            }\n        }\n    ",
            "}\n    // to reduce current chunk, first store our result in memory\n    {\n        x_30227 = x_acc_33811;\n        ((__local int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803)] =\n            x_30227;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33817;\n    int32_t skip_waves_33818;\n    \n    skip_waves_33818 = 1;\n    \n    int32_t x_33813;\n    int32_t x_33814;\n    \n    offset_33817 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33803, sext_i64_i32(segred_group_sizze_31838))) {\n            x_33813 = ((__local\n                        int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                      offset_33817)];\n        }\n    }\n    offset_33817 = 1;\n    while (slt32(offset_33817, wave_sizze_33805)) {\n        if (slt32(local_tid_33803 + offset_33817,\n                  sext_i64_i32(segred_group_sizze_31838)) && ((local_tid_33803 -\n                                                               squot32(local_tid_33803,\n                                                                       wave_sizze_33805) *\n                                                               wave_sizze_33805) &\n                                                              (2 *\n                                                               offset_33817 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_33814 = ((volatile __local\n                            int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                          offset_33817)];\n            }\n            // apply reduction operation\n            {\n                int32_t defunc_1_op_res_33815 = add32(x_33813, x_33814);\n                \n                x_33813 = defunc_1_op_res_33815;\n       ",
            "     }\n            // write result of operation\n            {\n                ((volatile __local\n                  int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803)] =\n                    x_33813;\n            }\n        }\n        offset_33817 *= 2;\n    }\n    while (slt32(skip_waves_33818,\n                 squot32(sext_i64_i32(segred_group_sizze_31838) +\n                         wave_sizze_33805 - 1, wave_sizze_33805))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33817 = skip_waves_33818 * wave_sizze_33805;\n        if (slt32(local_tid_33803 + offset_33817,\n                  sext_i64_i32(segred_group_sizze_31838)) && ((local_tid_33803 -\n                                                               squot32(local_tid_33803,\n                                                                       wave_sizze_33805) *\n                                                               wave_sizze_33805) ==\n                                                              0 &&\n                                                              (squot32(local_tid_33803,\n                                                                       wave_sizze_33805) &\n                                                               (2 *\n                                                                skip_waves_33818 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_33814 = ((__local\n                            int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                          offset_33817)];\n            }\n            // apply reduction operation\n            {\n                int32_t defunc_1_op_res_33815 = add32(x_33813, x_33814);\n                \n                x_33813 = defunc_1_op_res_33815;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int32_t *) red_arr_mem_33809)[se",
            "xt_i32_i64(local_tid_33803)] =\n                    x_33813;\n            }\n        }\n        skip_waves_33818 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33803) == (int64_t) 0) {\n            x_acc_33811 = x_33813;\n        }\n    }\n    \n    int32_t old_counter_33819;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33803 == 0) {\n            ((__global\n              int32_t *) group_res_arr_mem_33799)[sext_i32_i64(group_tid_33804) *\n                                                  segred_group_sizze_31838] =\n                x_acc_33811;\n            mem_fence_global();\n            old_counter_33819 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_ballQueryzicounter_mem_33797)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33807)[(int64_t) 0] =\n                old_counter_33819 == num_groups_31840 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33820;\n    \n    is_last_group_33820 = ((__local bool *) sync_arr_mem_33807)[(int64_t) 0];\n    if (is_last_group_33820) {\n        if (local_tid_33803 == 0) {\n            old_counter_33819 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_ballQueryzicounter_mem_33797)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_31840));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33821 = sdiv_up64(num_groups_31840,\n                                                      segred_group_sizze_31838);\n            \n            x_30227 = 0;\n            for (int64_t i_33822 = 0; i_3382",
            "2 < read_per_thread_33821;\n                 i_33822++) {\n                int64_t group_res_id_33823 = sext_i32_i64(local_tid_33803) *\n                        read_per_thread_33821 + i_33822;\n                int64_t index_of_group_res_33824 = group_res_id_33823;\n                \n                if (slt64(group_res_id_33823, num_groups_31840)) {\n                    x_30228 = ((__global\n                                int32_t *) group_res_arr_mem_33799)[index_of_group_res_33824 *\n                                                                    segred_group_sizze_31838];\n                    \n                    int32_t defunc_1_op_res_30229;\n                    \n                    defunc_1_op_res_30229 = add32(x_30227, x_30228);\n                    x_30227 = defunc_1_op_res_30229;\n                }\n            }\n        }\n        ((__local int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803)] =\n            x_30227;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33825;\n            int32_t skip_waves_33826;\n            \n            skip_waves_33826 = 1;\n            \n            int32_t x_33813;\n            int32_t x_33814;\n            \n            offset_33825 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33803,\n                          sext_i64_i32(segred_group_sizze_31838))) {\n                    x_33813 = ((__local\n                                int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                              offset_33825)];\n                }\n            }\n            offset_33825 = 1;\n            while (slt32(offset_33825, wave_sizze_33805)) {\n                if (slt32(local_tid_33803 + offset_33825,\n                          sext_i64_i32(segred_group_sizze_31838)) &&\n                    ((local_tid_33803 - squot32(local_tid_33803,\n                              ",
            "                  wave_sizze_33805) *\n                      wave_sizze_33805) & (2 * offset_33825 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_33814 = ((volatile __local\n                                    int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                                  offset_33825)];\n                    }\n                    // apply reduction operation\n                    {\n                        int32_t defunc_1_op_res_33815 = add32(x_33813, x_33814);\n                        \n                        x_33813 = defunc_1_op_res_33815;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803)] =\n                            x_33813;\n                    }\n                }\n                offset_33825 *= 2;\n            }\n            while (slt32(skip_waves_33826,\n                         squot32(sext_i64_i32(segred_group_sizze_31838) +\n                                 wave_sizze_33805 - 1, wave_sizze_33805))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33825 = skip_waves_33826 * wave_sizze_33805;\n                if (slt32(local_tid_33803 + offset_33825,\n                          sext_i64_i32(segred_group_sizze_31838)) &&\n                    ((local_tid_33803 - squot32(local_tid_33803,\n                                                wave_sizze_33805) *\n                      wave_sizze_33805) == 0 && (squot32(local_tid_33803,\n                                                         wave_sizze_33805) &\n                                                 (2 * skip_waves_33826 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33814 = ((__local\n                                    int32_t *) red_",
            "arr_mem_33809)[sext_i32_i64(local_tid_33803 +\n                                                                  offset_33825)];\n                    }\n                    // apply reduction operation\n                    {\n                        int32_t defunc_1_op_res_33815 = add32(x_33813, x_33814);\n                        \n                        x_33813 = defunc_1_op_res_33815;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int32_t *) red_arr_mem_33809)[sext_i32_i64(local_tid_33803)] =\n                            x_33813;\n                    }\n                }\n                skip_waves_33826 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_33803 == 0) {\n                    ((__global int32_t *) mem_32122)[(int64_t) 0] = x_33813;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_31838\n}\n__kernel void test_ballQueryzisegred_small_33235(__global int *global_failure,\n                                                 uint red_arr_mem_33243_backing_offset_0,\n                                                 int64_t defunc_2_reduce_res_29982,\n                                                 int64_t num_groups_31625,\n                                                 int32_t num_subhistos_33156,\n                                                 int64_t segment_sizze_nonzzero_33236,\n                                                 __global\n                                                 unsigned char *mem_32054,\n                                                 __global\n                                                 unsigned char *defunc_1_map_res_subhistos_mem_33157)\n{\n    #define seghist_group_sizze_31623 (test_ballQueryziseghist_group_sizze_31622)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n",
            "    volatile char *red_arr_mem_33243_backing_0 =\n                  &shared_mem[red_arr_mem_33243_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33238;\n    int32_t local_tid_33239;\n    int64_t group_sizze_33242;\n    int32_t wave_sizze_33241;\n    int32_t group_tid_33240;\n    \n    global_tid_33238 = get_global_id(0);\n    local_tid_33239 = get_local_id(0);\n    group_sizze_33242 = get_local_size(0);\n    wave_sizze_33241 = LOCKSTEP_WIDTH;\n    group_tid_33240 = get_group_id(0);\n    \n    int32_t flat_gtid_33235;\n    \n    flat_gtid_33235 = global_tid_33238;\n    \n    __local char *red_arr_mem_33243;\n    \n    red_arr_mem_33243 = (__local char *) red_arr_mem_33243_backing_0;\n    \n    int32_t phys_group_id_33245;\n    \n    phys_group_id_33245 = get_group_id(0);\n    for (int32_t i_33246 = 0; i_33246 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29982,\n                                          squot64(seghist_group_sizze_31623,\n                                                  segment_sizze_nonzzero_33236))) -\n                   phys_group_id_33245, sext_i64_i32(num_groups_31625));\n         i_33246++) {\n        int32_t virt_group_id_33247 = phys_group_id_33245 + i_33246 *\n                sext_i64_i32(num_groups_31625);\n        int64_t bucket_id_33233 = squot64(sext_i32_i64(local_tid_33239),\n                                          segment_sizze_nonzzero_33236) +\n                sext_i32_i64(virt_group_id_33247) *\n                squot64(seghist_group_sizze_31623,\n                        segment_sizze_nonzzero_33236);\n        int64_t subhistogram_id_33234 = srem64(sext_i32_i64(local_tid_33239),\n                                               num_subhistos_33156);\n        \n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_33156) &&\n                (slt64(bucket_id_33233, defunc_2_reduce_res_29982) &&\n                 slt64(sext_i32_i64(local_tid_33239), num_subhist",
            "os_33156 *\n                       squot64(seghist_group_sizze_31623,\n                               segment_sizze_nonzzero_33236)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                        ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_33157)[subhistogram_id_33234 *\n                                                                           defunc_2_reduce_res_29982 +\n                                                                           bucket_id_33233];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                    (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_33156)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_31629;\n                int64_t x_31630;\n                int64_t x_33248;\n                int64_t x_33249;\n                bool ltid_in_bounds_33251;\n                \n                ltid_in_bounds_33251 = slt64(sext_i32_i64(local_tid_33239),\n                                             num_subhistos_33156 *\n                                             squot64(seghist_group_sizze_31623,\n                                                     segment_sizze_nonzzero_33236));\n                \n                int32_t skip_threads_33252;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_33251) {\n                        x_31630 = ((volatile __local\n                                    int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)];\n                        if ((local_tid_33239 - squot32(local_tid_33239, 32) *\n                             32) == 0) {\n                         ",
            "   x_31629 = x_31630;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_33252 = 1;\n                    while (slt32(skip_threads_33252, 32)) {\n                        if (sle32(skip_threads_33252, local_tid_33239 -\n                                  squot32(local_tid_33239, 32) * 32) &&\n                            ltid_in_bounds_33251) {\n                            // read operands\n                            {\n                                x_31629 = ((volatile __local\n                                            int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239) -\n                                                                          sext_i32_i64(skip_threads_33252)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_33253 =\n                                     slt64(srem64(sext_i32_i64(local_tid_33239),\n                                                  num_subhistos_33156),\n                                           sext_i32_i64(local_tid_33239) -\n                                           sext_i32_i64(local_tid_33239 -\n                                           skip_threads_33252));\n                                \n                                if (inactive_33253) {\n                                    x_31629 = x_31630;\n                                }\n                                if (!inactive_33253) {\n                                    int64_t defunc_1_f_res_31631 =\n                                            smax64(x_31629, x_31630);\n                                    \n                                    x_31629 = defunc_1_f_res_31631;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_33241, skip_threads_33252)) {\n           ",
            "                 barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_33252, local_tid_33239 -\n                                  squot32(local_tid_33239, 32) * 32) &&\n                            ltid_in_bounds_33251) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                                    x_31629;\n                                x_31630 = x_31629;\n                            }\n                        }\n                        if (sle32(wave_sizze_33241, skip_threads_33252)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_33252 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_33239 - squot32(local_tid_33239, 32) * 32) ==\n                        31 && ltid_in_bounds_33251) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_33243)[sext_i32_i64(squot32(local_tid_33239,\n                                                                             32))] =\n                            x_31629;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_33254;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_33239, 32) == 0 &&\n                            ltid_in_bounds_33251) {\n                            x_33249 = ((volatile __local\n                                        int64_t *) red_a",
            "rr_mem_33243)[sext_i32_i64(local_tid_33239)];\n                            if ((local_tid_33239 - squot32(local_tid_33239,\n                                                           32) * 32) == 0) {\n                                x_33248 = x_33249;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_33254 = 1;\n                        while (slt32(skip_threads_33254, 32)) {\n                            if (sle32(skip_threads_33254, local_tid_33239 -\n                                      squot32(local_tid_33239, 32) * 32) &&\n                                (squot32(local_tid_33239, 32) == 0 &&\n                                 ltid_in_bounds_33251)) {\n                                // read operands\n                                {\n                                    x_33248 = ((volatile __local\n                                                int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239) -\n                                                                              sext_i32_i64(skip_threads_33254)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_33255 =\n                                         slt64(srem64(sext_i32_i64(local_tid_33239 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_33156),\n                                               sext_i32_i64(local_tid_33239 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_33239 -\n                                                             skip_threads_33254) *\n                                               32 + 32 - 1));\n                                    \n          ",
            "                          if (inactive_33255) {\n                                        x_33248 = x_33249;\n                                    }\n                                    if (!inactive_33255) {\n                                        int64_t defunc_1_f_res_33250 =\n                                                smax64(x_33248, x_33249);\n                                        \n                                        x_33248 = defunc_1_f_res_33250;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_33241, skip_threads_33254)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_33254, local_tid_33239 -\n                                      squot32(local_tid_33239, 32) * 32) &&\n                                (squot32(local_tid_33239, 32) == 0 &&\n                                 ltid_in_bounds_33251)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                                        x_33248;\n                                    x_33249 = x_33248;\n                                }\n                            }\n                            if (sle32(wave_sizze_33241, skip_threads_33254)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_33254 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_33239, 32) == 0 ||\n                          !ltid_in_bounds_33251)) {\n                        // read operands\n        ",
            "                {\n                            x_31630 = x_31629;\n                            x_31629 = ((__local\n                                        int64_t *) red_arr_mem_33243)[sext_i32_i64(squot32(local_tid_33239,\n                                                                                           32)) -\n                                                                      (int64_t) 1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_33256 =\n                                 slt64(srem64(sext_i32_i64(local_tid_33239),\n                                              num_subhistos_33156),\n                                       sext_i32_i64(local_tid_33239) -\n                                       sext_i32_i64(squot32(local_tid_33239,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_33256) {\n                                x_31629 = x_31630;\n                            }\n                            if (!inactive_33256) {\n                                int64_t defunc_1_f_res_31631 = smax64(x_31629,\n                                                                      x_31630);\n                                \n                                x_31629 = defunc_1_f_res_31631;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                                x_31629;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_33239, 32) == 0) {\n                        ((__local\n                          int64",
            "_t *) red_arr_mem_33243)[sext_i32_i64(local_tid_33239)] =\n                            x_31630;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_33247) *\n                      squot64(seghist_group_sizze_31623,\n                              segment_sizze_nonzzero_33236) +\n                      sext_i32_i64(local_tid_33239),\n                      defunc_2_reduce_res_29982) &&\n                slt64(sext_i32_i64(local_tid_33239),\n                      squot64(seghist_group_sizze_31623,\n                              segment_sizze_nonzzero_33236))) {\n                ((__global\n                  int64_t *) mem_32054)[sext_i32_i64(virt_group_id_33247) *\n                                        squot64(seghist_group_sizze_31623,\n                                                segment_sizze_nonzzero_33236) +\n                                        sext_i32_i64(local_tid_33239)] =\n                    ((__local\n                      int64_t *) red_arr_mem_33243)[(sext_i32_i64(local_tid_33239) +\n                                                     (int64_t) 1) *\n                                                    segment_sizze_nonzzero_33236 -\n                                                    (int64_t) 1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_31623\n}\n__kernel void test_ballQueryzisegscan_31237(__global int *global_failure,\n                                            uint local_mem_32515_backing_offset_0,\n                                            int64_t implz2081U_29737,\n                                            int32_t defunc_2_radix_sort_step_arg_29772,\n                                            int32_t defunc_0_get_bit_arg_297",
            "73,\n                                            __global\n                                            unsigned char *mem_param_31961,\n                                            __global unsigned char *mem_31973,\n                                            __global unsigned char *mem_31975,\n                                            __global unsigned char *mem_31977,\n                                            __global unsigned char *mem_31979,\n                                            __global unsigned char *mem_31981,\n                                            __global\n                                            unsigned char *test_ballQueryziid_counter_mem_32471,\n                                            __global\n                                            unsigned char *status_flags_mem_32473,\n                                            __global\n                                            unsigned char *aggregates_mem_32475,\n                                            __global\n                                            unsigned char *incprefixes_mem_32477,\n                                            __global\n                                            unsigned char *aggregates_mem_32479,\n                                            __global\n                                            unsigned char *incprefixes_mem_32481,\n                                            __global\n                                            unsigned char *aggregates_mem_32483,\n                                            __global\n                                            unsigned char *incprefixes_mem_32485,\n                                            __global\n                                            unsigned char *aggregates_mem_32487,\n                                            __global\n                                            unsigned char *incprefixes_mem_32489)\n{\n    #define segscan_group_sizze_31232 (test_ballQueryzisegscan_group_sizze_31231)\n    \n    const int block_d",
            "im0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32515_backing_0 =\n                  &shared_mem[local_mem_32515_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32500;\n    int32_t local_tid_32501;\n    int64_t group_sizze_32504;\n    int32_t wave_sizze_32503;\n    int32_t group_tid_32502;\n    \n    global_tid_32500 = get_global_id(0);\n    local_tid_32501 = get_local_id(0);\n    group_sizze_32504 = get_local_size(0);\n    wave_sizze_32503 = LOCKSTEP_WIDTH;\n    group_tid_32502 = get_group_id(0);\n    \n    int32_t phys_tid_31237;\n    \n    phys_tid_31237 = global_tid_32500;\n    \n    int64_t byte_offsets_32505;\n    \n    byte_offsets_32505 = (int64_t) 0;\n    \n    int64_t byte_offsets_32506;\n    \n    byte_offsets_32506 = segscan_group_sizze_31232 * (int64_t) 8;\n    \n    int64_t byte_offsets_32507;\n    \n    byte_offsets_32507 = sdiv_up64(segscan_group_sizze_31232 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_31232 * (int64_t) 8;\n    \n    int64_t byte_offsets_32508;\n    \n    byte_offsets_32508 = sdiv_up64(sdiv_up64(segscan_group_sizze_31232 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_31232 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_31232 * (int64_t) 8;\n    \n    int64_t byte_offsets_32509;\n    \n    byte_offsets_32509 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_31232 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_31232 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_31232 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31232 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32510;\n    ",
            "\n    warp_byte_offset_32510 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32511;\n    \n    warp_byte_offset_32511 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_32512;\n    \n    warp_byte_offset_32512 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_32513;\n    \n    warp_byte_offset_32513 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_32514;\n    \n    warp_byte_offset_32514 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32515;\n    \n    local_mem_32515 = (__local char *) local_mem_32515_backing_0;\n    \n    int64_t trans_arr_len_32516;\n    \n    trans_arr_len_32516 = (int64_t) 9 * segscan_group_sizze_31232;\n    \n    int32_t dynamic_id_32532;\n    \n    if (local_tid_32501 == 0) {\n        dynamic_id_32532 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_32471)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32515)[(int64_t) 0] = dynamic_id_32532;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32532 = ((__local int32_t *) local_mem_32515)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32533;\n    \n    blockOff_32533 = sext_i32_i64(dynamic_id_32532) * (int64_t) 9 *\n        segscan_group_sizze_31232;\n    \n    int64_t private_mem_32534[9];\n    int64_t private_mem_32536[9];\n    int64_t private_mem_32538[9];\n    int64_t private_mem_32540[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32542 = 0; i_32542 < (int64_t) 9; i_32542++) {\n            int64_t gtid_31236 = blockOff_32533 +\n                    sext_i32_i64(local_tid_32501) + i_32542 *\n                    segscan_group_sizze_31232;\n            \n            if (slt64(gtid_31236, implz2081U_29737)) {\n                int32_t x_29799 = ((__global\n                                    int32_t *) mem_param_31961)[gtid_31236];\n                int32_t zgzg_res_29800 = ashr32(x_29799,",
            "\n                                                defunc_0_get_bit_arg_29773);\n                int32_t za_res_29801 = 1 & zgzg_res_29800;\n                int32_t x_29802 = mul32(2, za_res_29801);\n                int32_t zgzg_res_29803 = ashr32(x_29799,\n                                                defunc_2_radix_sort_step_arg_29772);\n                int32_t za_res_29804 = 1 & zgzg_res_29803;\n                int32_t defunc_0_f_res_29805 = add32(x_29802, za_res_29804);\n                bool cond_29806 = defunc_0_f_res_29805 == 0;\n                int64_t defunc_0_f_res_29807 = btoi_bool_i64(cond_29806);\n                int64_t defunc_0_f_res_29808;\n                int64_t defunc_0_f_res_29809;\n                int64_t defunc_0_f_res_29810;\n                \n                if (cond_29806) {\n                    defunc_0_f_res_29808 = (int64_t) 0;\n                    defunc_0_f_res_29809 = (int64_t) 0;\n                    defunc_0_f_res_29810 = (int64_t) 0;\n                } else {\n                    bool cond_29811 = defunc_0_f_res_29805 == 1;\n                    int64_t defunc_0_f_res_f_res_29812 =\n                            btoi_bool_i64(cond_29811);\n                    int64_t defunc_0_f_res_f_res_29813;\n                    int64_t defunc_0_f_res_f_res_29814;\n                    \n                    if (cond_29811) {\n                        defunc_0_f_res_f_res_29813 = (int64_t) 0;\n                        defunc_0_f_res_f_res_29814 = (int64_t) 0;\n                    } else {\n                        bool cond_29815 = defunc_0_f_res_29805 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_29816 =\n                                btoi_bool_i64(cond_29815);\n                        bool cond_neg_29817 = !cond_29815;\n                        int64_t defunc_0_f_res_f_res_f_res_29818 =\n                                btoi_bool_i64(cond_neg_29817);\n                        \n                        defunc_0_f_res_f_res_29813 =\n                            defunc_0_f_",
            "res_f_res_f_res_29816;\n                        defunc_0_f_res_f_res_29814 =\n                            defunc_0_f_res_f_res_f_res_29818;\n                    }\n                    defunc_0_f_res_29808 = defunc_0_f_res_f_res_29812;\n                    defunc_0_f_res_29809 = defunc_0_f_res_f_res_29813;\n                    defunc_0_f_res_29810 = defunc_0_f_res_f_res_29814;\n                }\n                ((__global int32_t *) mem_31981)[gtid_31236] =\n                    defunc_0_f_res_29805;\n                private_mem_32534[i_32542] = defunc_0_f_res_29807;\n                private_mem_32536[i_32542] = defunc_0_f_res_29808;\n                private_mem_32538[i_32542] = defunc_0_f_res_29809;\n                private_mem_32540[i_32542] = defunc_0_f_res_29810;\n            } else {\n                private_mem_32534[i_32542] = (int64_t) 0;\n                private_mem_32536[i_32542] = (int64_t) 0;\n                private_mem_32538[i_32542] = (int64_t) 0;\n                private_mem_32540[i_32542] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32543 = 0; i_32543 < (int64_t) 9; i_32543++) {\n            int64_t sharedIdx_32544 = sext_i32_i64(local_tid_32501) + i_32543 *\n                    segscan_group_sizze_31232;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32544] =\n                private_mem_32534[i_32543];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32545 = 0; i_32545 < 9; i_32545++) {\n            int32_t sharedIdx_32546 = local_tid_32501 * 9 + i_32545;\n            \n            private_mem_32534[sext_i32_i64(i_32545)] = ((__local\n                                                         int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32546)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32547 = 0; i_32547 < (int64_t) 9; i_32547++) {\n            int64_t sharedIdx_32548 = sext_i32_i64(local_tid_32501)",
            " + i_32547 *\n                    segscan_group_sizze_31232;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32548] =\n                private_mem_32536[i_32547];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32549 = 0; i_32549 < 9; i_32549++) {\n            int32_t sharedIdx_32550 = local_tid_32501 * 9 + i_32549;\n            \n            private_mem_32536[sext_i32_i64(i_32549)] = ((__local\n                                                         int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32550)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32551 = 0; i_32551 < (int64_t) 9; i_32551++) {\n            int64_t sharedIdx_32552 = sext_i32_i64(local_tid_32501) + i_32551 *\n                    segscan_group_sizze_31232;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32552] =\n                private_mem_32538[i_32551];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32553 = 0; i_32553 < 9; i_32553++) {\n            int32_t sharedIdx_32554 = local_tid_32501 * 9 + i_32553;\n            \n            private_mem_32538[sext_i32_i64(i_32553)] = ((__local\n                                                         int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32554)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32555 = 0; i_32555 < (int64_t) 9; i_32555++) {\n            int64_t sharedIdx_32556 = sext_i32_i64(local_tid_32501) + i_32555 *\n                    segscan_group_sizze_31232;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32556] =\n                private_mem_32540[i_32555];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32557 = 0; i_32557 < 9; i_32557++) {\n            int32_t sharedIdx_32558 = local_tid_32501 * 9 + i_32557;\n            \n            private_mem_32540[sext_i32_i64(i_32557)] = ((__local\n                                                         int64_t *) local",
            "_mem_32515)[sext_i32_i64(sharedIdx_32558)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32559 = 0; i_32559 < (int64_t) 8; i_32559++) {\n            int64_t x_29787;\n            int64_t x_29791;\n            \n            x_29787 = private_mem_32534[i_32559];\n            x_29791 = private_mem_32534[i_32559 + (int64_t) 1];\n            \n            int64_t x_29788;\n            int64_t x_29792;\n            \n            x_29788 = private_mem_32536[i_32559];\n            x_29792 = private_mem_32536[i_32559 + (int64_t) 1];\n            \n            int64_t x_29789;\n            int64_t x_29793;\n            \n            x_29789 = private_mem_32538[i_32559];\n            x_29793 = private_mem_32538[i_32559 + (int64_t) 1];\n            \n            int64_t x_29790;\n            int64_t x_29794;\n            \n            x_29790 = private_mem_32540[i_32559];\n            x_29794 = private_mem_32540[i_32559 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29795;\n            \n            defunc_1_op_res_29795 = add64(x_29787, x_29791);\n            \n            int64_t defunc_1_op_res_29796 = add64(x_29788, x_29792);\n            int64_t defunc_1_op_res_29797 = add64(x_29789, x_29793);\n            int64_t defunc_1_op_res_29798 = add64(x_29790, x_29794);\n            \n            private_mem_32534[i_32559 + (int64_t) 1] = defunc_1_op_res_29795;\n            private_mem_32536[i_32559 + (int64_t) 1] = defunc_1_op_res_29796;\n            private_mem_32538[i_32559 + (int64_t) 1] = defunc_1_op_res_29797;\n            private_mem_32540[i_32559 + (int64_t) 1] = defunc_1_op_res_29798;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n            private_mem_32534[(int64_t) 8];\n        ((__local int",
            "64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n            private_mem_32536[(int64_t) 8];\n        ((__local int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n            private_mem_32538[(int64_t) 8];\n        ((__local int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n            private_mem_32540[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32572;\n    int64_t acc_32573;\n    int64_t acc_32574;\n    int64_t acc_32575;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32560;\n        int64_t x_32561;\n        int64_t x_32562;\n        int64_t x_32563;\n        int64_t x_32564;\n        int64_t x_32565;\n        int64_t x_32566;\n        int64_t x_32567;\n        int64_t x_32576;\n        int64_t x_32577;\n        int64_t x_32578;\n        int64_t x_32579;\n        int64_t x_32580;\n        int64_t x_32581;\n        int64_t x_32582;\n        int64_t x_32583;\n        bool ltid_in_bounds_32588;\n        \n        ltid_in_bounds_32588 = slt64(sext_i32_i64(local_tid_32501),\n                                     segscan_group_sizze_31232);\n        \n        int32_t skip_threads_32589;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32588) {\n                x_32564 = ((volatile __local\n                            int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32501)];\n                x",
            "_32565 = ((volatile __local\n                            int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32501)];\n                x_32566 = ((volatile __local\n                            int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32501)];\n                x_32567 = ((volatile __local\n                            int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32501)];\n                if ((local_tid_32501 - squot32(local_tid_32501, 32) * 32) ==\n                    0) {\n                    x_32560 = x_32564;\n                    x_32561 = x_32565;\n                    x_32562 = x_32566;\n                    x_32563 = x_32567;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32589 = 1;\n            while (slt32(skip_threads_32589, 32)) {\n                if (sle32(skip_threads_32589, local_tid_32501 -\n                          squot32(local_tid_32501, 32) * 32) &&\n                    ltid_in_bounds_32588) {\n                    // read operands\n                    {\n                        x_32560 = ((volatile __local\n                                    int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32501) -\n                                                                 sext_i32_i64(skip_threads_32589))];\n              ",
            "          x_32561 = ((volatile __local\n                                    int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32501) -\n                                                                 sext_i32_i64(skip_threads_32589))];\n                        x_32562 = ((volatile __local\n                                    int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32501) -\n                                                                 sext_i32_i64(skip_threads_32589))];\n                        x_32563 = ((volatile __local\n                                    int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32501) -\n                                                                 sext_i32_i64(skip_threads_32589))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32568 = add64(x_32560, x_32564);\n                        int64_t defunc_1_op_res_32569 = add64(x_32561, x_32565);\n                        int64_t defunc_1_op_res_32570 = add64(x_32562, x_32566);\n                        int64_t defunc_1_op_res_32571 = add64(x_32563, x_32567);\n                        \n                        x_32560 = defunc_1_op_res_32568;\n                        x_32561 = defunc_1_op_res_32569;\n                        x_32562 = defunc_1_op_res_32570;\n                        x_32563 = defunc_1_op_res_32571;\n                    }\n                }\n                if (sl",
            "e32(wave_sizze_32503, skip_threads_32589)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32589, local_tid_32501 -\n                          squot32(local_tid_32501, 32) * 32) &&\n                    ltid_in_bounds_32588) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32501)] =\n                            x_32560;\n                        x_32564 = x_32560;\n                        ((volatile __local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32501)] =\n                            x_32561;\n                        x_32565 = x_32561;\n                        ((volatile __local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32501)] =\n                            x_32562;\n                        x_32566 = x_32562;\n                        ((volatile __local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32501)] =\n                            x_32563;\n                        x_32567 = x_32563;\n                    }\n                }\n                if (sle32(wave_sizze_32503, skip_threads_32589)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n      ",
            "          skip_threads_32589 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32501 - squot32(local_tid_32501, 32) * 32) == 31 &&\n                ltid_in_bounds_32588) {\n                ((volatile __local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32501,\n                                                                   32))] =\n                    x_32560;\n                ((volatile __local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32501,\n                                                                   32))] =\n                    x_32561;\n                ((volatile __local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32501,\n                                                                   32))] =\n                    x_32562;\n                ((volatile __local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32501,\n                                                                   32))] =\n                    x_32563;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32590;\n            \n            // read input f",
            "or in-block scan\n            {\n                if (squot32(local_tid_32501, 32) == 0 && ltid_in_bounds_32588) {\n                    x_32580 = ((volatile __local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32501)];\n                    x_32581 = ((volatile __local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32501)];\n                    x_32582 = ((volatile __local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32501)];\n                    x_32583 = ((volatile __local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32501)];\n                    if ((local_tid_32501 - squot32(local_tid_32501, 32) * 32) ==\n                        0) {\n                        x_32576 = x_32580;\n                        x_32577 = x_32581;\n                        x_32578 = x_32582;\n                        x_32579 = x_32583;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32590 = 1;\n                while (slt32(skip_threads_32590, 32)) {\n                    if (sle32(skip_threads_32590, local_tid_32501 -\n                              squot32(local_tid_32501, 32) * 32) &",
            "&\n                        (squot32(local_tid_32501, 32) == 0 &&\n                         ltid_in_bounds_32588)) {\n                        // read operands\n                        {\n                            x_32576 = ((volatile __local\n                                        int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32501) -\n                                                                     sext_i32_i64(skip_threads_32590))];\n                            x_32577 = ((volatile __local\n                                        int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32501) -\n                                                                     sext_i32_i64(skip_threads_32590))];\n                            x_32578 = ((volatile __local\n                                        int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32501) -\n                                                                     sext_i32_i64(skip_threads_32590))];\n                            x_32579 = ((volatile __local\n                                        int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32501) -\n                                                                     sext_i32_i64(skip_threads_32590))];\n                   ",
            "     }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32584 = add64(x_32576,\n                                                                  x_32580);\n                            int64_t defunc_1_op_res_32585 = add64(x_32577,\n                                                                  x_32581);\n                            int64_t defunc_1_op_res_32586 = add64(x_32578,\n                                                                  x_32582);\n                            int64_t defunc_1_op_res_32587 = add64(x_32579,\n                                                                  x_32583);\n                            \n                            x_32576 = defunc_1_op_res_32584;\n                            x_32577 = defunc_1_op_res_32585;\n                            x_32578 = defunc_1_op_res_32586;\n                            x_32579 = defunc_1_op_res_32587;\n                        }\n                    }\n                    if (sle32(wave_sizze_32503, skip_threads_32590)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32590, local_tid_32501 -\n                              squot32(local_tid_32501, 32) * 32) &&\n                        (squot32(local_tid_32501, 32) == 0 &&\n                         ltid_in_bounds_32588)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32501)] =\n                                x_32576;\n                            x_32580 = x_32576;\n                            ((volatile __local\n                              int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n          ",
            "                                                        (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32501)] =\n                                x_32577;\n                            x_32581 = x_32577;\n                            ((volatile __local\n                              int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32501)] =\n                                x_32578;\n                            x_32582 = x_32578;\n                            ((volatile __local\n                              int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32501)] =\n                                x_32579;\n                            x_32583 = x_32579;\n                        }\n                    }\n                    if (sle32(wave_sizze_32503, skip_threads_32590)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32590 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32501, 32) == 0 || !ltid_in_bounds_32588)) {\n                // read operands\n                {\n                    x_32564 = x_32560;\n                    x_32565 = x_32561;\n                    x_32566 = x_32562;\n                    x_32567 = x_32563;\n                    x_32560 = ((__local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(",
            "local_tid_32501,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32561 = ((__local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32501,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32562 = ((__local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32501,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32563 = ((__local\n                                int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32501,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32568 = add64(x_32560, x_32564);\n                    int64_t defunc_1_op_res_32569 = add64(x_32561, x_32565);\n                    int64_t defunc_1_op_res_32570 = add64(x_32562, x_32566);\n                    int64_t defunc_1_op_res_32571 = add64(x_32563, x_32567);\n            ",
            "        \n                    x_32560 = defunc_1_op_res_32568;\n                    x_32561 = defunc_1_op_res_32569;\n                    x_32562 = defunc_1_op_res_32570;\n                    x_32563 = defunc_1_op_res_32571;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        x_32560;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        x_32561;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        x_32562;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        x_32563;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32501, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n                    x_32564;\n                ((__local\n                  int",
            "64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n                    x_32565;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n                    x_32566;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32501)] =\n                    x_32567;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32501 == 0) {\n            acc_32572 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31232 -\n                                                       (int64_t) 1)];\n            acc_32573 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31232 -\n                                                       (int64_t) 1)];\n            acc_32574 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31232 -\n                                                       (int64_t) 1)];\n            acc_32575 = ((__local\n        ",
            "                  int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31232 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32572 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32505,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32501) -\n                                                       (int64_t) 1)];\n            acc_32573 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32506,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32501) -\n                                                       (int64_t) 1)];\n            acc_32574 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32507,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32501) -\n                                                       (int64_t) 1)];\n            acc_32575 = ((__local\n                          int64_t *) local_mem_32515)[squot64(byte_offsets_32508,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32501) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32591;\n    \n    prefix_32591 = (int64_t) 0;\n    \n    int64_t prefix_32592;\n    \n    prefix_32592 = (int64_t) 0;\n    \n    int64_t prefix_32593;\n    \n    prefix_32593 = (int64_t) 0;\n    \n    int64_t pref",
            "ix_32594;\n    \n    prefix_32594 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32532 == (int64_t) 0 && local_tid_32501 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32477)[dynamic_id_32532] = acc_32572;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32481)[dynamic_id_32532] = acc_32573;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32485)[dynamic_id_32532] = acc_32574;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32489)[dynamic_id_32532] = acc_32575;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32473)[dynamic_id_32532] = (int8_t) 2;\n            acc_32572 = (int64_t) 0;\n            acc_32573 = (int64_t) 0;\n            acc_32574 = (int64_t) 0;\n            acc_32575 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32532 == (int64_t) 0) && slt32(local_tid_32501,\n                                                        wave_sizze_32503)) {\n            if (local_tid_32501 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32475)[dynamic_id_32532] =\n                    acc_32572;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32479)[dynamic_id_32532] =\n                    acc_32573;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32483)[dynamic_id_32532] =\n                    acc_32574;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32487)[dynamic_id_32532] =\n                    acc_32575;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32473)[dynamic_id_32532] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32515)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32473)[dynam",
            "ic_id_32532 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32595;\n            \n            status_32595 = ((__local int8_t *) local_mem_32515)[(int64_t) 0];\n            if (status_32595 == (int8_t) 2) {\n                if (local_tid_32501 == 0) {\n                    prefix_32591 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32477)[dynamic_id_32532 -\n                                                                       (int64_t) 1];\n                    prefix_32592 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32481)[dynamic_id_32532 -\n                                                                       (int64_t) 1];\n                    prefix_32593 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32485)[dynamic_id_32532 -\n                                                                       (int64_t) 1];\n                    prefix_32594 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32489)[dynamic_id_32532 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32596 = dynamic_id_32532 -\n                        sext_i32_i64(wave_sizze_32503);\n                \n                while (slt32(wave_sizze_32503 * -1, readOffset_32596)) {\n                    int32_t read_i_32597 = readOffset_32596 + local_tid_32501;\n                    int64_t aggr_32598 = (int64_t) 0;\n                    int64_t aggr_32599 = (int64_t) 0;\n                    int64_t aggr_32600 = (int64_t) 0;\n                    int64_t aggr_32601 = (int64_t) 0;\n                    int8_t flag_32602 = (int8_t) 0;\n                    int8_t used_32603 = (int8_t) 0;\n                    \n         ",
            "           if (sle32(0, read_i_32597)) {\n                        flag_32602 = ((volatile __global\n                                       int8_t *) status_flags_mem_32473)[sext_i32_i64(read_i_32597)];\n                        if (flag_32602 == (int8_t) 2) {\n                            aggr_32598 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32477)[sext_i32_i64(read_i_32597)];\n                            aggr_32599 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32481)[sext_i32_i64(read_i_32597)];\n                            aggr_32600 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32485)[sext_i32_i64(read_i_32597)];\n                            aggr_32601 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32489)[sext_i32_i64(read_i_32597)];\n                        } else {\n                            if (flag_32602 == (int8_t) 1) {\n                                aggr_32598 = ((volatile __global\n                                               int64_t *) aggregates_mem_32475)[sext_i32_i64(read_i_32597)];\n                                aggr_32599 = ((volatile __global\n                                               int64_t *) aggregates_mem_32479)[sext_i32_i64(read_i_32597)];\n                                aggr_32600 = ((volatile __global\n                                               int64_t *) aggregates_mem_32483)[sext_i32_i64(read_i_32597)];\n                                aggr_32601 = ((volatile __global\n                                               int64_t *) aggregates_mem_32487)[sext_i32_i64(read_i_32597)];\n                                used_32603 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(warp_byte_offset_32510,\n                                        ",
            "                  (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        aggr_32598;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(warp_byte_offset_32511,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        aggr_32599;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(warp_byte_offset_32512,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        aggr_32600;\n                    ((__local\n                      int64_t *) local_mem_32515)[squot64(warp_byte_offset_32513,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32501)] =\n                        aggr_32601;\n                    \n                    int8_t tmp_32604;\n                    \n                    tmp_32604 = flag_32602 | used_32603 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32515)[sext_i32_i64(local_tid_32501)] =\n                        tmp_32604;\n                    mem_fence_local();\n                    flag_32602 = ((volatile __local\n                                   int8_t *) local_mem_32515)[sext_i32_i64(wave_sizze_32503) -\n                                                              (int64_t) 1];\n                    if (local_tid_32501 == 0) {\n                        if (!(flag_32602 == (int8_t) 2)) {\n                            int64_t x_32605 = (int64_t) 0;\n                            int64_t x_32606 = (int64_t) 0;\n                            int64_t x_32607 = (int64_t) 0;\n                            int64_t x_32608 = (int64_t) 0;\n                            int64",
            "_t x_32609;\n                            int64_t x_32610;\n                            int64_t x_32611;\n                            int64_t x_32612;\n                            int8_t flag1_32617;\n                            \n                            flag1_32617 = (int8_t) 0;\n                            \n                            int8_t flag2_32618;\n                            int8_t used1_32619;\n                            \n                            used1_32619 = (int8_t) 0;\n                            \n                            int8_t used2_32620;\n                            \n                            for (int32_t i_32621 = 0; i_32621 <\n                                 wave_sizze_32503; i_32621++) {\n                                flag2_32618 = ((__local\n                                                int8_t *) local_mem_32515)[sext_i32_i64(i_32621)];\n                                used2_32620 = lshr8(flag2_32618, (int8_t) 2);\n                                flag2_32618 = flag2_32618 & (int8_t) 3;\n                                x_32609 = ((__local\n                                            int64_t *) local_mem_32515)[squot64(warp_byte_offset_32510,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32621)];\n                                x_32610 = ((__local\n                                            int64_t *) local_mem_32515)[squot64(warp_byte_offset_32511,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32621)];\n                                x_32611 = ((__local\n                                            int64_t *) local_mem_32515)[squot64(warp_byte_offset_32512,\n                                                                                (int64_t) 8) +\n                              ",
            "                                          sext_i32_i64(i_32621)];\n                                x_32612 = ((__local\n                                            int64_t *) local_mem_32515)[squot64(warp_byte_offset_32513,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32621)];\n                                if (!(flag2_32618 == (int8_t) 1)) {\n                                    flag1_32617 = flag2_32618;\n                                    used1_32619 = used2_32620;\n                                    x_32605 = x_32609;\n                                    x_32606 = x_32610;\n                                    x_32607 = x_32611;\n                                    x_32608 = x_32612;\n                                } else {\n                                    used1_32619 += used2_32620;\n                                    \n                                    int64_t defunc_1_op_res_32613;\n                                    \n                                    defunc_1_op_res_32613 = add64(x_32605,\n                                                                  x_32609);\n                                    \n                                    int64_t defunc_1_op_res_32614 =\n                                            add64(x_32606, x_32610);\n                                    int64_t defunc_1_op_res_32615 =\n                                            add64(x_32607, x_32611);\n                                    int64_t defunc_1_op_res_32616 =\n                                            add64(x_32608, x_32612);\n                                    \n                                    x_32605 = defunc_1_op_res_32613;\n                                    x_32606 = defunc_1_op_res_32614;\n                                    x_32607 = defunc_1_op_res_32615;\n                                    x_32608 = defunc_1_op_res_32616;\n               ",
            "                 }\n                            }\n                            flag_32602 = flag1_32617;\n                            used_32603 = used1_32619;\n                            aggr_32598 = x_32605;\n                            aggr_32599 = x_32606;\n                            aggr_32600 = x_32607;\n                            aggr_32601 = x_32608;\n                        } else {\n                            aggr_32598 = ((__local\n                                           int64_t *) local_mem_32515)[squot64(warp_byte_offset_32510,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32503) -\n                                                                        (int64_t) 1)];\n                            aggr_32599 = ((__local\n                                           int64_t *) local_mem_32515)[squot64(warp_byte_offset_32511,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32503) -\n                                                                        (int64_t) 1)];\n                            aggr_32600 = ((__local\n                                           int64_t *) local_mem_32515)[squot64(warp_byte_offset_32512,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32503) -\n                                                                        (int64_t) 1)];\n                            aggr_32601 = ((__local\n                                           int64_t *) local_mem_32515)[squot64(warp_byte_offset_32513,\n                                                                               (int64_t) 8) +\n                                          ",
            "                             (sext_i32_i64(wave_sizze_32503) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32602 == (int8_t) 2) {\n                            readOffset_32596 = wave_sizze_32503 * -1;\n                        } else {\n                            readOffset_32596 -= zext_i8_i32(used_32603);\n                        }\n                        ((__local int32_t *) local_mem_32515)[(int64_t) 0] =\n                            readOffset_32596;\n                        \n                        int64_t x_32622;\n                        \n                        x_32622 = aggr_32598;\n                        \n                        int64_t x_32623;\n                        \n                        x_32623 = aggr_32599;\n                        \n                        int64_t x_32624;\n                        \n                        x_32624 = aggr_32600;\n                        \n                        int64_t x_32625;\n                        \n                        x_32625 = aggr_32601;\n                        \n                        int64_t x_32626;\n                        \n                        x_32626 = prefix_32591;\n                        \n                        int64_t x_32627;\n                        \n                        x_32627 = prefix_32592;\n                        \n                        int64_t x_32628;\n                        \n                        x_32628 = prefix_32593;\n                        \n                        int64_t x_32629;\n                        \n                        x_32629 = prefix_32594;\n                        \n                        int64_t defunc_1_op_res_32630;\n                        \n                        defunc_1_op_res_32630 = add64(x_32622, x_32626);\n                        \n                        int64_t defunc_1_op_res_32631 = add64(x_32623, x_32627);\n                        int64_t defunc_1_op_res_32632 =",
            " add64(x_32624, x_32628);\n                        int64_t defunc_1_op_res_32633 = add64(x_32625, x_32629);\n                        \n                        prefix_32591 = defunc_1_op_res_32630;\n                        prefix_32592 = defunc_1_op_res_32631;\n                        prefix_32593 = defunc_1_op_res_32632;\n                        prefix_32594 = defunc_1_op_res_32633;\n                    }\n                    mem_fence_local();\n                    readOffset_32596 = ((__local\n                                         int32_t *) local_mem_32515)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32501 == 0) {\n                int64_t x_32634 = prefix_32591;\n                int64_t x_32635 = prefix_32592;\n                int64_t x_32636 = prefix_32593;\n                int64_t x_32637 = prefix_32594;\n                int64_t x_32638 = acc_32572;\n                int64_t x_32639 = acc_32573;\n                int64_t x_32640 = acc_32574;\n                int64_t x_32641 = acc_32575;\n                int64_t defunc_1_op_res_32642 = add64(x_32634, x_32638);\n                int64_t defunc_1_op_res_32643 = add64(x_32635, x_32639);\n                int64_t defunc_1_op_res_32644 = add64(x_32636, x_32640);\n                int64_t defunc_1_op_res_32645 = add64(x_32637, x_32641);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32477)[dynamic_id_32532] =\n                    defunc_1_op_res_32642;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32481)[dynamic_id_32532] =\n                    defunc_1_op_res_32643;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32485)[dynamic_id_32532] =\n                    defunc_1_op_res_32644;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32489)[dynamic_id_32532] =\n                    defunc_1_op_res_32645;\n                mem_fence_global();\n                ((volatile __globa",
            "l\n                  int8_t *) status_flags_mem_32473)[dynamic_id_32532] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(warp_byte_offset_32510,\n                                                      (int64_t) 8)] =\n                    prefix_32591;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(warp_byte_offset_32511,\n                                                      (int64_t) 8)] =\n                    prefix_32592;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(warp_byte_offset_32512,\n                                                      (int64_t) 8)] =\n                    prefix_32593;\n                ((__local\n                  int64_t *) local_mem_32515)[squot64(warp_byte_offset_32513,\n                                                      (int64_t) 8)] =\n                    prefix_32594;\n                acc_32572 = (int64_t) 0;\n                acc_32573 = (int64_t) 0;\n                acc_32574 = (int64_t) 0;\n                acc_32575 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32532 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32591 = ((__local\n                             int64_t *) local_mem_32515)[squot64(warp_byte_offset_32510,\n                                                                 (int64_t) 8)];\n            prefix_32592 = ((__local\n                             int64_t *) local_mem_32515)[squot64(warp_byte_offset_32511,\n                                                                 (int64_t) 8)];\n            prefix_32593 = ((__local\n                             int64_t *) local_mem_32515)[squot64(warp_byte_offset_32512,\n                                                                 (int64_t) 8)];\n            prefix_32594 = ((__local\n                             int64_t *) local_mem_32515)[squot64(warp_byte_offset_32513,\n                                      ",
            "                           (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32646;\n        int64_t x_32650;\n        int64_t x_32658;\n        \n        x_32658 = prefix_32591;\n        \n        int64_t x_32662;\n        \n        x_32662 = acc_32572;\n        \n        int64_t x_32647;\n        int64_t x_32651;\n        int64_t x_32659;\n        \n        x_32659 = prefix_32592;\n        \n        int64_t x_32663;\n        \n        x_32663 = acc_32573;\n        \n        int64_t x_32648;\n        int64_t x_32652;\n        int64_t x_32660;\n        \n        x_32660 = prefix_32593;\n        \n        int64_t x_32664;\n        \n        x_32664 = acc_32574;\n        \n        int64_t x_32649;\n        int64_t x_32653;\n        int64_t x_32661;\n        \n        x_32661 = prefix_32594;\n        \n        int64_t x_32665;\n        \n        x_32665 = acc_32575;\n        \n        int64_t defunc_1_op_res_32666;\n        \n        defunc_1_op_res_32666 = add64(x_32658, x_32662);\n        \n        int64_t defunc_1_op_res_32667 = add64(x_32659, x_32663);\n        int64_t defunc_1_op_res_32668 = add64(x_32660, x_32664);\n        int64_t defunc_1_op_res_32669 = add64(x_32661, x_32665);\n        \n        x_32646 = defunc_1_op_res_32666;\n        x_32647 = defunc_1_op_res_32667;\n        x_32648 = defunc_1_op_res_32668;\n        x_32649 = defunc_1_op_res_32669;\n        for (int64_t i_32670 = 0; i_32670 < (int64_t) 9; i_32670++) {\n            x_32650 = private_mem_32534[i_32670];\n            x_32651 = private_mem_32536[i_32670];\n            x_32652 = private_mem_32538[i_32670];\n            x_32653 = private_mem_32540[i_32670];\n            \n            int64_t defunc_1_op_res_32654;\n            \n            defunc_1_op_res_32654 = add64(x_32646, x_32650);\n            \n            int64_t defunc_1_op_res_32655 = add64(x_32647, x_32651);\n            int64_t defunc_1_op_res_32656 = add64(x_32648, x_32652);\n            int64_t defunc_1_op_res_32657 = add",
            "64(x_32649, x_32653);\n            \n            private_mem_32534[i_32670] = defunc_1_op_res_32654;\n            private_mem_32536[i_32670] = defunc_1_op_res_32655;\n            private_mem_32538[i_32670] = defunc_1_op_res_32656;\n            private_mem_32540[i_32670] = defunc_1_op_res_32657;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32671 = 0; i_32671 < (int64_t) 9; i_32671++) {\n            int64_t sharedIdx_32672 = sext_i32_i64(local_tid_32501 * 9) +\n                    i_32671;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32672] =\n                private_mem_32534[i_32671];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32673 = 0; i_32673 < (int64_t) 9; i_32673++) {\n            int32_t sharedIdx_32674 = local_tid_32501 +\n                    sext_i64_i32(segscan_group_sizze_31232 * i_32673);\n            \n            private_mem_32534[i_32673] = ((__local\n                                           int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32674)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32675 = 0; i_32675 < (int64_t) 9; i_32675++) {\n            int64_t sharedIdx_32676 = sext_i32_i64(local_tid_32501 * 9) +\n                    i_32675;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32676] =\n                private_mem_32536[i_32675];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32677 = 0; i_32677 < (int64_t) 9; i_32677++) {\n            int32_t sharedIdx_32678 = local_tid_32501 +\n                    sext_i64_i32(segscan_group_sizze_31232 * i_32677);\n            \n            private_mem_32536[i_32677] = ((__local\n                                           int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32678)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32679 = 0; i_32679 < (int64_t) 9; i_32679++) {\n            int64_t sharedIdx_32",
            "680 = sext_i32_i64(local_tid_32501 * 9) +\n                    i_32679;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32680] =\n                private_mem_32538[i_32679];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32681 = 0; i_32681 < (int64_t) 9; i_32681++) {\n            int32_t sharedIdx_32682 = local_tid_32501 +\n                    sext_i64_i32(segscan_group_sizze_31232 * i_32681);\n            \n            private_mem_32538[i_32681] = ((__local\n                                           int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32682)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32683 = 0; i_32683 < (int64_t) 9; i_32683++) {\n            int64_t sharedIdx_32684 = sext_i32_i64(local_tid_32501 * 9) +\n                    i_32683;\n            \n            ((__local int64_t *) local_mem_32515)[sharedIdx_32684] =\n                private_mem_32540[i_32683];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32685 = 0; i_32685 < (int64_t) 9; i_32685++) {\n            int32_t sharedIdx_32686 = local_tid_32501 +\n                    sext_i64_i32(segscan_group_sizze_31232 * i_32685);\n            \n            private_mem_32540[i_32685] = ((__local\n                                           int64_t *) local_mem_32515)[sext_i32_i64(sharedIdx_32686)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32687 = 0; i_32687 < (int64_t) 9; i_32687++) {\n            int64_t gtid_31236 = blockOff_32533 + segscan_group_sizze_31232 *\n                    i_32687 + sext_i32_i64(local_tid_32501);\n            \n            if (slt64(gtid_31236, implz2081U_29737)) {\n                ((__global int64_t *) mem_31973)[gtid_31236] =\n                    private_mem_32534[i_32687];\n            }\n        }\n        for (int64_t i_32688 = 0; i_32688 < (int64_t) 9; i_32688++) {\n            int64_t gtid_31236 = blockOff",
            "_32533 + segscan_group_sizze_31232 *\n                    i_32688 + sext_i32_i64(local_tid_32501);\n            \n            if (slt64(gtid_31236, implz2081U_29737)) {\n                ((__global int64_t *) mem_31975)[gtid_31236] =\n                    private_mem_32536[i_32688];\n            }\n        }\n        for (int64_t i_32689 = 0; i_32689 < (int64_t) 9; i_32689++) {\n            int64_t gtid_31236 = blockOff_32533 + segscan_group_sizze_31232 *\n                    i_32689 + sext_i32_i64(local_tid_32501);\n            \n            if (slt64(gtid_31236, implz2081U_29737)) {\n                ((__global int64_t *) mem_31977)[gtid_31236] =\n                    private_mem_32538[i_32689];\n            }\n        }\n        for (int64_t i_32690 = 0; i_32690 < (int64_t) 9; i_32690++) {\n            int64_t gtid_31236 = blockOff_32533 + segscan_group_sizze_31232 *\n                    i_32690 + sext_i32_i64(local_tid_32501);\n            \n            if (slt64(gtid_31236, implz2081U_29737)) {\n                ((__global int64_t *) mem_31979)[gtid_31236] =\n                    private_mem_32540[i_32690];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32532 == sdiv_up64(implz2081U_29737,\n                                          segscan_group_sizze_31232 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_32471)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31232\n}\n__kernel void test_ballQueryzisegscan_31299(__global int *global_failure,\n                                            uint local_mem_32732_backing_offset_0,\n                                            int64_t implz2081U_29737, __global\n                                            unsigned char *mem_32010, __global\n                                            unsigned char *mem_32013, __global\n                          ",
            "                  unsigned char *mem_32015, __global\n                                            unsigned char *test_ballQueryziid_counter_mem_32709,\n                                            __global\n                                            unsigned char *status_flags_mem_32711,\n                                            __global\n                                            unsigned char *aggregates_mem_32713,\n                                            __global\n                                            unsigned char *incprefixes_mem_32715,\n                                            __global\n                                            unsigned char *aggregates_mem_32717,\n                                            __global\n                                            unsigned char *incprefixes_mem_32719)\n{\n    #define segscan_group_sizze_31294 (test_ballQueryzisegscan_group_sizze_31293)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32732_backing_0 =\n                  &shared_mem[local_mem_32732_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32721;\n    int32_t local_tid_32722;\n    int64_t group_sizze_32725;\n    int32_t wave_sizze_32724;\n    int32_t group_tid_32723;\n    \n    global_tid_32721 = get_global_id(0);\n    local_tid_32722 = get_local_id(0);\n    group_sizze_32725 = get_local_size(0);\n    wave_sizze_32724 = LOCKSTEP_WIDTH;\n    group_tid_32723 = get_group_id(0);\n    \n    int32_t phys_tid_31299;\n    \n    phys_tid_31299 = global_tid_32721;\n    \n    int64_t byte_offsets_32726;\n    \n    byte_offsets_32726 = (int64_t) 0;\n    \n    int64_t byte_offsets_32727;\n    \n    byte_offsets_32727 = segscan_group_sizze_31294;\n    \n    int64_t byte_offsets_32728;\n    \n    byte_offsets_32728 = sdiv_up64(segscan_group_sizze_31294, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31294 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32729;\n",
            "    \n    warp_byte_offset_32729 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32730;\n    \n    warp_byte_offset_32730 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_32731;\n    \n    warp_byte_offset_32731 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32732;\n    \n    local_mem_32732 = (__local char *) local_mem_32732_backing_0;\n    \n    int64_t trans_arr_len_32733;\n    \n    trans_arr_len_32733 = (int64_t) 9 * segscan_group_sizze_31294;\n    \n    int32_t dynamic_id_32743;\n    \n    if (local_tid_32722 == 0) {\n        dynamic_id_32743 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_32709)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32732)[(int64_t) 0] = dynamic_id_32743;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32743 = ((__local int32_t *) local_mem_32732)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32744;\n    \n    blockOff_32744 = sext_i32_i64(dynamic_id_32743) * (int64_t) 9 *\n        segscan_group_sizze_31294;\n    \n    bool private_mem_32745[9];\n    int64_t private_mem_32747[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32749 = 0; i_32749 < (int64_t) 9; i_32749++) {\n            int64_t gtid_31298 = blockOff_32744 +\n                    sext_i32_i64(local_tid_32722) + i_32749 *\n                    segscan_group_sizze_31294;\n            \n            if (slt64(gtid_31298, implz2081U_29737)) {\n                bool x_29885 = ((__global bool *) mem_32010)[gtid_31298];\n                \n                private_mem_32745[i_32749] = x_29885;\n                private_mem_32747[i_32749] = (int64_t) 1;\n            } else {\n                private_mem_32745[i_32749] = 0;\n                private_mem_32747[i_32749] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FE",
            "NCE);\n        for (int64_t i_32750 = 0; i_32750 < (int64_t) 9; i_32750++) {\n            int64_t sharedIdx_32751 = sext_i32_i64(local_tid_32722) + i_32750 *\n                    segscan_group_sizze_31294;\n            \n            ((__local bool *) local_mem_32732)[sharedIdx_32751] =\n                private_mem_32745[i_32750];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32752 = 0; i_32752 < 9; i_32752++) {\n            int32_t sharedIdx_32753 = local_tid_32722 * 9 + i_32752;\n            \n            private_mem_32745[sext_i32_i64(i_32752)] = ((__local\n                                                         bool *) local_mem_32732)[sext_i32_i64(sharedIdx_32753)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32754 = 0; i_32754 < (int64_t) 9; i_32754++) {\n            int64_t sharedIdx_32755 = sext_i32_i64(local_tid_32722) + i_32754 *\n                    segscan_group_sizze_31294;\n            \n            ((__local int64_t *) local_mem_32732)[sharedIdx_32755] =\n                private_mem_32747[i_32754];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32756 = 0; i_32756 < 9; i_32756++) {\n            int32_t sharedIdx_32757 = local_tid_32722 * 9 + i_32756;\n            \n            private_mem_32747[sext_i32_i64(i_32756)] = ((__local\n                                                         int64_t *) local_mem_32732)[sext_i32_i64(sharedIdx_32757)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32758 = 0; i_32758 < (int64_t) 8; i_32758++) {\n            bool x_29878;\n            bool x_29880;\n            \n            x_29878 = private_mem_32745[i_32758];\n            x_29880 = private_mem_32745[i_32758 + (int64_t) 1];\n            \n            int64_t x_29879;\n            int64_t x_29881;\n            \n            x_29879 = private_mem_32747[i_32758];\n            x_29881 = private_mem_32747[i_32758 + (int64_t) 1];\n            \n            bool de",
            "func_1_op_res_29882;\n            \n            defunc_1_op_res_29882 = x_29878 || x_29880;\n            \n            int64_t defunc_1_op_res_29883;\n            \n            if (x_29880) {\n                defunc_1_op_res_29883 = x_29881;\n            } else {\n                int64_t defunc_1_op_res_29884 = add64(x_29879, x_29881);\n                \n                defunc_1_op_res_29883 = defunc_1_op_res_29884;\n            }\n            private_mem_32745[i_32758 + (int64_t) 1] = defunc_1_op_res_29882;\n            private_mem_32747[i_32758 + (int64_t) 1] = defunc_1_op_res_29883;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_32732)[byte_offsets_32726 +\n                                           sext_i32_i64(local_tid_32722)] =\n            private_mem_32745[(int64_t) 8];\n        ((__local int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32722)] =\n            private_mem_32747[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_32766;\n    int64_t acc_32767;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_32759;\n        int64_t x_32760;\n        bool x_32761;\n        int64_t x_32762;\n        bool x_32768;\n        int64_t x_32769;\n        bool x_32770;\n        int64_t x_32771;\n        bool ltid_in_bounds_32775;\n        \n        ltid_in_bounds_32775 = slt64(sext_i32_i64(local_tid_32722),\n                                     segscan_group_sizze_31294);\n        \n        int32_t skip_threads_32776;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32775) {\n                x_32761 = ((volatile __local\n                            bool *) local_mem_32732)[byte_offsets_32726 +\n                                                     sext_i32_i64(local_tid_32722)];\n                x_32762 = ((volatile __local\n           ",
            "                 int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32722)];\n                if ((local_tid_32722 - squot32(local_tid_32722, 32) * 32) ==\n                    0) {\n                    x_32759 = x_32761;\n                    x_32760 = x_32762;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32776 = 1;\n            while (slt32(skip_threads_32776, 32)) {\n                if (sle32(skip_threads_32776, local_tid_32722 -\n                          squot32(local_tid_32722, 32) * 32) &&\n                    ltid_in_bounds_32775) {\n                    // read operands\n                    {\n                        x_32759 = ((volatile __local\n                                    bool *) local_mem_32732)[byte_offsets_32726 +\n                                                             (sext_i32_i64(local_tid_32722) -\n                                                              sext_i32_i64(skip_threads_32776))];\n                        x_32760 = ((volatile __local\n                                    int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32722) -\n                                                                 sext_i32_i64(skip_threads_32776))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_32763 = x_32759 || x_32761;\n                        int64_t defunc_1_op_res_32764;\n                        \n                        if (x_32761) {\n                            defunc_1_op_res_32764 = x_32762;\n                        } else {\n                         ",
            "   int64_t defunc_1_op_res_32765 = add64(x_32760,\n                                                                  x_32762);\n                            \n                            defunc_1_op_res_32764 = defunc_1_op_res_32765;\n                        }\n                        x_32759 = defunc_1_op_res_32763;\n                        x_32760 = defunc_1_op_res_32764;\n                    }\n                }\n                if (sle32(wave_sizze_32724, skip_threads_32776)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32776, local_tid_32722 -\n                          squot32(local_tid_32722, 32) * 32) &&\n                    ltid_in_bounds_32775) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_32732)[byte_offsets_32726 +\n                                                   sext_i32_i64(local_tid_32722)] =\n                            x_32759;\n                        x_32761 = x_32759;\n                        ((volatile __local\n                          int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32722)] =\n                            x_32760;\n                        x_32762 = x_32760;\n                    }\n                }\n                if (sle32(wave_sizze_32724, skip_threads_32776)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32776 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32722 - squot32(local_tid_32722, 32) * 32) == 31 &&\n                ltid_in_bounds_32775) {\n                ((volatile __local bool *) local_mem_32732)[byte_offsets_32726 +\n                     ",
            "                                       sext_i32_i64(squot32(local_tid_32722,\n                                                                                 32))] =\n                    x_32759;\n                ((volatile __local\n                  int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32722,\n                                                                   32))] =\n                    x_32760;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32777;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32722, 32) == 0 && ltid_in_bounds_32775) {\n                    x_32770 = ((volatile __local\n                                bool *) local_mem_32732)[byte_offsets_32726 +\n                                                         sext_i32_i64(local_tid_32722)];\n                    x_32771 = ((volatile __local\n                                int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32722)];\n                    if ((local_tid_32722 - squot32(local_tid_32722, 32) * 32) ==\n                        0) {\n                        x_32768 = x_32770;\n                        x_32769 = x_32771;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32777 = 1;\n                while (slt32(skip_threads_32777, 32)) {\n                    if (sle32(skip_threads_32777, local_tid_32722 -\n                              squot32(local_tid_32722, 32) * 32) &&\n ",
            "                       (squot32(local_tid_32722, 32) == 0 &&\n                         ltid_in_bounds_32775)) {\n                        // read operands\n                        {\n                            x_32768 = ((volatile __local\n                                        bool *) local_mem_32732)[byte_offsets_32726 +\n                                                                 (sext_i32_i64(local_tid_32722) -\n                                                                  sext_i32_i64(skip_threads_32777))];\n                            x_32769 = ((volatile __local\n                                        int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32722) -\n                                                                     sext_i32_i64(skip_threads_32777))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_32772 = x_32768 || x_32770;\n                            int64_t defunc_1_op_res_32773;\n                            \n                            if (x_32770) {\n                                defunc_1_op_res_32773 = x_32771;\n                            } else {\n                                int64_t defunc_1_op_res_32774 = add64(x_32769,\n                                                                      x_32771);\n                                \n                                defunc_1_op_res_32773 = defunc_1_op_res_32774;\n                            }\n                            x_32768 = defunc_1_op_res_32772;\n                            x_32769 = defunc_1_op_res_32773;\n                        }\n                    }\n                    if (sle32(wave_sizze_32724, skip_threads_32777)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n    ",
            "                if (sle32(skip_threads_32777, local_tid_32722 -\n                              squot32(local_tid_32722, 32) * 32) &&\n                        (squot32(local_tid_32722, 32) == 0 &&\n                         ltid_in_bounds_32775)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_32732)[byte_offsets_32726 +\n                                                       sext_i32_i64(local_tid_32722)] =\n                                x_32768;\n                            x_32770 = x_32768;\n                            ((volatile __local\n                              int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32722)] =\n                                x_32769;\n                            x_32771 = x_32769;\n                        }\n                    }\n                    if (sle32(wave_sizze_32724, skip_threads_32777)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32777 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32722, 32) == 0 || !ltid_in_bounds_32775)) {\n                // read operands\n                {\n                    x_32761 = x_32759;\n                    x_32762 = x_32760;\n                    x_32759 = ((__local\n                                bool *) local_mem_32732)[byte_offsets_32726 +\n                                                         (sext_i32_i64(squot32(local_tid_32722,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_32760 = ((",
            "__local\n                                int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32722,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_32763 = x_32759 || x_32761;\n                    int64_t defunc_1_op_res_32764;\n                    \n                    if (x_32761) {\n                        defunc_1_op_res_32764 = x_32762;\n                    } else {\n                        int64_t defunc_1_op_res_32765 = add64(x_32760, x_32762);\n                        \n                        defunc_1_op_res_32764 = defunc_1_op_res_32765;\n                    }\n                    x_32759 = defunc_1_op_res_32763;\n                    x_32760 = defunc_1_op_res_32764;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_32732)[byte_offsets_32726 +\n                                                       sext_i32_i64(local_tid_32722)] =\n                        x_32759;\n                    ((__local\n                      int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32722)] =\n                        x_32760;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32722, 32) == 0) {\n                ((__local bool *) local_mem_32732)[byte_offsets_32726 +\n                                                   sext_i32_i64(local_tid_32722)] =\n",
            "                    x_32761;\n                ((__local\n                  int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32722)] =\n                    x_32762;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32722 == 0) {\n            acc_32766 = ((__local bool *) local_mem_32732)[byte_offsets_32726 +\n                                                           (segscan_group_sizze_31294 -\n                                                            (int64_t) 1)];\n            acc_32767 = ((__local\n                          int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31294 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32766 = ((__local bool *) local_mem_32732)[byte_offsets_32726 +\n                                                           (sext_i32_i64(local_tid_32722) -\n                                                            (int64_t) 1)];\n            acc_32767 = ((__local\n                          int64_t *) local_mem_32732)[squot64(byte_offsets_32727,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32722) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_32778;\n    \n    prefix_32778 = 0;\n    \n    int64_t prefix_32779;\n    \n    prefix_32779 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32743 == (int64_t) 0 && local_tid_32722 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_32715)[",
            "dynamic_id_32743] = acc_32766;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32719)[dynamic_id_32743] = acc_32767;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32711)[dynamic_id_32743] = (int8_t) 2;\n            acc_32766 = 0;\n            acc_32767 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32743 == (int64_t) 0) && slt32(local_tid_32722,\n                                                        wave_sizze_32724)) {\n            if (local_tid_32722 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_32713)[dynamic_id_32743] = acc_32766;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32717)[dynamic_id_32743] =\n                    acc_32767;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32711)[dynamic_id_32743] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32732)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32711)[dynamic_id_32743 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32780;\n            \n            status_32780 = ((__local int8_t *) local_mem_32732)[(int64_t) 0];\n            if (status_32780 == (int8_t) 2) {\n                if (local_tid_32722 == 0) {\n                    prefix_32778 = ((volatile __global\n                                     bool *) incprefixes_mem_32715)[dynamic_id_32743 -\n                                                                    (int64_t) 1];\n                    prefix_32779 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32719)[dynamic_id_32743 -\n                                                            ",
            "           (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32781 = dynamic_id_32743 -\n                        sext_i32_i64(wave_sizze_32724);\n                \n                while (slt32(wave_sizze_32724 * -1, readOffset_32781)) {\n                    int32_t read_i_32782 = readOffset_32781 + local_tid_32722;\n                    bool aggr_32783 = 0;\n                    int64_t aggr_32784 = (int64_t) 0;\n                    int8_t flag_32785 = (int8_t) 0;\n                    int8_t used_32786 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32782)) {\n                        flag_32785 = ((volatile __global\n                                       int8_t *) status_flags_mem_32711)[sext_i32_i64(read_i_32782)];\n                        if (flag_32785 == (int8_t) 2) {\n                            aggr_32783 = ((volatile __global\n                                           bool *) incprefixes_mem_32715)[sext_i32_i64(read_i_32782)];\n                            aggr_32784 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32719)[sext_i32_i64(read_i_32782)];\n                        } else {\n                            if (flag_32785 == (int8_t) 1) {\n                                aggr_32783 = ((volatile __global\n                                               bool *) aggregates_mem_32713)[sext_i32_i64(read_i_32782)];\n                                aggr_32784 = ((volatile __global\n                                               int64_t *) aggregates_mem_32717)[sext_i32_i64(read_i_32782)];\n                                used_32786 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_32732)[warp_byte_offset_32729 +\n                                                       sext_i32_i64(local_tid_32722)] =\n                        aggr_32783;\n                    ((__local\n                      int6",
            "4_t *) local_mem_32732)[squot64(warp_byte_offset_32730,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32722)] =\n                        aggr_32784;\n                    \n                    int8_t tmp_32787;\n                    \n                    tmp_32787 = flag_32785 | used_32786 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32732)[sext_i32_i64(local_tid_32722)] =\n                        tmp_32787;\n                    mem_fence_local();\n                    flag_32785 = ((volatile __local\n                                   int8_t *) local_mem_32732)[sext_i32_i64(wave_sizze_32724) -\n                                                              (int64_t) 1];\n                    if (local_tid_32722 == 0) {\n                        if (!(flag_32785 == (int8_t) 2)) {\n                            bool x_32788 = 0;\n                            int64_t x_32789 = (int64_t) 0;\n                            bool x_32790;\n                            int64_t x_32791;\n                            int8_t flag1_32795;\n                            \n                            flag1_32795 = (int8_t) 0;\n                            \n                            int8_t flag2_32796;\n                            int8_t used1_32797;\n                            \n                            used1_32797 = (int8_t) 0;\n                            \n                            int8_t used2_32798;\n                            \n                            for (int32_t i_32799 = 0; i_32799 <\n                                 wave_sizze_32724; i_32799++) {\n                                flag2_32796 = ((__local\n                                                int8_t *) local_mem_32732)[sext_i32_i64(i_32799)];\n                                used2_32798 = lshr8(flag2_32796, (int8_t) 2);\n                                flag2_32796 = flag2_32796 & (int8_t) 3;\n               ",
            "                 x_32790 = ((__local\n                                            bool *) local_mem_32732)[warp_byte_offset_32729 +\n                                                                     sext_i32_i64(i_32799)];\n                                x_32791 = ((__local\n                                            int64_t *) local_mem_32732)[squot64(warp_byte_offset_32730,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32799)];\n                                if (!(flag2_32796 == (int8_t) 1)) {\n                                    flag1_32795 = flag2_32796;\n                                    used1_32797 = used2_32798;\n                                    x_32788 = x_32790;\n                                    x_32789 = x_32791;\n                                } else {\n                                    used1_32797 += used2_32798;\n                                    \n                                    bool defunc_1_op_res_32792;\n                                    \n                                    defunc_1_op_res_32792 = x_32788 || x_32790;\n                                    \n                                    int64_t defunc_1_op_res_32793;\n                                    \n                                    if (x_32790) {\n                                        defunc_1_op_res_32793 = x_32791;\n                                    } else {\n                                        int64_t defunc_1_op_res_32794 =\n                                                add64(x_32789, x_32791);\n                                        \n                                        defunc_1_op_res_32793 =\n                                            defunc_1_op_res_32794;\n                                    }\n                                    x_32788 = defunc_1_op_res_32792;\n                                    x_32789 = defunc_1_op_res_32793;",
            "\n                                }\n                            }\n                            flag_32785 = flag1_32795;\n                            used_32786 = used1_32797;\n                            aggr_32783 = x_32788;\n                            aggr_32784 = x_32789;\n                        } else {\n                            aggr_32783 = ((__local\n                                           bool *) local_mem_32732)[warp_byte_offset_32729 +\n                                                                    (sext_i32_i64(wave_sizze_32724) -\n                                                                     (int64_t) 1)];\n                            aggr_32784 = ((__local\n                                           int64_t *) local_mem_32732)[squot64(warp_byte_offset_32730,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32724) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32785 == (int8_t) 2) {\n                            readOffset_32781 = wave_sizze_32724 * -1;\n                        } else {\n                            readOffset_32781 -= zext_i8_i32(used_32786);\n                        }\n                        ((__local int32_t *) local_mem_32732)[(int64_t) 0] =\n                            readOffset_32781;\n                        \n                        bool x_32800;\n                        \n                        x_32800 = aggr_32783;\n                        \n                        int64_t x_32801;\n                        \n                        x_32801 = aggr_32784;\n                        \n                        bool x_32802;\n                        \n                        x_32802 = prefix_32778;\n                        \n                        int64_t x_32803;\n                        \n                   ",
            "     x_32803 = prefix_32779;\n                        \n                        bool defunc_1_op_res_32804;\n                        \n                        defunc_1_op_res_32804 = x_32800 || x_32802;\n                        \n                        int64_t defunc_1_op_res_32805;\n                        \n                        if (x_32802) {\n                            defunc_1_op_res_32805 = x_32803;\n                        } else {\n                            int64_t defunc_1_op_res_32806 = add64(x_32801,\n                                                                  x_32803);\n                            \n                            defunc_1_op_res_32805 = defunc_1_op_res_32806;\n                        }\n                        prefix_32778 = defunc_1_op_res_32804;\n                        prefix_32779 = defunc_1_op_res_32805;\n                    }\n                    mem_fence_local();\n                    readOffset_32781 = ((__local\n                                         int32_t *) local_mem_32732)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32722 == 0) {\n                bool x_32807 = prefix_32778;\n                int64_t x_32808 = prefix_32779;\n                bool x_32809 = acc_32766;\n                int64_t x_32810 = acc_32767;\n                bool defunc_1_op_res_32811 = x_32807 || x_32809;\n                int64_t defunc_1_op_res_32812;\n                \n                if (x_32809) {\n                    defunc_1_op_res_32812 = x_32810;\n                } else {\n                    int64_t defunc_1_op_res_32813 = add64(x_32808, x_32810);\n                    \n                    defunc_1_op_res_32812 = defunc_1_op_res_32813;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_32715)[dynamic_id_32743] =\n                    defunc_1_op_res_32811;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32719)[dynamic_id_32743] =\n                    defunc_1_op_res_",
            "32812;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32711)[dynamic_id_32743] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_32732)[warp_byte_offset_32729] =\n                    prefix_32778;\n                ((__local\n                  int64_t *) local_mem_32732)[squot64(warp_byte_offset_32730,\n                                                      (int64_t) 8)] =\n                    prefix_32779;\n                acc_32766 = 0;\n                acc_32767 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32743 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32778 = ((__local\n                             bool *) local_mem_32732)[warp_byte_offset_32729];\n            prefix_32779 = ((__local\n                             int64_t *) local_mem_32732)[squot64(warp_byte_offset_32730,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_32814;\n        bool x_32816;\n        bool x_32821;\n        \n        x_32821 = prefix_32778;\n        \n        bool x_32823;\n        \n        x_32823 = acc_32766;\n        \n        int64_t x_32815;\n        int64_t x_32817;\n        int64_t x_32822;\n        \n        x_32822 = prefix_32779;\n        \n        int64_t x_32824;\n        \n        x_32824 = acc_32767;\n        \n        bool defunc_1_op_res_32825;\n        \n        defunc_1_op_res_32825 = x_32821 || x_32823;\n        \n        int64_t defunc_1_op_res_32826;\n        \n        if (x_32823) {\n            defunc_1_op_res_32826 = x_32824;\n        } else {\n            int64_t defunc_1_op_res_32827 = add64(x_32822, x_32824);\n            \n            defunc_1_op_res_32826 = defunc_1_op_res_32827;\n        }\n        x_32814 = defunc_1_op_res_32825;\n        x_32815 = defunc_1_op_res_32826;\n        for (int64_t i_32828 = 0; i_32828 < ",
            "(int64_t) 9; i_32828++) {\n            x_32816 = private_mem_32745[i_32828];\n            x_32817 = private_mem_32747[i_32828];\n            \n            bool defunc_1_op_res_32818;\n            \n            defunc_1_op_res_32818 = x_32814 || x_32816;\n            \n            int64_t defunc_1_op_res_32819;\n            \n            if (x_32816) {\n                defunc_1_op_res_32819 = x_32817;\n            } else {\n                int64_t defunc_1_op_res_32820 = add64(x_32815, x_32817);\n                \n                defunc_1_op_res_32819 = defunc_1_op_res_32820;\n            }\n            private_mem_32745[i_32828] = defunc_1_op_res_32818;\n            private_mem_32747[i_32828] = defunc_1_op_res_32819;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32829 = 0; i_32829 < (int64_t) 9; i_32829++) {\n            int64_t sharedIdx_32830 = sext_i32_i64(local_tid_32722 * 9) +\n                    i_32829;\n            \n            ((__local bool *) local_mem_32732)[sharedIdx_32830] =\n                private_mem_32745[i_32829];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32831 = 0; i_32831 < (int64_t) 9; i_32831++) {\n            int32_t sharedIdx_32832 = local_tid_32722 +\n                    sext_i64_i32(segscan_group_sizze_31294 * i_32831);\n            \n            private_mem_32745[i_32831] = ((__local\n                                           bool *) local_mem_32732)[sext_i32_i64(sharedIdx_32832)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32833 = 0; i_32833 < (int64_t) 9; i_32833++) {\n            int64_t sharedIdx_32834 = sext_i32_i64(local_tid_32722 * 9) +\n                    i_32833;\n            \n            ((__local int64_t *) local_mem_32732)[sharedIdx_32834] =\n                private_mem_32747[i_32833];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32835 = 0; i_32835 < (int64_t) 9; i_32835++) {\n            int32_t sharedIdx_32",
            "836 = local_tid_32722 +\n                    sext_i64_i32(segscan_group_sizze_31294 * i_32835);\n            \n            private_mem_32747[i_32835] = ((__local\n                                           int64_t *) local_mem_32732)[sext_i32_i64(sharedIdx_32836)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32837 = 0; i_32837 < (int64_t) 9; i_32837++) {\n            int64_t gtid_31298 = blockOff_32744 + segscan_group_sizze_31294 *\n                    i_32837 + sext_i32_i64(local_tid_32722);\n            \n            if (slt64(gtid_31298, implz2081U_29737)) {\n                ((__global bool *) mem_32013)[gtid_31298] =\n                    private_mem_32745[i_32837];\n            }\n        }\n        for (int64_t i_32838 = 0; i_32838 < (int64_t) 9; i_32838++) {\n            int64_t gtid_31298 = blockOff_32744 + segscan_group_sizze_31294 *\n                    i_32838 + sext_i32_i64(local_tid_32722);\n            \n            if (slt64(gtid_31298, implz2081U_29737)) {\n                ((__global int64_t *) mem_32015)[gtid_31298] =\n                    private_mem_32747[i_32838];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32743 == sdiv_up64(implz2081U_29737,\n                                          segscan_group_sizze_31294 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_32709)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31294\n}\n__kernel void test_ballQueryzisegscan_31307(__global int *global_failure,\n                                            uint local_mem_32859_backing_offset_0,\n                                            int64_t implz2081U_29737, __global\n                                            unsigned char *mem_32010, __global\n                                      ",
            "      unsigned char *mem_32018, __global\n                                            unsigned char *test_ballQueryziid_counter_mem_32842,\n                                            __global\n                                            unsigned char *status_flags_mem_32844,\n                                            __global\n                                            unsigned char *aggregates_mem_32846,\n                                            __global\n                                            unsigned char *incprefixes_mem_32848)\n{\n    #define segscan_group_sizze_31302 (test_ballQueryzisegscan_group_sizze_31301)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32859_backing_0 =\n                  &shared_mem[local_mem_32859_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32850;\n    int32_t local_tid_32851;\n    int64_t group_sizze_32854;\n    int32_t wave_sizze_32853;\n    int32_t group_tid_32852;\n    \n    global_tid_32850 = get_global_id(0);\n    local_tid_32851 = get_local_id(0);\n    group_sizze_32854 = get_local_size(0);\n    wave_sizze_32853 = LOCKSTEP_WIDTH;\n    group_tid_32852 = get_group_id(0);\n    \n    int32_t phys_tid_31307;\n    \n    phys_tid_31307 = global_tid_32850;\n    \n    int64_t byte_offsets_32855;\n    \n    byte_offsets_32855 = (int64_t) 0;\n    \n    int64_t byte_offsets_32856;\n    \n    byte_offsets_32856 = segscan_group_sizze_31302 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32857;\n    \n    warp_byte_offset_32857 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32858;\n    \n    warp_byte_offset_32858 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32859;\n    \n    local_mem_32859 = (__local char *) local_mem_32859_backing_0;\n    \n    int64_t trans_arr_len_32860;\n    \n    trans_arr_len_32860 = (int64_t) 9 * segscan_group_sizze_31302;\n    \n    int32_t dynamic_id_32867;\n    \n    ",
            "if (local_tid_32851 == 0) {\n        dynamic_id_32867 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_32842)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32859)[(int64_t) 0] = dynamic_id_32867;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32867 = ((__local int32_t *) local_mem_32859)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32868;\n    \n    blockOff_32868 = sext_i32_i64(dynamic_id_32867) * (int64_t) 9 *\n        segscan_group_sizze_31302;\n    \n    int64_t private_mem_32869[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32871 = 0; i_32871 < (int64_t) 9; i_32871++) {\n            int64_t gtid_31306 = blockOff_32868 +\n                    sext_i32_i64(local_tid_32851) + i_32871 *\n                    segscan_group_sizze_31302;\n            \n            if (slt64(gtid_31306, implz2081U_29737)) {\n                int64_t i_p_o_31850 = add64((int64_t) 1, gtid_31306);\n                int64_t rot_i_31851 = smod64(i_p_o_31850, implz2081U_29737);\n                bool x_29892 = ((__global bool *) mem_32010)[rot_i_31851];\n                int64_t defunc_0_f_res_29893 = btoi_bool_i64(x_29892);\n                \n                private_mem_32869[i_32871] = defunc_0_f_res_29893;\n            } else {\n                private_mem_32869[i_32871] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32872 = 0; i_32872 < (int64_t) 9; i_32872++) {\n            int64_t sharedIdx_32873 = sext_i32_i64(local_tid_32851) + i_32872 *\n                    segscan_group_sizze_31302;\n            \n            ((__local int64_t *) local_mem_32859)[sharedIdx_32873] =\n                private_mem_32869[i_32872];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32874 = 0; i_32874 < 9; i_32874++) {\n      ",
            "      int32_t sharedIdx_32875 = local_tid_32851 * 9 + i_32874;\n            \n            private_mem_32869[sext_i32_i64(i_32874)] = ((__local\n                                                         int64_t *) local_mem_32859)[sext_i32_i64(sharedIdx_32875)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32876 = 0; i_32876 < (int64_t) 8; i_32876++) {\n            int64_t x_29889;\n            int64_t x_29890;\n            \n            x_29889 = private_mem_32869[i_32876];\n            x_29890 = private_mem_32869[i_32876 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29891;\n            \n            defunc_1_op_res_29891 = add64(x_29889, x_29890);\n            private_mem_32869[i_32876 + (int64_t) 1] = defunc_1_op_res_29891;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32851)] =\n            private_mem_32869[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32880;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32877;\n        int64_t x_32878;\n        int64_t x_32881;\n        int64_t x_32882;\n        bool ltid_in_bounds_32884;\n        \n        ltid_in_bounds_32884 = slt64(sext_i32_i64(local_tid_32851),\n                                     segscan_group_sizze_31302);\n        \n        int32_t skip_threads_32885;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32884) {\n                x_32878 = ((volatile __local\n                            int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32851)];\n                if ((local_tid_",
            "32851 - squot32(local_tid_32851, 32) * 32) ==\n                    0) {\n                    x_32877 = x_32878;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32885 = 1;\n            while (slt32(skip_threads_32885, 32)) {\n                if (sle32(skip_threads_32885, local_tid_32851 -\n                          squot32(local_tid_32851, 32) * 32) &&\n                    ltid_in_bounds_32884) {\n                    // read operands\n                    {\n                        x_32877 = ((volatile __local\n                                    int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32851) -\n                                                                 sext_i32_i64(skip_threads_32885))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32879 = add64(x_32877, x_32878);\n                        \n                        x_32877 = defunc_1_op_res_32879;\n                    }\n                }\n                if (sle32(wave_sizze_32853, skip_threads_32885)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32885, local_tid_32851 -\n                          squot32(local_tid_32851, 32) * 32) &&\n                    ltid_in_bounds_32884) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32851)] =\n                            x_32877;\n                        x_32878 = x_32877;\n           ",
            "         }\n                }\n                if (sle32(wave_sizze_32853, skip_threads_32885)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32885 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32851 - squot32(local_tid_32851, 32) * 32) == 31 &&\n                ltid_in_bounds_32884) {\n                ((volatile __local\n                  int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32851,\n                                                                   32))] =\n                    x_32877;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32886;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32851, 32) == 0 && ltid_in_bounds_32884) {\n                    x_32882 = ((volatile __local\n                                int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32851)];\n                    if ((local_tid_32851 - squot32(local_tid_32851, 32) * 32) ==\n                        0) {\n                        x_32881 = x_32882;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32886 = 1;\n                while (slt32(skip_threads_32886, 32)) {\n                    if (sle32(skip_threads_32886, local_tid_32851 -\n                              squot32(local_tid_32851, 32) ",
            "* 32) &&\n                        (squot32(local_tid_32851, 32) == 0 &&\n                         ltid_in_bounds_32884)) {\n                        // read operands\n                        {\n                            x_32881 = ((volatile __local\n                                        int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32851) -\n                                                                     sext_i32_i64(skip_threads_32886))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32883 = add64(x_32881,\n                                                                  x_32882);\n                            \n                            x_32881 = defunc_1_op_res_32883;\n                        }\n                    }\n                    if (sle32(wave_sizze_32853, skip_threads_32886)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32886, local_tid_32851 -\n                              squot32(local_tid_32851, 32) * 32) &&\n                        (squot32(local_tid_32851, 32) == 0 &&\n                         ltid_in_bounds_32884)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32851)] =\n                                x_32881;\n                            x_32882 = x_32881;\n                        }\n                    }\n                    if (sle32(wave_sizze_32853, skip_threads_32886)) {\n   ",
            "                     barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32886 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32851, 32) == 0 || !ltid_in_bounds_32884)) {\n                // read operands\n                {\n                    x_32878 = x_32877;\n                    x_32877 = ((__local\n                                int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32851,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32879 = add64(x_32877, x_32878);\n                    \n                    x_32877 = defunc_1_op_res_32879;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32851)] =\n                        x_32877;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32851, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32851)] =\n                    x_32878;\n            }\n        }\n    ",
            "    barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32851 == 0) {\n            acc_32880 = ((__local\n                          int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31302 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32880 = ((__local\n                          int64_t *) local_mem_32859)[squot64(byte_offsets_32855,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32851) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32887;\n    \n    prefix_32887 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32867 == (int64_t) 0 && local_tid_32851 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32848)[dynamic_id_32867] = acc_32880;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32844)[dynamic_id_32867] = (int8_t) 2;\n            acc_32880 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32867 == (int64_t) 0) && slt32(local_tid_32851,\n                                                        wave_sizze_32853)) {\n            if (local_tid_32851 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32846)[dynamic_id_32867] =\n                    acc_32880;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32844)[dynamic_id_32867] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32859)[(int64_t) 0] = ((__global\n                                                                      i",
            "nt8_t *) status_flags_mem_32844)[dynamic_id_32867 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32888;\n            \n            status_32888 = ((__local int8_t *) local_mem_32859)[(int64_t) 0];\n            if (status_32888 == (int8_t) 2) {\n                if (local_tid_32851 == 0) {\n                    prefix_32887 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32848)[dynamic_id_32867 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32889 = dynamic_id_32867 -\n                        sext_i32_i64(wave_sizze_32853);\n                \n                while (slt32(wave_sizze_32853 * -1, readOffset_32889)) {\n                    int32_t read_i_32890 = readOffset_32889 + local_tid_32851;\n                    int64_t aggr_32891 = (int64_t) 0;\n                    int8_t flag_32892 = (int8_t) 0;\n                    int8_t used_32893 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32890)) {\n                        flag_32892 = ((volatile __global\n                                       int8_t *) status_flags_mem_32844)[sext_i32_i64(read_i_32890)];\n                        if (flag_32892 == (int8_t) 2) {\n                            aggr_32891 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32848)[sext_i32_i64(read_i_32890)];\n                        } else {\n                            if (flag_32892 == (int8_t) 1) {\n                                aggr_32891 = ((volatile __global\n                                               int64_t *) aggregates_mem_32846)[sext_i32_i64(read_i_32890)];\n                                used_32893 = (int8_t) 1;\n                            }\n                        }\n           ",
            "         }\n                    ((__local\n                      int64_t *) local_mem_32859)[squot64(warp_byte_offset_32857,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32851)] =\n                        aggr_32891;\n                    \n                    int8_t tmp_32894;\n                    \n                    tmp_32894 = flag_32892 | used_32893 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32859)[sext_i32_i64(local_tid_32851)] =\n                        tmp_32894;\n                    mem_fence_local();\n                    flag_32892 = ((volatile __local\n                                   int8_t *) local_mem_32859)[sext_i32_i64(wave_sizze_32853) -\n                                                              (int64_t) 1];\n                    if (local_tid_32851 == 0) {\n                        if (!(flag_32892 == (int8_t) 2)) {\n                            int64_t x_32895 = (int64_t) 0;\n                            int64_t x_32896;\n                            int8_t flag1_32898;\n                            \n                            flag1_32898 = (int8_t) 0;\n                            \n                            int8_t flag2_32899;\n                            int8_t used1_32900;\n                            \n                            used1_32900 = (int8_t) 0;\n                            \n                            int8_t used2_32901;\n                            \n                            for (int32_t i_32902 = 0; i_32902 <\n                                 wave_sizze_32853; i_32902++) {\n                                flag2_32899 = ((__local\n                                                int8_t *) local_mem_32859)[sext_i32_i64(i_32902)];\n                                used2_32901 = lshr8(flag2_32899, (int8_t) 2);\n                                flag2_32899 = flag2_32899 & (int8_t) 3;\n                                x_32",
            "896 = ((__local\n                                            int64_t *) local_mem_32859)[squot64(warp_byte_offset_32857,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32902)];\n                                if (!(flag2_32899 == (int8_t) 1)) {\n                                    flag1_32898 = flag2_32899;\n                                    used1_32900 = used2_32901;\n                                    x_32895 = x_32896;\n                                } else {\n                                    used1_32900 += used2_32901;\n                                    \n                                    int64_t defunc_1_op_res_32897;\n                                    \n                                    defunc_1_op_res_32897 = add64(x_32895,\n                                                                  x_32896);\n                                    x_32895 = defunc_1_op_res_32897;\n                                }\n                            }\n                            flag_32892 = flag1_32898;\n                            used_32893 = used1_32900;\n                            aggr_32891 = x_32895;\n                        } else {\n                            aggr_32891 = ((__local\n                                           int64_t *) local_mem_32859)[squot64(warp_byte_offset_32857,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32853) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32892 == (int8_t) 2) {\n                            readOffset_32889 = wave_sizze_32853 * -1;\n                        } else {\n                            readOffset_32889 -= zext_i8_i32(used_32893);\n                     ",
            "   }\n                        ((__local int32_t *) local_mem_32859)[(int64_t) 0] =\n                            readOffset_32889;\n                        \n                        int64_t x_32903;\n                        \n                        x_32903 = aggr_32891;\n                        \n                        int64_t x_32904;\n                        \n                        x_32904 = prefix_32887;\n                        \n                        int64_t defunc_1_op_res_32905;\n                        \n                        defunc_1_op_res_32905 = add64(x_32903, x_32904);\n                        prefix_32887 = defunc_1_op_res_32905;\n                    }\n                    mem_fence_local();\n                    readOffset_32889 = ((__local\n                                         int32_t *) local_mem_32859)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32851 == 0) {\n                int64_t x_32906 = prefix_32887;\n                int64_t x_32907 = acc_32880;\n                int64_t defunc_1_op_res_32908 = add64(x_32906, x_32907);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32848)[dynamic_id_32867] =\n                    defunc_1_op_res_32908;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32844)[dynamic_id_32867] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32859)[squot64(warp_byte_offset_32857,\n                                                      (int64_t) 8)] =\n                    prefix_32887;\n                acc_32880 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32867 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32887 = ((__local\n                             int64_t *) local_mem_32859)[squot64(warp_byte_offset_32857,\n                                                                 (int64_t) 8)];\n          ",
            "  barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32909;\n        int64_t x_32910;\n        int64_t x_32912;\n        \n        x_32912 = prefix_32887;\n        \n        int64_t x_32913;\n        \n        x_32913 = acc_32880;\n        \n        int64_t defunc_1_op_res_32914;\n        \n        defunc_1_op_res_32914 = add64(x_32912, x_32913);\n        x_32909 = defunc_1_op_res_32914;\n        for (int64_t i_32915 = 0; i_32915 < (int64_t) 9; i_32915++) {\n            x_32910 = private_mem_32869[i_32915];\n            \n            int64_t defunc_1_op_res_32911;\n            \n            defunc_1_op_res_32911 = add64(x_32909, x_32910);\n            private_mem_32869[i_32915] = defunc_1_op_res_32911;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32916 = 0; i_32916 < (int64_t) 9; i_32916++) {\n            int64_t sharedIdx_32917 = sext_i32_i64(local_tid_32851 * 9) +\n                    i_32916;\n            \n            ((__local int64_t *) local_mem_32859)[sharedIdx_32917] =\n                private_mem_32869[i_32916];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32918 = 0; i_32918 < (int64_t) 9; i_32918++) {\n            int32_t sharedIdx_32919 = local_tid_32851 +\n                    sext_i64_i32(segscan_group_sizze_31302 * i_32918);\n            \n            private_mem_32869[i_32918] = ((__local\n                                           int64_t *) local_mem_32859)[sext_i32_i64(sharedIdx_32919)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32920 = 0; i_32920 < (int64_t) 9; i_32920++) {\n            int64_t gtid_31306 = blockOff_32868 + segscan_group_sizze_31302 *\n                    i_32920 + sext_i32_i64(local_tid_32851);\n            \n            if (slt64(gtid_31306, implz2081U_29737)) {\n                ((__global int64_t *) mem_32018)[gtid_31306] =\n              ",
            "      private_mem_32869[i_32920];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32867 == sdiv_up64(implz2081U_29737,\n                                          segscan_group_sizze_31302 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_32842)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31302\n}\n__kernel void test_ballQueryzisegscan_31321(__global int *global_failure,\n                                            uint local_mem_32955_backing_offset_0,\n                                            int64_t num_segments_29894, __global\n                                            unsigned char *mem_32020, __global\n                                            unsigned char *mem_32024, __global\n                                            unsigned char *test_ballQueryziid_counter_mem_32938,\n                                            __global\n                                            unsigned char *status_flags_mem_32940,\n                                            __global\n                                            unsigned char *aggregates_mem_32942,\n                                            __global\n                                            unsigned char *incprefixes_mem_32944)\n{\n    #define segscan_group_sizze_31316 (test_ballQueryzisegscan_group_sizze_31315)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32955_backing_0 =\n                  &shared_mem[local_mem_32955_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32946;\n    int32_t local_tid_32947;\n    int64_t group_sizze_32950;\n    int32_t wave_sizze_32949;\n    int32_t group_tid_32948;\n    \n    global_tid_32946 = get_global_id(0);\n    local_tid_32947 = get_local_id(0);\n    grou",
            "p_sizze_32950 = get_local_size(0);\n    wave_sizze_32949 = LOCKSTEP_WIDTH;\n    group_tid_32948 = get_group_id(0);\n    \n    int32_t phys_tid_31321;\n    \n    phys_tid_31321 = global_tid_32946;\n    \n    int64_t byte_offsets_32951;\n    \n    byte_offsets_32951 = (int64_t) 0;\n    \n    int64_t byte_offsets_32952;\n    \n    byte_offsets_32952 = segscan_group_sizze_31316 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32953;\n    \n    warp_byte_offset_32953 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32954;\n    \n    warp_byte_offset_32954 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32955;\n    \n    local_mem_32955 = (__local char *) local_mem_32955_backing_0;\n    \n    int64_t trans_arr_len_32956;\n    \n    trans_arr_len_32956 = (int64_t) 9 * segscan_group_sizze_31316;\n    \n    int32_t dynamic_id_32963;\n    \n    if (local_tid_32947 == 0) {\n        dynamic_id_32963 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_32938)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32955)[(int64_t) 0] = dynamic_id_32963;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32963 = ((__local int32_t *) local_mem_32955)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32964;\n    \n    blockOff_32964 = sext_i32_i64(dynamic_id_32963) * (int64_t) 9 *\n        segscan_group_sizze_31316;\n    \n    int64_t private_mem_32965[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32967 = 0; i_32967 < (int64_t) 9; i_32967++) {\n            int64_t gtid_31320 = blockOff_32964 +\n                    sext_i32_i64(local_tid_32947) + i_32967 *\n                    segscan_group_sizze_31316;\n            \n            if (slt64(gtid_31320, num_segments_29894)) {\n                int64_t x_29911 = ((__global int64_t *) mem_32020)[gtid_31320];\n                \n                private_mem_3",
            "2965[i_32967] = x_29911;\n            } else {\n                private_mem_32965[i_32967] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32968 = 0; i_32968 < (int64_t) 9; i_32968++) {\n            int64_t sharedIdx_32969 = sext_i32_i64(local_tid_32947) + i_32968 *\n                    segscan_group_sizze_31316;\n            \n            ((__local int64_t *) local_mem_32955)[sharedIdx_32969] =\n                private_mem_32965[i_32968];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32970 = 0; i_32970 < 9; i_32970++) {\n            int32_t sharedIdx_32971 = local_tid_32947 * 9 + i_32970;\n            \n            private_mem_32965[sext_i32_i64(i_32970)] = ((__local\n                                                         int64_t *) local_mem_32955)[sext_i32_i64(sharedIdx_32971)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32972 = 0; i_32972 < (int64_t) 8; i_32972++) {\n            int64_t x_29908;\n            int64_t x_29909;\n            \n            x_29908 = private_mem_32965[i_32972];\n            x_29909 = private_mem_32965[i_32972 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29910;\n            \n            defunc_1_op_res_29910 = add64(x_29908, x_29909);\n            private_mem_32965[i_32972 + (int64_t) 1] = defunc_1_op_res_29910;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32947)] =\n            private_mem_32965[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32976;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32973;\n        int64_t x_32974;\n        int64_t x_32977;\n        int64_t x_32978;\n    ",
            "    bool ltid_in_bounds_32980;\n        \n        ltid_in_bounds_32980 = slt64(sext_i32_i64(local_tid_32947),\n                                     segscan_group_sizze_31316);\n        \n        int32_t skip_threads_32981;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32980) {\n                x_32974 = ((volatile __local\n                            int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32947)];\n                if ((local_tid_32947 - squot32(local_tid_32947, 32) * 32) ==\n                    0) {\n                    x_32973 = x_32974;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32981 = 1;\n            while (slt32(skip_threads_32981, 32)) {\n                if (sle32(skip_threads_32981, local_tid_32947 -\n                          squot32(local_tid_32947, 32) * 32) &&\n                    ltid_in_bounds_32980) {\n                    // read operands\n                    {\n                        x_32973 = ((volatile __local\n                                    int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32947) -\n                                                                 sext_i32_i64(skip_threads_32981))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32975 = add64(x_32973, x_32974);\n                        \n                        x_32973 = defunc_1_op_res_32975;\n                    }\n                }\n                if (sle32(wave_sizze_32949, skip_threads_32981)) {\n                    barrier(CLK_LO",
            "CAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32981, local_tid_32947 -\n                          squot32(local_tid_32947, 32) * 32) &&\n                    ltid_in_bounds_32980) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32947)] =\n                            x_32973;\n                        x_32974 = x_32973;\n                    }\n                }\n                if (sle32(wave_sizze_32949, skip_threads_32981)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32981 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32947 - squot32(local_tid_32947, 32) * 32) == 31 &&\n                ltid_in_bounds_32980) {\n                ((volatile __local\n                  int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32947,\n                                                                   32))] =\n                    x_32973;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32982;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32947, 32) == 0 && ltid_in_bounds_32980) {\n                    x_32978 = ((volatile __local\n                                int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                   ",
            "                                 (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32947)];\n                    if ((local_tid_32947 - squot32(local_tid_32947, 32) * 32) ==\n                        0) {\n                        x_32977 = x_32978;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32982 = 1;\n                while (slt32(skip_threads_32982, 32)) {\n                    if (sle32(skip_threads_32982, local_tid_32947 -\n                              squot32(local_tid_32947, 32) * 32) &&\n                        (squot32(local_tid_32947, 32) == 0 &&\n                         ltid_in_bounds_32980)) {\n                        // read operands\n                        {\n                            x_32977 = ((volatile __local\n                                        int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32947) -\n                                                                     sext_i32_i64(skip_threads_32982))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32979 = add64(x_32977,\n                                                                  x_32978);\n                            \n                            x_32977 = defunc_1_op_res_32979;\n                        }\n                    }\n                    if (sle32(wave_sizze_32949, skip_threads_32982)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32982, local_tid_32947 -\n                              squot32(local_tid_32947, 32) * 32) &&\n                        (squot32(local_tid_32947,",
            " 32) == 0 &&\n                         ltid_in_bounds_32980)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32947)] =\n                                x_32977;\n                            x_32978 = x_32977;\n                        }\n                    }\n                    if (sle32(wave_sizze_32949, skip_threads_32982)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32982 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32947, 32) == 0 || !ltid_in_bounds_32980)) {\n                // read operands\n                {\n                    x_32974 = x_32973;\n                    x_32973 = ((__local\n                                int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32947,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32975 = add64(x_32973, x_32974);\n                    \n                    x_32973 = defunc_1_op_res_32975;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                           ",
            "               (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32947)] =\n                        x_32973;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32947, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32947)] =\n                    x_32974;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32947 == 0) {\n            acc_32976 = ((__local\n                          int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31316 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32976 = ((__local\n                          int64_t *) local_mem_32955)[squot64(byte_offsets_32951,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32947) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32983;\n    \n    prefix_32983 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32963 == (int64_t) 0 && local_tid_32947 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32944)[dynamic_id_32963] = acc_32976;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32940)[dynamic_id_32963] = (int8_t) 2;\n            acc_32976 = (int64_t) 0;\n        }\n        if",
            " (!(dynamic_id_32963 == (int64_t) 0) && slt32(local_tid_32947,\n                                                        wave_sizze_32949)) {\n            if (local_tid_32947 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32942)[dynamic_id_32963] =\n                    acc_32976;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32940)[dynamic_id_32963] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32955)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32940)[dynamic_id_32963 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32984;\n            \n            status_32984 = ((__local int8_t *) local_mem_32955)[(int64_t) 0];\n            if (status_32984 == (int8_t) 2) {\n                if (local_tid_32947 == 0) {\n                    prefix_32983 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32944)[dynamic_id_32963 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32985 = dynamic_id_32963 -\n                        sext_i32_i64(wave_sizze_32949);\n                \n                while (slt32(wave_sizze_32949 * -1, readOffset_32985)) {\n                    int32_t read_i_32986 = readOffset_32985 + local_tid_32947;\n                    int64_t aggr_32987 = (int64_t) 0;\n                    int8_t flag_32988 = (int8_t) 0;\n                    int8_t used_32989 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32986)) {\n                        flag_32988 = ((volatile __global\n                                       int8_t *) status_flags_mem_32940)",
            "[sext_i32_i64(read_i_32986)];\n                        if (flag_32988 == (int8_t) 2) {\n                            aggr_32987 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32944)[sext_i32_i64(read_i_32986)];\n                        } else {\n                            if (flag_32988 == (int8_t) 1) {\n                                aggr_32987 = ((volatile __global\n                                               int64_t *) aggregates_mem_32942)[sext_i32_i64(read_i_32986)];\n                                used_32989 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32955)[squot64(warp_byte_offset_32953,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32947)] =\n                        aggr_32987;\n                    \n                    int8_t tmp_32990;\n                    \n                    tmp_32990 = flag_32988 | used_32989 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32955)[sext_i32_i64(local_tid_32947)] =\n                        tmp_32990;\n                    mem_fence_local();\n                    flag_32988 = ((volatile __local\n                                   int8_t *) local_mem_32955)[sext_i32_i64(wave_sizze_32949) -\n                                                              (int64_t) 1];\n                    if (local_tid_32947 == 0) {\n                        if (!(flag_32988 == (int8_t) 2)) {\n                            int64_t x_32991 = (int64_t) 0;\n                            int64_t x_32992;\n                            int8_t flag1_32994;\n                            \n                            flag1_32994 = (int8_t) 0;\n                            \n                            int8_t flag2_32995;\n                            int8_t used1_32996;\n              ",
            "              \n                            used1_32996 = (int8_t) 0;\n                            \n                            int8_t used2_32997;\n                            \n                            for (int32_t i_32998 = 0; i_32998 <\n                                 wave_sizze_32949; i_32998++) {\n                                flag2_32995 = ((__local\n                                                int8_t *) local_mem_32955)[sext_i32_i64(i_32998)];\n                                used2_32997 = lshr8(flag2_32995, (int8_t) 2);\n                                flag2_32995 = flag2_32995 & (int8_t) 3;\n                                x_32992 = ((__local\n                                            int64_t *) local_mem_32955)[squot64(warp_byte_offset_32953,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32998)];\n                                if (!(flag2_32995 == (int8_t) 1)) {\n                                    flag1_32994 = flag2_32995;\n                                    used1_32996 = used2_32997;\n                                    x_32991 = x_32992;\n                                } else {\n                                    used1_32996 += used2_32997;\n                                    \n                                    int64_t defunc_1_op_res_32993;\n                                    \n                                    defunc_1_op_res_32993 = add64(x_32991,\n                                                                  x_32992);\n                                    x_32991 = defunc_1_op_res_32993;\n                                }\n                            }\n                            flag_32988 = flag1_32994;\n                            used_32989 = used1_32996;\n                            aggr_32987 = x_32991;\n                        } else {\n                            aggr_32987 = ((__local\n                        ",
            "                   int64_t *) local_mem_32955)[squot64(warp_byte_offset_32953,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32949) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32988 == (int8_t) 2) {\n                            readOffset_32985 = wave_sizze_32949 * -1;\n                        } else {\n                            readOffset_32985 -= zext_i8_i32(used_32989);\n                        }\n                        ((__local int32_t *) local_mem_32955)[(int64_t) 0] =\n                            readOffset_32985;\n                        \n                        int64_t x_32999;\n                        \n                        x_32999 = aggr_32987;\n                        \n                        int64_t x_33000;\n                        \n                        x_33000 = prefix_32983;\n                        \n                        int64_t defunc_1_op_res_33001;\n                        \n                        defunc_1_op_res_33001 = add64(x_32999, x_33000);\n                        prefix_32983 = defunc_1_op_res_33001;\n                    }\n                    mem_fence_local();\n                    readOffset_32985 = ((__local\n                                         int32_t *) local_mem_32955)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32947 == 0) {\n                int64_t x_33002 = prefix_32983;\n                int64_t x_33003 = acc_32976;\n                int64_t defunc_1_op_res_33004 = add64(x_33002, x_33003);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32944)[dynamic_id_32963] =\n                    defunc_1_op_res_33004;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_",
            "mem_32940)[dynamic_id_32963] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32955)[squot64(warp_byte_offset_32953,\n                                                      (int64_t) 8)] =\n                    prefix_32983;\n                acc_32976 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32963 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32983 = ((__local\n                             int64_t *) local_mem_32955)[squot64(warp_byte_offset_32953,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33005;\n        int64_t x_33006;\n        int64_t x_33008;\n        \n        x_33008 = prefix_32983;\n        \n        int64_t x_33009;\n        \n        x_33009 = acc_32976;\n        \n        int64_t defunc_1_op_res_33010;\n        \n        defunc_1_op_res_33010 = add64(x_33008, x_33009);\n        x_33005 = defunc_1_op_res_33010;\n        for (int64_t i_33011 = 0; i_33011 < (int64_t) 9; i_33011++) {\n            x_33006 = private_mem_32965[i_33011];\n            \n            int64_t defunc_1_op_res_33007;\n            \n            defunc_1_op_res_33007 = add64(x_33005, x_33006);\n            private_mem_32965[i_33011] = defunc_1_op_res_33007;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33012 = 0; i_33012 < (int64_t) 9; i_33012++) {\n            int64_t sharedIdx_33013 = sext_i32_i64(local_tid_32947 * 9) +\n                    i_33012;\n            \n            ((__local int64_t *) local_mem_32955)[sharedIdx_33013] =\n                private_mem_32965[i_33012];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33014 = 0; i_33014 < (int64_t) 9; i_33014++) {\n            int32_t sharedIdx_33015 = local_tid_32947 +\n                    sext_i64_i32(segscan_group_sizze_3131",
            "6 * i_33014);\n            \n            private_mem_32965[i_33014] = ((__local\n                                           int64_t *) local_mem_32955)[sext_i32_i64(sharedIdx_33015)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33016 = 0; i_33016 < (int64_t) 9; i_33016++) {\n            int64_t gtid_31320 = blockOff_32964 + segscan_group_sizze_31316 *\n                    i_33016 + sext_i32_i64(local_tid_32947);\n            \n            if (slt64(gtid_31320, num_segments_29894)) {\n                ((__global int64_t *) mem_32024)[gtid_31320] =\n                    private_mem_32965[i_33016];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32963 == sdiv_up64(num_segments_29894,\n                                          segscan_group_sizze_31316 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_32938)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31316\n}\n__kernel void test_ballQueryzisegscan_31610(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            uint local_mem_33062_backing_offset_0,\n                                            int64_t bytes_31948, __global\n                                            unsigned char *mem_32028, __global\n                                            unsigned char *mem_32044, __global\n                                            unsigned char *mem_32047, __global\n                                            unsigned char *mem_32049, __global\n                                            unsigned char *test_ballQueryziid_counter_mem_33045,\n                                          ",
            "  __global\n                                            unsigned char *status_flags_mem_33047,\n                                            __global\n                                            unsigned char *aggregates_mem_33049,\n                                            __global\n                                            unsigned char *incprefixes_mem_33051)\n{\n    #define segscan_group_sizze_31605 (test_ballQueryzisegscan_group_sizze_31604)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33062_backing_0 =\n                  &shared_mem[local_mem_33062_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_33053;\n    int32_t local_tid_33054;\n    int64_t group_sizze_33057;\n    int32_t wave_sizze_33056;\n    int32_t group_tid_33055;\n    \n    global_tid_33053 = get_global_id(0);\n    local_tid_33054 = get_local_id(0);\n    group_sizze_33057 = get_local_size(0);\n    wave_sizze_33056 = LOCKSTEP_WIDTH;\n    group_tid_33055 = get_group_id(0);\n    \n    int32_t phys_tid_31610;\n    \n    phys_tid_31610 = global_tid_33053;\n    \n    int64_t byte_offsets_33058;\n    \n    byte_offsets_33058 = (int64_t) 0;\n    \n    int64_t byte_offsets_33059;\n    \n    byte_offsets_33059 = segscan_group_sizze_31605 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33060;\n    \n    warp_byte_offset_33060 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33061;\n    \n    warp_byte_offset_33061 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33062;\n    \n    local_mem_33062 = (__local char *) local_mem_33062_backing_0;\n    \n    int64_t trans_arr_len_33063;\n    \n    trans_arr_len_33063 = (int64_t) 9 * segscan_group_sizze_31605;\n    \n    int32_t dynamic_id_33070;\n   ",
            " \n    if (local_tid_33054 == 0) {\n        dynamic_id_33070 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_33045)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33062)[(int64_t) 0] = dynamic_id_33070;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33070 = ((__local int32_t *) local_mem_33062)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33071;\n    \n    blockOff_33071 = sext_i32_i64(dynamic_id_33070) * (int64_t) 9 *\n        segscan_group_sizze_31605;\n    \n    int64_t private_mem_33072[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33074 = 0; i_33074 < (int64_t) 9; i_33074++) {\n            int64_t gtid_31609 = blockOff_33071 +\n                    sext_i32_i64(local_tid_33054) + i_33074 *\n                    segscan_group_sizze_31605;\n            \n            if (slt64(gtid_31609, bytes_31948)) {\n                int64_t new_index_31872 = squot64(gtid_31609, (int64_t) 8);\n                int64_t binop_y_31874 = (int64_t) 8 * new_index_31872;\n                int64_t new_index_31875 = gtid_31609 - binop_y_31874;\n                int32_t x_29973 = ((__global\n                                    int32_t *) mem_32044)[new_index_31872 *\n                                                          (int64_t) 8 +\n                                                          new_index_31875];\n                int64_t s_29974 = sext_i32_i64(x_29973);\n                bool x_29975 = sle64((int64_t) 0, s_29974);\n                bool y_29976 = slt64(s_29974, (int64_t) 4096);\n                bool bounds_check_29977 = x_29975 && y_29976;\n                bool index_certs_29978;\n                \n                if (!bounds_check_29977) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 2) ==\n                            -1) {\n                            glo",
            "bal_failure_args[0] = s_29974;\n                            global_failure_args[1] = (int64_t) 4096;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t defunc_0_f_res_29979 = ((__global\n                                                 int64_t *) mem_32028)[s_29974];\n                \n                ((__global int64_t *) mem_32049)[gtid_31609] =\n                    defunc_0_f_res_29979;\n                private_mem_33072[i_33074] = defunc_0_f_res_29979;\n            } else {\n                private_mem_33072[i_33074] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33075 = 0; i_33075 < (int64_t) 9; i_33075++) {\n            int64_t sharedIdx_33076 = sext_i32_i64(local_tid_33054) + i_33075 *\n                    segscan_group_sizze_31605;\n            \n            ((__local int64_t *) local_mem_33062)[sharedIdx_33076] =\n                private_mem_33072[i_33075];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33077 = 0; i_33077 < 9; i_33077++) {\n            int32_t sharedIdx_33078 = local_tid_33054 * 9 + i_33077;\n            \n            private_mem_33072[sext_i32_i64(i_33077)] = ((__local\n                                                         int64_t *) local_mem_33062)[sext_i32_i64(sharedIdx_33078)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33079 = 0; i_33079 < (int64_t) 8; i_33079++) {\n            int64_t x_29970;\n            int64_t x_29971;\n            \n            x_29970 = private_mem_33072[i_33079];\n            x_29971 = private_mem_33072[i_33079 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29972;\n            \n            defunc_1_op_res_29972 = add64(x_29970, x_29971);\n            private_mem_33072[",
            "i_33079 + (int64_t) 1] = defunc_1_op_res_29972;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33054)] =\n            private_mem_33072[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_33083;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_33080;\n        int64_t x_33081;\n        int64_t x_33084;\n        int64_t x_33085;\n        bool ltid_in_bounds_33087;\n        \n        ltid_in_bounds_33087 = slt64(sext_i32_i64(local_tid_33054),\n                                     segscan_group_sizze_31605);\n        \n        int32_t skip_threads_33088;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33087) {\n                x_33081 = ((volatile __local\n                            int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33054)];\n                if ((local_tid_33054 - squot32(local_tid_33054, 32) * 32) ==\n                    0) {\n                    x_33080 = x_33081;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33088 = 1;\n            while (slt32(skip_threads_33088, 32)) {\n                if (sle32(skip_threads_33088, local_tid_33054 -\n                          squot32(local_tid_33054, 32) * 32) &&\n                    ltid_in_bounds_33087) {\n                    // read operands\n                    {\n                        x_33080 = ((volatile __local\n                                    int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                        (i",
            "nt64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33054) -\n                                                                 sext_i32_i64(skip_threads_33088))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_33082 = add64(x_33080, x_33081);\n                        \n                        x_33080 = defunc_1_op_res_33082;\n                    }\n                }\n                if (sle32(wave_sizze_33056, skip_threads_33088)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33088, local_tid_33054 -\n                          squot32(local_tid_33054, 32) * 32) &&\n                    ltid_in_bounds_33087) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33054)] =\n                            x_33080;\n                        x_33081 = x_33080;\n                    }\n                }\n                if (sle32(wave_sizze_33056, skip_threads_33088)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33088 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33054 - squot32(local_tid_33054, 32) * 32) == 31 &&\n                ltid_in_bounds_33087) {\n                ((volatile __local\n                  int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33054,\n                              ",
            "                                     32))] =\n                    x_33080;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33089;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33054, 32) == 0 && ltid_in_bounds_33087) {\n                    x_33085 = ((volatile __local\n                                int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33054)];\n                    if ((local_tid_33054 - squot32(local_tid_33054, 32) * 32) ==\n                        0) {\n                        x_33084 = x_33085;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33089 = 1;\n                while (slt32(skip_threads_33089, 32)) {\n                    if (sle32(skip_threads_33089, local_tid_33054 -\n                              squot32(local_tid_33054, 32) * 32) &&\n                        (squot32(local_tid_33054, 32) == 0 &&\n                         ltid_in_bounds_33087)) {\n                        // read operands\n                        {\n                            x_33084 = ((volatile __local\n                                        int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33054) -\n                                                                     sext_i32_i64(skip_threads_33089))];\n                        }\n                        // perform operation\n                        {\n                     ",
            "       int64_t defunc_1_op_res_33086 = add64(x_33084,\n                                                                  x_33085);\n                            \n                            x_33084 = defunc_1_op_res_33086;\n                        }\n                    }\n                    if (sle32(wave_sizze_33056, skip_threads_33089)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33089, local_tid_33054 -\n                              squot32(local_tid_33054, 32) * 32) &&\n                        (squot32(local_tid_33054, 32) == 0 &&\n                         ltid_in_bounds_33087)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33054)] =\n                                x_33084;\n                            x_33085 = x_33084;\n                        }\n                    }\n                    if (sle32(wave_sizze_33056, skip_threads_33089)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33089 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33054, 32) == 0 || !ltid_in_bounds_33087)) {\n                // read operands\n                {\n                    x_33081 = x_33080;\n                    x_33080 = ((__local\n                                int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33054,\n              ",
            "                                                                    32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_33082 = add64(x_33080, x_33081);\n                    \n                    x_33080 = defunc_1_op_res_33082;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33054)] =\n                        x_33080;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33054, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33054)] =\n                    x_33081;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33054 == 0) {\n            acc_33083 = ((__local\n                          int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31605 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33083 = ((__local\n                          int64_t *) local_mem_33062)[squot64(byte_offsets_33058,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33054) -\n     ",
            "                                                  (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_33090;\n    \n    prefix_33090 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33070 == (int64_t) 0 && local_tid_33054 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_33051)[dynamic_id_33070] = acc_33083;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33047)[dynamic_id_33070] = (int8_t) 2;\n            acc_33083 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33070 == (int64_t) 0) && slt32(local_tid_33054,\n                                                        wave_sizze_33056)) {\n            if (local_tid_33054 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_33049)[dynamic_id_33070] =\n                    acc_33083;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33047)[dynamic_id_33070] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33062)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33047)[dynamic_id_33070 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33091;\n            \n            status_33091 = ((__local int8_t *) local_mem_33062)[(int64_t) 0];\n            if (status_33091 == (int8_t) 2) {\n                if (local_tid_33054 == 0) {\n                    prefix_33090 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33051)[dynamic_id_33070 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33092 = dy",
            "namic_id_33070 -\n                        sext_i32_i64(wave_sizze_33056);\n                \n                while (slt32(wave_sizze_33056 * -1, readOffset_33092)) {\n                    int32_t read_i_33093 = readOffset_33092 + local_tid_33054;\n                    int64_t aggr_33094 = (int64_t) 0;\n                    int8_t flag_33095 = (int8_t) 0;\n                    int8_t used_33096 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33093)) {\n                        flag_33095 = ((volatile __global\n                                       int8_t *) status_flags_mem_33047)[sext_i32_i64(read_i_33093)];\n                        if (flag_33095 == (int8_t) 2) {\n                            aggr_33094 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33051)[sext_i32_i64(read_i_33093)];\n                        } else {\n                            if (flag_33095 == (int8_t) 1) {\n                                aggr_33094 = ((volatile __global\n                                               int64_t *) aggregates_mem_33049)[sext_i32_i64(read_i_33093)];\n                                used_33096 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_33062)[squot64(warp_byte_offset_33060,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33054)] =\n                        aggr_33094;\n                    \n                    int8_t tmp_33097;\n                    \n                    tmp_33097 = flag_33095 | used_33096 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33062)[sext_i32_i64(local_tid_33054)] =\n                        tmp_33097;\n                    mem_fence_local();\n                    flag_33095 = ((volatile __local\n                                   int8_t *) local_m",
            "em_33062)[sext_i32_i64(wave_sizze_33056) -\n                                                              (int64_t) 1];\n                    if (local_tid_33054 == 0) {\n                        if (!(flag_33095 == (int8_t) 2)) {\n                            int64_t x_33098 = (int64_t) 0;\n                            int64_t x_33099;\n                            int8_t flag1_33101;\n                            \n                            flag1_33101 = (int8_t) 0;\n                            \n                            int8_t flag2_33102;\n                            int8_t used1_33103;\n                            \n                            used1_33103 = (int8_t) 0;\n                            \n                            int8_t used2_33104;\n                            \n                            for (int32_t i_33105 = 0; i_33105 <\n                                 wave_sizze_33056; i_33105++) {\n                                flag2_33102 = ((__local\n                                                int8_t *) local_mem_33062)[sext_i32_i64(i_33105)];\n                                used2_33104 = lshr8(flag2_33102, (int8_t) 2);\n                                flag2_33102 = flag2_33102 & (int8_t) 3;\n                                x_33099 = ((__local\n                                            int64_t *) local_mem_33062)[squot64(warp_byte_offset_33060,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33105)];\n                                if (!(flag2_33102 == (int8_t) 1)) {\n                                    flag1_33101 = flag2_33102;\n                                    used1_33103 = used2_33104;\n                                    x_33098 = x_33099;\n                                } else {\n                                    used1_33103 += used2_33104;\n                                    \n                                    int64_t defunc_1_o",
            "p_res_33100;\n                                    \n                                    defunc_1_op_res_33100 = add64(x_33098,\n                                                                  x_33099);\n                                    x_33098 = defunc_1_op_res_33100;\n                                }\n                            }\n                            flag_33095 = flag1_33101;\n                            used_33096 = used1_33103;\n                            aggr_33094 = x_33098;\n                        } else {\n                            aggr_33094 = ((__local\n                                           int64_t *) local_mem_33062)[squot64(warp_byte_offset_33060,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33056) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33095 == (int8_t) 2) {\n                            readOffset_33092 = wave_sizze_33056 * -1;\n                        } else {\n                            readOffset_33092 -= zext_i8_i32(used_33096);\n                        }\n                        ((__local int32_t *) local_mem_33062)[(int64_t) 0] =\n                            readOffset_33092;\n                        \n                        int64_t x_33106;\n                        \n                        x_33106 = aggr_33094;\n                        \n                        int64_t x_33107;\n                        \n                        x_33107 = prefix_33090;\n                        \n                        int64_t defunc_1_op_res_33108;\n                        \n                        defunc_1_op_res_33108 = add64(x_33106, x_33107);\n                        prefix_33090 = defunc_1_op_res_33108;\n                    }\n                    mem_fence_local();\n                    readOffset_33092 = ((__local\n  ",
            "                                       int32_t *) local_mem_33062)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33054 == 0) {\n                int64_t x_33109 = prefix_33090;\n                int64_t x_33110 = acc_33083;\n                int64_t defunc_1_op_res_33111 = add64(x_33109, x_33110);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_33051)[dynamic_id_33070] =\n                    defunc_1_op_res_33111;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33047)[dynamic_id_33070] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_33062)[squot64(warp_byte_offset_33060,\n                                                      (int64_t) 8)] =\n                    prefix_33090;\n                acc_33083 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33070 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33090 = ((__local\n                             int64_t *) local_mem_33062)[squot64(warp_byte_offset_33060,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33112;\n        int64_t x_33113;\n        int64_t x_33115;\n        \n        x_33115 = prefix_33090;\n        \n        int64_t x_33116;\n        \n        x_33116 = acc_33083;\n        \n        int64_t defunc_1_op_res_33117;\n        \n        defunc_1_op_res_33117 = add64(x_33115, x_33116);\n        x_33112 = defunc_1_op_res_33117;\n        for (int64_t i_33118 = 0; i_33118 < (int64_t) 9; i_33118++) {\n            x_33113 = private_mem_33072[i_33118];\n            \n            int64_t defunc_1_op_res_33114;\n            \n            defunc_1_op_res_33114 = add64(x_33112, x_33113);\n            private_mem_33072[i_33118] = defunc_1_op_res_33114;\n        }\n    }\n   ",
            " // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33119 = 0; i_33119 < (int64_t) 9; i_33119++) {\n            int64_t sharedIdx_33120 = sext_i32_i64(local_tid_33054 * 9) +\n                    i_33119;\n            \n            ((__local int64_t *) local_mem_33062)[sharedIdx_33120] =\n                private_mem_33072[i_33119];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33121 = 0; i_33121 < (int64_t) 9; i_33121++) {\n            int32_t sharedIdx_33122 = local_tid_33054 +\n                    sext_i64_i32(segscan_group_sizze_31605 * i_33121);\n            \n            private_mem_33072[i_33121] = ((__local\n                                           int64_t *) local_mem_33062)[sext_i32_i64(sharedIdx_33122)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33123 = 0; i_33123 < (int64_t) 9; i_33123++) {\n            int64_t gtid_31609 = blockOff_33071 + segscan_group_sizze_31605 *\n                    i_33123 + sext_i32_i64(local_tid_33054);\n            \n            if (slt64(gtid_31609, bytes_31948)) {\n                ((__global int64_t *) mem_32047)[gtid_31609] =\n                    private_mem_33072[i_33123];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33070 == sdiv_up64(bytes_31948,\n                                          segscan_group_sizze_31605 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_33045)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31605\n}\n__kernel void test_ballQueryzisegscan_31643(__global int *global_failure,\n                                            uint local_mem_33322_backing_offset_0,\n                                            int64_t defunc_2_reduce_res_29982,\n                 ",
            "                           __global unsigned char *mem_32054,\n                                            __global unsigned char *mem_32058,\n                                            __global unsigned char *mem_32060,\n                                            __global\n                                            unsigned char *test_ballQueryziid_counter_mem_33299,\n                                            __global\n                                            unsigned char *status_flags_mem_33301,\n                                            __global\n                                            unsigned char *aggregates_mem_33303,\n                                            __global\n                                            unsigned char *incprefixes_mem_33305,\n                                            __global\n                                            unsigned char *aggregates_mem_33307,\n                                            __global\n                                            unsigned char *incprefixes_mem_33309)\n{\n    #define segscan_group_sizze_31638 (test_ballQueryzisegscan_group_sizze_31637)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33322_backing_0 =\n                  &shared_mem[local_mem_33322_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33311;\n    int32_t local_tid_33312;\n    int64_t group_sizze_33315;\n    int32_t wave_sizze_33314;\n    int32_t group_tid_33313;\n    \n    global_tid_33311 = get_global_id(0);\n    local_tid_33312 = get_local_id(0);\n    group_sizze_33315 = get_local_size(0);\n    wave_sizze_33314 = LOCKSTEP_WIDTH;\n    group_tid_33313 = get_group_id(0);\n    \n    int32_t phys_tid_31643;\n    \n    phys_tid_31643 = global_tid_33311;\n    \n    int64_t byte_offsets_33316;\n    \n    byte_offsets_33316 = (int64_t) 0;\n    \n    int64_t byte_offsets_33317;\n    \n    byte_offsets_33317 = segscan_group_sizze_31638;\n   ",
            " \n    int64_t byte_offsets_33318;\n    \n    byte_offsets_33318 = sdiv_up64(segscan_group_sizze_31638, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31638 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33319;\n    \n    warp_byte_offset_33319 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33320;\n    \n    warp_byte_offset_33320 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_33321;\n    \n    warp_byte_offset_33321 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33322;\n    \n    local_mem_33322 = (__local char *) local_mem_33322_backing_0;\n    \n    int64_t trans_arr_len_33323;\n    \n    trans_arr_len_33323 = (int64_t) 9 * segscan_group_sizze_31638;\n    \n    int32_t dynamic_id_33333;\n    \n    if (local_tid_33312 == 0) {\n        dynamic_id_33333 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_33299)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33322)[(int64_t) 0] = dynamic_id_33333;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33333 = ((__local int32_t *) local_mem_33322)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33334;\n    \n    blockOff_33334 = sext_i32_i64(dynamic_id_33333) * (int64_t) 9 *\n        segscan_group_sizze_31638;\n    \n    bool private_mem_33335[9];\n    int64_t private_mem_33337[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33339 = 0; i_33339 < (int64_t) 9; i_33339++) {\n            int64_t gtid_31642 = blockOff_33334 +\n                    sext_i32_i64(local_tid_33312) + i_33339 *\n                    segscan_group_sizze_31638;\n            \n            if (slt64(gtid_31642, defunc_2_reduce_res_29982)) {\n                int64_t x_30008 = ((__global int64_t *) mem_32054)[gtid_31642];\n                bool defunc_0_f_res_30009 = slt64((int64_t) 0, x_30008);\n                \n                private_mem_",
            "33335[i_33339] = defunc_0_f_res_30009;\n                private_mem_33337[i_33339] = x_30008;\n            } else {\n                private_mem_33335[i_33339] = 0;\n                private_mem_33337[i_33339] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33340 = 0; i_33340 < (int64_t) 9; i_33340++) {\n            int64_t sharedIdx_33341 = sext_i32_i64(local_tid_33312) + i_33340 *\n                    segscan_group_sizze_31638;\n            \n            ((__local bool *) local_mem_33322)[sharedIdx_33341] =\n                private_mem_33335[i_33340];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33342 = 0; i_33342 < 9; i_33342++) {\n            int32_t sharedIdx_33343 = local_tid_33312 * 9 + i_33342;\n            \n            private_mem_33335[sext_i32_i64(i_33342)] = ((__local\n                                                         bool *) local_mem_33322)[sext_i32_i64(sharedIdx_33343)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33344 = 0; i_33344 < (int64_t) 9; i_33344++) {\n            int64_t sharedIdx_33345 = sext_i32_i64(local_tid_33312) + i_33344 *\n                    segscan_group_sizze_31638;\n            \n            ((__local int64_t *) local_mem_33322)[sharedIdx_33345] =\n                private_mem_33337[i_33344];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33346 = 0; i_33346 < 9; i_33346++) {\n            int32_t sharedIdx_33347 = local_tid_33312 * 9 + i_33346;\n            \n            private_mem_33337[sext_i32_i64(i_33346)] = ((__local\n                                                         int64_t *) local_mem_33322)[sext_i32_i64(sharedIdx_33347)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33348 = 0; i_33348 < (int64_t) 8; i_33348++) {\n            bool x_30001;\n            bool x_30003;\n            \n            x_30001 = priva",
            "te_mem_33335[i_33348];\n            x_30003 = private_mem_33335[i_33348 + (int64_t) 1];\n            \n            int64_t x_30002;\n            int64_t x_30004;\n            \n            x_30002 = private_mem_33337[i_33348];\n            x_30004 = private_mem_33337[i_33348 + (int64_t) 1];\n            \n            bool defunc_1_op_res_30005;\n            \n            defunc_1_op_res_30005 = x_30001 || x_30003;\n            \n            int64_t defunc_1_op_res_30006;\n            \n            if (x_30003) {\n                defunc_1_op_res_30006 = x_30004;\n            } else {\n                int64_t defunc_1_op_res_30007 = add64(x_30002, x_30004);\n                \n                defunc_1_op_res_30006 = defunc_1_op_res_30007;\n            }\n            private_mem_33335[i_33348 + (int64_t) 1] = defunc_1_op_res_30005;\n            private_mem_33337[i_33348 + (int64_t) 1] = defunc_1_op_res_30006;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_33322)[byte_offsets_33316 +\n                                           sext_i32_i64(local_tid_33312)] =\n            private_mem_33335[(int64_t) 8];\n        ((__local int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33312)] =\n            private_mem_33337[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_33356;\n    int64_t acc_33357;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_33349;\n        int64_t x_33350;\n        bool x_33351;\n        int64_t x_33352;\n        bool x_33358;\n        int64_t x_33359;\n        bool x_33360;\n        int64_t x_33361;\n        bool ltid_in_bounds_33365;\n        \n        ltid_in_bounds_33365 = slt64(sext_i32_i64(local_tid_33312),\n                                     segscan_group_sizze_31638);\n        \n        int32_t skip_threads_33366;\n        \n        // read input for in-bloc",
            "k scan\n        {\n            if (ltid_in_bounds_33365) {\n                x_33351 = ((volatile __local\n                            bool *) local_mem_33322)[byte_offsets_33316 +\n                                                     sext_i32_i64(local_tid_33312)];\n                x_33352 = ((volatile __local\n                            int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33312)];\n                if ((local_tid_33312 - squot32(local_tid_33312, 32) * 32) ==\n                    0) {\n                    x_33349 = x_33351;\n                    x_33350 = x_33352;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33366 = 1;\n            while (slt32(skip_threads_33366, 32)) {\n                if (sle32(skip_threads_33366, local_tid_33312 -\n                          squot32(local_tid_33312, 32) * 32) &&\n                    ltid_in_bounds_33365) {\n                    // read operands\n                    {\n                        x_33349 = ((volatile __local\n                                    bool *) local_mem_33322)[byte_offsets_33316 +\n                                                             (sext_i32_i64(local_tid_33312) -\n                                                              sext_i32_i64(skip_threads_33366))];\n                        x_33350 = ((volatile __local\n                                    int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33312) -\n                                                                 sext_i32_i64(skip_threads_33366))];\n                    }\n                    // perform operation\n                ",
            "    {\n                        bool defunc_1_op_res_33353 = x_33349 || x_33351;\n                        int64_t defunc_1_op_res_33354;\n                        \n                        if (x_33351) {\n                            defunc_1_op_res_33354 = x_33352;\n                        } else {\n                            int64_t defunc_1_op_res_33355 = add64(x_33350,\n                                                                  x_33352);\n                            \n                            defunc_1_op_res_33354 = defunc_1_op_res_33355;\n                        }\n                        x_33349 = defunc_1_op_res_33353;\n                        x_33350 = defunc_1_op_res_33354;\n                    }\n                }\n                if (sle32(wave_sizze_33314, skip_threads_33366)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33366, local_tid_33312 -\n                          squot32(local_tid_33312, 32) * 32) &&\n                    ltid_in_bounds_33365) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_33322)[byte_offsets_33316 +\n                                                   sext_i32_i64(local_tid_33312)] =\n                            x_33349;\n                        x_33351 = x_33349;\n                        ((volatile __local\n                          int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33312)] =\n                            x_33350;\n                        x_33352 = x_33350;\n                    }\n                }\n                if (sle32(wave_sizze_33314, skip_threads_33366)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33366 *= 2;\n            }\n        }\n        barrier(CLK_",
            "LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33312 - squot32(local_tid_33312, 32) * 32) == 31 &&\n                ltid_in_bounds_33365) {\n                ((volatile __local bool *) local_mem_33322)[byte_offsets_33316 +\n                                                            sext_i32_i64(squot32(local_tid_33312,\n                                                                                 32))] =\n                    x_33349;\n                ((volatile __local\n                  int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33312,\n                                                                   32))] =\n                    x_33350;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33367;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33312, 32) == 0 && ltid_in_bounds_33365) {\n                    x_33360 = ((volatile __local\n                                bool *) local_mem_33322)[byte_offsets_33316 +\n                                                         sext_i32_i64(local_tid_33312)];\n                    x_33361 = ((volatile __local\n                                int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33312)];\n                    if ((local_tid_33312 - squot32(local_tid_33312, 32) * 32) ==\n                        0) {\n                        x_33358 = x_33360;\n                        x_33359 = x_33361;\n                    }\n                }\n    ",
            "        }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33367 = 1;\n                while (slt32(skip_threads_33367, 32)) {\n                    if (sle32(skip_threads_33367, local_tid_33312 -\n                              squot32(local_tid_33312, 32) * 32) &&\n                        (squot32(local_tid_33312, 32) == 0 &&\n                         ltid_in_bounds_33365)) {\n                        // read operands\n                        {\n                            x_33358 = ((volatile __local\n                                        bool *) local_mem_33322)[byte_offsets_33316 +\n                                                                 (sext_i32_i64(local_tid_33312) -\n                                                                  sext_i32_i64(skip_threads_33367))];\n                            x_33359 = ((volatile __local\n                                        int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33312) -\n                                                                     sext_i32_i64(skip_threads_33367))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_33362 = x_33358 || x_33360;\n                            int64_t defunc_1_op_res_33363;\n                            \n                            if (x_33360) {\n                                defunc_1_op_res_33363 = x_33361;\n                            } else {\n                                int64_t defunc_1_op_res_33364 = add64(x_33359,\n                                                                      x_33361);\n                                \n                                defunc_1_op_res_33363 = defunc_1_op_res_33364;\n                            }\n    ",
            "                        x_33358 = defunc_1_op_res_33362;\n                            x_33359 = defunc_1_op_res_33363;\n                        }\n                    }\n                    if (sle32(wave_sizze_33314, skip_threads_33367)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33367, local_tid_33312 -\n                              squot32(local_tid_33312, 32) * 32) &&\n                        (squot32(local_tid_33312, 32) == 0 &&\n                         ltid_in_bounds_33365)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_33322)[byte_offsets_33316 +\n                                                       sext_i32_i64(local_tid_33312)] =\n                                x_33358;\n                            x_33360 = x_33358;\n                            ((volatile __local\n                              int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33312)] =\n                                x_33359;\n                            x_33361 = x_33359;\n                        }\n                    }\n                    if (sle32(wave_sizze_33314, skip_threads_33367)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33367 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33312, 32) == 0 || !ltid_in_bounds_33365)) {\n                // read operands\n                {\n                    x_33351 = x_33349;\n                    x_33352 = x_33350;\n                    x_33349 = ((__local\n                                bool *) local_me",
            "m_33322)[byte_offsets_33316 +\n                                                         (sext_i32_i64(squot32(local_tid_33312,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_33350 = ((__local\n                                int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33312,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_33353 = x_33349 || x_33351;\n                    int64_t defunc_1_op_res_33354;\n                    \n                    if (x_33351) {\n                        defunc_1_op_res_33354 = x_33352;\n                    } else {\n                        int64_t defunc_1_op_res_33355 = add64(x_33350, x_33352);\n                        \n                        defunc_1_op_res_33354 = defunc_1_op_res_33355;\n                    }\n                    x_33349 = defunc_1_op_res_33353;\n                    x_33350 = defunc_1_op_res_33354;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_33322)[byte_offsets_33316 +\n                                                       sext_i32_i64(local_tid_33312)] =\n                        x_33349;\n                    ((__local\n                      int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33312)] =\n                        x_33350;\n                }\n            }\n",
            "        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33312, 32) == 0) {\n                ((__local bool *) local_mem_33322)[byte_offsets_33316 +\n                                                   sext_i32_i64(local_tid_33312)] =\n                    x_33351;\n                ((__local\n                  int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33312)] =\n                    x_33352;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33312 == 0) {\n            acc_33356 = ((__local bool *) local_mem_33322)[byte_offsets_33316 +\n                                                           (segscan_group_sizze_31638 -\n                                                            (int64_t) 1)];\n            acc_33357 = ((__local\n                          int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31638 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33356 = ((__local bool *) local_mem_33322)[byte_offsets_33316 +\n                                                           (sext_i32_i64(local_tid_33312) -\n                                                            (int64_t) 1)];\n            acc_33357 = ((__local\n                          int64_t *) local_mem_33322)[squot64(byte_offsets_33317,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33312) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_ME",
            "M_FENCE);\n    }\n    \n    bool prefix_33368;\n    \n    prefix_33368 = 0;\n    \n    int64_t prefix_33369;\n    \n    prefix_33369 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33333 == (int64_t) 0 && local_tid_33312 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_33305)[dynamic_id_33333] = acc_33356;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33309)[dynamic_id_33333] = acc_33357;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33301)[dynamic_id_33333] = (int8_t) 2;\n            acc_33356 = 0;\n            acc_33357 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33333 == (int64_t) 0) && slt32(local_tid_33312,\n                                                        wave_sizze_33314)) {\n            if (local_tid_33312 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_33303)[dynamic_id_33333] = acc_33356;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33307)[dynamic_id_33333] =\n                    acc_33357;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33301)[dynamic_id_33333] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33322)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33301)[dynamic_id_33333 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33370;\n            \n            status_33370 = ((__local int8_t *) local_mem_33322)[(int64_t) 0];\n            if (status_33370 == (int8_t) 2) {\n                if (local_tid_33312 == 0) {\n                    prefix_33368 = ((volatile __global\n                                     bool *) incprefixes_",
            "mem_33305)[dynamic_id_33333 -\n                                                                    (int64_t) 1];\n                    prefix_33369 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33309)[dynamic_id_33333 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33371 = dynamic_id_33333 -\n                        sext_i32_i64(wave_sizze_33314);\n                \n                while (slt32(wave_sizze_33314 * -1, readOffset_33371)) {\n                    int32_t read_i_33372 = readOffset_33371 + local_tid_33312;\n                    bool aggr_33373 = 0;\n                    int64_t aggr_33374 = (int64_t) 0;\n                    int8_t flag_33375 = (int8_t) 0;\n                    int8_t used_33376 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33372)) {\n                        flag_33375 = ((volatile __global\n                                       int8_t *) status_flags_mem_33301)[sext_i32_i64(read_i_33372)];\n                        if (flag_33375 == (int8_t) 2) {\n                            aggr_33373 = ((volatile __global\n                                           bool *) incprefixes_mem_33305)[sext_i32_i64(read_i_33372)];\n                            aggr_33374 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33309)[sext_i32_i64(read_i_33372)];\n                        } else {\n                            if (flag_33375 == (int8_t) 1) {\n                                aggr_33373 = ((volatile __global\n                                               bool *) aggregates_mem_33303)[sext_i32_i64(read_i_33372)];\n                                aggr_33374 = ((volatile __global\n                                               int64_t *) aggregates_mem_33307)[sext_i32_i64(read_i_33372)];\n                                used_33376 = (int8_t) 1;\n                     ",
            "       }\n                        }\n                    }\n                    ((__local bool *) local_mem_33322)[warp_byte_offset_33319 +\n                                                       sext_i32_i64(local_tid_33312)] =\n                        aggr_33373;\n                    ((__local\n                      int64_t *) local_mem_33322)[squot64(warp_byte_offset_33320,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33312)] =\n                        aggr_33374;\n                    \n                    int8_t tmp_33377;\n                    \n                    tmp_33377 = flag_33375 | used_33376 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33322)[sext_i32_i64(local_tid_33312)] =\n                        tmp_33377;\n                    mem_fence_local();\n                    flag_33375 = ((volatile __local\n                                   int8_t *) local_mem_33322)[sext_i32_i64(wave_sizze_33314) -\n                                                              (int64_t) 1];\n                    if (local_tid_33312 == 0) {\n                        if (!(flag_33375 == (int8_t) 2)) {\n                            bool x_33378 = 0;\n                            int64_t x_33379 = (int64_t) 0;\n                            bool x_33380;\n                            int64_t x_33381;\n                            int8_t flag1_33385;\n                            \n                            flag1_33385 = (int8_t) 0;\n                            \n                            int8_t flag2_33386;\n                            int8_t used1_33387;\n                            \n                            used1_33387 = (int8_t) 0;\n                            \n                            int8_t used2_33388;\n                            \n                            for (int32_t i_33389 = 0; i_33389 <\n                                 wave_sizze_33314; i_33389++) {\n   ",
            "                             flag2_33386 = ((__local\n                                                int8_t *) local_mem_33322)[sext_i32_i64(i_33389)];\n                                used2_33388 = lshr8(flag2_33386, (int8_t) 2);\n                                flag2_33386 = flag2_33386 & (int8_t) 3;\n                                x_33380 = ((__local\n                                            bool *) local_mem_33322)[warp_byte_offset_33319 +\n                                                                     sext_i32_i64(i_33389)];\n                                x_33381 = ((__local\n                                            int64_t *) local_mem_33322)[squot64(warp_byte_offset_33320,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33389)];\n                                if (!(flag2_33386 == (int8_t) 1)) {\n                                    flag1_33385 = flag2_33386;\n                                    used1_33387 = used2_33388;\n                                    x_33378 = x_33380;\n                                    x_33379 = x_33381;\n                                } else {\n                                    used1_33387 += used2_33388;\n                                    \n                                    bool defunc_1_op_res_33382;\n                                    \n                                    defunc_1_op_res_33382 = x_33378 || x_33380;\n                                    \n                                    int64_t defunc_1_op_res_33383;\n                                    \n                                    if (x_33380) {\n                                        defunc_1_op_res_33383 = x_33381;\n                                    } else {\n                                        int64_t defunc_1_op_res_33384 =\n                                                add64(x_33379, x_33381);\n                              ",
            "          \n                                        defunc_1_op_res_33383 =\n                                            defunc_1_op_res_33384;\n                                    }\n                                    x_33378 = defunc_1_op_res_33382;\n                                    x_33379 = defunc_1_op_res_33383;\n                                }\n                            }\n                            flag_33375 = flag1_33385;\n                            used_33376 = used1_33387;\n                            aggr_33373 = x_33378;\n                            aggr_33374 = x_33379;\n                        } else {\n                            aggr_33373 = ((__local\n                                           bool *) local_mem_33322)[warp_byte_offset_33319 +\n                                                                    (sext_i32_i64(wave_sizze_33314) -\n                                                                     (int64_t) 1)];\n                            aggr_33374 = ((__local\n                                           int64_t *) local_mem_33322)[squot64(warp_byte_offset_33320,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33314) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33375 == (int8_t) 2) {\n                            readOffset_33371 = wave_sizze_33314 * -1;\n                        } else {\n                            readOffset_33371 -= zext_i8_i32(used_33376);\n                        }\n                        ((__local int32_t *) local_mem_33322)[(int64_t) 0] =\n                            readOffset_33371;\n                        \n                        bool x_33390;\n                        \n                        x_33390 = aggr_33373;\n                        \n                        int64_t x_33391;\n",
            "                        \n                        x_33391 = aggr_33374;\n                        \n                        bool x_33392;\n                        \n                        x_33392 = prefix_33368;\n                        \n                        int64_t x_33393;\n                        \n                        x_33393 = prefix_33369;\n                        \n                        bool defunc_1_op_res_33394;\n                        \n                        defunc_1_op_res_33394 = x_33390 || x_33392;\n                        \n                        int64_t defunc_1_op_res_33395;\n                        \n                        if (x_33392) {\n                            defunc_1_op_res_33395 = x_33393;\n                        } else {\n                            int64_t defunc_1_op_res_33396 = add64(x_33391,\n                                                                  x_33393);\n                            \n                            defunc_1_op_res_33395 = defunc_1_op_res_33396;\n                        }\n                        prefix_33368 = defunc_1_op_res_33394;\n                        prefix_33369 = defunc_1_op_res_33395;\n                    }\n                    mem_fence_local();\n                    readOffset_33371 = ((__local\n                                         int32_t *) local_mem_33322)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33312 == 0) {\n                bool x_33397 = prefix_33368;\n                int64_t x_33398 = prefix_33369;\n                bool x_33399 = acc_33356;\n                int64_t x_33400 = acc_33357;\n                bool defunc_1_op_res_33401 = x_33397 || x_33399;\n                int64_t defunc_1_op_res_33402;\n                \n                if (x_33399) {\n                    defunc_1_op_res_33402 = x_33400;\n                } else {\n                    int64_t defunc_1_op_res_33403 = add64(x_33398, x_33400);\n                    \n                    defunc_1_op_res_33402 = defunc_1_op_res_",
            "33403;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_33305)[dynamic_id_33333] =\n                    defunc_1_op_res_33401;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33309)[dynamic_id_33333] =\n                    defunc_1_op_res_33402;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33301)[dynamic_id_33333] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_33322)[warp_byte_offset_33319] =\n                    prefix_33368;\n                ((__local\n                  int64_t *) local_mem_33322)[squot64(warp_byte_offset_33320,\n                                                      (int64_t) 8)] =\n                    prefix_33369;\n                acc_33356 = 0;\n                acc_33357 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33333 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33368 = ((__local\n                             bool *) local_mem_33322)[warp_byte_offset_33319];\n            prefix_33369 = ((__local\n                             int64_t *) local_mem_33322)[squot64(warp_byte_offset_33320,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_33404;\n        bool x_33406;\n        bool x_33411;\n        \n        x_33411 = prefix_33368;\n        \n        bool x_33413;\n        \n        x_33413 = acc_33356;\n        \n        int64_t x_33405;\n        int64_t x_33407;\n        int64_t x_33412;\n        \n        x_33412 = prefix_33369;\n        \n        int64_t x_33414;\n        \n        x_33414 = acc_33357;\n        \n        bool defunc_1_op_res_33415;\n        \n        defunc_1_op_res_33415 = x_33411 || x_33413;\n        \n        int64_t defunc_1_op_res_33416;\n        \n        if (x_33413) {\n            defunc_1_o",
            "p_res_33416 = x_33414;\n        } else {\n            int64_t defunc_1_op_res_33417 = add64(x_33412, x_33414);\n            \n            defunc_1_op_res_33416 = defunc_1_op_res_33417;\n        }\n        x_33404 = defunc_1_op_res_33415;\n        x_33405 = defunc_1_op_res_33416;\n        for (int64_t i_33418 = 0; i_33418 < (int64_t) 9; i_33418++) {\n            x_33406 = private_mem_33335[i_33418];\n            x_33407 = private_mem_33337[i_33418];\n            \n            bool defunc_1_op_res_33408;\n            \n            defunc_1_op_res_33408 = x_33404 || x_33406;\n            \n            int64_t defunc_1_op_res_33409;\n            \n            if (x_33406) {\n                defunc_1_op_res_33409 = x_33407;\n            } else {\n                int64_t defunc_1_op_res_33410 = add64(x_33405, x_33407);\n                \n                defunc_1_op_res_33409 = defunc_1_op_res_33410;\n            }\n            private_mem_33335[i_33418] = defunc_1_op_res_33408;\n            private_mem_33337[i_33418] = defunc_1_op_res_33409;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33419 = 0; i_33419 < (int64_t) 9; i_33419++) {\n            int64_t sharedIdx_33420 = sext_i32_i64(local_tid_33312 * 9) +\n                    i_33419;\n            \n            ((__local bool *) local_mem_33322)[sharedIdx_33420] =\n                private_mem_33335[i_33419];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33421 = 0; i_33421 < (int64_t) 9; i_33421++) {\n            int32_t sharedIdx_33422 = local_tid_33312 +\n                    sext_i64_i32(segscan_group_sizze_31638 * i_33421);\n            \n            private_mem_33335[i_33421] = ((__local\n                                           bool *) local_mem_33322)[sext_i32_i64(sharedIdx_33422)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33423 = 0; i_33423 < (int64_t) 9; i_33423++) {\n            int64_t sharedIdx_33424 = sext_i32_i64(local_tid_3",
            "3312 * 9) +\n                    i_33423;\n            \n            ((__local int64_t *) local_mem_33322)[sharedIdx_33424] =\n                private_mem_33337[i_33423];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33425 = 0; i_33425 < (int64_t) 9; i_33425++) {\n            int32_t sharedIdx_33426 = local_tid_33312 +\n                    sext_i64_i32(segscan_group_sizze_31638 * i_33425);\n            \n            private_mem_33337[i_33425] = ((__local\n                                           int64_t *) local_mem_33322)[sext_i32_i64(sharedIdx_33426)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33427 = 0; i_33427 < (int64_t) 9; i_33427++) {\n            int64_t gtid_31642 = blockOff_33334 + segscan_group_sizze_31638 *\n                    i_33427 + sext_i32_i64(local_tid_33312);\n            \n            if (slt64(gtid_31642, defunc_2_reduce_res_29982)) {\n                ((__global bool *) mem_32058)[gtid_31642] =\n                    private_mem_33335[i_33427];\n            }\n        }\n        for (int64_t i_33428 = 0; i_33428 < (int64_t) 9; i_33428++) {\n            int64_t gtid_31642 = blockOff_33334 + segscan_group_sizze_31638 *\n                    i_33428 + sext_i32_i64(local_tid_33312);\n            \n            if (slt64(gtid_31642, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32060)[gtid_31642] =\n                    private_mem_33337[i_33428];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33333 == sdiv_up64(defunc_2_reduce_res_29982,\n                                          segscan_group_sizze_31638 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_ballQueryziid_counter_mem_33299)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31638\n}\n__kernel ",
            "void test_ballQueryzisegscan_31669(__global int *global_failure,\n                                            uint local_mem_33460_backing_offset_0,\n                                            int64_t defunc_2_reduce_res_29982,\n                                            __global unsigned char *mem_32063,\n                                            __global unsigned char *mem_32066,\n                                            __global unsigned char *mem_32068,\n                                            __global\n                                            unsigned char *test_ballQueryziid_counter_mem_33437,\n                                            __global\n                                            unsigned char *status_flags_mem_33439,\n                                            __global\n                                            unsigned char *aggregates_mem_33441,\n                                            __global\n                                            unsigned char *incprefixes_mem_33443,\n                                            __global\n                                            unsigned char *aggregates_mem_33445,\n                                            __global\n                                            unsigned char *incprefixes_mem_33447)\n{\n    #define segscan_group_sizze_31664 (test_ballQueryzisegscan_group_sizze_31663)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33460_backing_0 =\n                  &shared_mem[local_mem_33460_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33449;\n    int32_t local_tid_33450;\n    int64_t group_sizze_33453;\n    int32_t wave_sizze_33452;\n    int32_t group_tid_33451;\n    \n    global_tid_33449 = get_global_id(0);\n    local_tid_33450 = get_local_id(0);\n    group_sizze_33453 = get_local_size(0);\n    wave_sizze_33452 = LOCKSTEP_WIDTH;\n    group_tid_33451 = get_group_id(0);\n    \n    i",
            "nt32_t phys_tid_31669;\n    \n    phys_tid_31669 = global_tid_33449;\n    \n    int64_t byte_offsets_33454;\n    \n    byte_offsets_33454 = (int64_t) 0;\n    \n    int64_t byte_offsets_33455;\n    \n    byte_offsets_33455 = segscan_group_sizze_31664;\n    \n    int64_t byte_offsets_33456;\n    \n    byte_offsets_33456 = sdiv_up64(segscan_group_sizze_31664, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31664 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33457;\n    \n    warp_byte_offset_33457 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33458;\n    \n    warp_byte_offset_33458 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_33459;\n    \n    warp_byte_offset_33459 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33460;\n    \n    local_mem_33460 = (__local char *) local_mem_33460_backing_0;\n    \n    int64_t trans_arr_len_33461;\n    \n    trans_arr_len_33461 = (int64_t) 9 * segscan_group_sizze_31664;\n    \n    int32_t dynamic_id_33471;\n    \n    if (local_tid_33450 == 0) {\n        dynamic_id_33471 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_33437)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33460)[(int64_t) 0] = dynamic_id_33471;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33471 = ((__local int32_t *) local_mem_33460)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33472;\n    \n    blockOff_33472 = sext_i32_i64(dynamic_id_33471) * (int64_t) 9 *\n        segscan_group_sizze_31664;\n    \n    bool private_mem_33473[9];\n    int64_t private_mem_33475[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33477 = 0; i_33477 < (int64_t) 9; i_33477++) {\n            int64_t gtid_31668 = blockOff_33472 +\n                    sext_i32_i64(local_tid_33450) + i_33477 *\n                    segscan_group_sizze_31664;\n            \n            if (sl",
            "t64(gtid_31668, defunc_2_reduce_res_29982)) {\n                bool x_30039 = ((__global bool *) mem_32063)[gtid_31668];\n                \n                private_mem_33473[i_33477] = x_30039;\n                private_mem_33475[i_33477] = (int64_t) 1;\n            } else {\n                private_mem_33473[i_33477] = 0;\n                private_mem_33475[i_33477] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33478 = 0; i_33478 < (int64_t) 9; i_33478++) {\n            int64_t sharedIdx_33479 = sext_i32_i64(local_tid_33450) + i_33478 *\n                    segscan_group_sizze_31664;\n            \n            ((__local bool *) local_mem_33460)[sharedIdx_33479] =\n                private_mem_33473[i_33478];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33480 = 0; i_33480 < 9; i_33480++) {\n            int32_t sharedIdx_33481 = local_tid_33450 * 9 + i_33480;\n            \n            private_mem_33473[sext_i32_i64(i_33480)] = ((__local\n                                                         bool *) local_mem_33460)[sext_i32_i64(sharedIdx_33481)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33482 = 0; i_33482 < (int64_t) 9; i_33482++) {\n            int64_t sharedIdx_33483 = sext_i32_i64(local_tid_33450) + i_33482 *\n                    segscan_group_sizze_31664;\n            \n            ((__local int64_t *) local_mem_33460)[sharedIdx_33483] =\n                private_mem_33475[i_33482];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33484 = 0; i_33484 < 9; i_33484++) {\n            int32_t sharedIdx_33485 = local_tid_33450 * 9 + i_33484;\n            \n            private_mem_33475[sext_i32_i64(i_33484)] = ((__local\n                                                         int64_t *) local_mem_33460)[sext_i32_i64(sharedIdx_33485)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n      ",
            "  for (int64_t i_33486 = 0; i_33486 < (int64_t) 8; i_33486++) {\n            bool x_30032;\n            bool x_30034;\n            \n            x_30032 = private_mem_33473[i_33486];\n            x_30034 = private_mem_33473[i_33486 + (int64_t) 1];\n            \n            int64_t x_30033;\n            int64_t x_30035;\n            \n            x_30033 = private_mem_33475[i_33486];\n            x_30035 = private_mem_33475[i_33486 + (int64_t) 1];\n            \n            bool defunc_1_op_res_30036;\n            \n            defunc_1_op_res_30036 = x_30032 || x_30034;\n            \n            int64_t defunc_1_op_res_30037;\n            \n            if (x_30034) {\n                defunc_1_op_res_30037 = x_30035;\n            } else {\n                int64_t defunc_1_op_res_30038 = add64(x_30033, x_30035);\n                \n                defunc_1_op_res_30037 = defunc_1_op_res_30038;\n            }\n            private_mem_33473[i_33486 + (int64_t) 1] = defunc_1_op_res_30036;\n            private_mem_33475[i_33486 + (int64_t) 1] = defunc_1_op_res_30037;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_33460)[byte_offsets_33454 +\n                                           sext_i32_i64(local_tid_33450)] =\n            private_mem_33473[(int64_t) 8];\n        ((__local int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33450)] =\n            private_mem_33475[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_33494;\n    int64_t acc_33495;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_33487;\n        int64_t x_33488;\n        bool x_33489;\n        int64_t x_33490;\n        bool x_33496;\n        int64_t x_33497;\n        bool x_33498;\n        int64_t x_33499;\n        bool ltid_in_bounds_33503;\n        \n        ltid_in_bounds_33503 = slt64(sext_i32_i64(local_tid_3345",
            "0),\n                                     segscan_group_sizze_31664);\n        \n        int32_t skip_threads_33504;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33503) {\n                x_33489 = ((volatile __local\n                            bool *) local_mem_33460)[byte_offsets_33454 +\n                                                     sext_i32_i64(local_tid_33450)];\n                x_33490 = ((volatile __local\n                            int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33450)];\n                if ((local_tid_33450 - squot32(local_tid_33450, 32) * 32) ==\n                    0) {\n                    x_33487 = x_33489;\n                    x_33488 = x_33490;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33504 = 1;\n            while (slt32(skip_threads_33504, 32)) {\n                if (sle32(skip_threads_33504, local_tid_33450 -\n                          squot32(local_tid_33450, 32) * 32) &&\n                    ltid_in_bounds_33503) {\n                    // read operands\n                    {\n                        x_33487 = ((volatile __local\n                                    bool *) local_mem_33460)[byte_offsets_33454 +\n                                                             (sext_i32_i64(local_tid_33450) -\n                                                              sext_i32_i64(skip_threads_33504))];\n                        x_33488 = ((volatile __local\n                                    int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33450) -\n                        ",
            "                                         sext_i32_i64(skip_threads_33504))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_33491 = x_33487 || x_33489;\n                        int64_t defunc_1_op_res_33492;\n                        \n                        if (x_33489) {\n                            defunc_1_op_res_33492 = x_33490;\n                        } else {\n                            int64_t defunc_1_op_res_33493 = add64(x_33488,\n                                                                  x_33490);\n                            \n                            defunc_1_op_res_33492 = defunc_1_op_res_33493;\n                        }\n                        x_33487 = defunc_1_op_res_33491;\n                        x_33488 = defunc_1_op_res_33492;\n                    }\n                }\n                if (sle32(wave_sizze_33452, skip_threads_33504)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33504, local_tid_33450 -\n                          squot32(local_tid_33450, 32) * 32) &&\n                    ltid_in_bounds_33503) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_33460)[byte_offsets_33454 +\n                                                   sext_i32_i64(local_tid_33450)] =\n                            x_33487;\n                        x_33489 = x_33487;\n                        ((volatile __local\n                          int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33450)] =\n                            x_33488;\n                        x_33490 = x_33488;\n                    }\n                }\n                if (sle32(wave_sizze_33452, skip_threads_33504))",
            " {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33504 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33450 - squot32(local_tid_33450, 32) * 32) == 31 &&\n                ltid_in_bounds_33503) {\n                ((volatile __local bool *) local_mem_33460)[byte_offsets_33454 +\n                                                            sext_i32_i64(squot32(local_tid_33450,\n                                                                                 32))] =\n                    x_33487;\n                ((volatile __local\n                  int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33450,\n                                                                   32))] =\n                    x_33488;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33505;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33450, 32) == 0 && ltid_in_bounds_33503) {\n                    x_33498 = ((volatile __local\n                                bool *) local_mem_33460)[byte_offsets_33454 +\n                                                         sext_i32_i64(local_tid_33450)];\n                    x_33499 = ((volatile __local\n                                int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33450)];\n                    if ((local_tid_33450 - squot32(local_tid_33450, 32) * 32) ==\n   ",
            "                     0) {\n                        x_33496 = x_33498;\n                        x_33497 = x_33499;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33505 = 1;\n                while (slt32(skip_threads_33505, 32)) {\n                    if (sle32(skip_threads_33505, local_tid_33450 -\n                              squot32(local_tid_33450, 32) * 32) &&\n                        (squot32(local_tid_33450, 32) == 0 &&\n                         ltid_in_bounds_33503)) {\n                        // read operands\n                        {\n                            x_33496 = ((volatile __local\n                                        bool *) local_mem_33460)[byte_offsets_33454 +\n                                                                 (sext_i32_i64(local_tid_33450) -\n                                                                  sext_i32_i64(skip_threads_33505))];\n                            x_33497 = ((volatile __local\n                                        int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33450) -\n                                                                     sext_i32_i64(skip_threads_33505))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_33500 = x_33496 || x_33498;\n                            int64_t defunc_1_op_res_33501;\n                            \n                            if (x_33498) {\n                                defunc_1_op_res_33501 = x_33499;\n                            } else {\n                                int64_t defunc_1_op_res_33502 = add64(x_33497,\n                                                                      ",
            "x_33499);\n                                \n                                defunc_1_op_res_33501 = defunc_1_op_res_33502;\n                            }\n                            x_33496 = defunc_1_op_res_33500;\n                            x_33497 = defunc_1_op_res_33501;\n                        }\n                    }\n                    if (sle32(wave_sizze_33452, skip_threads_33505)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33505, local_tid_33450 -\n                              squot32(local_tid_33450, 32) * 32) &&\n                        (squot32(local_tid_33450, 32) == 0 &&\n                         ltid_in_bounds_33503)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_33460)[byte_offsets_33454 +\n                                                       sext_i32_i64(local_tid_33450)] =\n                                x_33496;\n                            x_33498 = x_33496;\n                            ((volatile __local\n                              int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33450)] =\n                                x_33497;\n                            x_33499 = x_33497;\n                        }\n                    }\n                    if (sle32(wave_sizze_33452, skip_threads_33505)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33505 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33450, 32) == 0 || !ltid_in_bounds_33503)) {\n                // read operands\n                {\n          ",
            "          x_33489 = x_33487;\n                    x_33490 = x_33488;\n                    x_33487 = ((__local\n                                bool *) local_mem_33460)[byte_offsets_33454 +\n                                                         (sext_i32_i64(squot32(local_tid_33450,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_33488 = ((__local\n                                int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33450,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_33491 = x_33487 || x_33489;\n                    int64_t defunc_1_op_res_33492;\n                    \n                    if (x_33489) {\n                        defunc_1_op_res_33492 = x_33490;\n                    } else {\n                        int64_t defunc_1_op_res_33493 = add64(x_33488, x_33490);\n                        \n                        defunc_1_op_res_33492 = defunc_1_op_res_33493;\n                    }\n                    x_33487 = defunc_1_op_res_33491;\n                    x_33488 = defunc_1_op_res_33492;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_33460)[byte_offsets_33454 +\n                                                       sext_i32_i64(local_tid_33450)] =\n                        x_33487;\n                    ((__local\n                      int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                          (int64_",
            "t) 8) +\n                                                  sext_i32_i64(local_tid_33450)] =\n                        x_33488;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33450, 32) == 0) {\n                ((__local bool *) local_mem_33460)[byte_offsets_33454 +\n                                                   sext_i32_i64(local_tid_33450)] =\n                    x_33489;\n                ((__local\n                  int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33450)] =\n                    x_33490;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33450 == 0) {\n            acc_33494 = ((__local bool *) local_mem_33460)[byte_offsets_33454 +\n                                                           (segscan_group_sizze_31664 -\n                                                            (int64_t) 1)];\n            acc_33495 = ((__local\n                          int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31664 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33494 = ((__local bool *) local_mem_33460)[byte_offsets_33454 +\n                                                           (sext_i32_i64(local_tid_33450) -\n                                                            (int64_t) 1)];\n            acc_33495 = ((__local\n                          int64_t *) local_mem_33460)[squot64(byte_offsets_33455,\n                                                              (int64_t) 8) +\n                                       ",
            "               (sext_i32_i64(local_tid_33450) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_33506;\n    \n    prefix_33506 = 0;\n    \n    int64_t prefix_33507;\n    \n    prefix_33507 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33471 == (int64_t) 0 && local_tid_33450 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_33443)[dynamic_id_33471] = acc_33494;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33447)[dynamic_id_33471] = acc_33495;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33439)[dynamic_id_33471] = (int8_t) 2;\n            acc_33494 = 0;\n            acc_33495 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33471 == (int64_t) 0) && slt32(local_tid_33450,\n                                                        wave_sizze_33452)) {\n            if (local_tid_33450 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_33441)[dynamic_id_33471] = acc_33494;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33445)[dynamic_id_33471] =\n                    acc_33495;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33439)[dynamic_id_33471] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33460)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33439)[dynamic_id_33471 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33508;\n            \n            status_33508 = ((__local int8_t *) local_mem_33460)[(int64_t) 0];\n            if (status_33508 == (int8_t) 2) {\n",
            "                if (local_tid_33450 == 0) {\n                    prefix_33506 = ((volatile __global\n                                     bool *) incprefixes_mem_33443)[dynamic_id_33471 -\n                                                                    (int64_t) 1];\n                    prefix_33507 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33447)[dynamic_id_33471 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33509 = dynamic_id_33471 -\n                        sext_i32_i64(wave_sizze_33452);\n                \n                while (slt32(wave_sizze_33452 * -1, readOffset_33509)) {\n                    int32_t read_i_33510 = readOffset_33509 + local_tid_33450;\n                    bool aggr_33511 = 0;\n                    int64_t aggr_33512 = (int64_t) 0;\n                    int8_t flag_33513 = (int8_t) 0;\n                    int8_t used_33514 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33510)) {\n                        flag_33513 = ((volatile __global\n                                       int8_t *) status_flags_mem_33439)[sext_i32_i64(read_i_33510)];\n                        if (flag_33513 == (int8_t) 2) {\n                            aggr_33511 = ((volatile __global\n                                           bool *) incprefixes_mem_33443)[sext_i32_i64(read_i_33510)];\n                            aggr_33512 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33447)[sext_i32_i64(read_i_33510)];\n                        } else {\n                            if (flag_33513 == (int8_t) 1) {\n                                aggr_33511 = ((volatile __global\n                                               bool *) aggregates_mem_33441)[sext_i32_i64(read_i_33510)];\n                                aggr_33512 = ((volatile __global\n                               ",
            "                int64_t *) aggregates_mem_33445)[sext_i32_i64(read_i_33510)];\n                                used_33514 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_33460)[warp_byte_offset_33457 +\n                                                       sext_i32_i64(local_tid_33450)] =\n                        aggr_33511;\n                    ((__local\n                      int64_t *) local_mem_33460)[squot64(warp_byte_offset_33458,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33450)] =\n                        aggr_33512;\n                    \n                    int8_t tmp_33515;\n                    \n                    tmp_33515 = flag_33513 | used_33514 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33460)[sext_i32_i64(local_tid_33450)] =\n                        tmp_33515;\n                    mem_fence_local();\n                    flag_33513 = ((volatile __local\n                                   int8_t *) local_mem_33460)[sext_i32_i64(wave_sizze_33452) -\n                                                              (int64_t) 1];\n                    if (local_tid_33450 == 0) {\n                        if (!(flag_33513 == (int8_t) 2)) {\n                            bool x_33516 = 0;\n                            int64_t x_33517 = (int64_t) 0;\n                            bool x_33518;\n                            int64_t x_33519;\n                            int8_t flag1_33523;\n                            \n                            flag1_33523 = (int8_t) 0;\n                            \n                            int8_t flag2_33524;\n                            int8_t used1_33525;\n                            \n                            used1_33525 = (int8_t) 0;\n                            \n                            int8_t used2_33526;\n    ",
            "                        \n                            for (int32_t i_33527 = 0; i_33527 <\n                                 wave_sizze_33452; i_33527++) {\n                                flag2_33524 = ((__local\n                                                int8_t *) local_mem_33460)[sext_i32_i64(i_33527)];\n                                used2_33526 = lshr8(flag2_33524, (int8_t) 2);\n                                flag2_33524 = flag2_33524 & (int8_t) 3;\n                                x_33518 = ((__local\n                                            bool *) local_mem_33460)[warp_byte_offset_33457 +\n                                                                     sext_i32_i64(i_33527)];\n                                x_33519 = ((__local\n                                            int64_t *) local_mem_33460)[squot64(warp_byte_offset_33458,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33527)];\n                                if (!(flag2_33524 == (int8_t) 1)) {\n                                    flag1_33523 = flag2_33524;\n                                    used1_33525 = used2_33526;\n                                    x_33516 = x_33518;\n                                    x_33517 = x_33519;\n                                } else {\n                                    used1_33525 += used2_33526;\n                                    \n                                    bool defunc_1_op_res_33520;\n                                    \n                                    defunc_1_op_res_33520 = x_33516 || x_33518;\n                                    \n                                    int64_t defunc_1_op_res_33521;\n                                    \n                                    if (x_33518) {\n                                        defunc_1_op_res_33521 = x_33519;\n                                    } else {\n                   ",
            "                     int64_t defunc_1_op_res_33522 =\n                                                add64(x_33517, x_33519);\n                                        \n                                        defunc_1_op_res_33521 =\n                                            defunc_1_op_res_33522;\n                                    }\n                                    x_33516 = defunc_1_op_res_33520;\n                                    x_33517 = defunc_1_op_res_33521;\n                                }\n                            }\n                            flag_33513 = flag1_33523;\n                            used_33514 = used1_33525;\n                            aggr_33511 = x_33516;\n                            aggr_33512 = x_33517;\n                        } else {\n                            aggr_33511 = ((__local\n                                           bool *) local_mem_33460)[warp_byte_offset_33457 +\n                                                                    (sext_i32_i64(wave_sizze_33452) -\n                                                                     (int64_t) 1)];\n                            aggr_33512 = ((__local\n                                           int64_t *) local_mem_33460)[squot64(warp_byte_offset_33458,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33452) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33513 == (int8_t) 2) {\n                            readOffset_33509 = wave_sizze_33452 * -1;\n                        } else {\n                            readOffset_33509 -= zext_i8_i32(used_33514);\n                        }\n                        ((__local int32_t *) local_mem_33460)[(int64_t) 0] =\n                            readOffset_33509;\n                        \n                   ",
            "     bool x_33528;\n                        \n                        x_33528 = aggr_33511;\n                        \n                        int64_t x_33529;\n                        \n                        x_33529 = aggr_33512;\n                        \n                        bool x_33530;\n                        \n                        x_33530 = prefix_33506;\n                        \n                        int64_t x_33531;\n                        \n                        x_33531 = prefix_33507;\n                        \n                        bool defunc_1_op_res_33532;\n                        \n                        defunc_1_op_res_33532 = x_33528 || x_33530;\n                        \n                        int64_t defunc_1_op_res_33533;\n                        \n                        if (x_33530) {\n                            defunc_1_op_res_33533 = x_33531;\n                        } else {\n                            int64_t defunc_1_op_res_33534 = add64(x_33529,\n                                                                  x_33531);\n                            \n                            defunc_1_op_res_33533 = defunc_1_op_res_33534;\n                        }\n                        prefix_33506 = defunc_1_op_res_33532;\n                        prefix_33507 = defunc_1_op_res_33533;\n                    }\n                    mem_fence_local();\n                    readOffset_33509 = ((__local\n                                         int32_t *) local_mem_33460)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33450 == 0) {\n                bool x_33535 = prefix_33506;\n                int64_t x_33536 = prefix_33507;\n                bool x_33537 = acc_33494;\n                int64_t x_33538 = acc_33495;\n                bool defunc_1_op_res_33539 = x_33535 || x_33537;\n                int64_t defunc_1_op_res_33540;\n                \n                if (x_33537) {\n                    defunc_1_op_res_33540 = x_33538;\n                } else {\n  ",
            "                  int64_t defunc_1_op_res_33541 = add64(x_33536, x_33538);\n                    \n                    defunc_1_op_res_33540 = defunc_1_op_res_33541;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_33443)[dynamic_id_33471] =\n                    defunc_1_op_res_33539;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33447)[dynamic_id_33471] =\n                    defunc_1_op_res_33540;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33439)[dynamic_id_33471] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_33460)[warp_byte_offset_33457] =\n                    prefix_33506;\n                ((__local\n                  int64_t *) local_mem_33460)[squot64(warp_byte_offset_33458,\n                                                      (int64_t) 8)] =\n                    prefix_33507;\n                acc_33494 = 0;\n                acc_33495 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33471 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33506 = ((__local\n                             bool *) local_mem_33460)[warp_byte_offset_33457];\n            prefix_33507 = ((__local\n                             int64_t *) local_mem_33460)[squot64(warp_byte_offset_33458,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_33542;\n        bool x_33544;\n        bool x_33549;\n        \n        x_33549 = prefix_33506;\n        \n        bool x_33551;\n        \n        x_33551 = acc_33494;\n        \n        int64_t x_33543;\n        int64_t x_33545;\n        int64_t x_33550;\n        \n        x_33550 = prefix_33507;\n        \n        int64_t x_33552;\n        \n        x_33552 = acc_33495;\n        \n        bool defunc_1_op_res_33553;\n       ",
            " \n        defunc_1_op_res_33553 = x_33549 || x_33551;\n        \n        int64_t defunc_1_op_res_33554;\n        \n        if (x_33551) {\n            defunc_1_op_res_33554 = x_33552;\n        } else {\n            int64_t defunc_1_op_res_33555 = add64(x_33550, x_33552);\n            \n            defunc_1_op_res_33554 = defunc_1_op_res_33555;\n        }\n        x_33542 = defunc_1_op_res_33553;\n        x_33543 = defunc_1_op_res_33554;\n        for (int64_t i_33556 = 0; i_33556 < (int64_t) 9; i_33556++) {\n            x_33544 = private_mem_33473[i_33556];\n            x_33545 = private_mem_33475[i_33556];\n            \n            bool defunc_1_op_res_33546;\n            \n            defunc_1_op_res_33546 = x_33542 || x_33544;\n            \n            int64_t defunc_1_op_res_33547;\n            \n            if (x_33544) {\n                defunc_1_op_res_33547 = x_33545;\n            } else {\n                int64_t defunc_1_op_res_33548 = add64(x_33543, x_33545);\n                \n                defunc_1_op_res_33547 = defunc_1_op_res_33548;\n            }\n            private_mem_33473[i_33556] = defunc_1_op_res_33546;\n            private_mem_33475[i_33556] = defunc_1_op_res_33547;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33557 = 0; i_33557 < (int64_t) 9; i_33557++) {\n            int64_t sharedIdx_33558 = sext_i32_i64(local_tid_33450 * 9) +\n                    i_33557;\n            \n            ((__local bool *) local_mem_33460)[sharedIdx_33558] =\n                private_mem_33473[i_33557];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33559 = 0; i_33559 < (int64_t) 9; i_33559++) {\n            int32_t sharedIdx_33560 = local_tid_33450 +\n                    sext_i64_i32(segscan_group_sizze_31664 * i_33559);\n            \n            private_mem_33473[i_33559] = ((__local\n                                           bool *) local_mem_33460)[sext_i32_i64(sharedIdx_33560)];\n        }\n        barrie",
            "r(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33561 = 0; i_33561 < (int64_t) 9; i_33561++) {\n            int64_t sharedIdx_33562 = sext_i32_i64(local_tid_33450 * 9) +\n                    i_33561;\n            \n            ((__local int64_t *) local_mem_33460)[sharedIdx_33562] =\n                private_mem_33475[i_33561];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33563 = 0; i_33563 < (int64_t) 9; i_33563++) {\n            int32_t sharedIdx_33564 = local_tid_33450 +\n                    sext_i64_i32(segscan_group_sizze_31664 * i_33563);\n            \n            private_mem_33475[i_33563] = ((__local\n                                           int64_t *) local_mem_33460)[sext_i32_i64(sharedIdx_33564)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33565 = 0; i_33565 < (int64_t) 9; i_33565++) {\n            int64_t gtid_31668 = blockOff_33472 + segscan_group_sizze_31664 *\n                    i_33565 + sext_i32_i64(local_tid_33450);\n            \n            if (slt64(gtid_31668, defunc_2_reduce_res_29982)) {\n                ((__global bool *) mem_32066)[gtid_31668] =\n                    private_mem_33473[i_33565];\n            }\n        }\n        for (int64_t i_33566 = 0; i_33566 < (int64_t) 9; i_33566++) {\n            int64_t gtid_31668 = blockOff_33472 + segscan_group_sizze_31664 *\n                    i_33566 + sext_i32_i64(local_tid_33450);\n            \n            if (slt64(gtid_31668, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32068)[gtid_31668] =\n                    private_mem_33475[i_33566];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33471 == sdiv_up64(defunc_2_reduce_res_29982,\n                                          segscan_group_sizze_31664 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int",
            "32_t *) test_ballQueryziid_counter_mem_33437)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31664\n}\n__kernel void test_ballQueryzisegscan_31829(__global int *global_failure,\n                                            uint local_mem_33615_backing_offset_0,\n                                            int64_t defunc_2_reduce_res_29982,\n                                            int64_t i32_res_30132,\n                                            int64_t i32_res_30133, __global\n                                            unsigned char *mem_param_32080,\n                                            __global unsigned char *mem_32092,\n                                            __global unsigned char *mem_32094,\n                                            __global unsigned char *mem_32096,\n                                            __global unsigned char *mem_32098,\n                                            __global unsigned char *mem_32100,\n                                            __global\n                                            unsigned char *test_ballQueryziid_counter_mem_33580,\n                                            __global\n                                            unsigned char *status_flags_mem_33582,\n                                            __global\n                                            unsigned char *aggregates_mem_33584,\n                                            __global\n                                            unsigned char *incprefixes_mem_33586,\n                                            __global\n                                            unsigned char *aggregates_mem_33588,\n                                            __global\n                                            unsigned char *incprefixes_mem_33590,\n                                            __global\n                                            unsigned char *aggregates_mem_33592,\n                                            _",
            "_global\n                                            unsigned char *incprefixes_mem_33594,\n                                            __global\n                                            unsigned char *aggregates_mem_33596,\n                                            __global\n                                            unsigned char *incprefixes_mem_33598)\n{\n    #define segscan_group_sizze_31824 (test_ballQueryzisegscan_group_sizze_31823)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33615_backing_0 =\n                  &shared_mem[local_mem_33615_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33600;\n    int32_t local_tid_33601;\n    int64_t group_sizze_33604;\n    int32_t wave_sizze_33603;\n    int32_t group_tid_33602;\n    \n    global_tid_33600 = get_global_id(0);\n    local_tid_33601 = get_local_id(0);\n    group_sizze_33604 = get_local_size(0);\n    wave_sizze_33603 = LOCKSTEP_WIDTH;\n    group_tid_33602 = get_group_id(0);\n    \n    int32_t phys_tid_31829;\n    \n    phys_tid_31829 = global_tid_33600;\n    \n    int64_t byte_offsets_33605;\n    \n    byte_offsets_33605 = (int64_t) 0;\n    \n    int64_t byte_offsets_33606;\n    \n    byte_offsets_33606 = segscan_group_sizze_31824 * (int64_t) 8;\n    \n    int64_t byte_offsets_33607;\n    \n    byte_offsets_33607 = sdiv_up64(segscan_group_sizze_31824 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_31824 * (int64_t) 8;\n    \n    int64_t byte_offsets_33608;\n    \n    byte_offsets_33608 = sdiv_up64(sdiv_up64(segscan_group_sizze_31824 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_31824 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_31824 * (int64_t) 8;\n    \n    int64_t byte_offsets_33609;\n    \n    byte_o",
            "ffsets_33609 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_31824 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_31824 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_31824 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31824 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33610;\n    \n    warp_byte_offset_33610 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33611;\n    \n    warp_byte_offset_33611 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_33612;\n    \n    warp_byte_offset_33612 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_33613;\n    \n    warp_byte_offset_33613 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_33614;\n    \n    warp_byte_offset_33614 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33615;\n    \n    local_mem_33615 = (__local char *) local_mem_33615_backing_0;\n    \n    int64_t trans_arr_len_33616;\n    \n    trans_arr_len_33616 = (int64_t) 9 * segscan_group_sizze_31824;\n    \n    int32_t dynamic_id_33632;\n    \n    if (local_tid_33601 == 0) {\n        dynamic_id_33632 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_ballQueryziid_counter_mem_33580)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33615)[(int64_t) 0] = dynamic_id_33632;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33632 = ((__local int32_t *) local_mem_33615)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33633;\n    \n    blockOff_33633 = sext_i32_i64(dynamic_id_33632) * (int64_t) 9 *\n        segscan_group_sizze_31824;\n    \n    int64_t private_mem_33634[9];\n    int64_t private_mem_33636[9];\n    int64_t private_mem_33638[9];\n    int64_t private_mem_33640[9];\n    \n    // Load and map\n    {\n      ",
            "  for (int64_t i_33642 = 0; i_33642 < (int64_t) 9; i_33642++) {\n            int64_t gtid_31828 = blockOff_33633 +\n                    sext_i32_i64(local_tid_33601) + i_33642 *\n                    segscan_group_sizze_31824;\n            \n            if (slt64(gtid_31828, defunc_2_reduce_res_29982)) {\n                int64_t x_30161 = ((__global\n                                    int64_t *) mem_param_32080)[gtid_31828];\n                int64_t zgzg_res_30162 = ashr64(x_30161, i32_res_30132);\n                int64_t za_res_30163 = (int64_t) 1 & zgzg_res_30162;\n                int32_t to_i32_res_30164 = sext_i64_i32(za_res_30163);\n                int32_t x_30165 = mul32(2, to_i32_res_30164);\n                int64_t zgzg_res_30166 = ashr64(x_30161, i32_res_30133);\n                int64_t za_res_30167 = (int64_t) 1 & zgzg_res_30166;\n                int32_t to_i32_res_30168 = sext_i64_i32(za_res_30167);\n                int32_t defunc_0_f_res_30169 = add32(x_30165, to_i32_res_30168);\n                bool cond_30170 = defunc_0_f_res_30169 == 0;\n                int64_t defunc_0_f_res_30171 = btoi_bool_i64(cond_30170);\n                int64_t defunc_0_f_res_30172;\n                int64_t defunc_0_f_res_30173;\n                int64_t defunc_0_f_res_30174;\n                \n                if (cond_30170) {\n                    defunc_0_f_res_30172 = (int64_t) 0;\n                    defunc_0_f_res_30173 = (int64_t) 0;\n                    defunc_0_f_res_30174 = (int64_t) 0;\n                } else {\n                    bool cond_30175 = defunc_0_f_res_30169 == 1;\n                    int64_t defunc_0_f_res_f_res_30176 =\n                            btoi_bool_i64(cond_30175);\n                    int64_t defunc_0_f_res_f_res_30177;\n                    int64_t defunc_0_f_res_f_res_30178;\n                    \n                    if (cond_30175) {\n                        defunc_0_f_res_f_res_30177 = (int64_t) 0;\n                        defunc_0_f_res_f_res_30178 = (int64_t) 0;\n            ",
            "        } else {\n                        bool cond_30179 = defunc_0_f_res_30169 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_30180 =\n                                btoi_bool_i64(cond_30179);\n                        bool cond_neg_30181 = !cond_30179;\n                        int64_t defunc_0_f_res_f_res_f_res_30182 =\n                                btoi_bool_i64(cond_neg_30181);\n                        \n                        defunc_0_f_res_f_res_30177 =\n                            defunc_0_f_res_f_res_f_res_30180;\n                        defunc_0_f_res_f_res_30178 =\n                            defunc_0_f_res_f_res_f_res_30182;\n                    }\n                    defunc_0_f_res_30172 = defunc_0_f_res_f_res_30176;\n                    defunc_0_f_res_30173 = defunc_0_f_res_f_res_30177;\n                    defunc_0_f_res_30174 = defunc_0_f_res_f_res_30178;\n                }\n                ((__global int32_t *) mem_32100)[gtid_31828] =\n                    defunc_0_f_res_30169;\n                private_mem_33634[i_33642] = defunc_0_f_res_30171;\n                private_mem_33636[i_33642] = defunc_0_f_res_30172;\n                private_mem_33638[i_33642] = defunc_0_f_res_30173;\n                private_mem_33640[i_33642] = defunc_0_f_res_30174;\n            } else {\n                private_mem_33634[i_33642] = (int64_t) 0;\n                private_mem_33636[i_33642] = (int64_t) 0;\n                private_mem_33638[i_33642] = (int64_t) 0;\n                private_mem_33640[i_33642] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33643 = 0; i_33643 < (int64_t) 9; i_33643++) {\n            int64_t sharedIdx_33644 = sext_i32_i64(local_tid_33601) + i_33643 *\n                    segscan_group_sizze_31824;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33644] =\n                private_mem_33634[i_33643];\n        }\n        barrier(CLK_LOCAL_MEM",
            "_FENCE);\n        for (int32_t i_33645 = 0; i_33645 < 9; i_33645++) {\n            int32_t sharedIdx_33646 = local_tid_33601 * 9 + i_33645;\n            \n            private_mem_33634[sext_i32_i64(i_33645)] = ((__local\n                                                         int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33646)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33647 = 0; i_33647 < (int64_t) 9; i_33647++) {\n            int64_t sharedIdx_33648 = sext_i32_i64(local_tid_33601) + i_33647 *\n                    segscan_group_sizze_31824;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33648] =\n                private_mem_33636[i_33647];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33649 = 0; i_33649 < 9; i_33649++) {\n            int32_t sharedIdx_33650 = local_tid_33601 * 9 + i_33649;\n            \n            private_mem_33636[sext_i32_i64(i_33649)] = ((__local\n                                                         int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33650)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33651 = 0; i_33651 < (int64_t) 9; i_33651++) {\n            int64_t sharedIdx_33652 = sext_i32_i64(local_tid_33601) + i_33651 *\n                    segscan_group_sizze_31824;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33652] =\n                private_mem_33638[i_33651];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33653 = 0; i_33653 < 9; i_33653++) {\n            int32_t sharedIdx_33654 = local_tid_33601 * 9 + i_33653;\n            \n            private_mem_33638[sext_i32_i64(i_33653)] = ((__local\n                                                         int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33654)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33655 = 0; i_33655 < (int64_t) 9; i_33655++) {\n            int64_t sharedIdx_33656 = sext_i32_i64(local_tid_33",
            "601) + i_33655 *\n                    segscan_group_sizze_31824;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33656] =\n                private_mem_33640[i_33655];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33657 = 0; i_33657 < 9; i_33657++) {\n            int32_t sharedIdx_33658 = local_tid_33601 * 9 + i_33657;\n            \n            private_mem_33640[sext_i32_i64(i_33657)] = ((__local\n                                                         int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33658)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33659 = 0; i_33659 < (int64_t) 8; i_33659++) {\n            int64_t x_30149;\n            int64_t x_30153;\n            \n            x_30149 = private_mem_33634[i_33659];\n            x_30153 = private_mem_33634[i_33659 + (int64_t) 1];\n            \n            int64_t x_30150;\n            int64_t x_30154;\n            \n            x_30150 = private_mem_33636[i_33659];\n            x_30154 = private_mem_33636[i_33659 + (int64_t) 1];\n            \n            int64_t x_30151;\n            int64_t x_30155;\n            \n            x_30151 = private_mem_33638[i_33659];\n            x_30155 = private_mem_33638[i_33659 + (int64_t) 1];\n            \n            int64_t x_30152;\n            int64_t x_30156;\n            \n            x_30152 = private_mem_33640[i_33659];\n            x_30156 = private_mem_33640[i_33659 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_30157;\n            \n            defunc_1_op_res_30157 = add64(x_30149, x_30153);\n            \n            int64_t defunc_1_op_res_30158 = add64(x_30150, x_30154);\n            int64_t defunc_1_op_res_30159 = add64(x_30151, x_30155);\n            int64_t defunc_1_op_res_30160 = add64(x_30152, x_30156);\n            \n            private_mem_33634[i_33659 + (int64_t) 1] = defunc_1_op_res_30157;\n            private_mem_33636[i_33659 + (int64_t) 1] = defunc_1_o",
            "p_res_30158;\n            private_mem_33638[i_33659 + (int64_t) 1] = defunc_1_op_res_30159;\n            private_mem_33640[i_33659 + (int64_t) 1] = defunc_1_op_res_30160;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n            private_mem_33634[(int64_t) 8];\n        ((__local int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n            private_mem_33636[(int64_t) 8];\n        ((__local int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n            private_mem_33638[(int64_t) 8];\n        ((__local int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n            private_mem_33640[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_33672;\n    int64_t acc_33673;\n    int64_t acc_33674;\n    int64_t acc_33675;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_33660;\n        int64_t x_33661;\n        int64_t x_33662;\n        int64_t x_33663;\n        int64_t x_33664;\n        int64_t x_33665;\n        int64_t x_33666;\n        int64_t x_33667;\n        int64_t x_33676;\n        int64_t x_33677;\n        int64_t x_33678;\n        int64_t x_33679;\n        int64_t x_33680;\n        int64_t x_33681;\n        int64_t x_33682;\n        int64_t x_33683;\n        bool ltid_in_bounds_33688;\n        \n        ltid_in_bounds_33688 = slt64(sext_i32_i64(local_tid_33601),\n    ",
            "                                 segscan_group_sizze_31824);\n        \n        int32_t skip_threads_33689;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33688) {\n                x_33664 = ((volatile __local\n                            int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33601)];\n                x_33665 = ((volatile __local\n                            int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33601)];\n                x_33666 = ((volatile __local\n                            int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33601)];\n                x_33667 = ((volatile __local\n                            int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33601)];\n                if ((local_tid_33601 - squot32(local_tid_33601, 32) * 32) ==\n                    0) {\n                    x_33660 = x_33664;\n                    x_33661 = x_33665;\n                    x_33662 = x_33666;\n                    x_33663 = x_33667;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33689 = 1;\n            while (slt32(skip_threads_33689, 32)) {\n                if (sle32(skip_threads_33689, local_tid_33601 -\n                          squot32(local_tid_33601, 32) * 32) &&\n                    ltid_in_b",
            "ounds_33688) {\n                    // read operands\n                    {\n                        x_33660 = ((volatile __local\n                                    int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33601) -\n                                                                 sext_i32_i64(skip_threads_33689))];\n                        x_33661 = ((volatile __local\n                                    int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33601) -\n                                                                 sext_i32_i64(skip_threads_33689))];\n                        x_33662 = ((volatile __local\n                                    int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33601) -\n                                                                 sext_i32_i64(skip_threads_33689))];\n                        x_33663 = ((volatile __local\n                                    int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33601) -\n                                                                 sext_i32_i64(skip_threads_33689))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_33668 = add64(x_33660, x_33664);\n                        int64_t defunc_1",
            "_op_res_33669 = add64(x_33661, x_33665);\n                        int64_t defunc_1_op_res_33670 = add64(x_33662, x_33666);\n                        int64_t defunc_1_op_res_33671 = add64(x_33663, x_33667);\n                        \n                        x_33660 = defunc_1_op_res_33668;\n                        x_33661 = defunc_1_op_res_33669;\n                        x_33662 = defunc_1_op_res_33670;\n                        x_33663 = defunc_1_op_res_33671;\n                    }\n                }\n                if (sle32(wave_sizze_33603, skip_threads_33689)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33689, local_tid_33601 -\n                          squot32(local_tid_33601, 32) * 32) &&\n                    ltid_in_bounds_33688) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33601)] =\n                            x_33660;\n                        x_33664 = x_33660;\n                        ((volatile __local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33601)] =\n                            x_33661;\n                        x_33665 = x_33661;\n                        ((volatile __local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33601)] =\n                            x_33662;\n                        x_33666 = x_33662;\n                        ((volati",
            "le __local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33601)] =\n                            x_33663;\n                        x_33667 = x_33663;\n                    }\n                }\n                if (sle32(wave_sizze_33603, skip_threads_33689)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33689 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33601 - squot32(local_tid_33601, 32) * 32) == 31 &&\n                ltid_in_bounds_33688) {\n                ((volatile __local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33601,\n                                                                   32))] =\n                    x_33660;\n                ((volatile __local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33601,\n                                                                   32))] =\n                    x_33661;\n                ((volatile __local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33601,\n                                                                   32))] =\n                    x_33662;\n                ((volatile __local\n                  int64_t *) local_mem_33615)[squot64(b",
            "yte_offsets_33608,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33601,\n                                                                   32))] =\n                    x_33663;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33690;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33601, 32) == 0 && ltid_in_bounds_33688) {\n                    x_33680 = ((volatile __local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33601)];\n                    x_33681 = ((volatile __local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33601)];\n                    x_33682 = ((volatile __local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33601)];\n                    x_33683 = ((volatile __local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33601)];\n                    if ((local_tid_33601 - squot32(local_tid_33601, 32) * 32) ==\n                        0) {\n            ",
            "            x_33676 = x_33680;\n                        x_33677 = x_33681;\n                        x_33678 = x_33682;\n                        x_33679 = x_33683;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33690 = 1;\n                while (slt32(skip_threads_33690, 32)) {\n                    if (sle32(skip_threads_33690, local_tid_33601 -\n                              squot32(local_tid_33601, 32) * 32) &&\n                        (squot32(local_tid_33601, 32) == 0 &&\n                         ltid_in_bounds_33688)) {\n                        // read operands\n                        {\n                            x_33676 = ((volatile __local\n                                        int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33601) -\n                                                                     sext_i32_i64(skip_threads_33690))];\n                            x_33677 = ((volatile __local\n                                        int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33601) -\n                                                                     sext_i32_i64(skip_threads_33690))];\n                            x_33678 = ((volatile __local\n                                        int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33601) -\n                                                        ",
            "             sext_i32_i64(skip_threads_33690))];\n                            x_33679 = ((volatile __local\n                                        int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33601) -\n                                                                     sext_i32_i64(skip_threads_33690))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_33684 = add64(x_33676,\n                                                                  x_33680);\n                            int64_t defunc_1_op_res_33685 = add64(x_33677,\n                                                                  x_33681);\n                            int64_t defunc_1_op_res_33686 = add64(x_33678,\n                                                                  x_33682);\n                            int64_t defunc_1_op_res_33687 = add64(x_33679,\n                                                                  x_33683);\n                            \n                            x_33676 = defunc_1_op_res_33684;\n                            x_33677 = defunc_1_op_res_33685;\n                            x_33678 = defunc_1_op_res_33686;\n                            x_33679 = defunc_1_op_res_33687;\n                        }\n                    }\n                    if (sle32(wave_sizze_33603, skip_threads_33690)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33690, local_tid_33601 -\n                              squot32(local_tid_33601, 32) * 32) &&\n                        (squot32(local_tid_33601, 32) == 0 &&\n                         ltid_in_bounds_33688)) {\n                        // write result\n                        {\n                  ",
            "          ((volatile __local\n                              int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33601)] =\n                                x_33676;\n                            x_33680 = x_33676;\n                            ((volatile __local\n                              int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33601)] =\n                                x_33677;\n                            x_33681 = x_33677;\n                            ((volatile __local\n                              int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33601)] =\n                                x_33678;\n                            x_33682 = x_33678;\n                            ((volatile __local\n                              int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33601)] =\n                                x_33679;\n                            x_33683 = x_33679;\n                        }\n                    }\n                    if (sle32(wave_sizze_33603, skip_threads_33690)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33690 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33601, 32) == 0 || !ltid_in",
            "_bounds_33688)) {\n                // read operands\n                {\n                    x_33664 = x_33660;\n                    x_33665 = x_33661;\n                    x_33666 = x_33662;\n                    x_33667 = x_33663;\n                    x_33660 = ((__local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33601,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_33661 = ((__local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33601,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_33662 = ((__local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33601,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_33663 = ((__local\n                                int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33601,\n                                        ",
            "                                          32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_33668 = add64(x_33660, x_33664);\n                    int64_t defunc_1_op_res_33669 = add64(x_33661, x_33665);\n                    int64_t defunc_1_op_res_33670 = add64(x_33662, x_33666);\n                    int64_t defunc_1_op_res_33671 = add64(x_33663, x_33667);\n                    \n                    x_33660 = defunc_1_op_res_33668;\n                    x_33661 = defunc_1_op_res_33669;\n                    x_33662 = defunc_1_op_res_33670;\n                    x_33663 = defunc_1_op_res_33671;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        x_33660;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        x_33661;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        x_33662;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        x_33663;",
            "\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33601, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n                    x_33664;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n                    x_33665;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n                    x_33666;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33601)] =\n                    x_33667;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33601 == 0) {\n            acc_33672 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31824 -\n                                                       (int64_t) 1)];\n            acc_33673 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                              (int64_t) 8) +\n                       ",
            "                               (segscan_group_sizze_31824 -\n                                                       (int64_t) 1)];\n            acc_33674 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31824 -\n                                                       (int64_t) 1)];\n            acc_33675 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33608,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31824 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33672 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33605,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33601) -\n                                                       (int64_t) 1)];\n            acc_33673 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33606,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33601) -\n                                                       (int64_t) 1)];\n            acc_33674 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33607,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33601) -\n                                                       (int64_t) 1)];\n            acc_33675 = ((__local\n                          int64_t *) local_mem_33615)[squot64(byte_offsets_33",
            "608,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33601) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_33691;\n    \n    prefix_33691 = (int64_t) 0;\n    \n    int64_t prefix_33692;\n    \n    prefix_33692 = (int64_t) 0;\n    \n    int64_t prefix_33693;\n    \n    prefix_33693 = (int64_t) 0;\n    \n    int64_t prefix_33694;\n    \n    prefix_33694 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33632 == (int64_t) 0 && local_tid_33601 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_33586)[dynamic_id_33632] = acc_33672;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33590)[dynamic_id_33632] = acc_33673;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33594)[dynamic_id_33632] = acc_33674;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33598)[dynamic_id_33632] = acc_33675;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33582)[dynamic_id_33632] = (int8_t) 2;\n            acc_33672 = (int64_t) 0;\n            acc_33673 = (int64_t) 0;\n            acc_33674 = (int64_t) 0;\n            acc_33675 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33632 == (int64_t) 0) && slt32(local_tid_33601,\n                                                        wave_sizze_33603)) {\n            if (local_tid_33601 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_33584)[dynamic_id_33632] =\n                    acc_33672;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33588)[dynamic_id_33632] =\n                    acc_33673;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33592)[dynamic_id_33632] =\n               ",
            "     acc_33674;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33596)[dynamic_id_33632] =\n                    acc_33675;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33582)[dynamic_id_33632] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33615)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33582)[dynamic_id_33632 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33695;\n            \n            status_33695 = ((__local int8_t *) local_mem_33615)[(int64_t) 0];\n            if (status_33695 == (int8_t) 2) {\n                if (local_tid_33601 == 0) {\n                    prefix_33691 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33586)[dynamic_id_33632 -\n                                                                       (int64_t) 1];\n                    prefix_33692 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33590)[dynamic_id_33632 -\n                                                                       (int64_t) 1];\n                    prefix_33693 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33594)[dynamic_id_33632 -\n                                                                       (int64_t) 1];\n                    prefix_33694 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33598)[dynamic_id_33632 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33696 = dynamic_id_33632 -\n                        sext_i32_i64(wave_sizze_33603);\n ",
            "               \n                while (slt32(wave_sizze_33603 * -1, readOffset_33696)) {\n                    int32_t read_i_33697 = readOffset_33696 + local_tid_33601;\n                    int64_t aggr_33698 = (int64_t) 0;\n                    int64_t aggr_33699 = (int64_t) 0;\n                    int64_t aggr_33700 = (int64_t) 0;\n                    int64_t aggr_33701 = (int64_t) 0;\n                    int8_t flag_33702 = (int8_t) 0;\n                    int8_t used_33703 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33697)) {\n                        flag_33702 = ((volatile __global\n                                       int8_t *) status_flags_mem_33582)[sext_i32_i64(read_i_33697)];\n                        if (flag_33702 == (int8_t) 2) {\n                            aggr_33698 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33586)[sext_i32_i64(read_i_33697)];\n                            aggr_33699 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33590)[sext_i32_i64(read_i_33697)];\n                            aggr_33700 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33594)[sext_i32_i64(read_i_33697)];\n                            aggr_33701 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33598)[sext_i32_i64(read_i_33697)];\n                        } else {\n                            if (flag_33702 == (int8_t) 1) {\n                                aggr_33698 = ((volatile __global\n                                               int64_t *) aggregates_mem_33584)[sext_i32_i64(read_i_33697)];\n                                aggr_33699 = ((volatile __global\n                                               int64_t *) aggregates_mem_33588)[sext_i32_i64(read_i_33697)];\n                                aggr_33700 = ((volatile __global\n                                               int64",
            "_t *) aggregates_mem_33592)[sext_i32_i64(read_i_33697)];\n                                aggr_33701 = ((volatile __global\n                                               int64_t *) aggregates_mem_33596)[sext_i32_i64(read_i_33697)];\n                                used_33703 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(warp_byte_offset_33610,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        aggr_33698;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(warp_byte_offset_33611,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        aggr_33699;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(warp_byte_offset_33612,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        aggr_33700;\n                    ((__local\n                      int64_t *) local_mem_33615)[squot64(warp_byte_offset_33613,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33601)] =\n                        aggr_33701;\n                    \n                    int8_t tmp_33704;\n                    \n                    tmp_33704 = flag_33702 | used_33703 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33615)[sext_i32_i64(local_tid_33601)] =\n                        tmp_33704;\n                    mem_fence_local();\n                    flag_33702 = ((volatile __local\n                             ",
            "      int8_t *) local_mem_33615)[sext_i32_i64(wave_sizze_33603) -\n                                                              (int64_t) 1];\n                    if (local_tid_33601 == 0) {\n                        if (!(flag_33702 == (int8_t) 2)) {\n                            int64_t x_33705 = (int64_t) 0;\n                            int64_t x_33706 = (int64_t) 0;\n                            int64_t x_33707 = (int64_t) 0;\n                            int64_t x_33708 = (int64_t) 0;\n                            int64_t x_33709;\n                            int64_t x_33710;\n                            int64_t x_33711;\n                            int64_t x_33712;\n                            int8_t flag1_33717;\n                            \n                            flag1_33717 = (int8_t) 0;\n                            \n                            int8_t flag2_33718;\n                            int8_t used1_33719;\n                            \n                            used1_33719 = (int8_t) 0;\n                            \n                            int8_t used2_33720;\n                            \n                            for (int32_t i_33721 = 0; i_33721 <\n                                 wave_sizze_33603; i_33721++) {\n                                flag2_33718 = ((__local\n                                                int8_t *) local_mem_33615)[sext_i32_i64(i_33721)];\n                                used2_33720 = lshr8(flag2_33718, (int8_t) 2);\n                                flag2_33718 = flag2_33718 & (int8_t) 3;\n                                x_33709 = ((__local\n                                            int64_t *) local_mem_33615)[squot64(warp_byte_offset_33610,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33721)];\n                                x_33710 = ((__local\n                                            int64_t *) loc",
            "al_mem_33615)[squot64(warp_byte_offset_33611,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33721)];\n                                x_33711 = ((__local\n                                            int64_t *) local_mem_33615)[squot64(warp_byte_offset_33612,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33721)];\n                                x_33712 = ((__local\n                                            int64_t *) local_mem_33615)[squot64(warp_byte_offset_33613,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33721)];\n                                if (!(flag2_33718 == (int8_t) 1)) {\n                                    flag1_33717 = flag2_33718;\n                                    used1_33719 = used2_33720;\n                                    x_33705 = x_33709;\n                                    x_33706 = x_33710;\n                                    x_33707 = x_33711;\n                                    x_33708 = x_33712;\n                                } else {\n                                    used1_33719 += used2_33720;\n                                    \n                                    int64_t defunc_1_op_res_33713;\n                                    \n                                    defunc_1_op_res_33713 = add64(x_33705,\n                                                                  x_33709);\n                                    \n                                    int64_t defunc_1_op_res_33714 =\n                                            add64(x_33706, x_33710);\n                                    int64_t defunc_1_op_res_33715 =\n                ",
            "                            add64(x_33707, x_33711);\n                                    int64_t defunc_1_op_res_33716 =\n                                            add64(x_33708, x_33712);\n                                    \n                                    x_33705 = defunc_1_op_res_33713;\n                                    x_33706 = defunc_1_op_res_33714;\n                                    x_33707 = defunc_1_op_res_33715;\n                                    x_33708 = defunc_1_op_res_33716;\n                                }\n                            }\n                            flag_33702 = flag1_33717;\n                            used_33703 = used1_33719;\n                            aggr_33698 = x_33705;\n                            aggr_33699 = x_33706;\n                            aggr_33700 = x_33707;\n                            aggr_33701 = x_33708;\n                        } else {\n                            aggr_33698 = ((__local\n                                           int64_t *) local_mem_33615)[squot64(warp_byte_offset_33610,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33603) -\n                                                                        (int64_t) 1)];\n                            aggr_33699 = ((__local\n                                           int64_t *) local_mem_33615)[squot64(warp_byte_offset_33611,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33603) -\n                                                                        (int64_t) 1)];\n                            aggr_33700 = ((__local\n                                           int64_t *) local_mem_33615)[squot64(warp_byte_offset_33612,\n                                                          ",
            "                     (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33603) -\n                                                                        (int64_t) 1)];\n                            aggr_33701 = ((__local\n                                           int64_t *) local_mem_33615)[squot64(warp_byte_offset_33613,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33603) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33702 == (int8_t) 2) {\n                            readOffset_33696 = wave_sizze_33603 * -1;\n                        } else {\n                            readOffset_33696 -= zext_i8_i32(used_33703);\n                        }\n                        ((__local int32_t *) local_mem_33615)[(int64_t) 0] =\n                            readOffset_33696;\n                        \n                        int64_t x_33722;\n                        \n                        x_33722 = aggr_33698;\n                        \n                        int64_t x_33723;\n                        \n                        x_33723 = aggr_33699;\n                        \n                        int64_t x_33724;\n                        \n                        x_33724 = aggr_33700;\n                        \n                        int64_t x_33725;\n                        \n                        x_33725 = aggr_33701;\n                        \n                        int64_t x_33726;\n                        \n                        x_33726 = prefix_33691;\n                        \n                        int64_t x_33727;\n                        \n                        x_33727 = prefix_33692;\n                        \n                        int64_t x_33728;\n                        \n        ",
            "                x_33728 = prefix_33693;\n                        \n                        int64_t x_33729;\n                        \n                        x_33729 = prefix_33694;\n                        \n                        int64_t defunc_1_op_res_33730;\n                        \n                        defunc_1_op_res_33730 = add64(x_33722, x_33726);\n                        \n                        int64_t defunc_1_op_res_33731 = add64(x_33723, x_33727);\n                        int64_t defunc_1_op_res_33732 = add64(x_33724, x_33728);\n                        int64_t defunc_1_op_res_33733 = add64(x_33725, x_33729);\n                        \n                        prefix_33691 = defunc_1_op_res_33730;\n                        prefix_33692 = defunc_1_op_res_33731;\n                        prefix_33693 = defunc_1_op_res_33732;\n                        prefix_33694 = defunc_1_op_res_33733;\n                    }\n                    mem_fence_local();\n                    readOffset_33696 = ((__local\n                                         int32_t *) local_mem_33615)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33601 == 0) {\n                int64_t x_33734 = prefix_33691;\n                int64_t x_33735 = prefix_33692;\n                int64_t x_33736 = prefix_33693;\n                int64_t x_33737 = prefix_33694;\n                int64_t x_33738 = acc_33672;\n                int64_t x_33739 = acc_33673;\n                int64_t x_33740 = acc_33674;\n                int64_t x_33741 = acc_33675;\n                int64_t defunc_1_op_res_33742 = add64(x_33734, x_33738);\n                int64_t defunc_1_op_res_33743 = add64(x_33735, x_33739);\n                int64_t defunc_1_op_res_33744 = add64(x_33736, x_33740);\n                int64_t defunc_1_op_res_33745 = add64(x_33737, x_33741);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_33586)[dynamic_id_33632] =\n                    defunc_1_op_res_33742;\n     ",
            "           ((volatile __global\n                  int64_t *) incprefixes_mem_33590)[dynamic_id_33632] =\n                    defunc_1_op_res_33743;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33594)[dynamic_id_33632] =\n                    defunc_1_op_res_33744;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33598)[dynamic_id_33632] =\n                    defunc_1_op_res_33745;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33582)[dynamic_id_33632] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(warp_byte_offset_33610,\n                                                      (int64_t) 8)] =\n                    prefix_33691;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(warp_byte_offset_33611,\n                                                      (int64_t) 8)] =\n                    prefix_33692;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(warp_byte_offset_33612,\n                                                      (int64_t) 8)] =\n                    prefix_33693;\n                ((__local\n                  int64_t *) local_mem_33615)[squot64(warp_byte_offset_33613,\n                                                      (int64_t) 8)] =\n                    prefix_33694;\n                acc_33672 = (int64_t) 0;\n                acc_33673 = (int64_t) 0;\n                acc_33674 = (int64_t) 0;\n                acc_33675 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33632 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33691 = ((__local\n                             int64_t *) local_mem_33615)[squot64(warp_byte_offset_33610,\n                                                                 (int64_t) 8)];\n            prefix_33692 = ((__local\n                     ",
            "        int64_t *) local_mem_33615)[squot64(warp_byte_offset_33611,\n                                                                 (int64_t) 8)];\n            prefix_33693 = ((__local\n                             int64_t *) local_mem_33615)[squot64(warp_byte_offset_33612,\n                                                                 (int64_t) 8)];\n            prefix_33694 = ((__local\n                             int64_t *) local_mem_33615)[squot64(warp_byte_offset_33613,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33746;\n        int64_t x_33750;\n        int64_t x_33758;\n        \n        x_33758 = prefix_33691;\n        \n        int64_t x_33762;\n        \n        x_33762 = acc_33672;\n        \n        int64_t x_33747;\n        int64_t x_33751;\n        int64_t x_33759;\n        \n        x_33759 = prefix_33692;\n        \n        int64_t x_33763;\n        \n        x_33763 = acc_33673;\n        \n        int64_t x_33748;\n        int64_t x_33752;\n        int64_t x_33760;\n        \n        x_33760 = prefix_33693;\n        \n        int64_t x_33764;\n        \n        x_33764 = acc_33674;\n        \n        int64_t x_33749;\n        int64_t x_33753;\n        int64_t x_33761;\n        \n        x_33761 = prefix_33694;\n        \n        int64_t x_33765;\n        \n        x_33765 = acc_33675;\n        \n        int64_t defunc_1_op_res_33766;\n        \n        defunc_1_op_res_33766 = add64(x_33758, x_33762);\n        \n        int64_t defunc_1_op_res_33767 = add64(x_33759, x_33763);\n        int64_t defunc_1_op_res_33768 = add64(x_33760, x_33764);\n        int64_t defunc_1_op_res_33769 = add64(x_33761, x_33765);\n        \n        x_33746 = defunc_1_op_res_33766;\n        x_33747 = defunc_1_op_res_33767;\n        x_33748 = defunc_1_op_res_33768;\n        x_33749 = defunc_1_op_res_33769;\n        for (int64_t i_33770 = 0; i_33770 < (int64_t) 9; i_33770++) {\n          ",
            "  x_33750 = private_mem_33634[i_33770];\n            x_33751 = private_mem_33636[i_33770];\n            x_33752 = private_mem_33638[i_33770];\n            x_33753 = private_mem_33640[i_33770];\n            \n            int64_t defunc_1_op_res_33754;\n            \n            defunc_1_op_res_33754 = add64(x_33746, x_33750);\n            \n            int64_t defunc_1_op_res_33755 = add64(x_33747, x_33751);\n            int64_t defunc_1_op_res_33756 = add64(x_33748, x_33752);\n            int64_t defunc_1_op_res_33757 = add64(x_33749, x_33753);\n            \n            private_mem_33634[i_33770] = defunc_1_op_res_33754;\n            private_mem_33636[i_33770] = defunc_1_op_res_33755;\n            private_mem_33638[i_33770] = defunc_1_op_res_33756;\n            private_mem_33640[i_33770] = defunc_1_op_res_33757;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33771 = 0; i_33771 < (int64_t) 9; i_33771++) {\n            int64_t sharedIdx_33772 = sext_i32_i64(local_tid_33601 * 9) +\n                    i_33771;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33772] =\n                private_mem_33634[i_33771];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33773 = 0; i_33773 < (int64_t) 9; i_33773++) {\n            int32_t sharedIdx_33774 = local_tid_33601 +\n                    sext_i64_i32(segscan_group_sizze_31824 * i_33773);\n            \n            private_mem_33634[i_33773] = ((__local\n                                           int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33774)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33775 = 0; i_33775 < (int64_t) 9; i_33775++) {\n            int64_t sharedIdx_33776 = sext_i32_i64(local_tid_33601 * 9) +\n                    i_33775;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33776] =\n                private_mem_33636[i_33775];\n        }\n        barrier(CLK_LOCAL_MEM_FENC",
            "E);\n        for (int64_t i_33777 = 0; i_33777 < (int64_t) 9; i_33777++) {\n            int32_t sharedIdx_33778 = local_tid_33601 +\n                    sext_i64_i32(segscan_group_sizze_31824 * i_33777);\n            \n            private_mem_33636[i_33777] = ((__local\n                                           int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33778)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33779 = 0; i_33779 < (int64_t) 9; i_33779++) {\n            int64_t sharedIdx_33780 = sext_i32_i64(local_tid_33601 * 9) +\n                    i_33779;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33780] =\n                private_mem_33638[i_33779];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33781 = 0; i_33781 < (int64_t) 9; i_33781++) {\n            int32_t sharedIdx_33782 = local_tid_33601 +\n                    sext_i64_i32(segscan_group_sizze_31824 * i_33781);\n            \n            private_mem_33638[i_33781] = ((__local\n                                           int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33782)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33783 = 0; i_33783 < (int64_t) 9; i_33783++) {\n            int64_t sharedIdx_33784 = sext_i32_i64(local_tid_33601 * 9) +\n                    i_33783;\n            \n            ((__local int64_t *) local_mem_33615)[sharedIdx_33784] =\n                private_mem_33640[i_33783];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33785 = 0; i_33785 < (int64_t) 9; i_33785++) {\n            int32_t sharedIdx_33786 = local_tid_33601 +\n                    sext_i64_i32(segscan_group_sizze_31824 * i_33785);\n            \n            private_mem_33640[i_33785] = ((__local\n                                           int64_t *) local_mem_33615)[sext_i32_i64(sharedIdx_33786)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n     ",
            "   for (int64_t i_33787 = 0; i_33787 < (int64_t) 9; i_33787++) {\n            int64_t gtid_31828 = blockOff_33633 + segscan_group_sizze_31824 *\n                    i_33787 + sext_i32_i64(local_tid_33601);\n            \n            if (slt64(gtid_31828, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32092)[gtid_31828] =\n                    private_mem_33634[i_33787];\n            }\n        }\n        for (int64_t i_33788 = 0; i_33788 < (int64_t) 9; i_33788++) {\n            int64_t gtid_31828 = blockOff_33633 + segscan_group_sizze_31824 *\n                    i_33788 + sext_i32_i64(local_tid_33601);\n            \n            if (slt64(gtid_31828, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32094)[gtid_31828] =\n                    private_mem_33636[i_33788];\n            }\n        }\n        for (int64_t i_33789 = 0; i_33789 < (int64_t) 9; i_33789++) {\n            int64_t gtid_31828 = blockOff_33633 + segscan_group_sizze_31824 *\n                    i_33789 + sext_i32_i64(local_tid_33601);\n            \n            if (slt64(gtid_31828, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32096)[gtid_31828] =\n                    private_mem_33638[i_33789];\n            }\n        }\n        for (int64_t i_33790 = 0; i_33790 < (int64_t) 9; i_33790++) {\n            int64_t gtid_31828 = blockOff_33633 + segscan_group_sizze_31824 *\n                    i_33790 + sext_i32_i64(local_tid_33601);\n            \n            if (slt64(gtid_31828, defunc_2_reduce_res_29982)) {\n                ((__global int64_t *) mem_32098)[gtid_31828] =\n                    private_mem_33640[i_33790];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33632 == sdiv_up64(defunc_2_reduce_res_29982,\n                                          segscan_group_sizze_31824 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t",
            " *) test_ballQueryziid_counter_mem_33580)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31824\n}\n__kernel void test_clusterWithzicopy_33013(int64_t num_segments_29050, __global\n                                           unsigned char *mem_32022, __global\n                                           unsigned char *mem_32024)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_33013;\n    int32_t copy_ltid_33014;\n    int32_t copy_gid_33015;\n    \n    copy_gtid_33013 = get_global_id(0);\n    copy_ltid_33014 = get_local_id(0);\n    copy_gid_33015 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_33013), num_segments_29050)) {\n        ((__global int64_t *) mem_32024)[sext_i32_i64(copy_gtid_33013)] =\n            ((__global\n              int64_t *) mem_32022)[smod64(sext_i32_i64(copy_gtid_33013) +\n                                           (int64_t) -1, num_segments_29050)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_clusterWithzicopy_34206(int64_t num_segments_29432, __global\n                                           unsigned char *mem_32190, __global\n                                           unsigned char *mem_32192)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_34206;\n    int32_t copy_ltid_34207;\n    int32_t copy_gid_34208;\n    \n    copy_gtid_34206 = get_global_id(0);\n    copy_ltid_34207 = get_local_id(0);\n    copy_gid_34208 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_34206), num_segments_29432)) {\n        ((__global int64_t *) mem_32192)[sext_i32_i64(copy_gtid_34206)] =\n            ((__global\n              int64_t *) mem_32190)[smod64(sext_i32_i64(copy_gtid_34206) +\n                                           (int64_t) -1, num_segments_29432)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_clusterWithzicopy_34523(int64_t num_segments_29493, __global\n             ",
            "                              unsigned char *mem_32216, __global\n                                           unsigned char *mem_32218)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_34523;\n    int32_t copy_ltid_34524;\n    int32_t copy_gid_34525;\n    \n    copy_gtid_34523 = get_global_id(0);\n    copy_ltid_34524 = get_local_id(0);\n    copy_gid_34525 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_34523), num_segments_29493)) {\n        ((__global int64_t *) mem_32218)[sext_i32_i64(copy_gtid_34523)] =\n            ((__global\n              int64_t *) mem_32216)[smod64(sext_i32_i64(copy_gtid_34523) +\n                                           (int64_t) -1, num_segments_29493)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_clusterWithzicopy_35217(int64_t partition_sizze_29591,\n                                           __global unsigned char *mem_32309,\n                                           __global unsigned char *mem_32311)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_35217;\n    int32_t copy_ltid_35218;\n    int32_t copy_gid_35219;\n    \n    copy_gtid_35217 = get_global_id(0);\n    copy_ltid_35218 = get_local_id(0);\n    copy_gid_35219 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_35217), partition_sizze_29591)) {\n        ((__global int64_t *) mem_32311)[sext_i32_i64(copy_gtid_35217)] =\n            ((__global\n              int64_t *) mem_32309)[smod64(sext_i32_i64(copy_gtid_35217) +\n                                           (int64_t) -1,\n                                           partition_sizze_29591)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_clusterWithziseghist_global_30660(__global\n                                                     int *global_failure,\n                                                     int64_t numVert_28890,\n                                                     int64_t defu",
            "nc_2_reduce_res_29171,\n                                                     int64_t num_groups_30657,\n                                                     int32_t num_subhistos_33260,\n                                                     int32_t chk_i_33327,\n                                                     int64_t hist_H_chk_33328,\n                                                     __global\n                                                     unsigned char *mem_32093,\n                                                     __global\n                                                     unsigned char *defunc_1_map_res_subhistos_mem_33261)\n{\n    #define seghist_group_sizze_30655 (test_clusterWithziseghist_group_sizze_30654)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33329;\n    int32_t local_tid_33330;\n    int64_t group_sizze_33333;\n    int32_t wave_sizze_33332;\n    int32_t group_tid_33331;\n    \n    global_tid_33329 = get_global_id(0);\n    local_tid_33330 = get_local_id(0);\n    group_sizze_33333 = get_local_size(0);\n    wave_sizze_33332 = LOCKSTEP_WIDTH;\n    group_tid_33331 = get_group_id(0);\n    \n    int32_t phys_tid_30660;\n    \n    phys_tid_30660 = global_tid_33329;\n    \n    int32_t subhisto_ind_33334;\n    \n    subhisto_ind_33334 = squot32(global_tid_33329,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_30655 *\n                                           num_groups_30657),\n                                           num_subhistos_33260));\n    for (int64_t i_33335 = 0; i_33335 < sdiv_up64(numVert_28890 -\n                                                  sext_i32_i64(global_tid_33329),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_30655 *\n                                                  num_groups_30657)));\n         i_33335++) {\n        int32_t gtid_30659 = sext_i",
            "64_i32(i_33335 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_30655 *\n                num_groups_30657)) + sext_i32_i64(global_tid_33329));\n        \n        if (slt64(i_33335 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_30655 *\n                  num_groups_30657)) + sext_i32_i64(global_tid_33329),\n                  numVert_28890)) {\n            int64_t i_p_o_31864 = add64((int64_t) -1, gtid_30659);\n            int64_t rot_i_31865 = smod64(i_p_o_31864, numVert_28890);\n            bool cond_30666 = gtid_30659 == (int64_t) 0;\n            int64_t defunc_1_f_res_30667;\n            \n            if (cond_30666) {\n                defunc_1_f_res_30667 = (int64_t) 0;\n            } else {\n                int64_t x_30665 = ((__global int64_t *) mem_32093)[rot_i_31865];\n                \n                defunc_1_f_res_30667 = x_30665;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_33327) * hist_H_chk_33328,\n                          defunc_1_f_res_30667) && (slt64(defunc_1_f_res_30667,\n                                                          sext_i32_i64(chk_i_33327) *\n                                                          hist_H_chk_33328 +\n                                                          hist_H_chk_33328) &&\n                                                    slt64(defunc_1_f_res_30667,\n                                                          defunc_2_reduce_res_29171))) {\n                    int64_t x_30661;\n                    int64_t x_30662;\n                    \n                    x_30662 = gtid_30659;\n                    \n                    int64_t old_33336;\n                    \n                    old_33336 = atomic_smax_i64_global(&((volatile __global\n                                                          int64_t *) defunc_1_map_res_subhistos_mem_33261)[sext_i32_i64(subhisto_ind_33334) *\n            ",
            "                                                                                               defunc_2_reduce_res_29171 +\n                                                                                                           defunc_1_f_res_30667],\n                                                       (int64_t) x_30662);\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_30655\n}\n__kernel void test_clusterWithziseghist_global_31051(__global\n                                                     int *global_failure,\n                                                     int64_t partition_sizze_29591,\n                                                     int64_t defunc_2_reduce_res_29634,\n                                                     int64_t num_groups_31048,\n                                                     int32_t num_subhistos_34857,\n                                                     int32_t chk_i_34924,\n                                                     int64_t hist_H_chk_34925,\n                                                     __global\n                                                     unsigned char *mem_32290,\n                                                     __global\n                                                     unsigned char *defunc_1_map_res_subhistos_mem_34858)\n{\n    #define seghist_group_sizze_31046 (test_clusterWithziseghist_group_sizze_31045)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34926;\n    int32_t local_tid_34927;\n    int64_t group_sizze_34930;\n    int32_t wave_sizze_34929;\n    int32_t group_tid_34928;\n    \n    global_tid_34926 = get_global_id(0);\n    local_tid_34927 = get_local_id(0);\n    group_sizze_34930 = get_local_size(0);\n    wave_sizze_34929 = LOCKSTEP_WIDTH;\n    group_tid_34928 = get_group_id(0);\n    \n    int32_t phys_tid_31051;\n ",
            "   \n    phys_tid_31051 = global_tid_34926;\n    \n    int32_t subhisto_ind_34931;\n    \n    subhisto_ind_34931 = squot32(global_tid_34926,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_31046 *\n                                           num_groups_31048),\n                                           num_subhistos_34857));\n    for (int64_t i_34932 = 0; i_34932 < sdiv_up64(partition_sizze_29591 -\n                                                  sext_i32_i64(global_tid_34926),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_31046 *\n                                                  num_groups_31048)));\n         i_34932++) {\n        int32_t gtid_31050 = sext_i64_i32(i_34932 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_31046 *\n                num_groups_31048)) + sext_i32_i64(global_tid_34926));\n        \n        if (slt64(i_34932 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_31046 *\n                  num_groups_31048)) + sext_i32_i64(global_tid_34926),\n                  partition_sizze_29591)) {\n            int64_t i_p_o_31889 = add64((int64_t) -1, gtid_31050);\n            int64_t rot_i_31890 = smod64(i_p_o_31889, partition_sizze_29591);\n            bool cond_31057 = gtid_31050 == (int64_t) 0;\n            int64_t defunc_1_f_res_31058;\n            \n            if (cond_31057) {\n                defunc_1_f_res_31058 = (int64_t) 0;\n            } else {\n                int64_t x_31056 = ((__global int64_t *) mem_32290)[rot_i_31890];\n                \n                defunc_1_f_res_31058 = x_31056;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_34924) * hist_H_chk_34925,\n                          defunc_1_f_res_31058) && (slt64(defunc_1_f_res_31058,\n                                                          sext_i32_i64(chk_i_34924) *\n                     ",
            "                                     hist_H_chk_34925 +\n                                                          hist_H_chk_34925) &&\n                                                    slt64(defunc_1_f_res_31058,\n                                                          defunc_2_reduce_res_29634))) {\n                    int64_t x_31052;\n                    int64_t x_31053;\n                    \n                    x_31053 = gtid_31050;\n                    \n                    int64_t old_34933;\n                    \n                    old_34933 = atomic_smax_i64_global(&((volatile __global\n                                                          int64_t *) defunc_1_map_res_subhistos_mem_34858)[sext_i32_i64(subhisto_ind_34931) *\n                                                                                                           defunc_2_reduce_res_29634 +\n                                                                                                           defunc_1_f_res_31058],\n                                                       (int64_t) x_31053);\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_31046\n}\n__kernel void test_clusterWithziseghist_local_30660(__global\n                                                    int *global_failure,\n                                                    uint subhistogram_local_mem_33299_backing_offset_0,\n                                                    int64_t numVert_28890,\n                                                    int64_t defunc_2_reduce_res_29171,\n                                                    int32_t max_group_sizze_33270,\n                                                    int64_t num_groups_33271,\n                                                    int32_t hist_M_33277,\n                                                    int32_t chk_i_33282,\n                                                    int64_t num_segments_33283,\n                 ",
            "                                   int64_t hist_H_chk_33284,\n                                                    int64_t histo_sizze_33285,\n                                                    int32_t init_per_thread_33286,\n                                                    __global\n                                                    unsigned char *mem_32093,\n                                                    __global\n                                                    unsigned char *defunc_1_map_res_subhistos_mem_33261)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *subhistogram_local_mem_33299_backing_0 =\n                  &shared_mem[subhistogram_local_mem_33299_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33287;\n    int32_t local_tid_33288;\n    int64_t group_sizze_33291;\n    int32_t wave_sizze_33290;\n    int32_t group_tid_33289;\n    \n    global_tid_33287 = get_global_id(0);\n    local_tid_33288 = get_local_id(0);\n    group_sizze_33291 = get_local_size(0);\n    wave_sizze_33290 = LOCKSTEP_WIDTH;\n    group_tid_33289 = get_group_id(0);\n    \n    int32_t phys_tid_30660;\n    \n    phys_tid_30660 = global_tid_33287;\n    \n    int32_t phys_group_id_33292;\n    \n    phys_group_id_33292 = get_group_id(0);\n    for (int32_t i_33293 = 0; i_33293 <\n         sdiv_up32(sext_i64_i32(num_groups_33271 * num_segments_33283) -\n                   phys_group_id_33292, sext_i64_i32(num_groups_33271));\n         i_33293++) {\n        int32_t virt_group_id_33294 = phys_group_id_33292 + i_33293 *\n                sext_i64_i32(num_groups_33271);\n        int32_t flat_segment_id_33295 = squot32(virt_group_id_33294,\n                                                sext_i64_i32(num_groups_33271));\n        int32_t gid_in_segment_33296 = srem32(virt_group_id_33294,\n                                              sext_i64_i32(num_groups_33271));\n        int32_t pgtid_in_segment_33297 = gid_i",
            "n_segment_33296 *\n                sext_i64_i32(max_group_sizze_33270) + local_tid_33288;\n        int32_t threads_per_segment_33298 = sext_i64_i32(num_groups_33271 *\n                max_group_sizze_33270);\n        __local char *subhistogram_local_mem_33299;\n        \n        subhistogram_local_mem_33299 = (__local\n                                        char *) subhistogram_local_mem_33299_backing_0;\n        \n        int32_t thread_local_subhisto_i_33301;\n        \n        thread_local_subhisto_i_33301 = srem32(local_tid_33288, hist_M_33277);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_33302 = 0; local_i_33302 <\n                 init_per_thread_33286; local_i_33302++) {\n                int32_t j_33303 = local_i_33302 *\n                        sext_i64_i32(max_group_sizze_33270) + local_tid_33288;\n                int32_t j_offset_33304 = hist_M_33277 *\n                        sext_i64_i32(histo_sizze_33285) * gid_in_segment_33296 +\n                        j_33303;\n                int32_t local_subhisto_i_33305 = squot32(j_33303,\n                                                         sext_i64_i32(histo_sizze_33285));\n                int32_t global_subhisto_i_33306 = squot32(j_offset_33304,\n                                                          sext_i64_i32(histo_sizze_33285));\n                \n                if (slt32(j_33303, hist_M_33277 *\n                          sext_i64_i32(histo_sizze_33285))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_33306 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_33299)[sext_i32_i64(local_subhisto_i_33305) *\n                                                                       hist_H_chk_33284 +\n                                                                       sext_i32_i64(srem32(j_33303,",
            "\n                                                                                           sext_i64_i32(histo_sizze_33285)))] =\n                                ((__global\n                                  int64_t *) defunc_1_map_res_subhistos_mem_33261)[sext_i32_i64(srem32(j_33303,\n                                                                                                       sext_i64_i32(histo_sizze_33285))) +\n                                                                                   sext_i32_i64(chk_i_33282) *\n                                                                                   hist_H_chk_33284];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_33299)[sext_i32_i64(local_subhisto_i_33305) *\n                                                                       hist_H_chk_33284 +\n                                                                       sext_i32_i64(srem32(j_33303,\n                                                                                           sext_i64_i32(histo_sizze_33285)))] =\n                                (int64_t) 0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33307 = 0; i_33307 <\n             sdiv_up32(sext_i64_i32(numVert_28890) - pgtid_in_segment_33297,\n                       threads_per_segment_33298); i_33307++) {\n            int32_t gtid_30659 = i_33307 * threads_per_segment_33298 +\n                    pgtid_in_segment_33297;\n            int64_t i_p_o_31864 = add64((int64_t) -1, gtid_30659);\n            int64_t rot_i_31865 = smod64(i_p_o_31864, numVert_28890);\n            bool cond_30666 = gtid_30659 == (int64_t) 0;\n            int64_t defunc_1_f_res_30667;\n            \n            if (cond_30666) {\n                defunc_1_f_res_30667 = (int64_t) 0;\n            } else {\n                int64_t x_30665 = ((__gl",
            "obal int64_t *) mem_32093)[rot_i_31865];\n                \n                defunc_1_f_res_30667 = x_30665;\n            }\n            if (chk_i_33282 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(defunc_1_f_res_30667, defunc_2_reduce_res_29171) &&\n                    (sle64(sext_i32_i64(chk_i_33282) * hist_H_chk_33284,\n                           defunc_1_f_res_30667) && slt64(defunc_1_f_res_30667,\n                                                          sext_i32_i64(chk_i_33282) *\n                                                          hist_H_chk_33284 +\n                                                          hist_H_chk_33284))) {\n                    int64_t x_30661;\n                    int64_t x_30662;\n                    \n                    x_30662 = gtid_30659;\n                    \n                    int64_t old_33308;\n                    \n                    old_33308 = atomic_smax_i64_local(&((volatile __local\n                                                         int64_t *) subhistogram_local_mem_33299)[sext_i32_i64(thread_local_subhisto_i_33301) *\n                                                                                                  hist_H_chk_33284 +\n                                                                                                  (defunc_1_f_res_30667 -\n                                                                                                   sext_i32_i64(chk_i_33282) *\n                                                                                                   hist_H_chk_33284)],\n                                                      (int64_t) x_30662);\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_33309 = smin64(hist_H_chk_33284,\n            ",
            "                               defunc_2_reduce_res_29171 -\n                                           sext_i32_i64(chk_i_33282) *\n                                           hist_H_chk_33284);\n            int32_t histo_sizze_33310 = sext_i64_i32(trunc_H_33309);\n            \n            for (int32_t local_i_33311 = 0; local_i_33311 <\n                 init_per_thread_33286; local_i_33311++) {\n                int32_t j_33312 = local_i_33311 *\n                        sext_i64_i32(max_group_sizze_33270) + local_tid_33288;\n                \n                if (slt32(j_33312, histo_sizze_33310)) {\n                    int64_t x_30661;\n                    int64_t x_30662;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_30661 = ((__local\n                                    int64_t *) subhistogram_local_mem_33299)[sext_i32_i64(j_33312)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_33313 = 0; subhisto_id_33313 <\n                             hist_M_33277 - 1; subhisto_id_33313++) {\n                            x_30662 = ((__local\n                                        int64_t *) subhistogram_local_mem_33299)[(sext_i32_i64(subhisto_id_33313) +\n                                                                                  (int64_t) 1) *\n                                                                                 hist_H_chk_33284 +\n                                                                                 sext_i32_i64(j_33312)];\n                            \n                            int64_t defunc_1_f_res_30663;\n                            \n                            defunc_1_f_res_30663 = smax64(x_30661, x_30662);\n                            x_30661 = defunc_1_f_res_30663;\n                        }\n                    }\n                    // Put final bucket value in gl",
            "obal memory.\n                    {\n                        ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_33261)[srem64(sext_i32_i64(virt_group_id_33294),\n                                                                                  num_groups_33271) *\n                                                                           defunc_2_reduce_res_29171 +\n                                                                           (sext_i32_i64(j_33312) +\n                                                                            sext_i32_i64(chk_i_33282) *\n                                                                            hist_H_chk_33284)] =\n                            x_30661;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void test_clusterWithziseghist_local_31051(__global\n                                                    int *global_failure,\n                                                    uint subhistogram_local_mem_34896_backing_offset_0,\n                                                    int64_t partition_sizze_29591,\n                                                    int64_t defunc_2_reduce_res_29634,\n                                                    int32_t max_group_sizze_34867,\n                                                    int64_t num_groups_34868,\n                                                    int32_t hist_M_34874,\n                                                    int32_t chk_i_34879,\n                                                    int64_t num_segments_34880,\n                                                    int64_t hist_H_chk_34881,\n                                                    int64_t histo_sizze_34882,\n                                                    int32_t init_per_thread_34883,\n                                                    __global\n            ",
            "                                        unsigned char *mem_32290,\n                                                    __global\n                                                    unsigned char *defunc_1_map_res_subhistos_mem_34858)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *subhistogram_local_mem_34896_backing_0 =\n                  &shared_mem[subhistogram_local_mem_34896_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34884;\n    int32_t local_tid_34885;\n    int64_t group_sizze_34888;\n    int32_t wave_sizze_34887;\n    int32_t group_tid_34886;\n    \n    global_tid_34884 = get_global_id(0);\n    local_tid_34885 = get_local_id(0);\n    group_sizze_34888 = get_local_size(0);\n    wave_sizze_34887 = LOCKSTEP_WIDTH;\n    group_tid_34886 = get_group_id(0);\n    \n    int32_t phys_tid_31051;\n    \n    phys_tid_31051 = global_tid_34884;\n    \n    int32_t phys_group_id_34889;\n    \n    phys_group_id_34889 = get_group_id(0);\n    for (int32_t i_34890 = 0; i_34890 <\n         sdiv_up32(sext_i64_i32(num_groups_34868 * num_segments_34880) -\n                   phys_group_id_34889, sext_i64_i32(num_groups_34868));\n         i_34890++) {\n        int32_t virt_group_id_34891 = phys_group_id_34889 + i_34890 *\n                sext_i64_i32(num_groups_34868);\n        int32_t flat_segment_id_34892 = squot32(virt_group_id_34891,\n                                                sext_i64_i32(num_groups_34868));\n        int32_t gid_in_segment_34893 = srem32(virt_group_id_34891,\n                                              sext_i64_i32(num_groups_34868));\n        int32_t pgtid_in_segment_34894 = gid_in_segment_34893 *\n                sext_i64_i32(max_group_sizze_34867) + local_tid_34885;\n        int32_t threads_per_segment_34895 = sext_i64_i32(num_groups_34868 *\n                max_group_sizze_34867);\n        __local char *subhistogram_local_mem_34896;\n        \n        subhistogram_local_mem",
            "_34896 = (__local\n                                        char *) subhistogram_local_mem_34896_backing_0;\n        \n        int32_t thread_local_subhisto_i_34898;\n        \n        thread_local_subhisto_i_34898 = srem32(local_tid_34885, hist_M_34874);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_34899 = 0; local_i_34899 <\n                 init_per_thread_34883; local_i_34899++) {\n                int32_t j_34900 = local_i_34899 *\n                        sext_i64_i32(max_group_sizze_34867) + local_tid_34885;\n                int32_t j_offset_34901 = hist_M_34874 *\n                        sext_i64_i32(histo_sizze_34882) * gid_in_segment_34893 +\n                        j_34900;\n                int32_t local_subhisto_i_34902 = squot32(j_34900,\n                                                         sext_i64_i32(histo_sizze_34882));\n                int32_t global_subhisto_i_34903 = squot32(j_offset_34901,\n                                                          sext_i64_i32(histo_sizze_34882));\n                \n                if (slt32(j_34900, hist_M_34874 *\n                          sext_i64_i32(histo_sizze_34882))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_34903 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_34896)[sext_i32_i64(local_subhisto_i_34902) *\n                                                                       hist_H_chk_34881 +\n                                                                       sext_i32_i64(srem32(j_34900,\n                                                                                           sext_i64_i32(histo_sizze_34882)))] =\n                                ((__global\n                                  int64_t *) defunc_1_map_res_subhistos_mem_34858)[sext_i32_i64(srem32(j_34900,\n            ",
            "                                                                                           sext_i64_i32(histo_sizze_34882))) +\n                                                                                   sext_i32_i64(chk_i_34879) *\n                                                                                   hist_H_chk_34881];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_34896)[sext_i32_i64(local_subhisto_i_34902) *\n                                                                       hist_H_chk_34881 +\n                                                                       sext_i32_i64(srem32(j_34900,\n                                                                                           sext_i64_i32(histo_sizze_34882)))] =\n                                (int64_t) 0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34904 = 0; i_34904 <\n             sdiv_up32(sext_i64_i32(partition_sizze_29591) -\n                       pgtid_in_segment_34894, threads_per_segment_34895);\n             i_34904++) {\n            int32_t gtid_31050 = i_34904 * threads_per_segment_34895 +\n                    pgtid_in_segment_34894;\n            int64_t i_p_o_31889 = add64((int64_t) -1, gtid_31050);\n            int64_t rot_i_31890 = smod64(i_p_o_31889, partition_sizze_29591);\n            bool cond_31057 = gtid_31050 == (int64_t) 0;\n            int64_t defunc_1_f_res_31058;\n            \n            if (cond_31057) {\n                defunc_1_f_res_31058 = (int64_t) 0;\n            } else {\n                int64_t x_31056 = ((__global int64_t *) mem_32290)[rot_i_31890];\n                \n                defunc_1_f_res_31058 = x_31056;\n            }\n            if (chk_i_34879 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates",
            "\n            {\n                if (slt64(defunc_1_f_res_31058, defunc_2_reduce_res_29634) &&\n                    (sle64(sext_i32_i64(chk_i_34879) * hist_H_chk_34881,\n                           defunc_1_f_res_31058) && slt64(defunc_1_f_res_31058,\n                                                          sext_i32_i64(chk_i_34879) *\n                                                          hist_H_chk_34881 +\n                                                          hist_H_chk_34881))) {\n                    int64_t x_31052;\n                    int64_t x_31053;\n                    \n                    x_31053 = gtid_31050;\n                    \n                    int64_t old_34905;\n                    \n                    old_34905 = atomic_smax_i64_local(&((volatile __local\n                                                         int64_t *) subhistogram_local_mem_34896)[sext_i32_i64(thread_local_subhisto_i_34898) *\n                                                                                                  hist_H_chk_34881 +\n                                                                                                  (defunc_1_f_res_31058 -\n                                                                                                   sext_i32_i64(chk_i_34879) *\n                                                                                                   hist_H_chk_34881)],\n                                                      (int64_t) x_31053);\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_34906 = smin64(hist_H_chk_34881,\n                                           defunc_2_reduce_res_29634 -\n                                           sext_i32_i64(chk_i_34879) *\n                                           hist_H_chk_34881);\n            int32_t histo_sizze_34907 = sext_i64_i32(trunc_H_34906);\n      ",
            "      \n            for (int32_t local_i_34908 = 0; local_i_34908 <\n                 init_per_thread_34883; local_i_34908++) {\n                int32_t j_34909 = local_i_34908 *\n                        sext_i64_i32(max_group_sizze_34867) + local_tid_34885;\n                \n                if (slt32(j_34909, histo_sizze_34907)) {\n                    int64_t x_31052;\n                    int64_t x_31053;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_31052 = ((__local\n                                    int64_t *) subhistogram_local_mem_34896)[sext_i32_i64(j_34909)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_34910 = 0; subhisto_id_34910 <\n                             hist_M_34874 - 1; subhisto_id_34910++) {\n                            x_31053 = ((__local\n                                        int64_t *) subhistogram_local_mem_34896)[(sext_i32_i64(subhisto_id_34910) +\n                                                                                  (int64_t) 1) *\n                                                                                 hist_H_chk_34881 +\n                                                                                 sext_i32_i64(j_34909)];\n                            \n                            int64_t defunc_1_f_res_31054;\n                            \n                            defunc_1_f_res_31054 = smax64(x_31052, x_31053);\n                            x_31052 = defunc_1_f_res_31054;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_34858)[srem64(sext_i32_i64(virt_group_id_34891),\n                                                                                ",
            "  num_groups_34868) *\n                                                                           defunc_2_reduce_res_29634 +\n                                                                           (sext_i32_i64(j_34909) +\n                                                                            sext_i32_i64(chk_i_34879) *\n                                                                            hist_H_chk_34881)] =\n                            x_31052;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void test_clusterWithzisegmap_30473(__global int *global_failure,\n                                             int64_t numVert_28890, __global\n                                             unsigned char *mem_31950)\n{\n    #define segmap_group_sizze_30481 (test_clusterWithzisegmap_group_sizze_30475)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32444;\n    int32_t local_tid_32445;\n    int64_t group_sizze_32448;\n    int32_t wave_sizze_32447;\n    int32_t group_tid_32446;\n    \n    global_tid_32444 = get_global_id(0);\n    local_tid_32445 = get_local_id(0);\n    group_sizze_32448 = get_local_size(0);\n    wave_sizze_32447 = LOCKSTEP_WIDTH;\n    group_tid_32446 = get_group_id(0);\n    \n    int32_t phys_tid_30473;\n    \n    phys_tid_30473 = global_tid_32444;\n    \n    int64_t gtid_30472;\n    \n    gtid_30472 = sext_i32_i64(group_tid_32446) * segmap_group_sizze_30481 +\n        sext_i32_i64(local_tid_32445);\n    if (slt64(gtid_30472, numVert_28890)) {\n        int32_t defunc_0_f_res_30485 = sext_i64_i32(gtid_30472);\n        \n        ((__global int32_t *) mem_31950)[gtid_30472] = defunc_0_f_res_30485;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30481\n}\n__kernel void test_clusterWithzisegmap_30495(__global int *global_fail",
            "ure,\n                                             int64_t conc_tmp_28900,\n                                             int64_t last_res_28970,\n                                             int64_t last_res_28971,\n                                             int64_t last_res_28972, __global\n                                             unsigned char *mem_param_31959,\n                                             __global\n                                             unsigned char *mem_param_31964,\n                                             __global unsigned char *mem_31971,\n                                             __global unsigned char *mem_31973,\n                                             __global unsigned char *mem_31975,\n                                             __global unsigned char *mem_31977,\n                                             __global unsigned char *mem_31979,\n                                             __global unsigned char *mem_31981,\n                                             __global unsigned char *mem_31983)\n{\n    #define segmap_group_sizze_30498 (test_clusterWithzisegmap_group_sizze_30497)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32687;\n    int32_t local_tid_32688;\n    int64_t group_sizze_32691;\n    int32_t wave_sizze_32690;\n    int32_t group_tid_32689;\n    \n    global_tid_32687 = get_global_id(0);\n    local_tid_32688 = get_local_id(0);\n    group_sizze_32691 = get_local_size(0);\n    wave_sizze_32690 = LOCKSTEP_WIDTH;\n    group_tid_32689 = get_group_id(0);\n    \n    int32_t phys_tid_30495;\n    \n    phys_tid_30495 = global_tid_32687;\n    \n    int64_t write_i_30494;\n    \n    write_i_30494 = sext_i32_i64(group_tid_32689) * segmap_group_sizze_30498 +\n        sext_i32_i64(local_tid_32688);\n    if (slt64(write_i_30494, conc_tmp_28900)) {\n        int32_t x_28977 = ((__global int32_t *) mem_31979)[write_i_30494",
            "];\n        int32_t write_value_28982 = ((__global\n                                      int32_t *) mem_param_31959)[write_i_30494];\n        int64_t write_value_28983 = ((__global\n                                      int64_t *) mem_param_31964)[write_i_30494];\n        bool match_lit_28984 = 0 == x_28977;\n        int64_t defunc_1_f_res_28985;\n        \n        if (match_lit_28984) {\n            int64_t x_28978 = ((__global int64_t *) mem_31971)[write_i_30494];\n            int64_t case_res_28986 = sub64(x_28978, (int64_t) 1);\n            \n            defunc_1_f_res_28985 = case_res_28986;\n        } else {\n            bool match_lit_28987 = 1 == x_28977;\n            int64_t x_28988;\n            \n            if (match_lit_28987) {\n                int64_t x_28979 = ((__global\n                                    int64_t *) mem_31973)[write_i_30494];\n                int64_t x_28989 = add64(last_res_28970, x_28979);\n                int64_t case_res_28990 = sub64(x_28989, (int64_t) 1);\n                \n                x_28988 = case_res_28990;\n            } else {\n                bool match_lit_28991 = 2 == x_28977;\n                int64_t x_28992;\n                \n                if (match_lit_28991) {\n                    int64_t x_28980 = ((__global\n                                        int64_t *) mem_31975)[write_i_30494];\n                    int64_t x_28993 = add64(last_res_28970, last_res_28971);\n                    int64_t x_28994 = add64(x_28980, x_28993);\n                    int64_t case_res_28995 = sub64(x_28994, (int64_t) 1);\n                    \n                    x_28992 = case_res_28995;\n                } else {\n                    int64_t x_28981 = ((__global\n                                        int64_t *) mem_31977)[write_i_30494];\n                    int64_t x_28996 = add64(last_res_28970, last_res_28971);\n                    int64_t x_28997 = add64(last_res_28972, x_28996);\n                    int64_t x_28998 = add64(x_28981, x_28997);\n                 ",
            "   int64_t defunc_1_f_res_res_28999 = sub64(x_28998,\n                                                             (int64_t) 1);\n                    \n                    x_28992 = defunc_1_f_res_res_28999;\n                }\n                x_28988 = x_28992;\n            }\n            defunc_1_f_res_28985 = x_28988;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_28985) &&\n            slt64(defunc_1_f_res_28985, conc_tmp_28900)) {\n            ((__global int32_t *) mem_31981)[defunc_1_f_res_28985] =\n                write_value_28982;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_28985) &&\n            slt64(defunc_1_f_res_28985, conc_tmp_28900)) {\n            ((__global int64_t *) mem_31983)[defunc_1_f_res_28985] =\n                write_value_28983;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30498\n}\n__kernel void test_clusterWithzisegmap_30501(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t implz2081U_28888,\n                                             int64_t conc_tmp_28900, __global\n                                             unsigned char *graph_from_mem_31946,\n                                             __global\n                                             unsigned char *graph_to_mem_31947,\n                                             __global\n                                             unsigned char *defunc_0_f_res_mem_31998,\n                                             __global unsigned char *mem_32001,\n                                             __global unsigned char *mem_32003,\n                                             __global unsigned char *mem_32005)\n{\n    #define segmap_group_sizze_30526 (test_clusterWithzisegmap_group_sizze_30503)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_",
            "dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32692;\n    int32_t local_tid_32693;\n    int64_t group_sizze_32696;\n    int32_t wave_sizze_32695;\n    int32_t group_tid_32694;\n    \n    global_tid_32692 = get_global_id(0);\n    local_tid_32693 = get_local_id(0);\n    group_sizze_32696 = get_local_size(0);\n    wave_sizze_32695 = LOCKSTEP_WIDTH;\n    group_tid_32694 = get_group_id(0);\n    \n    int32_t phys_tid_30501;\n    \n    phys_tid_30501 = global_tid_32692;\n    \n    int64_t gtid_30500;\n    \n    gtid_30500 = sext_i32_i64(group_tid_32694) * segmap_group_sizze_30526 +\n        sext_i32_i64(local_tid_32693);\n    if (slt64(gtid_30500, conc_tmp_28900)) {\n        int64_t x_30531 = ((__global\n                            int64_t *) defunc_0_f_res_mem_31998)[gtid_30500];\n        bool x_30532 = sle64((int64_t) 0, x_30531);\n        bool y_30533 = slt64(x_30531, conc_tmp_28900);\n        bool bounds_check_30534 = x_30532 && y_30533;\n        bool index_certs_30535;\n        \n        if (!bounds_check_30534) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                    global_failure_args[0] = x_30531;\n                    global_failure_args[1] = conc_tmp_28900;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool index_concat_cmp_30536 = sle64(implz2081U_28888, x_30531);\n        int32_t index_concat_branch_30537;\n        \n        if (index_concat_cmp_30536) {\n            int64_t index_concat_i_30538 = sub64(x_30531, implz2081U_28888);\n            int32_t index_primexp_30539 = sext_i64_i32(index_concat_i_30538);\n            int32_t index_concat_30540 = index_primexp_30539;\n            \n            index_concat_branch_30537 = index_concat_30540;\n        } else {\n            int32_t index_concat_30541 = ((__global\n                                           int32_t *) graph_from_mem_31946)[x_30531];\n            \n            index_concat_branch_",
            "30537 = index_concat_30541;\n        }\n        \n        int32_t index_concat_branch_30542;\n        \n        if (index_concat_cmp_30536) {\n            int64_t index_concat_i_30543 = sub64(x_30531, implz2081U_28888);\n            int32_t index_primexp_30544 = sext_i64_i32(index_concat_i_30543);\n            int32_t index_concat_30545 = index_primexp_30544;\n            \n            index_concat_branch_30542 = index_concat_30545;\n        } else {\n            int32_t index_concat_30546 = ((__global\n                                           int32_t *) graph_to_mem_31947)[x_30531];\n            \n            index_concat_branch_30542 = index_concat_30546;\n        }\n        \n        int32_t x_30547 = index_concat_branch_30537;\n        int32_t defunc_0_f_res_elem_30548 = index_concat_branch_30542;\n        int64_t defunc_0_f_res_30549 = sext_i32_i64(index_concat_branch_30537);\n        \n        ((__global int64_t *) mem_32001)[gtid_30500] = defunc_0_f_res_30549;\n        ((__global int32_t *) mem_32003)[gtid_30500] = x_30547;\n        ((__global int32_t *) mem_32005)[gtid_30500] =\n            defunc_0_f_res_elem_30548;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30526\n}\n__kernel void test_clusterWithzisegmap_30551(__global int *global_failure,\n                                             int64_t conc_tmp_28900, __global\n                                             unsigned char *mem_32001, __global\n                                             unsigned char *mem_32008)\n{\n    #define segmap_group_sizze_30561 (test_clusterWithzisegmap_group_sizze_30553)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32697;\n    int32_t local_tid_32698;\n    int64_t group_sizze_32701;\n    int32_t wave_sizze_32700;\n    int32_t group_tid_32699;\n    \n    global_tid_32697 = get_global_id(0);\n    local_tid_32698 = get_local_id(0);\n    group_sizze_32701 = get_local_s",
            "ize(0);\n    wave_sizze_32700 = LOCKSTEP_WIDTH;\n    group_tid_32699 = get_group_id(0);\n    \n    int32_t phys_tid_30551;\n    \n    phys_tid_30551 = global_tid_32697;\n    \n    int64_t gtid_30550;\n    \n    gtid_30550 = sext_i32_i64(group_tid_32699) * segmap_group_sizze_30561 +\n        sext_i32_i64(local_tid_32698);\n    if (slt64(gtid_30550, conc_tmp_28900)) {\n        int64_t x_30564 = ((__global int64_t *) mem_32001)[gtid_30550];\n        int64_t i_p_o_31850 = add64((int64_t) -1, gtid_30550);\n        int64_t rot_i_31851 = smod64(i_p_o_31850, conc_tmp_28900);\n        int64_t x_30565 = ((__global int64_t *) mem_32001)[rot_i_31851];\n        bool defunc_1_f_res_30566 = x_30564 == x_30565;\n        bool defunc_1_f_res_30567 = !defunc_1_f_res_30566;\n        \n        ((__global bool *) mem_32008)[gtid_30550] = defunc_1_f_res_30567;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30561\n}\n__kernel void test_clusterWithzisegmap_30585(__global int *global_failure,\n                                             int64_t conc_tmp_28900,\n                                             int64_t num_segments_29050,\n                                             __global unsigned char *mem_32008,\n                                             __global unsigned char *mem_32013,\n                                             __global unsigned char *mem_32016,\n                                             __global unsigned char *mem_32018)\n{\n    #define segmap_group_sizze_30588 (test_clusterWithzisegmap_group_sizze_30587)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32926;\n    int32_t local_tid_32927;\n    int64_t group_sizze_32930;\n    int32_t wave_sizze_32929;\n    int32_t group_tid_32928;\n    \n    global_tid_32926 = get_global_id(0);\n    local_tid_32927 = get_local_id(0);\n    group_sizze_32930 = get_local_size(0);\n    wave_sizze_32929 = LOCKSTEP_WIDTH;\n    group_",
            "tid_32928 = get_group_id(0);\n    \n    int32_t phys_tid_30585;\n    \n    phys_tid_30585 = global_tid_32926;\n    \n    int64_t write_i_30584;\n    \n    write_i_30584 = sext_i32_i64(group_tid_32928) * segmap_group_sizze_30588 +\n        sext_i32_i64(local_tid_32927);\n    if (slt64(write_i_30584, conc_tmp_28900)) {\n        int64_t i_p_o_31854 = add64((int64_t) 1, write_i_30584);\n        int64_t rot_i_31855 = smod64(i_p_o_31854, conc_tmp_28900);\n        bool x_29059 = ((__global bool *) mem_32008)[rot_i_31855];\n        int64_t write_value_29060 = ((__global\n                                      int64_t *) mem_32013)[write_i_30584];\n        int64_t defunc_1_f_res_29061;\n        \n        if (x_29059) {\n            int64_t x_29058 = ((__global int64_t *) mem_32016)[write_i_30584];\n            int64_t defunc_1_f_res_t_res_29062 = sub64(x_29058, (int64_t) 1);\n            \n            defunc_1_f_res_29061 = defunc_1_f_res_t_res_29062;\n        } else {\n            defunc_1_f_res_29061 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29061) &&\n            slt64(defunc_1_f_res_29061, num_segments_29050)) {\n            ((__global int64_t *) mem_32018)[defunc_1_f_res_29061] =\n                write_value_29060;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30588\n}\n__kernel void test_clusterWithzisegmap_30599(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t numVert_28890,\n                                             int64_t conc_tmp_28900,\n                                             int64_t num_segments_29050,\n                                             __global unsigned char *mem_32003,\n                                             __global unsigned char *mem_32018,\n                                             __global unsigned char *mem_32024,\n     ",
            "                                        __global unsigned char *mem_32026,\n                                             __global unsigned char *mem_32028)\n{\n    #define segmap_group_sizze_30602 (test_clusterWithzisegmap_group_sizze_30601)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33018;\n    int32_t local_tid_33019;\n    int64_t group_sizze_33022;\n    int32_t wave_sizze_33021;\n    int32_t group_tid_33020;\n    \n    global_tid_33018 = get_global_id(0);\n    local_tid_33019 = get_local_id(0);\n    group_sizze_33022 = get_local_size(0);\n    wave_sizze_33021 = LOCKSTEP_WIDTH;\n    group_tid_33020 = get_group_id(0);\n    \n    int32_t phys_tid_30599;\n    \n    phys_tid_30599 = global_tid_33018;\n    \n    int64_t write_i_30598;\n    \n    write_i_30598 = sext_i32_i64(group_tid_33020) * segmap_group_sizze_30602 +\n        sext_i32_i64(local_tid_33019);\n    if (slt64(write_i_30598, num_segments_29050)) {\n        int64_t x_29077 = ((__global int64_t *) mem_32024)[write_i_30598];\n        int64_t write_value_29078 = ((__global\n                                      int64_t *) mem_32018)[write_i_30598];\n        bool x_29079 = sle64((int64_t) 0, x_29077);\n        bool y_29080 = slt64(x_29077, conc_tmp_28900);\n        bool bounds_check_29081 = x_29079 && y_29080;\n        bool index_certs_29082;\n        \n        if (!bounds_check_29081) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = x_29077;\n                    global_failure_args[1] = conc_tmp_28900;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t i32_arg_29083 = ((__global int32_t *) mem_32003)[x_29077];\n        int64_t i32_res_29084 = sext_i32_i64(i32_arg_29083);\n        \n        if (sle64((int64_t) 0, i32_res_29084) && slt64(i32_res_29084,\n                ",
            "                                       numVert_28890)) {\n            ((__global int64_t *) mem_32026)[i32_res_29084] = write_value_29078;\n        }\n        if (sle64((int64_t) 0, i32_res_29084) && slt64(i32_res_29084,\n                                                       numVert_28890)) {\n            ((__global int64_t *) mem_32028)[i32_res_29084] = x_29077;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30602\n}\n__kernel void test_clusterWithzisegmap_30685(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t numVert_28890,\n                                             int64_t maxSizze_29114,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             __global\n                                             unsigned char *mem_param_32074,\n                                             __global\n                                             unsigned char *mem_param_32079,\n                                             __global unsigned char *mem_32097,\n                                             __global unsigned char *mem_32108,\n                                             __global unsigned char *mem_32113,\n                                             __global unsigned char *mem_32116,\n                                             __global unsigned char *mem_32118,\n                                             __global unsigned char *mem_32120)\n{\n    #define segmap_group_sizze_30740 (test_clusterWithzisegmap_group_sizze_30687)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33666;\n    int32_t local_tid_33667;\n    int64_t group_sizze_33670;\n    int32_t wave_sizze_33669;\n    int32_t ",
            "group_tid_33668;\n    \n    global_tid_33666 = get_global_id(0);\n    local_tid_33667 = get_local_id(0);\n    group_sizze_33670 = get_local_size(0);\n    wave_sizze_33669 = LOCKSTEP_WIDTH;\n    group_tid_33668 = get_group_id(0);\n    \n    int32_t phys_tid_30685;\n    \n    phys_tid_30685 = global_tid_33666;\n    \n    int64_t gtid_30684;\n    \n    gtid_30684 = sext_i32_i64(group_tid_33668) * segmap_group_sizze_30740 +\n        sext_i32_i64(local_tid_33667);\n    if (slt64(gtid_30684, defunc_2_reduce_res_29171)) {\n        int64_t x_30746 = ((__global int64_t *) mem_32113)[gtid_30684];\n        int64_t x_30747 = ((__global int64_t *) mem_32108)[gtid_30684];\n        int64_t defunc_0_f_res_30750 = sub64(x_30746, (int64_t) 1);\n        bool x_30751 = sle64((int64_t) 0, x_30747);\n        bool y_30752 = slt64(x_30747, numVert_28890);\n        bool bounds_check_30753 = x_30751 && y_30752;\n        bool index_certs_30754;\n        \n        if (!bounds_check_30753) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = x_30747;\n                    global_failure_args[1] = numVert_28890;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t index_primexp_30755 = sext_i64_i32(x_30747);\n        int64_t x_30756 = (int64_t) 1 & defunc_0_f_res_30750;\n        bool cond_30757 = x_30756 == (int64_t) 0;\n        int32_t defunc_1_get_res_30758;\n        int32_t defunc_1_get_res_30759;\n        \n        if (cond_30757) {\n            int64_t v_30760 = sext_i32_i64(index_primexp_30755);\n            bool x_30761 = sle64((int64_t) 0, v_30760);\n            bool y_30762 = slt64(v_30760, numVert_28890);\n            bool bounds_check_30763 = x_30761 && y_30762;\n            bool index_certs_30764;\n            \n            if (!bounds_check_30763) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 14) ==\n                        -1) {\n     ",
            "                   global_failure_args[0] = v_30760;\n                        global_failure_args[1] = numVert_28890;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int32_t defunc_1_get_res_t_res_30765 = ((__global\n                                                     int32_t *) mem_32097)[v_30760];\n            int64_t getEntry_arg_30766 = ashr64(defunc_0_f_res_30750,\n                                                (int64_t) 1);\n            bool index_certs_30767;\n            \n            if (!bounds_check_30763) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 15) ==\n                        -1) {\n                        global_failure_args[0] = v_30760;\n                        global_failure_args[1] = numVert_28890;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int64_t x_30768 = ((__global int64_t *) mem_param_32079)[v_30760];\n            int64_t i_30769 = add64(getEntry_arg_30766, x_30768);\n            bool x_30770 = sle64((int64_t) 0, i_30769);\n            bool y_30771 = slt64(i_30769, maxSizze_29114);\n            bool bounds_check_30772 = x_30770 && y_30771;\n            bool index_certs_30773;\n            \n            if (!bounds_check_30772) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 16) ==\n                        -1) {\n                        global_failure_args[0] = i_30769;\n                        global_failure_args[1] = maxSizze_29114;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int32_t getEntry_res_30774 = ((__global\n                                           int32_t *) mem_param_32074)[i_30769];\n            \n            defunc_1_get_res_30758 = defunc_1_get_res_t_res_30765;\n            defunc_1_get_res_30759 = ge",
            "tEntry_res_30774;\n        } else {\n            int64_t getEntry_arg_30775 = ashr64(defunc_0_f_res_30750,\n                                                (int64_t) 1);\n            int64_t s_30776 = sext_i32_i64(index_primexp_30755);\n            bool x_30777 = sle64((int64_t) 0, s_30776);\n            bool y_30778 = slt64(s_30776, numVert_28890);\n            bool bounds_check_30779 = x_30777 && y_30778;\n            bool index_certs_30780;\n            \n            if (!bounds_check_30779) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 17) ==\n                        -1) {\n                        global_failure_args[0] = s_30776;\n                        global_failure_args[1] = numVert_28890;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int64_t x_30781 = ((__global int64_t *) mem_param_32079)[s_30776];\n            int64_t i_30782 = add64(getEntry_arg_30775, x_30781);\n            bool x_30783 = sle64((int64_t) 0, i_30782);\n            bool y_30784 = slt64(i_30782, maxSizze_29114);\n            bool bounds_check_30785 = x_30783 && y_30784;\n            bool index_certs_30786;\n            \n            if (!bounds_check_30785) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 18) ==\n                        -1) {\n                        global_failure_args[0] = i_30782;\n                        global_failure_args[1] = maxSizze_29114;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int32_t getEntry_res_30787 = ((__global\n                                           int32_t *) mem_param_32074)[i_30782];\n            bool index_certs_30788;\n            \n            if (!bounds_check_30779) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 19) ==\n                        -1) {\n                   ",
            "     global_failure_args[0] = s_30776;\n                        global_failure_args[1] = numVert_28890;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            int32_t defunc_1_get_res_f_res_30789 = ((__global\n                                                     int32_t *) mem_32097)[s_30776];\n            \n            defunc_1_get_res_30758 = getEntry_res_30787;\n            defunc_1_get_res_30759 = defunc_1_get_res_f_res_30789;\n        }\n        \n        int64_t unsign_arg_30790 = zext_i32_i64(defunc_1_get_res_30758);\n        int64_t x_30791 = unsign_arg_30790 << (int64_t) 32;\n        int64_t unsign_arg_30792 = zext_i32_i64(defunc_1_get_res_30759);\n        int64_t binop_p_30793 = x_30791 | unsign_arg_30792;\n        \n        ((__global int64_t *) mem_32116)[gtid_30684] = binop_p_30793;\n        ((__global int32_t *) mem_32118)[gtid_30684] = defunc_1_get_res_30758;\n        ((__global int32_t *) mem_32120)[gtid_30684] = defunc_1_get_res_30759;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30740\n}\n__kernel void test_clusterWithzisegmap_30803(__global int *global_failure,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             int64_t last_res_29361,\n                                             int64_t last_res_29362,\n                                             int64_t last_res_29363, __global\n                                             unsigned char *mem_param_32127,\n                                             __global\n                                             unsigned char *mem_param_32132,\n                                             __global unsigned char *mem_32139,\n                                             __global unsigned char *mem_32141,\n                                             __global unsigned char *mem_32143,\n                                             __global unsigned char *mem_32145,",
            "\n                                             __global unsigned char *mem_32147,\n                                             __global unsigned char *mem_32149,\n                                             __global unsigned char *mem_32151)\n{\n    #define segmap_group_sizze_30806 (test_clusterWithzisegmap_group_sizze_30805)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33889;\n    int32_t local_tid_33890;\n    int64_t group_sizze_33893;\n    int32_t wave_sizze_33892;\n    int32_t group_tid_33891;\n    \n    global_tid_33889 = get_global_id(0);\n    local_tid_33890 = get_local_id(0);\n    group_sizze_33893 = get_local_size(0);\n    wave_sizze_33892 = LOCKSTEP_WIDTH;\n    group_tid_33891 = get_group_id(0);\n    \n    int32_t phys_tid_30803;\n    \n    phys_tid_30803 = global_tid_33889;\n    \n    int64_t write_i_30802;\n    \n    write_i_30802 = sext_i32_i64(group_tid_33891) * segmap_group_sizze_30806 +\n        sext_i32_i64(local_tid_33890);\n    if (slt64(write_i_30802, defunc_2_reduce_res_29171)) {\n        int32_t x_29368 = ((__global int32_t *) mem_32147)[write_i_30802];\n        int64_t write_value_29373 = ((__global\n                                      int64_t *) mem_param_32127)[write_i_30802];\n        int64_t write_value_29374 = ((__global\n                                      int64_t *) mem_param_32132)[write_i_30802];\n        bool match_lit_29375 = 0 == x_29368;\n        int64_t defunc_1_f_res_29376;\n        \n        if (match_lit_29375) {\n            int64_t x_29369 = ((__global int64_t *) mem_32139)[write_i_30802];\n            int64_t case_res_29377 = sub64(x_29369, (int64_t) 1);\n            \n            defunc_1_f_res_29376 = case_res_29377;\n        } else {\n            bool match_lit_29378 = 1 == x_29368;\n            int64_t x_29379;\n            \n            if (match_lit_29378) {\n                int64_t x_29370 = ((__global\n                         ",
            "           int64_t *) mem_32141)[write_i_30802];\n                int64_t x_29380 = add64(last_res_29361, x_29370);\n                int64_t case_res_29381 = sub64(x_29380, (int64_t) 1);\n                \n                x_29379 = case_res_29381;\n            } else {\n                bool match_lit_29382 = 2 == x_29368;\n                int64_t x_29383;\n                \n                if (match_lit_29382) {\n                    int64_t x_29371 = ((__global\n                                        int64_t *) mem_32143)[write_i_30802];\n                    int64_t x_29384 = add64(last_res_29361, last_res_29362);\n                    int64_t x_29385 = add64(x_29371, x_29384);\n                    int64_t case_res_29386 = sub64(x_29385, (int64_t) 1);\n                    \n                    x_29383 = case_res_29386;\n                } else {\n                    int64_t x_29372 = ((__global\n                                        int64_t *) mem_32145)[write_i_30802];\n                    int64_t x_29387 = add64(last_res_29361, last_res_29362);\n                    int64_t x_29388 = add64(last_res_29363, x_29387);\n                    int64_t x_29389 = add64(x_29372, x_29388);\n                    int64_t defunc_1_f_res_res_29390 = sub64(x_29389,\n                                                             (int64_t) 1);\n                    \n                    x_29383 = defunc_1_f_res_res_29390;\n                }\n                x_29379 = x_29383;\n            }\n            defunc_1_f_res_29376 = x_29379;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29376) &&\n            slt64(defunc_1_f_res_29376, defunc_2_reduce_res_29171)) {\n            ((__global int64_t *) mem_32149)[defunc_1_f_res_29376] =\n                write_value_29373;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29376) &&\n            slt64(defunc_1_f_res_29376, defunc_2_reduce_res_29171)) {\n            ((__global int64_t *) mem_32151)[defunc_1_f_res_29376] =\n                write_value_29374;\n        }\n",
            "    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30806\n}\n__kernel void test_clusterWithzisegmap_30809(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             __global unsigned char *mem_32118,\n                                             __global unsigned char *mem_32120,\n                                             __global\n                                             unsigned char *defunc_0_f_res_mem_32166,\n                                             __global unsigned char *mem_32169,\n                                             __global unsigned char *mem_32171,\n                                             __global unsigned char *mem_32173)\n{\n    #define segmap_group_sizze_30826 (test_clusterWithzisegmap_group_sizze_30811)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33894;\n    int32_t local_tid_33895;\n    int64_t group_sizze_33898;\n    int32_t wave_sizze_33897;\n    int32_t group_tid_33896;\n    \n    global_tid_33894 = get_global_id(0);\n    local_tid_33895 = get_local_id(0);\n    group_sizze_33898 = get_local_size(0);\n    wave_sizze_33897 = LOCKSTEP_WIDTH;\n    group_tid_33896 = get_group_id(0);\n    \n    int32_t phys_tid_30809;\n    \n    phys_tid_30809 = global_tid_33894;\n    \n    int64_t gtid_30808;\n    \n    gtid_30808 = sext_i32_i64(group_tid_33896) * segmap_group_sizze_30826 +\n        sext_i32_i64(local_tid_33895);\n    if (slt64(gtid_30808, defunc_2_reduce_res_29171)) {\n        int64_t x_30831 = ((__global\n                            int64_t *) defunc_0_f_res_mem_32166)[gtid_30808];\n        bool x_30832 = sle64((int64_t) 0, x_30831);\n        bool y_30833 = slt64(x_30831, d",
            "efunc_2_reduce_res_29171);\n        bool bounds_check_30834 = x_30832 && y_30833;\n        bool index_certs_30835;\n        \n        if (!bounds_check_30834) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                    global_failure_args[0] = x_30831;\n                    global_failure_args[1] = defunc_2_reduce_res_29171;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_0_f_res_30836 = ((__global\n                                         int32_t *) mem_32118)[x_30831];\n        int32_t defunc_0_f_res_30837 = ((__global\n                                         int32_t *) mem_32120)[x_30831];\n        int64_t unsign_arg_30838 = zext_i32_i64(defunc_0_f_res_30836);\n        int64_t x_30839 = unsign_arg_30838 << (int64_t) 32;\n        int64_t unsign_arg_30840 = zext_i32_i64(defunc_0_f_res_30837);\n        int64_t binop_p_30841 = x_30839 | unsign_arg_30840;\n        \n        ((__global int64_t *) mem_32169)[gtid_30808] = binop_p_30841;\n        ((__global int32_t *) mem_32171)[gtid_30808] = defunc_0_f_res_30836;\n        ((__global int32_t *) mem_32173)[gtid_30808] = defunc_0_f_res_30837;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30826\n}\n__kernel void test_clusterWithzisegmap_30843(__global int *global_failure,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             __global unsigned char *mem_32169,\n                                             __global unsigned char *mem_32176)\n{\n    #define segmap_group_sizze_30853 (test_clusterWithzisegmap_group_sizze_30845)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33899;\n    int32_t local_tid_33900;\n    int64_t group_sizze_33903;\n    int32_t wave_sizze_33902;\n    int32_t group_tid_33901;\n    \n    global",
            "_tid_33899 = get_global_id(0);\n    local_tid_33900 = get_local_id(0);\n    group_sizze_33903 = get_local_size(0);\n    wave_sizze_33902 = LOCKSTEP_WIDTH;\n    group_tid_33901 = get_group_id(0);\n    \n    int32_t phys_tid_30843;\n    \n    phys_tid_30843 = global_tid_33899;\n    \n    int64_t gtid_30842;\n    \n    gtid_30842 = sext_i32_i64(group_tid_33901) * segmap_group_sizze_30853 +\n        sext_i32_i64(local_tid_33900);\n    if (slt64(gtid_30842, defunc_2_reduce_res_29171)) {\n        int64_t x_30856 = ((__global int64_t *) mem_32169)[gtid_30842];\n        int64_t i_p_o_31871 = add64((int64_t) -1, gtid_30842);\n        int64_t rot_i_31872 = smod64(i_p_o_31871, defunc_2_reduce_res_29171);\n        int64_t x_30857 = ((__global int64_t *) mem_32169)[rot_i_31872];\n        bool defunc_1_f_res_30858 = x_30856 == x_30857;\n        bool defunc_1_f_res_30859 = !defunc_1_f_res_30858;\n        \n        ((__global bool *) mem_32176)[gtid_30842] = defunc_1_f_res_30859;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30853\n}\n__kernel void test_clusterWithzisegmap_30877(__global int *global_failure,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             int64_t num_segments_29432,\n                                             __global unsigned char *mem_32176,\n                                             __global unsigned char *mem_32181,\n                                             __global unsigned char *mem_32184,\n                                             __global unsigned char *mem_32186)\n{\n    #define segmap_group_sizze_30880 (test_clusterWithzisegmap_group_sizze_30879)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34119;\n    int32_t local_tid_34120;\n    int64_t group_sizze_34123;\n    int32_t wave_sizze_34122;\n    int32_t group_tid_34121;\n    \n    global_tid_34119 = get_global_",
            "id(0);\n    local_tid_34120 = get_local_id(0);\n    group_sizze_34123 = get_local_size(0);\n    wave_sizze_34122 = LOCKSTEP_WIDTH;\n    group_tid_34121 = get_group_id(0);\n    \n    int32_t phys_tid_30877;\n    \n    phys_tid_30877 = global_tid_34119;\n    \n    int64_t write_i_30876;\n    \n    write_i_30876 = sext_i32_i64(group_tid_34121) * segmap_group_sizze_30880 +\n        sext_i32_i64(local_tid_34120);\n    if (slt64(write_i_30876, defunc_2_reduce_res_29171)) {\n        int64_t i_p_o_31875 = add64((int64_t) 1, write_i_30876);\n        int64_t rot_i_31876 = smod64(i_p_o_31875, defunc_2_reduce_res_29171);\n        bool x_29441 = ((__global bool *) mem_32176)[rot_i_31876];\n        int64_t write_value_29442 = ((__global\n                                      int64_t *) mem_32181)[write_i_30876];\n        int64_t defunc_1_f_res_29443;\n        \n        if (x_29441) {\n            int64_t x_29440 = ((__global int64_t *) mem_32184)[write_i_30876];\n            int64_t defunc_1_f_res_t_res_29444 = sub64(x_29440, (int64_t) 1);\n            \n            defunc_1_f_res_29443 = defunc_1_f_res_t_res_29444;\n        } else {\n            defunc_1_f_res_29443 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29443) &&\n            slt64(defunc_1_f_res_29443, num_segments_29432)) {\n            ((__global int64_t *) mem_32186)[defunc_1_f_res_29443] =\n                write_value_29442;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30880\n}\n__kernel void test_clusterWithzisegmap_30891(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t defunc_2_reduce_res_29171,\n                                             int64_t num_segments_29432,\n                                             __global unsigned char *mem_32171,\n                                             __global unsigned",
            " char *mem_32173,\n                                             __global unsigned char *mem_32192,\n                                             __global unsigned char *mem_32195,\n                                             __global unsigned char *mem_32197,\n                                             __global unsigned char *mem_32199)\n{\n    #define segmap_group_sizze_30905 (test_clusterWithzisegmap_group_sizze_30893)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34211;\n    int32_t local_tid_34212;\n    int64_t group_sizze_34215;\n    int32_t wave_sizze_34214;\n    int32_t group_tid_34213;\n    \n    global_tid_34211 = get_global_id(0);\n    local_tid_34212 = get_local_id(0);\n    group_sizze_34215 = get_local_size(0);\n    wave_sizze_34214 = LOCKSTEP_WIDTH;\n    group_tid_34213 = get_group_id(0);\n    \n    int32_t phys_tid_30891;\n    \n    phys_tid_30891 = global_tid_34211;\n    \n    int64_t gtid_30890;\n    \n    gtid_30890 = sext_i32_i64(group_tid_34213) * segmap_group_sizze_30905 +\n        sext_i32_i64(local_tid_34212);\n    if (slt64(gtid_30890, num_segments_29432)) {\n        int64_t x_30910 = ((__global int64_t *) mem_32192)[gtid_30890];\n        bool x_30911 = sle64((int64_t) 0, x_30910);\n        bool y_30912 = slt64(x_30910, defunc_2_reduce_res_29171);\n        bool bounds_check_30913 = x_30911 && y_30912;\n        bool index_certs_30914;\n        \n        if (!bounds_check_30913) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                    global_failure_args[0] = x_30910;\n                    global_failure_args[1] = defunc_2_reduce_res_29171;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_0_f_res_30915 = ((__global\n                                         int32_t *) mem_32171)[x_30910];\n        int32_t defunc_0_f_res_30916 =",
            " ((__global\n                                         int32_t *) mem_32173)[x_30910];\n        int64_t defunc_0_f_res_30917 = sext_i32_i64(defunc_0_f_res_30915);\n        \n        ((__global int64_t *) mem_32195)[gtid_30890] = defunc_0_f_res_30917;\n        ((__global int32_t *) mem_32197)[gtid_30890] = defunc_0_f_res_30915;\n        ((__global int32_t *) mem_32199)[gtid_30890] = defunc_0_f_res_30916;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30905\n}\n__kernel void test_clusterWithzisegmap_30919(__global int *global_failure,\n                                             int64_t num_segments_29432,\n                                             __global unsigned char *mem_32195,\n                                             __global unsigned char *mem_32202)\n{\n    #define segmap_group_sizze_30929 (test_clusterWithzisegmap_group_sizze_30921)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34216;\n    int32_t local_tid_34217;\n    int64_t group_sizze_34220;\n    int32_t wave_sizze_34219;\n    int32_t group_tid_34218;\n    \n    global_tid_34216 = get_global_id(0);\n    local_tid_34217 = get_local_id(0);\n    group_sizze_34220 = get_local_size(0);\n    wave_sizze_34219 = LOCKSTEP_WIDTH;\n    group_tid_34218 = get_group_id(0);\n    \n    int32_t phys_tid_30919;\n    \n    phys_tid_30919 = global_tid_34216;\n    \n    int64_t gtid_30918;\n    \n    gtid_30918 = sext_i32_i64(group_tid_34218) * segmap_group_sizze_30929 +\n        sext_i32_i64(local_tid_34217);\n    if (slt64(gtid_30918, num_segments_29432)) {\n        int64_t x_30932 = ((__global int64_t *) mem_32195)[gtid_30918];\n        int64_t i_p_o_31877 = add64((int64_t) -1, gtid_30918);\n        int64_t rot_i_31878 = smod64(i_p_o_31877, num_segments_29432);\n        int64_t x_30933 = ((__global int64_t *) mem_32195)[rot_i_31878];\n        bool defunc_1_f_res_30934 = x_30932 == x_30933;\n        bool defunc_",
            "1_f_res_30935 = !defunc_1_f_res_30934;\n        \n        ((__global bool *) mem_32202)[gtid_30918] = defunc_1_f_res_30935;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30929\n}\n__kernel void test_clusterWithzisegmap_30953(__global int *global_failure,\n                                             int64_t num_segments_29432,\n                                             int64_t num_segments_29493,\n                                             __global unsigned char *mem_32202,\n                                             __global unsigned char *mem_32207,\n                                             __global unsigned char *mem_32210,\n                                             __global unsigned char *mem_32212)\n{\n    #define segmap_group_sizze_30956 (test_clusterWithzisegmap_group_sizze_30955)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34436;\n    int32_t local_tid_34437;\n    int64_t group_sizze_34440;\n    int32_t wave_sizze_34439;\n    int32_t group_tid_34438;\n    \n    global_tid_34436 = get_global_id(0);\n    local_tid_34437 = get_local_id(0);\n    group_sizze_34440 = get_local_size(0);\n    wave_sizze_34439 = LOCKSTEP_WIDTH;\n    group_tid_34438 = get_group_id(0);\n    \n    int32_t phys_tid_30953;\n    \n    phys_tid_30953 = global_tid_34436;\n    \n    int64_t write_i_30952;\n    \n    write_i_30952 = sext_i32_i64(group_tid_34438) * segmap_group_sizze_30956 +\n        sext_i32_i64(local_tid_34437);\n    if (slt64(write_i_30952, num_segments_29432)) {\n        int64_t i_p_o_31881 = add64((int64_t) 1, write_i_30952);\n        int64_t rot_i_31882 = smod64(i_p_o_31881, num_segments_29432);\n        bool x_29506 = ((__global bool *) mem_32202)[rot_i_31882];\n        int64_t write_value_29507 = ((__global\n                                      int64_t *) mem_32207)[write_i_30952];\n        int64_t defunc_1_f_res_29508;\n        \n        if (x_2950",
            "6) {\n            int64_t x_29505 = ((__global int64_t *) mem_32210)[write_i_30952];\n            int64_t defunc_1_f_res_t_res_29509 = sub64(x_29505, (int64_t) 1);\n            \n            defunc_1_f_res_29508 = defunc_1_f_res_t_res_29509;\n        } else {\n            defunc_1_f_res_29508 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_29508) &&\n            slt64(defunc_1_f_res_29508, num_segments_29493)) {\n            ((__global int64_t *) mem_32212)[defunc_1_f_res_29508] =\n                write_value_29507;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30956\n}\n__kernel void test_clusterWithzisegmap_30967(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t numVert_28890,\n                                             int64_t num_segments_29432,\n                                             int64_t num_segments_29493,\n                                             __global unsigned char *mem_32197,\n                                             __global unsigned char *mem_32212,\n                                             __global unsigned char *mem_32218,\n                                             __global unsigned char *mem_32220,\n                                             __global unsigned char *mem_32222)\n{\n    #define segmap_group_sizze_30970 (test_clusterWithzisegmap_group_sizze_30969)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34528;\n    int32_t local_tid_34529;\n    int64_t group_sizze_34532;\n    int32_t wave_sizze_34531;\n    int32_t group_tid_34530;\n    \n    global_tid_34528 = get_global_id(0);\n    local_tid_34529 = get_local_id(0);\n    group_sizze_34532 = get_local_size(0);\n    wave_sizze_34531 = LO",
            "CKSTEP_WIDTH;\n    group_tid_34530 = get_group_id(0);\n    \n    int32_t phys_tid_30967;\n    \n    phys_tid_30967 = global_tid_34528;\n    \n    int64_t write_i_30966;\n    \n    write_i_30966 = sext_i32_i64(group_tid_34530) * segmap_group_sizze_30970 +\n        sext_i32_i64(local_tid_34529);\n    if (slt64(write_i_30966, num_segments_29493)) {\n        int64_t x_29524 = ((__global int64_t *) mem_32218)[write_i_30966];\n        int64_t write_value_29525 = ((__global\n                                      int64_t *) mem_32212)[write_i_30966];\n        bool x_29526 = sle64((int64_t) 0, x_29524);\n        bool y_29527 = slt64(x_29524, num_segments_29432);\n        bool bounds_check_29528 = x_29526 && y_29527;\n        bool index_certs_29529;\n        \n        if (!bounds_check_29528) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n                    global_failure_args[0] = x_29524;\n                    global_failure_args[1] = num_segments_29432;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t i32_arg_29530 = ((__global int32_t *) mem_32197)[x_29524];\n        int64_t i32_res_29531 = sext_i32_i64(i32_arg_29530);\n        \n        if (sle64((int64_t) 0, i32_res_29531) && slt64(i32_res_29531,\n                                                       numVert_28890)) {\n            ((__global int64_t *) mem_32220)[i32_res_29531] = write_value_29525;\n        }\n        if (sle64((int64_t) 0, i32_res_29531) && slt64(i32_res_29531,\n                                                       numVert_28890)) {\n            ((__global int64_t *) mem_32222)[i32_res_29531] = x_29524;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30970\n}\n__kernel void test_clusterWithzisegmap_31021(__global int *global_failure,\n                                             int64_t numVert_28890, __global\n                                             unsigned char *mem_32038, __global\n        ",
            "                                     unsigned char *mem_32278, __global\n                                             unsigned char *mem_32280, __global\n                                             unsigned char *mem_32282)\n{\n    #define segmap_group_sizze_31024 (test_clusterWithzisegmap_group_sizze_31023)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34738;\n    int32_t local_tid_34739;\n    int64_t group_sizze_34742;\n    int32_t wave_sizze_34741;\n    int32_t group_tid_34740;\n    \n    global_tid_34738 = get_global_id(0);\n    local_tid_34739 = get_local_id(0);\n    group_sizze_34742 = get_local_size(0);\n    wave_sizze_34741 = LOCKSTEP_WIDTH;\n    group_tid_34740 = get_group_id(0);\n    \n    int32_t phys_tid_31021;\n    \n    phys_tid_31021 = global_tid_34738;\n    \n    int64_t write_i_31020;\n    \n    write_i_31020 = sext_i32_i64(group_tid_34740) * segmap_group_sizze_31024 +\n        sext_i32_i64(local_tid_34739);\n    if (slt64(write_i_31020, numVert_28890)) {\n        int64_t c_29595 = ((__global int64_t *) mem_32280)[write_i_31020];\n        int64_t offset_29596 = ((__global int64_t *) mem_32278)[write_i_31020];\n        int32_t v_29597 = ((__global int32_t *) mem_32038)[write_i_31020];\n        bool is_this_one_29599 = c_29595 == (int64_t) 0;\n        int64_t this_offset_29600 = (int64_t) -1 + offset_29596;\n        int64_t total_res_29601;\n        \n        if (is_this_one_29599) {\n            total_res_29601 = this_offset_29600;\n        } else {\n            total_res_29601 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, total_res_29601) && slt64(total_res_29601,\n                                                         numVert_28890)) {\n            ((__global int32_t *) mem_32282)[total_res_29601] = v_29597;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31024\n}\n__kernel void test_clusterWithzisegmap_31068(__global int",
            " *global_failure,\n                                             int64_t defunc_2_reduce_res_29634,\n                                             __global unsigned char *mem_32303,\n                                             __global unsigned char *mem_32306)\n{\n    #define segmap_group_sizze_31078 (test_clusterWithzisegmap_group_sizze_31070)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_35130;\n    int32_t local_tid_35131;\n    int64_t group_sizze_35134;\n    int32_t wave_sizze_35133;\n    int32_t group_tid_35132;\n    \n    global_tid_35130 = get_global_id(0);\n    local_tid_35131 = get_local_id(0);\n    group_sizze_35134 = get_local_size(0);\n    wave_sizze_35133 = LOCKSTEP_WIDTH;\n    group_tid_35132 = get_group_id(0);\n    \n    int32_t phys_tid_31068;\n    \n    phys_tid_31068 = global_tid_35130;\n    \n    int64_t gtid_31067;\n    \n    gtid_31067 = sext_i32_i64(group_tid_35132) * segmap_group_sizze_31078 +\n        sext_i32_i64(local_tid_35131);\n    if (slt64(gtid_31067, defunc_2_reduce_res_29634)) {\n        int64_t x_31081 = ((__global int64_t *) mem_32303)[gtid_31067];\n        int64_t i_p_o_31893 = add64((int64_t) -1, gtid_31067);\n        int64_t rot_i_31894 = smod64(i_p_o_31893, defunc_2_reduce_res_29634);\n        int64_t x_31082 = ((__global int64_t *) mem_32303)[rot_i_31894];\n        bool defunc_1_f_res_31083 = x_31081 == x_31082;\n        bool defunc_1_f_res_31084 = !defunc_1_f_res_31083;\n        \n        ((__global bool *) mem_32306)[gtid_31067] = defunc_1_f_res_31084;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31078\n}\n__kernel void test_clusterWithzisegmap_31102(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             int64_t numVert_28890,\n                ",
            "                             int64_t sizze_29106,\n                                             int64_t partition_sizze_29591,\n                                             int64_t defunc_2_reduce_res_29634,\n                                             __global\n                                             unsigned char *clusterWith_res_mem_32265,\n                                             __global\n                                             unsigned char *clusterWith_res_mem_32270,\n                                             __global unsigned char *mem_32282,\n                                             __global unsigned char *mem_32303,\n                                             __global unsigned char *mem_32316,\n                                             __global unsigned char *mem_32319)\n{\n    #define segmap_group_sizze_31131 (test_clusterWithzisegmap_group_sizze_31104)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_35355;\n    int32_t local_tid_35356;\n    int64_t group_sizze_35359;\n    int32_t wave_sizze_35358;\n    int32_t group_tid_35357;\n    \n    global_tid_35355 = get_global_id(0);\n    local_tid_35356 = get_local_id(0);\n    group_sizze_35359 = get_local_size(0);\n    wave_sizze_35358 = LOCKSTEP_WIDTH;\n    group_tid_35357 = get_group_id(0);\n    \n    int32_t phys_tid_31102;\n    \n    phys_tid_31102 = global_tid_35355;\n    \n    int64_t gtid_31101;\n    \n    gtid_31101 = sext_i32_i64(group_tid_35357) * segmap_group_sizze_31131 +\n        sext_i32_i64(local_tid_35356);\n    if (slt64(gtid_31101, defunc_2_reduce_res_29634)) {\n        int64_t x_31135 = ((__global int64_t *) mem_32316)[gtid_31101];\n        int64_t x_31136 = ((__global int64_t *) mem_32303)[gtid_31101];\n        int64_t defunc_0_f_res_31139 = sub64(x_31135, (int64_t) 1);\n        bool x_31140 = sle64((int64_t) 0, x_31136);\n        bool y_31141 = slt64(x_31136, partition_sizze_29",
            "591);\n        bool bounds_check_31142 = x_31140 && y_31141;\n        bool index_certs_31143;\n        \n        if (!bounds_check_31142) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 24) == -1) {\n                    global_failure_args[0] = x_31136;\n                    global_failure_args[1] = partition_sizze_29591;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_0_get_arg_31144 = ((__global\n                                           int32_t *) mem_32282)[x_31136];\n        int64_t s_31145 = sext_i32_i64(defunc_0_get_arg_31144);\n        bool x_31146 = sle64((int64_t) 0, s_31145);\n        bool y_31147 = slt64(s_31145, numVert_28890);\n        bool bounds_check_31148 = x_31146 && y_31147;\n        bool index_certs_31149;\n        \n        if (!bounds_check_31148) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 25) == -1) {\n                    global_failure_args[0] = s_31145;\n                    global_failure_args[1] = numVert_28890;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t x_31150 = ((__global\n                            int64_t *) clusterWith_res_mem_32270)[s_31145];\n        int64_t i_31151 = add64(defunc_0_f_res_31139, x_31150);\n        bool x_31152 = sle64((int64_t) 0, i_31151);\n        bool y_31153 = slt64(i_31151, sizze_29106);\n        bool bounds_check_31154 = x_31152 && y_31153;\n        bool index_certs_31155;\n        \n        if (!bounds_check_31154) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 26) == -1) {\n                    global_failure_args[0] = i_31151;\n                    global_failure_args[1] = sizze_29106;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_1_get_res_31156 = ((__global\n                                           int32_t *) cl",
            "usterWith_res_mem_32265)[i_31151];\n        \n        ((__global int32_t *) mem_32319)[gtid_31101] = defunc_1_get_res_31156;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_31131\n}\n__kernel void test_clusterWithzisegred_large_33339(__global int *global_failure,\n                                                   uint sync_arr_mem_33377_backing_offset_0,\n                                                   uint red_arr_mem_33375_backing_offset_1,\n                                                   int64_t defunc_2_reduce_res_29171,\n                                                   int64_t num_groups_30657,\n                                                   int32_t num_subhistos_33260,\n                                                   int64_t groups_per_segment_33361,\n                                                   int64_t elements_per_thread_33362,\n                                                   int64_t virt_num_groups_33363,\n                                                   int64_t threads_per_segment_33365,\n                                                   __global\n                                                   unsigned char *mem_32102,\n                                                   __global\n                                                   unsigned char *defunc_1_map_res_subhistos_mem_33261,\n                                                   __global\n                                                   unsigned char *group_res_arr_mem_33366,\n                                                   __global\n                                                   unsigned char *test_clusterWithzicounter_mem_33368)\n{\n    #define seghist_group_sizze_30655 (test_clusterWithziseghist_group_sizze_30654)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *sync_arr_mem_33377_backing_1 =\n                  &shared_mem[sync_arr_mem_33377_backing_offset_0];\n    volatile char *red_arr_mem_33375_backin",
            "g_0 =\n                  &shared_mem[red_arr_mem_33375_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33370;\n    int32_t local_tid_33371;\n    int64_t group_sizze_33374;\n    int32_t wave_sizze_33373;\n    int32_t group_tid_33372;\n    \n    global_tid_33370 = get_global_id(0);\n    local_tid_33371 = get_local_id(0);\n    group_sizze_33374 = get_local_size(0);\n    wave_sizze_33373 = LOCKSTEP_WIDTH;\n    group_tid_33372 = get_group_id(0);\n    \n    int32_t flat_gtid_33339;\n    \n    flat_gtid_33339 = global_tid_33370;\n    \n    __local char *red_arr_mem_33375;\n    \n    red_arr_mem_33375 = (__local char *) red_arr_mem_33375_backing_0;\n    \n    __local char *sync_arr_mem_33377;\n    \n    sync_arr_mem_33377 = (__local char *) sync_arr_mem_33377_backing_1;\n    \n    int32_t phys_group_id_33379;\n    \n    phys_group_id_33379 = get_group_id(0);\n    for (int32_t i_33380 = 0; i_33380 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_33363) - phys_group_id_33379,\n                   sext_i64_i32(num_groups_30657)); i_33380++) {\n        int32_t virt_group_id_33381 = phys_group_id_33379 + i_33380 *\n                sext_i64_i32(num_groups_30657);\n        int32_t flat_segment_id_33382 = squot32(virt_group_id_33381,\n                                                sext_i64_i32(groups_per_segment_33361));\n        int64_t global_tid_33383 = srem64(sext_i32_i64(virt_group_id_33381) *\n                                          seghist_group_sizze_30655 +\n                                          sext_i32_i64(local_tid_33371),\n                                          seghist_group_sizze_30655 *\n                                          groups_per_segment_33361);\n        int64_t bucket_id_33337 = sext_i32_i64(flat_segment_id_33382);\n        int64_t subhistogram_id_33338;\n        int64_t x_acc_33384;\n        int64_t chunk_sizze_33385;\n        \n        chunk_sizze_33385 = smin64(elements_per_thread_33362,\n                                   sdiv_up64(num_s",
            "ubhistos_33260 -\n                                             global_tid_33383,\n                                             threads_per_segment_33365));\n        \n        int64_t x_30661;\n        int64_t x_30662;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_33384 = (int64_t) 0;\n        }\n        for (int64_t i_33389 = 0; i_33389 < chunk_sizze_33385; i_33389++) {\n            subhistogram_id_33338 = global_tid_33383 +\n                threads_per_segment_33365 * i_33389;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_30661 = x_acc_33384;\n                }\n                // load new values\n                {\n                    x_30662 = ((__global\n                                int64_t *) defunc_1_map_res_subhistos_mem_33261)[subhistogram_id_33338 *\n                                                                                 defunc_2_reduce_res_29171 +\n                                                                                 bucket_id_33337];\n                }\n                // apply reduction operator\n                {\n                    int64_t defunc_1_f_res_30663 = smax64(x_30661, x_30662);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_33384 = defunc_1_f_res_30663;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_30661 = x_acc_33384;\n            ((__local\n              int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                x_30661;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_33390;\n        int32_t skip_waves_33391;\n        \n        skip_waves_33391 = 1;\n        \n        int64_t x_33386;\n        int64_t x_33387;\n        \n        offset_33390 = 0;\n        // participating threads read initial accumulator\n",
            "        {\n            if (slt32(local_tid_33371,\n                      sext_i64_i32(seghist_group_sizze_30655))) {\n                x_33386 = ((__local\n                            int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                          offset_33390)];\n            }\n        }\n        offset_33390 = 1;\n        while (slt32(offset_33390, wave_sizze_33373)) {\n            if (slt32(local_tid_33371 + offset_33390,\n                      sext_i64_i32(seghist_group_sizze_30655)) &&\n                ((local_tid_33371 - squot32(local_tid_33371, wave_sizze_33373) *\n                  wave_sizze_33373) & (2 * offset_33390 - 1)) == 0) {\n                // read array element\n                {\n                    x_33387 = ((volatile __local\n                                int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                              offset_33390)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_33388 = smax64(x_33386, x_33387);\n                    \n                    x_33386 = defunc_1_f_res_33388;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                        x_33386;\n                }\n            }\n            offset_33390 *= 2;\n        }\n        while (slt32(skip_waves_33391,\n                     squot32(sext_i64_i32(seghist_group_sizze_30655) +\n                             wave_sizze_33373 - 1, wave_sizze_33373))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_33390 = skip_waves_33391 * wave_sizze_33373;\n            if (slt32(local_tid_33371 + offset_33390,\n                      sext_i64_i32(seghist_group_sizze_30655)) &&\n                ((local_tid_33371 - squot32(local_tid_33371, wave_sizze_33373) *\n ",
            "                 wave_sizze_33373) == 0 && (squot32(local_tid_33371,\n                                                     wave_sizze_33373) & (2 *\n                                                                          skip_waves_33391 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_33387 = ((__local\n                                int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                              offset_33390)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_33388 = smax64(x_33386, x_33387);\n                    \n                    x_33386 = defunc_1_f_res_33388;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                        x_33386;\n                }\n            }\n            skip_waves_33391 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_33371) == (int64_t) 0) {\n                x_acc_33384 = x_33386;\n            }\n        }\n        if (groups_per_segment_33361 == (int64_t) 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_33371 == 0) {\n                    ((__global int64_t *) mem_32102)[bucket_id_33337] =\n                        x_acc_33384;\n                }\n            }\n        } else {\n            int32_t old_counter_33392;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_33371 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_33366)[sext_i32_i64",
            "(virt_group_id_33381) *\n                                                          seghist_group_sizze_30655] =\n                        x_acc_33384;\n                    mem_fence_global();\n                    old_counter_33392 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_clusterWithzicounter_mem_33368)[sext_i32_i64(srem32(flat_segment_id_33382,\n                                                                                                                 10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_33377)[(int64_t) 0] =\n                        old_counter_33392 == groups_per_segment_33361 -\n                        (int64_t) 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_33393;\n            \n            is_last_group_33393 = ((__local\n                                    bool *) sync_arr_mem_33377)[(int64_t) 0];\n            if (is_last_group_33393) {\n                if (local_tid_33371 == 0) {\n                    old_counter_33392 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_clusterWithzicounter_mem_33368)[sext_i32_i64(srem32(flat_segment_id_33382,\n                                                                                                                 10240))],\n                                              (int) ((int64_t) 0 -\n                                                     groups_per_segment_33361));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_33394 =\n                            sdiv_up64(groups_per_segment_33361,\n                                      seghist_group_sizze_30655);\n                    \n                    x_30661 = (int64_t) ",
            "0;\n                    for (int64_t i_33395 = 0; i_33395 < read_per_thread_33394;\n                         i_33395++) {\n                        int64_t group_res_id_33396 =\n                                sext_i32_i64(local_tid_33371) *\n                                read_per_thread_33394 + i_33395;\n                        int64_t index_of_group_res_33397 =\n                                sext_i32_i64(flat_segment_id_33382) *\n                                groups_per_segment_33361 + group_res_id_33396;\n                        \n                        if (slt64(group_res_id_33396,\n                                  groups_per_segment_33361)) {\n                            x_30662 = ((__global\n                                        int64_t *) group_res_arr_mem_33366)[index_of_group_res_33397 *\n                                                                            seghist_group_sizze_30655];\n                            \n                            int64_t defunc_1_f_res_30663;\n                            \n                            defunc_1_f_res_30663 = smax64(x_30661, x_30662);\n                            x_30661 = defunc_1_f_res_30663;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                    x_30661;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_33398;\n                    int32_t skip_waves_33399;\n                    \n                    skip_waves_33399 = 1;\n                    \n                    int64_t x_33386;\n                    int64_t x_33387;\n                    \n                    offset_33398 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_33371,\n                                  sext_i64_i32(seghist_group_sizze_30655))) {",
            "\n                            x_33386 = ((__local\n                                        int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                                      offset_33398)];\n                        }\n                    }\n                    offset_33398 = 1;\n                    while (slt32(offset_33398, wave_sizze_33373)) {\n                        if (slt32(local_tid_33371 + offset_33398,\n                                  sext_i64_i32(seghist_group_sizze_30655)) &&\n                            ((local_tid_33371 - squot32(local_tid_33371,\n                                                        wave_sizze_33373) *\n                              wave_sizze_33373) & (2 * offset_33398 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_33387 = ((volatile __local\n                                            int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                                          offset_33398)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_33388 = smax64(x_33386,\n                                                                      x_33387);\n                                \n                                x_33386 = defunc_1_f_res_33388;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                                    x_33386;\n                            }\n                        }\n                        offset_33398 *= 2;\n                    }\n                    while (slt32(skip_waves_33399,\n                ",
            "                 squot32(sext_i64_i32(seghist_group_sizze_30655) +\n                                         wave_sizze_33373 - 1,\n                                         wave_sizze_33373))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_33398 = skip_waves_33399 * wave_sizze_33373;\n                        if (slt32(local_tid_33371 + offset_33398,\n                                  sext_i64_i32(seghist_group_sizze_30655)) &&\n                            ((local_tid_33371 - squot32(local_tid_33371,\n                                                        wave_sizze_33373) *\n                              wave_sizze_33373) == 0 &&\n                             (squot32(local_tid_33371, wave_sizze_33373) & (2 *\n                                                                            skip_waves_33399 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_33387 = ((__local\n                                            int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371 +\n                                                                          offset_33398)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_33388 = smax64(x_33386,\n                                                                      x_33387);\n                                \n                                x_33386 = defunc_1_f_res_33388;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_33375)[sext_i32_i64(local_tid_33371)] =\n                                    x_33386;\n                            }\n    ",
            "                    }\n                        skip_waves_33399 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_33371 == 0) {\n                            ((__global int64_t *) mem_32102)[bucket_id_33337] =\n                                x_33386;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_30655\n}\n__kernel void test_clusterWithzisegred_large_34936(__global int *global_failure,\n                                                   uint sync_arr_mem_34974_backing_offset_0,\n                                                   uint red_arr_mem_34972_backing_offset_1,\n                                                   int64_t defunc_2_reduce_res_29634,\n                                                   int64_t num_groups_31048,\n                                                   int32_t num_subhistos_34857,\n                                                   int64_t groups_per_segment_34958,\n                                                   int64_t elements_per_thread_34959,\n                                                   int64_t virt_num_groups_34960,\n                                                   int64_t threads_per_segment_34962,\n                                                   __global\n                                                   unsigned char *mem_32297,\n                                                   __global\n                                                   unsigned char *defunc_1_map_res_subhistos_mem_34858,\n                                                   __global\n                                                   unsigned char *group_res_arr_mem_34963,\n                                                   __global\n                                                   unsigned char *",
            "test_clusterWithzicounter_mem_34965)\n{\n    #define seghist_group_sizze_31046 (test_clusterWithziseghist_group_sizze_31045)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *sync_arr_mem_34974_backing_1 =\n                  &shared_mem[sync_arr_mem_34974_backing_offset_0];\n    volatile char *red_arr_mem_34972_backing_0 =\n                  &shared_mem[red_arr_mem_34972_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34967;\n    int32_t local_tid_34968;\n    int64_t group_sizze_34971;\n    int32_t wave_sizze_34970;\n    int32_t group_tid_34969;\n    \n    global_tid_34967 = get_global_id(0);\n    local_tid_34968 = get_local_id(0);\n    group_sizze_34971 = get_local_size(0);\n    wave_sizze_34970 = LOCKSTEP_WIDTH;\n    group_tid_34969 = get_group_id(0);\n    \n    int32_t flat_gtid_34936;\n    \n    flat_gtid_34936 = global_tid_34967;\n    \n    __local char *red_arr_mem_34972;\n    \n    red_arr_mem_34972 = (__local char *) red_arr_mem_34972_backing_0;\n    \n    __local char *sync_arr_mem_34974;\n    \n    sync_arr_mem_34974 = (__local char *) sync_arr_mem_34974_backing_1;\n    \n    int32_t phys_group_id_34976;\n    \n    phys_group_id_34976 = get_group_id(0);\n    for (int32_t i_34977 = 0; i_34977 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_34960) - phys_group_id_34976,\n                   sext_i64_i32(num_groups_31048)); i_34977++) {\n        int32_t virt_group_id_34978 = phys_group_id_34976 + i_34977 *\n                sext_i64_i32(num_groups_31048);\n        int32_t flat_segment_id_34979 = squot32(virt_group_id_34978,\n                                                sext_i64_i32(groups_per_segment_34958));\n        int64_t global_tid_34980 = srem64(sext_i32_i64(virt_group_id_34978) *\n                                          seghist_group_sizze_31046 +\n                                          sext_i32_i64(local_tid_34968),\n                                          seghist_group",
            "_sizze_31046 *\n                                          groups_per_segment_34958);\n        int64_t bucket_id_34934 = sext_i32_i64(flat_segment_id_34979);\n        int64_t subhistogram_id_34935;\n        int64_t x_acc_34981;\n        int64_t chunk_sizze_34982;\n        \n        chunk_sizze_34982 = smin64(elements_per_thread_34959,\n                                   sdiv_up64(num_subhistos_34857 -\n                                             global_tid_34980,\n                                             threads_per_segment_34962));\n        \n        int64_t x_31052;\n        int64_t x_31053;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_34981 = (int64_t) 0;\n        }\n        for (int64_t i_34986 = 0; i_34986 < chunk_sizze_34982; i_34986++) {\n            subhistogram_id_34935 = global_tid_34980 +\n                threads_per_segment_34962 * i_34986;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_31052 = x_acc_34981;\n                }\n                // load new values\n                {\n                    x_31053 = ((__global\n                                int64_t *) defunc_1_map_res_subhistos_mem_34858)[subhistogram_id_34935 *\n                                                                                 defunc_2_reduce_res_29634 +\n                                                                                 bucket_id_34934];\n                }\n                // apply reduction operator\n                {\n                    int64_t defunc_1_f_res_31054 = smax64(x_31052, x_31053);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_34981 = defunc_1_f_res_31054;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_31052 = x_acc_34981;\n            ((__local\n              int64_t *) red_arr_me",
            "m_34972)[sext_i32_i64(local_tid_34968)] =\n                x_31052;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_34987;\n        int32_t skip_waves_34988;\n        \n        skip_waves_34988 = 1;\n        \n        int64_t x_34983;\n        int64_t x_34984;\n        \n        offset_34987 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_34968,\n                      sext_i64_i32(seghist_group_sizze_31046))) {\n                x_34983 = ((__local\n                            int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                          offset_34987)];\n            }\n        }\n        offset_34987 = 1;\n        while (slt32(offset_34987, wave_sizze_34970)) {\n            if (slt32(local_tid_34968 + offset_34987,\n                      sext_i64_i32(seghist_group_sizze_31046)) &&\n                ((local_tid_34968 - squot32(local_tid_34968, wave_sizze_34970) *\n                  wave_sizze_34970) & (2 * offset_34987 - 1)) == 0) {\n                // read array element\n                {\n                    x_34984 = ((volatile __local\n                                int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                              offset_34987)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_34985 = smax64(x_34983, x_34984);\n                    \n                    x_34983 = defunc_1_f_res_34985;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968)] =\n                        x_34983;\n                }\n            }\n            offset_34987 *= 2;\n        }\n        while (slt32(skip_waves_34988,\n                     squot32(sext_i64_i32(seghist_group_sizze_31046) +\n  ",
            "                           wave_sizze_34970 - 1, wave_sizze_34970))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_34987 = skip_waves_34988 * wave_sizze_34970;\n            if (slt32(local_tid_34968 + offset_34987,\n                      sext_i64_i32(seghist_group_sizze_31046)) &&\n                ((local_tid_34968 - squot32(local_tid_34968, wave_sizze_34970) *\n                  wave_sizze_34970) == 0 && (squot32(local_tid_34968,\n                                                     wave_sizze_34970) & (2 *\n                                                                          skip_waves_34988 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_34984 = ((__local\n                                int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                              offset_34987)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_1_f_res_34985 = smax64(x_34983, x_34984);\n                    \n                    x_34983 = defunc_1_f_res_34985;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968)] =\n                        x_34983;\n                }\n            }\n            skip_waves_34988 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_34968) == (int64_t) 0) {\n                x_acc_34981 = x_34983;\n            }\n        }\n        if (groups_per_segment_34958 == (int64_t) 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_34968 == 0) {\n                    ((__global int64_t *) mem_32297)[bucket_id_",
            "34934] =\n                        x_acc_34981;\n                }\n            }\n        } else {\n            int32_t old_counter_34989;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_34968 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_34963)[sext_i32_i64(virt_group_id_34978) *\n                                                          seghist_group_sizze_31046] =\n                        x_acc_34981;\n                    mem_fence_global();\n                    old_counter_34989 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_clusterWithzicounter_mem_34965)[sext_i32_i64(srem32(flat_segment_id_34979,\n                                                                                                                 10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_34974)[(int64_t) 0] =\n                        old_counter_34989 == groups_per_segment_34958 -\n                        (int64_t) 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_34990;\n            \n            is_last_group_34990 = ((__local\n                                    bool *) sync_arr_mem_34974)[(int64_t) 0];\n            if (is_last_group_34990) {\n                if (local_tid_34968 == 0) {\n                    old_counter_34989 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test_clusterWithzicounter_mem_34965)[sext_i32_i64(srem32(flat_segment_id_34979,\n                                                                                                                 10240))],\n                                              (int) ((int64_t) 0 -\n                              ",
            "                       groups_per_segment_34958));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_34991 =\n                            sdiv_up64(groups_per_segment_34958,\n                                      seghist_group_sizze_31046);\n                    \n                    x_31052 = (int64_t) 0;\n                    for (int64_t i_34992 = 0; i_34992 < read_per_thread_34991;\n                         i_34992++) {\n                        int64_t group_res_id_34993 =\n                                sext_i32_i64(local_tid_34968) *\n                                read_per_thread_34991 + i_34992;\n                        int64_t index_of_group_res_34994 =\n                                sext_i32_i64(flat_segment_id_34979) *\n                                groups_per_segment_34958 + group_res_id_34993;\n                        \n                        if (slt64(group_res_id_34993,\n                                  groups_per_segment_34958)) {\n                            x_31053 = ((__global\n                                        int64_t *) group_res_arr_mem_34963)[index_of_group_res_34994 *\n                                                                            seghist_group_sizze_31046];\n                            \n                            int64_t defunc_1_f_res_31054;\n                            \n                            defunc_1_f_res_31054 = smax64(x_31052, x_31053);\n                            x_31052 = defunc_1_f_res_31054;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968)] =\n                    x_31052;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_34995;\n                    int32_t skip_waves_34996;\n                    \n                    skip_waves_34996 ",
            "= 1;\n                    \n                    int64_t x_34983;\n                    int64_t x_34984;\n                    \n                    offset_34995 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_34968,\n                                  sext_i64_i32(seghist_group_sizze_31046))) {\n                            x_34983 = ((__local\n                                        int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                                      offset_34995)];\n                        }\n                    }\n                    offset_34995 = 1;\n                    while (slt32(offset_34995, wave_sizze_34970)) {\n                        if (slt32(local_tid_34968 + offset_34995,\n                                  sext_i64_i32(seghist_group_sizze_31046)) &&\n                            ((local_tid_34968 - squot32(local_tid_34968,\n                                                        wave_sizze_34970) *\n                              wave_sizze_34970) & (2 * offset_34995 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_34984 = ((volatile __local\n                                            int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                                          offset_34995)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_34985 = smax64(x_34983,\n                                                                      x_34984);\n                                \n                                x_34983 = defunc_1_f_res_34985;\n                            }\n                            // write result of operation\n                            {\n  ",
            "                              ((volatile __local\n                                  int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968)] =\n                                    x_34983;\n                            }\n                        }\n                        offset_34995 *= 2;\n                    }\n                    while (slt32(skip_waves_34996,\n                                 squot32(sext_i64_i32(seghist_group_sizze_31046) +\n                                         wave_sizze_34970 - 1,\n                                         wave_sizze_34970))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_34995 = skip_waves_34996 * wave_sizze_34970;\n                        if (slt32(local_tid_34968 + offset_34995,\n                                  sext_i64_i32(seghist_group_sizze_31046)) &&\n                            ((local_tid_34968 - squot32(local_tid_34968,\n                                                        wave_sizze_34970) *\n                              wave_sizze_34970) == 0 &&\n                             (squot32(local_tid_34968, wave_sizze_34970) & (2 *\n                                                                            skip_waves_34996 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_34984 = ((__local\n                                            int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968 +\n                                                                          offset_34995)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_1_f_res_34985 = smax64(x_34983,\n                                                                      x_34984);\n                                \n                    ",
            "            x_34983 = defunc_1_f_res_34985;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_34972)[sext_i32_i64(local_tid_34968)] =\n                                    x_34983;\n                            }\n                        }\n                        skip_waves_34996 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_34968 == 0) {\n                            ((__global int64_t *) mem_32297)[bucket_id_34934] =\n                                x_34983;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_31046\n}\n__kernel void test_clusterWithzisegred_nonseg_30614(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_33045_backing_offset_0,\n                                                    uint sync_arr_mem_33043_backing_offset_1,\n                                                    int64_t numVert_28890,\n                                                    int64_t num_groups_30608,\n                                                    int64_t num_threads_33037,\n                                                    __global\n                                                    unsigned char *mem_32026,\n                                                    __global\n                                                    unsigned char *mem_32036,\n                                                    __global\n                                                    unsigned char *mem_32038,\n                                                    __global\n                ",
            "                                    unsigned char *test_clusterWithzicounter_mem_33033,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_33035)\n{\n    #define segred_group_sizze_30606 (test_clusterWithzisegred_group_sizze_30605)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33045_backing_1 =\n                  &shared_mem[red_arr_mem_33045_backing_offset_0];\n    volatile char *sync_arr_mem_33043_backing_0 =\n                  &shared_mem[sync_arr_mem_33043_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33038;\n    int32_t local_tid_33039;\n    int64_t group_sizze_33042;\n    int32_t wave_sizze_33041;\n    int32_t group_tid_33040;\n    \n    global_tid_33038 = get_global_id(0);\n    local_tid_33039 = get_local_id(0);\n    group_sizze_33042 = get_local_size(0);\n    wave_sizze_33041 = LOCKSTEP_WIDTH;\n    group_tid_33040 = get_group_id(0);\n    \n    int32_t phys_tid_30614;\n    \n    phys_tid_30614 = global_tid_33038;\n    \n    __local char *sync_arr_mem_33043;\n    \n    sync_arr_mem_33043 = (__local char *) sync_arr_mem_33043_backing_0;\n    \n    __local char *red_arr_mem_33045;\n    \n    red_arr_mem_33045 = (__local char *) red_arr_mem_33045_backing_1;\n    \n    int64_t dummy_30612;\n    \n    dummy_30612 = (int64_t) 0;\n    \n    int64_t gtid_30613;\n    \n    gtid_30613 = (int64_t) 0;\n    \n    bool x_acc_33047;\n    int64_t chunk_sizze_33048;\n    \n    chunk_sizze_33048 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30606 *\n                                         num_groups_30608))),\n                               sdiv_up64(numVert_28890 - phys_tid_30614,\n                                         num_threads_33037));\n    \n    bool x_29097;\n    bool x_29098;\n    \n    // neutral-initialise the accum",
            "ulators\n    {\n        x_acc_33047 = 1;\n    }\n    for (int64_t i_33052 = 0; i_33052 < chunk_sizze_33048; i_33052++) {\n        gtid_30613 = phys_tid_30614 + num_threads_33037 * i_33052;\n        // apply map function\n        {\n            int64_t x_29101 = ((__global int64_t *) mem_32026)[gtid_30613];\n            int32_t defunc_0_f_res_29102 = sext_i64_i32(gtid_30613);\n            bool defunc_1_f_res_29103 = (int64_t) 0 == x_29101;\n            \n            // save map-out results\n            {\n                ((__global int32_t *) mem_32038)[dummy_30612 * numVert_28890 +\n                                                 gtid_30613] =\n                    defunc_0_f_res_29102;\n            }\n            // load accumulator\n            {\n                x_29097 = x_acc_33047;\n            }\n            // load new values\n            {\n                x_29098 = defunc_1_f_res_29103;\n            }\n            // apply reduction operator\n            {\n                bool x_29099 = x_29097 && x_29098;\n                \n                // store in accumulator\n                {\n                    x_acc_33047 = x_29099;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29097 = x_acc_33047;\n        ((__local bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n            x_29097;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33053;\n    int32_t skip_waves_33054;\n    \n    skip_waves_33054 = 1;\n    \n    bool x_33049;\n    bool x_33050;\n    \n    offset_33053 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33039, sext_i64_i32(segred_group_sizze_30606))) {\n            x_33049 = ((__local\n                        bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                   offset_33053)];\n        }\n    }\n    offset_33053 = 1;\n    while (slt32(offset_33053, wave_sizze_33041)) {\n        if (slt32(l",
            "ocal_tid_33039 + offset_33053,\n                  sext_i64_i32(segred_group_sizze_30606)) && ((local_tid_33039 -\n                                                               squot32(local_tid_33039,\n                                                                       wave_sizze_33041) *\n                                                               wave_sizze_33041) &\n                                                              (2 *\n                                                               offset_33053 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_33050 = ((volatile __local\n                            bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                       offset_33053)];\n            }\n            // apply reduction operation\n            {\n                bool x_33051 = x_33049 && x_33050;\n                \n                x_33049 = x_33051;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n                    x_33049;\n            }\n        }\n        offset_33053 *= 2;\n    }\n    while (slt32(skip_waves_33054,\n                 squot32(sext_i64_i32(segred_group_sizze_30606) +\n                         wave_sizze_33041 - 1, wave_sizze_33041))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33053 = skip_waves_33054 * wave_sizze_33041;\n        if (slt32(local_tid_33039 + offset_33053,\n                  sext_i64_i32(segred_group_sizze_30606)) && ((local_tid_33039 -\n                                                               squot32(local_tid_33039,\n                                                                       wave_sizze_33041) *\n                                                               wave_sizze_33041) ==\n                                                      ",
            "        0 &&\n                                                              (squot32(local_tid_33039,\n                                                                       wave_sizze_33041) &\n                                                               (2 *\n                                                                skip_waves_33054 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_33050 = ((__local\n                            bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                       offset_33053)];\n            }\n            // apply reduction operation\n            {\n                bool x_33051 = x_33049 && x_33050;\n                \n                x_33049 = x_33051;\n            }\n            // write result of operation\n            {\n                ((__local\n                  bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n                    x_33049;\n            }\n        }\n        skip_waves_33054 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33039) == (int64_t) 0) {\n            x_acc_33047 = x_33049;\n        }\n    }\n    \n    int32_t old_counter_33055;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33039 == 0) {\n            ((__global\n              bool *) group_res_arr_mem_33035)[sext_i32_i64(group_tid_33040) *\n                                               segred_group_sizze_30606] =\n                x_acc_33047;\n            mem_fence_global();\n            old_counter_33055 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33033)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33043)[(int64_t) 0",
            "] =\n                old_counter_33055 == num_groups_30608 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33056;\n    \n    is_last_group_33056 = ((__local bool *) sync_arr_mem_33043)[(int64_t) 0];\n    if (is_last_group_33056) {\n        if (local_tid_33039 == 0) {\n            old_counter_33055 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33033)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30608));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33057 = sdiv_up64(num_groups_30608,\n                                                      segred_group_sizze_30606);\n            \n            x_29097 = 1;\n            for (int64_t i_33058 = 0; i_33058 < read_per_thread_33057;\n                 i_33058++) {\n                int64_t group_res_id_33059 = sext_i32_i64(local_tid_33039) *\n                        read_per_thread_33057 + i_33058;\n                int64_t index_of_group_res_33060 = group_res_id_33059;\n                \n                if (slt64(group_res_id_33059, num_groups_30608)) {\n                    x_29098 = ((__global\n                                bool *) group_res_arr_mem_33035)[index_of_group_res_33060 *\n                                                                 segred_group_sizze_30606];\n                    \n                    bool x_29099;\n                    \n                    x_29099 = x_29097 && x_29098;\n                    x_29097 = x_29099;\n                }\n            }\n        }\n        ((__local bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n            x_29097;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33061;\n            int32_t skip_wav",
            "es_33062;\n            \n            skip_waves_33062 = 1;\n            \n            bool x_33049;\n            bool x_33050;\n            \n            offset_33061 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33039,\n                          sext_i64_i32(segred_group_sizze_30606))) {\n                    x_33049 = ((__local\n                                bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                           offset_33061)];\n                }\n            }\n            offset_33061 = 1;\n            while (slt32(offset_33061, wave_sizze_33041)) {\n                if (slt32(local_tid_33039 + offset_33061,\n                          sext_i64_i32(segred_group_sizze_30606)) &&\n                    ((local_tid_33039 - squot32(local_tid_33039,\n                                                wave_sizze_33041) *\n                      wave_sizze_33041) & (2 * offset_33061 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_33050 = ((volatile __local\n                                    bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                               offset_33061)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_33051 = x_33049 && x_33050;\n                        \n                        x_33049 = x_33051;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n                            x_33049;\n                    }\n                }\n                offset_33061 *= 2;\n            }\n            while (slt32(skip_waves_33062,\n                         squot32(sext_i64_i32(segred_group_sizze_30606) +\n           ",
            "                      wave_sizze_33041 - 1, wave_sizze_33041))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33061 = skip_waves_33062 * wave_sizze_33041;\n                if (slt32(local_tid_33039 + offset_33061,\n                          sext_i64_i32(segred_group_sizze_30606)) &&\n                    ((local_tid_33039 - squot32(local_tid_33039,\n                                                wave_sizze_33041) *\n                      wave_sizze_33041) == 0 && (squot32(local_tid_33039,\n                                                         wave_sizze_33041) &\n                                                 (2 * skip_waves_33062 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33050 = ((__local\n                                    bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039 +\n                                                               offset_33061)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_33051 = x_33049 && x_33050;\n                        \n                        x_33049 = x_33051;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          bool *) red_arr_mem_33045)[sext_i32_i64(local_tid_33039)] =\n                            x_33049;\n                    }\n                }\n                skip_waves_33062 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_33039 == 0) {\n                    ((__global bool *) mem_32036)[(int64_t) 0] = x_33049;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30606\n}\n__kernel void test_clusterWithzisegred_nonseg_30624(__global\n                                                    int *global_failure,\n                      ",
            "                              uint red_arr_mem_33093_backing_offset_0,\n                                                    uint sync_arr_mem_33091_backing_offset_1,\n                                                    int64_t conc_tmp_28900,\n                                                    int64_t maxSizze_29114,\n                                                    int64_t num_groups_30619,\n                                                    int64_t num_threads_33085,\n                                                    __global\n                                                    unsigned char *mem_32005,\n                                                    __global\n                                                    unsigned char *mem_32066,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_33081,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_33083)\n{\n    #define segred_group_sizze_30617 (test_clusterWithzisegred_group_sizze_30616)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33093_backing_1 =\n                  &shared_mem[red_arr_mem_33093_backing_offset_0];\n    volatile char *sync_arr_mem_33091_backing_0 =\n                  &shared_mem[sync_arr_mem_33091_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33086;\n    int32_t local_tid_33087;\n    int64_t group_sizze_33090;\n    int32_t wave_sizze_33089;\n    int32_t group_tid_33088;\n    \n    global_tid_33086 = get_global_id(0);\n    local_tid_33087 = get_local_id(0);\n    group_sizze_33090 = get_local_size(0);\n    wave_sizze_33089 = LOCKSTEP_WIDTH;\n    group_tid_33088 = get_group_id(0);\n    \n    int32_t phys_tid_30624;\n    \n    phys_tid_30624 = global_tid_33086;\n    \n    __local char *sync_a",
            "rr_mem_33091;\n    \n    sync_arr_mem_33091 = (__local char *) sync_arr_mem_33091_backing_0;\n    \n    __local char *red_arr_mem_33093;\n    \n    red_arr_mem_33093 = (__local char *) red_arr_mem_33093_backing_1;\n    \n    int64_t dummy_30622;\n    \n    dummy_30622 = (int64_t) 0;\n    \n    int64_t gtid_30623;\n    \n    gtid_30623 = (int64_t) 0;\n    \n    bool x_acc_33095;\n    int64_t chunk_sizze_33096;\n    \n    chunk_sizze_33096 = smin64(sdiv_up64(maxSizze_29114,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30617 *\n                                         num_groups_30619))),\n                               sdiv_up64(maxSizze_29114 - phys_tid_30624,\n                                         num_threads_33085));\n    \n    bool x_29129;\n    bool x_29130;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_33095 = 1;\n    }\n    for (int64_t i_33100 = 0; i_33100 < chunk_sizze_33096; i_33100++) {\n        gtid_30623 = phys_tid_30624 + num_threads_33085 * i_33100;\n        // apply map function\n        {\n            bool index_concat_cmp_31859 = sle64(conc_tmp_28900, gtid_30623);\n            int32_t index_concat_branch_31863;\n            \n            if (index_concat_cmp_31859) {\n                index_concat_branch_31863 = 0;\n            } else {\n                int32_t index_concat_31862 = ((__global\n                                               int32_t *) mem_32005)[gtid_30623];\n                \n                index_concat_branch_31863 = index_concat_31862;\n            }\n            \n            bool defunc_1_f_res_29133 = 0 == index_concat_branch_31863;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29129 = x_acc_33095;\n            }\n            // load new values\n            {\n                x_29130 = defunc_1_f_res_29133;\n            }\n            // apply reduction operator\n            {\n                bool x_29131 = x_29129 && x_29130;\n    ",
            "            \n                // store in accumulator\n                {\n                    x_acc_33095 = x_29131;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29129 = x_acc_33095;\n        ((__local bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n            x_29129;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33101;\n    int32_t skip_waves_33102;\n    \n    skip_waves_33102 = 1;\n    \n    bool x_33097;\n    bool x_33098;\n    \n    offset_33101 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33087, sext_i64_i32(segred_group_sizze_30617))) {\n            x_33097 = ((__local\n                        bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                   offset_33101)];\n        }\n    }\n    offset_33101 = 1;\n    while (slt32(offset_33101, wave_sizze_33089)) {\n        if (slt32(local_tid_33087 + offset_33101,\n                  sext_i64_i32(segred_group_sizze_30617)) && ((local_tid_33087 -\n                                                               squot32(local_tid_33087,\n                                                                       wave_sizze_33089) *\n                                                               wave_sizze_33089) &\n                                                              (2 *\n                                                               offset_33101 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_33098 = ((volatile __local\n                            bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                       offset_33101)];\n            }\n            // apply reduction operation\n            {\n                bool x_33099 = x_33097 && x_33098;\n                \n                x_33097 = x_",
            "33099;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n                    x_33097;\n            }\n        }\n        offset_33101 *= 2;\n    }\n    while (slt32(skip_waves_33102,\n                 squot32(sext_i64_i32(segred_group_sizze_30617) +\n                         wave_sizze_33089 - 1, wave_sizze_33089))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33101 = skip_waves_33102 * wave_sizze_33089;\n        if (slt32(local_tid_33087 + offset_33101,\n                  sext_i64_i32(segred_group_sizze_30617)) && ((local_tid_33087 -\n                                                               squot32(local_tid_33087,\n                                                                       wave_sizze_33089) *\n                                                               wave_sizze_33089) ==\n                                                              0 &&\n                                                              (squot32(local_tid_33087,\n                                                                       wave_sizze_33089) &\n                                                               (2 *\n                                                                skip_waves_33102 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_33098 = ((__local\n                            bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                       offset_33101)];\n            }\n            // apply reduction operation\n            {\n                bool x_33099 = x_33097 && x_33098;\n                \n                x_33097 = x_33099;\n            }\n            // write result of operation\n            {\n                ((__local\n                  bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n   ",
            "                 x_33097;\n            }\n        }\n        skip_waves_33102 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33087) == (int64_t) 0) {\n            x_acc_33095 = x_33097;\n        }\n    }\n    \n    int32_t old_counter_33103;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33087 == 0) {\n            ((__global\n              bool *) group_res_arr_mem_33083)[sext_i32_i64(group_tid_33088) *\n                                               segred_group_sizze_30617] =\n                x_acc_33095;\n            mem_fence_global();\n            old_counter_33103 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33081)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33091)[(int64_t) 0] =\n                old_counter_33103 == num_groups_30619 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33104;\n    \n    is_last_group_33104 = ((__local bool *) sync_arr_mem_33091)[(int64_t) 0];\n    if (is_last_group_33104) {\n        if (local_tid_33087 == 0) {\n            old_counter_33103 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33081)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30619));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33105 = sdiv_up64(num_groups_30619,\n                                                      segred_group_sizze_30617);\n            \n            x_29129 = 1;\n            for (int64_t i_33106 = 0; i_33106 < read_per_thread_33105;\n         ",
            "        i_33106++) {\n                int64_t group_res_id_33107 = sext_i32_i64(local_tid_33087) *\n                        read_per_thread_33105 + i_33106;\n                int64_t index_of_group_res_33108 = group_res_id_33107;\n                \n                if (slt64(group_res_id_33107, num_groups_30619)) {\n                    x_29130 = ((__global\n                                bool *) group_res_arr_mem_33083)[index_of_group_res_33108 *\n                                                                 segred_group_sizze_30617];\n                    \n                    bool x_29131;\n                    \n                    x_29131 = x_29129 && x_29130;\n                    x_29129 = x_29131;\n                }\n            }\n        }\n        ((__local bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n            x_29129;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33109;\n            int32_t skip_waves_33110;\n            \n            skip_waves_33110 = 1;\n            \n            bool x_33097;\n            bool x_33098;\n            \n            offset_33109 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33087,\n                          sext_i64_i32(segred_group_sizze_30617))) {\n                    x_33097 = ((__local\n                                bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                           offset_33109)];\n                }\n            }\n            offset_33109 = 1;\n            while (slt32(offset_33109, wave_sizze_33089)) {\n                if (slt32(local_tid_33087 + offset_33109,\n                          sext_i64_i32(segred_group_sizze_30617)) &&\n                    ((local_tid_33087 - squot32(local_tid_33087,\n                                                wave_sizze_33089) *\n                      wave_sizze_33089) & (2 * offset_33109 - 1)) == ",
            "0) {\n                    // read array element\n                    {\n                        x_33098 = ((volatile __local\n                                    bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                               offset_33109)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_33099 = x_33097 && x_33098;\n                        \n                        x_33097 = x_33099;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n                            x_33097;\n                    }\n                }\n                offset_33109 *= 2;\n            }\n            while (slt32(skip_waves_33110,\n                         squot32(sext_i64_i32(segred_group_sizze_30617) +\n                                 wave_sizze_33089 - 1, wave_sizze_33089))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33109 = skip_waves_33110 * wave_sizze_33089;\n                if (slt32(local_tid_33087 + offset_33109,\n                          sext_i64_i32(segred_group_sizze_30617)) &&\n                    ((local_tid_33087 - squot32(local_tid_33087,\n                                                wave_sizze_33089) *\n                      wave_sizze_33089) == 0 && (squot32(local_tid_33087,\n                                                         wave_sizze_33089) &\n                                                 (2 * skip_waves_33110 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33098 = ((__local\n                                    bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087 +\n                                                               offset_33109)];\n                    }\n        ",
            "            // apply reduction operation\n                    {\n                        bool x_33099 = x_33097 && x_33098;\n                        \n                        x_33097 = x_33099;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          bool *) red_arr_mem_33093)[sext_i32_i64(local_tid_33087)] =\n                            x_33097;\n                    }\n                }\n                skip_waves_33110 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_33087 == 0) {\n                    ((__global bool *) mem_32066)[(int64_t) 0] = x_33097;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30617\n}\n__kernel void test_clusterWithzisegred_nonseg_30634(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_33124_backing_offset_0,\n                                                    uint sync_arr_mem_33122_backing_offset_1,\n                                                    int64_t numVert_28890,\n                                                    int64_t num_groups_30629,\n                                                    int64_t num_threads_33116,\n                                                    __global\n                                                    unsigned char *mem_32026,\n                                                    __global\n                                                    unsigned char *mem_32069,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_33112,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_33114)\n{\n    #define se",
            "gred_group_sizze_30627 (test_clusterWithzisegred_group_sizze_30626)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33124_backing_1 =\n                  &shared_mem[red_arr_mem_33124_backing_offset_0];\n    volatile char *sync_arr_mem_33122_backing_0 =\n                  &shared_mem[sync_arr_mem_33122_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33117;\n    int32_t local_tid_33118;\n    int64_t group_sizze_33121;\n    int32_t wave_sizze_33120;\n    int32_t group_tid_33119;\n    \n    global_tid_33117 = get_global_id(0);\n    local_tid_33118 = get_local_id(0);\n    group_sizze_33121 = get_local_size(0);\n    wave_sizze_33120 = LOCKSTEP_WIDTH;\n    group_tid_33119 = get_group_id(0);\n    \n    int32_t phys_tid_30634;\n    \n    phys_tid_30634 = global_tid_33117;\n    \n    __local char *sync_arr_mem_33122;\n    \n    sync_arr_mem_33122 = (__local char *) sync_arr_mem_33122_backing_0;\n    \n    __local char *red_arr_mem_33124;\n    \n    red_arr_mem_33124 = (__local char *) red_arr_mem_33124_backing_1;\n    \n    int64_t dummy_30632;\n    \n    dummy_30632 = (int64_t) 0;\n    \n    int64_t gtid_30633;\n    \n    gtid_30633 = (int64_t) 0;\n    \n    int64_t x_acc_33126;\n    int64_t chunk_sizze_33127;\n    \n    chunk_sizze_33127 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30627 *\n                                         num_groups_30629))),\n                               sdiv_up64(numVert_28890 - phys_tid_30634,\n                                         num_threads_33116));\n    \n    int64_t x_29137;\n    int64_t x_29138;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_33126 = (int64_t) 0;\n    }\n    for (int64_t i_33131 = 0; i_33131 < chunk_sizze_33127; i_33131++) {\n        gtid_30633 = phys_tid_30634 + num_threads_33116 * i_33131;\n        // apply map function\n        {\n            in",
            "t64_t x_29140 = ((__global int64_t *) mem_32026)[gtid_30633];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29137 = x_acc_33126;\n            }\n            // load new values\n            {\n                x_29138 = x_29140;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29139 = add64(x_29137, x_29138);\n                \n                // store in accumulator\n                {\n                    x_acc_33126 = defunc_1_op_res_29139;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29137 = x_acc_33126;\n        ((__local int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n            x_29137;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33132;\n    int32_t skip_waves_33133;\n    \n    skip_waves_33133 = 1;\n    \n    int64_t x_33128;\n    int64_t x_33129;\n    \n    offset_33132 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33118, sext_i64_i32(segred_group_sizze_30627))) {\n            x_33128 = ((__local\n                        int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                      offset_33132)];\n        }\n    }\n    offset_33132 = 1;\n    while (slt32(offset_33132, wave_sizze_33120)) {\n        if (slt32(local_tid_33118 + offset_33132,\n                  sext_i64_i32(segred_group_sizze_30627)) && ((local_tid_33118 -\n                                                               squot32(local_tid_33118,\n                                                                       wave_sizze_33120) *\n                                                               wave_sizze_33120) &\n                                                              (2 *\n                                                               offset_33132 -\n          ",
            "                                                     1)) == 0) {\n            // read array element\n            {\n                x_33129 = ((volatile __local\n                            int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                          offset_33132)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33130 = add64(x_33128, x_33129);\n                \n                x_33128 = defunc_1_op_res_33130;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n                    x_33128;\n            }\n        }\n        offset_33132 *= 2;\n    }\n    while (slt32(skip_waves_33133,\n                 squot32(sext_i64_i32(segred_group_sizze_30627) +\n                         wave_sizze_33120 - 1, wave_sizze_33120))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33132 = skip_waves_33133 * wave_sizze_33120;\n        if (slt32(local_tid_33118 + offset_33132,\n                  sext_i64_i32(segred_group_sizze_30627)) && ((local_tid_33118 -\n                                                               squot32(local_tid_33118,\n                                                                       wave_sizze_33120) *\n                                                               wave_sizze_33120) ==\n                                                              0 &&\n                                                              (squot32(local_tid_33118,\n                                                                       wave_sizze_33120) &\n                                                               (2 *\n                                                                skip_waves_33133 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                ",
            "x_33129 = ((__local\n                            int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                          offset_33132)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33130 = add64(x_33128, x_33129);\n                \n                x_33128 = defunc_1_op_res_33130;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n                    x_33128;\n            }\n        }\n        skip_waves_33133 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33118) == (int64_t) 0) {\n            x_acc_33126 = x_33128;\n        }\n    }\n    \n    int32_t old_counter_33134;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33118 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_33114)[sext_i32_i64(group_tid_33119) *\n                                                  segred_group_sizze_30627] =\n                x_acc_33126;\n            mem_fence_global();\n            old_counter_33134 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33112)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33122)[(int64_t) 0] =\n                old_counter_33134 == num_groups_30629 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33135;\n    \n    is_last_group_33135 = ((__local bool *) sync_arr_mem_33122)[(int64_t) 0];\n    if (is_last_group_33135) {\n        if (local_tid_33118 == 0) {\n            old_counter_33134 = atomic_add_i32_global(&((volatile __global\n                           ",
            "                              int *) test_clusterWithzicounter_mem_33112)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30629));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33136 = sdiv_up64(num_groups_30629,\n                                                      segred_group_sizze_30627);\n            \n            x_29137 = (int64_t) 0;\n            for (int64_t i_33137 = 0; i_33137 < read_per_thread_33136;\n                 i_33137++) {\n                int64_t group_res_id_33138 = sext_i32_i64(local_tid_33118) *\n                        read_per_thread_33136 + i_33137;\n                int64_t index_of_group_res_33139 = group_res_id_33138;\n                \n                if (slt64(group_res_id_33138, num_groups_30629)) {\n                    x_29138 = ((__global\n                                int64_t *) group_res_arr_mem_33114)[index_of_group_res_33139 *\n                                                                    segred_group_sizze_30627];\n                    \n                    int64_t defunc_1_op_res_29139;\n                    \n                    defunc_1_op_res_29139 = add64(x_29137, x_29138);\n                    x_29137 = defunc_1_op_res_29139;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n            x_29137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33140;\n            int32_t skip_waves_33141;\n            \n            skip_waves_33141 = 1;\n            \n            int64_t x_33128;\n            int64_t x_33129;\n            \n            offset_33140 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33118,\n                          sext_i64_i32(segred_group_sizze_30627))) {\n     ",
            "               x_33128 = ((__local\n                                int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                              offset_33140)];\n                }\n            }\n            offset_33140 = 1;\n            while (slt32(offset_33140, wave_sizze_33120)) {\n                if (slt32(local_tid_33118 + offset_33140,\n                          sext_i64_i32(segred_group_sizze_30627)) &&\n                    ((local_tid_33118 - squot32(local_tid_33118,\n                                                wave_sizze_33120) *\n                      wave_sizze_33120) & (2 * offset_33140 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_33129 = ((volatile __local\n                                    int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                                  offset_33140)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33130 = add64(x_33128, x_33129);\n                        \n                        x_33128 = defunc_1_op_res_33130;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n                            x_33128;\n                    }\n                }\n                offset_33140 *= 2;\n            }\n            while (slt32(skip_waves_33141,\n                         squot32(sext_i64_i32(segred_group_sizze_30627) +\n                                 wave_sizze_33120 - 1, wave_sizze_33120))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33140 = skip_waves_33141 * wave_sizze_33120;\n                if (slt32(local_tid_33118 + offset_33140,\n                          sext_i64_i32(segred_group_sizze_30627)) &&\n",
            "                    ((local_tid_33118 - squot32(local_tid_33118,\n                                                wave_sizze_33120) *\n                      wave_sizze_33120) == 0 && (squot32(local_tid_33118,\n                                                         wave_sizze_33120) &\n                                                 (2 * skip_waves_33141 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33129 = ((__local\n                                    int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118 +\n                                                                  offset_33140)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33130 = add64(x_33128, x_33129);\n                        \n                        x_33128 = defunc_1_op_res_33130;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_33124)[sext_i32_i64(local_tid_33118)] =\n                            x_33128;\n                    }\n                }\n                skip_waves_33141 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_33118 == 0) {\n                    ((__global int64_t *) mem_32069)[(int64_t) 0] = x_33128;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30627\n}\n__kernel void test_clusterWithzisegred_nonseg_30652(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_33242_backing_offset_0,\n                                                    uint sync_arr_mem_33240_backing_offset_1,\n                                                    int64_t numVert_28890,\n                   ",
            "                                 int64_t num_groups_30647,\n                                                    int64_t num_threads_33234,\n                                                    __global\n                                                    unsigned char *mem_32095,\n                                                    __global\n                                                    unsigned char *mem_32100,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_33230,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_33232)\n{\n    #define segred_group_sizze_30645 (test_clusterWithzisegred_group_sizze_30644)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33242_backing_1 =\n                  &shared_mem[red_arr_mem_33242_backing_offset_0];\n    volatile char *sync_arr_mem_33240_backing_0 =\n                  &shared_mem[sync_arr_mem_33240_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33235;\n    int32_t local_tid_33236;\n    int64_t group_sizze_33239;\n    int32_t wave_sizze_33238;\n    int32_t group_tid_33237;\n    \n    global_tid_33235 = get_global_id(0);\n    local_tid_33236 = get_local_id(0);\n    group_sizze_33239 = get_local_size(0);\n    wave_sizze_33238 = LOCKSTEP_WIDTH;\n    group_tid_33237 = get_group_id(0);\n    \n    int32_t phys_tid_30652;\n    \n    phys_tid_30652 = global_tid_33235;\n    \n    __local char *sync_arr_mem_33240;\n    \n    sync_arr_mem_33240 = (__local char *) sync_arr_mem_33240_backing_0;\n    \n    __local char *red_arr_mem_33242;\n    \n    red_arr_mem_33242 = (__local char *) red_arr_mem_33242_backing_1;\n    \n    int64_t dummy_30650;\n    \n    dummy_30650 = (int64_t) 0;\n    \n    int64_t gtid_30651;\n    \n    gtid_30651 = (int64_t) 0",
            ";\n    \n    int64_t x_acc_33244;\n    int64_t chunk_sizze_33245;\n    \n    chunk_sizze_33245 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30645 *\n                                         num_groups_30647))),\n                               sdiv_up64(numVert_28890 - phys_tid_30652,\n                                         num_threads_33234));\n    \n    int64_t x_29172;\n    int64_t x_29173;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_33244 = (int64_t) 0;\n    }\n    for (int64_t i_33249 = 0; i_33249 < chunk_sizze_33245; i_33249++) {\n        gtid_30651 = phys_tid_30652 + num_threads_33234 * i_33249;\n        // apply map function\n        {\n            int64_t x_29175 = ((__global int64_t *) mem_32095)[gtid_30651];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29172 = x_acc_33244;\n            }\n            // load new values\n            {\n                x_29173 = x_29175;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29174 = add64(x_29172, x_29173);\n                \n                // store in accumulator\n                {\n                    x_acc_33244 = defunc_1_op_res_29174;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29172 = x_acc_33244;\n        ((__local int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n            x_29172;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_33250;\n    int32_t skip_waves_33251;\n    \n    skip_waves_33251 = 1;\n    \n    int64_t x_33246;\n    int64_t x_33247;\n    \n    offset_33250 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_33236, sext_i64_i32(segred_group_sizze_30645))) {\n            x_33246 = ((__local\n                        int64_t *) red_arr_",
            "mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                      offset_33250)];\n        }\n    }\n    offset_33250 = 1;\n    while (slt32(offset_33250, wave_sizze_33238)) {\n        if (slt32(local_tid_33236 + offset_33250,\n                  sext_i64_i32(segred_group_sizze_30645)) && ((local_tid_33236 -\n                                                               squot32(local_tid_33236,\n                                                                       wave_sizze_33238) *\n                                                               wave_sizze_33238) &\n                                                              (2 *\n                                                               offset_33250 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_33247 = ((volatile __local\n                            int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                          offset_33250)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33248 = add64(x_33246, x_33247);\n                \n                x_33246 = defunc_1_op_res_33248;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n                    x_33246;\n            }\n        }\n        offset_33250 *= 2;\n    }\n    while (slt32(skip_waves_33251,\n                 squot32(sext_i64_i32(segred_group_sizze_30645) +\n                         wave_sizze_33238 - 1, wave_sizze_33238))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_33250 = skip_waves_33251 * wave_sizze_33238;\n        if (slt32(local_tid_33236 + offset_33250,\n                  sext_i64_i32(segred_group_sizze_30645)) && ((local_tid_33236 -\n                                                   ",
            "            squot32(local_tid_33236,\n                                                                       wave_sizze_33238) *\n                                                               wave_sizze_33238) ==\n                                                              0 &&\n                                                              (squot32(local_tid_33236,\n                                                                       wave_sizze_33238) &\n                                                               (2 *\n                                                                skip_waves_33251 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_33247 = ((__local\n                            int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                          offset_33250)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_33248 = add64(x_33246, x_33247);\n                \n                x_33246 = defunc_1_op_res_33248;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n                    x_33246;\n            }\n        }\n        skip_waves_33251 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_33236) == (int64_t) 0) {\n            x_acc_33244 = x_33246;\n        }\n    }\n    \n    int32_t old_counter_33252;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_33236 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_33232)[sext_i32_i64(group_tid_33237) *\n                                                  segred_group_sizze_30645] =\n                x_acc_33244;\n            mem_fence_global()",
            ";\n            old_counter_33252 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33230)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_33240)[(int64_t) 0] =\n                old_counter_33252 == num_groups_30647 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_33253;\n    \n    is_last_group_33253 = ((__local bool *) sync_arr_mem_33240)[(int64_t) 0];\n    if (is_last_group_33253) {\n        if (local_tid_33236 == 0) {\n            old_counter_33252 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_33230)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30647));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_33254 = sdiv_up64(num_groups_30647,\n                                                      segred_group_sizze_30645);\n            \n            x_29172 = (int64_t) 0;\n            for (int64_t i_33255 = 0; i_33255 < read_per_thread_33254;\n                 i_33255++) {\n                int64_t group_res_id_33256 = sext_i32_i64(local_tid_33236) *\n                        read_per_thread_33254 + i_33255;\n                int64_t index_of_group_res_33257 = group_res_id_33256;\n                \n                if (slt64(group_res_id_33256, num_groups_30647)) {\n                    x_29173 = ((__global\n                                int64_t *) group_res_arr_mem_33232)[index_of_group_res_33257 *\n                                                                    segred_group_sizze_30645];\n                    \n                    int64_t defunc_1_op_res_29174;\n                    \n                    defunc_1_o",
            "p_res_29174 = add64(x_29172, x_29173);\n                    x_29172 = defunc_1_op_res_29174;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n            x_29172;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_33258;\n            int32_t skip_waves_33259;\n            \n            skip_waves_33259 = 1;\n            \n            int64_t x_33246;\n            int64_t x_33247;\n            \n            offset_33258 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_33236,\n                          sext_i64_i32(segred_group_sizze_30645))) {\n                    x_33246 = ((__local\n                                int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                              offset_33258)];\n                }\n            }\n            offset_33258 = 1;\n            while (slt32(offset_33258, wave_sizze_33238)) {\n                if (slt32(local_tid_33236 + offset_33258,\n                          sext_i64_i32(segred_group_sizze_30645)) &&\n                    ((local_tid_33236 - squot32(local_tid_33236,\n                                                wave_sizze_33238) *\n                      wave_sizze_33238) & (2 * offset_33258 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_33247 = ((volatile __local\n                                    int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                                  offset_33258)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33248 = add64(x_33246, x_33247);\n                        \n                        x_33246 = defunc_1_op_res_33248;\n                    }\n              ",
            "      // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n                            x_33246;\n                    }\n                }\n                offset_33258 *= 2;\n            }\n            while (slt32(skip_waves_33259,\n                         squot32(sext_i64_i32(segred_group_sizze_30645) +\n                                 wave_sizze_33238 - 1, wave_sizze_33238))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_33258 = skip_waves_33259 * wave_sizze_33238;\n                if (slt32(local_tid_33236 + offset_33258,\n                          sext_i64_i32(segred_group_sizze_30645)) &&\n                    ((local_tid_33236 - squot32(local_tid_33236,\n                                                wave_sizze_33238) *\n                      wave_sizze_33238) == 0 && (squot32(local_tid_33236,\n                                                         wave_sizze_33238) &\n                                                 (2 * skip_waves_33259 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_33247 = ((__local\n                                    int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236 +\n                                                                  offset_33258)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_33248 = add64(x_33246, x_33247);\n                        \n                        x_33246 = defunc_1_op_res_33248;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_33242)[sext_i32_i64(local_tid_33236)] =\n                            x_33246;\n                    }\n                }\n                skip_wa",
            "ves_33259 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_33236 == 0) {\n                    ((__global int64_t *) mem_32100)[(int64_t) 0] = x_33246;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30645\n}\n__kernel void test_clusterWithzisegred_nonseg_30981(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_34546_backing_offset_0,\n                                                    uint sync_arr_mem_34544_backing_offset_1,\n                                                    int64_t numVert_28890,\n                                                    int64_t num_groups_30976,\n                                                    int64_t num_threads_34538,\n                                                    __global\n                                                    unsigned char *mem_param_32084,\n                                                    __global\n                                                    unsigned char *mem_32220,\n                                                    __global\n                                                    unsigned char *mem_32230,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_34534,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_34536)\n{\n    #define segred_group_sizze_30974 (test_clusterWithzisegred_group_sizze_30973)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34546_backing_1 =\n                  &shared_mem[red_arr_mem_34546_backing_offset_0];\n    volatile char *sync_arr_mem_34544_backing_0 =\n                  &shared_",
            "mem[sync_arr_mem_34544_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34539;\n    int32_t local_tid_34540;\n    int64_t group_sizze_34543;\n    int32_t wave_sizze_34542;\n    int32_t group_tid_34541;\n    \n    global_tid_34539 = get_global_id(0);\n    local_tid_34540 = get_local_id(0);\n    group_sizze_34543 = get_local_size(0);\n    wave_sizze_34542 = LOCKSTEP_WIDTH;\n    group_tid_34541 = get_group_id(0);\n    \n    int32_t phys_tid_30981;\n    \n    phys_tid_30981 = global_tid_34539;\n    \n    __local char *sync_arr_mem_34544;\n    \n    sync_arr_mem_34544 = (__local char *) sync_arr_mem_34544_backing_0;\n    \n    __local char *red_arr_mem_34546;\n    \n    red_arr_mem_34546 = (__local char *) red_arr_mem_34546_backing_1;\n    \n    int64_t dummy_30979;\n    \n    dummy_30979 = (int64_t) 0;\n    \n    int64_t gtid_30980;\n    \n    gtid_30980 = (int64_t) 0;\n    \n    bool x_acc_34548;\n    int64_t chunk_sizze_34549;\n    \n    chunk_sizze_34549 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30974 *\n                                         num_groups_30976))),\n                               sdiv_up64(numVert_28890 - phys_tid_30981,\n                                         num_threads_34538));\n    \n    bool x_29539;\n    bool x_29540;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_34548 = 1;\n    }\n    for (int64_t i_34553 = 0; i_34553 < chunk_sizze_34549; i_34553++) {\n        gtid_30980 = phys_tid_30981 + num_threads_34538 * i_34553;\n        // apply map function\n        {\n            int64_t x_29542 = ((__global\n                                int64_t *) mem_param_32084)[gtid_30980];\n            int64_t x_29543 = ((__global int64_t *) mem_32220)[gtid_30980];\n            bool defunc_1_f_res_29544 = x_29542 == x_29543;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29539 = x",
            "_acc_34548;\n            }\n            // load new values\n            {\n                x_29540 = defunc_1_f_res_29544;\n            }\n            // apply reduction operator\n            {\n                bool x_29541 = x_29539 && x_29540;\n                \n                // store in accumulator\n                {\n                    x_acc_34548 = x_29541;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29539 = x_acc_34548;\n        ((__local bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n            x_29539;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_34554;\n    int32_t skip_waves_34555;\n    \n    skip_waves_34555 = 1;\n    \n    bool x_34550;\n    bool x_34551;\n    \n    offset_34554 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_34540, sext_i64_i32(segred_group_sizze_30974))) {\n            x_34550 = ((__local\n                        bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540 +\n                                                   offset_34554)];\n        }\n    }\n    offset_34554 = 1;\n    while (slt32(offset_34554, wave_sizze_34542)) {\n        if (slt32(local_tid_34540 + offset_34554,\n                  sext_i64_i32(segred_group_sizze_30974)) && ((local_tid_34540 -\n                                                               squot32(local_tid_34540,\n                                                                       wave_sizze_34542) *\n                                                               wave_sizze_34542) &\n                                                              (2 *\n                                                               offset_34554 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_34551 = ((volatile __local\n                            bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34",
            "540 +\n                                                       offset_34554)];\n            }\n            // apply reduction operation\n            {\n                bool x_34552 = x_34550 && x_34551;\n                \n                x_34550 = x_34552;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n                    x_34550;\n            }\n        }\n        offset_34554 *= 2;\n    }\n    while (slt32(skip_waves_34555,\n                 squot32(sext_i64_i32(segred_group_sizze_30974) +\n                         wave_sizze_34542 - 1, wave_sizze_34542))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_34554 = skip_waves_34555 * wave_sizze_34542;\n        if (slt32(local_tid_34540 + offset_34554,\n                  sext_i64_i32(segred_group_sizze_30974)) && ((local_tid_34540 -\n                                                               squot32(local_tid_34540,\n                                                                       wave_sizze_34542) *\n                                                               wave_sizze_34542) ==\n                                                              0 &&\n                                                              (squot32(local_tid_34540,\n                                                                       wave_sizze_34542) &\n                                                               (2 *\n                                                                skip_waves_34555 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_34551 = ((__local\n                            bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540 +\n                                                       offset_34554)];\n            }\n            // apply reduction operation\n            {\n                bool x_34552 = x_3455",
            "0 && x_34551;\n                \n                x_34550 = x_34552;\n            }\n            // write result of operation\n            {\n                ((__local\n                  bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n                    x_34550;\n            }\n        }\n        skip_waves_34555 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_34540) == (int64_t) 0) {\n            x_acc_34548 = x_34550;\n        }\n    }\n    \n    int32_t old_counter_34556;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_34540 == 0) {\n            ((__global\n              bool *) group_res_arr_mem_34536)[sext_i32_i64(group_tid_34541) *\n                                               segred_group_sizze_30974] =\n                x_acc_34548;\n            mem_fence_global();\n            old_counter_34556 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34534)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_34544)[(int64_t) 0] =\n                old_counter_34556 == num_groups_30976 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_34557;\n    \n    is_last_group_34557 = ((__local bool *) sync_arr_mem_34544)[(int64_t) 0];\n    if (is_last_group_34557) {\n        if (local_tid_34540 == 0) {\n            old_counter_34556 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34534)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30976));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_",
            "thread_34558 = sdiv_up64(num_groups_30976,\n                                                      segred_group_sizze_30974);\n            \n            x_29539 = 1;\n            for (int64_t i_34559 = 0; i_34559 < read_per_thread_34558;\n                 i_34559++) {\n                int64_t group_res_id_34560 = sext_i32_i64(local_tid_34540) *\n                        read_per_thread_34558 + i_34559;\n                int64_t index_of_group_res_34561 = group_res_id_34560;\n                \n                if (slt64(group_res_id_34560, num_groups_30976)) {\n                    x_29540 = ((__global\n                                bool *) group_res_arr_mem_34536)[index_of_group_res_34561 *\n                                                                 segred_group_sizze_30974];\n                    \n                    bool x_29541;\n                    \n                    x_29541 = x_29539 && x_29540;\n                    x_29539 = x_29541;\n                }\n            }\n        }\n        ((__local bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n            x_29539;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_34562;\n            int32_t skip_waves_34563;\n            \n            skip_waves_34563 = 1;\n            \n            bool x_34550;\n            bool x_34551;\n            \n            offset_34562 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_34540,\n                          sext_i64_i32(segred_group_sizze_30974))) {\n                    x_34550 = ((__local\n                                bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540 +\n                                                           offset_34562)];\n                }\n            }\n            offset_34562 = 1;\n            while (slt32(offset_34562, wave_sizze_34542)) {\n                if (slt32(local_tid_34540 + offset_34562,\n                          sex",
            "t_i64_i32(segred_group_sizze_30974)) &&\n                    ((local_tid_34540 - squot32(local_tid_34540,\n                                                wave_sizze_34542) *\n                      wave_sizze_34542) & (2 * offset_34562 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_34551 = ((volatile __local\n                                    bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540 +\n                                                               offset_34562)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_34552 = x_34550 && x_34551;\n                        \n                        x_34550 = x_34552;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n                            x_34550;\n                    }\n                }\n                offset_34562 *= 2;\n            }\n            while (slt32(skip_waves_34563,\n                         squot32(sext_i64_i32(segred_group_sizze_30974) +\n                                 wave_sizze_34542 - 1, wave_sizze_34542))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_34562 = skip_waves_34563 * wave_sizze_34542;\n                if (slt32(local_tid_34540 + offset_34562,\n                          sext_i64_i32(segred_group_sizze_30974)) &&\n                    ((local_tid_34540 - squot32(local_tid_34540,\n                                                wave_sizze_34542) *\n                      wave_sizze_34542) == 0 && (squot32(local_tid_34540,\n                                                         wave_sizze_34542) &\n                                                 (2 * skip_waves_34563 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n     ",
            "                   x_34551 = ((__local\n                                    bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540 +\n                                                               offset_34562)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_34552 = x_34550 && x_34551;\n                        \n                        x_34550 = x_34552;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          bool *) red_arr_mem_34546)[sext_i32_i64(local_tid_34540)] =\n                            x_34550;\n                    }\n                }\n                skip_waves_34563 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_34540 == 0) {\n                    ((__global bool *) mem_32230)[(int64_t) 0] = x_34550;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30974\n}\n__kernel void test_clusterWithzisegred_nonseg_30991(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_34577_backing_offset_0,\n                                                    uint sync_arr_mem_34575_backing_offset_1,\n                                                    int64_t maxSizze_29114,\n                                                    int64_t num_segments_29432,\n                                                    int64_t num_groups_30986,\n                                                    int64_t num_threads_34569,\n                                                    __global\n                                                    unsigned char *mem_param_32074,\n                                                    __global\n                                                    unsigned char *mem_32199,\n     ",
            "                                               __global\n                                                    unsigned char *mem_32233,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_34565,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_34567)\n{\n    #define segred_group_sizze_30984 (test_clusterWithzisegred_group_sizze_30983)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34577_backing_1 =\n                  &shared_mem[red_arr_mem_34577_backing_offset_0];\n    volatile char *sync_arr_mem_34575_backing_0 =\n                  &shared_mem[sync_arr_mem_34575_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34570;\n    int32_t local_tid_34571;\n    int64_t group_sizze_34574;\n    int32_t wave_sizze_34573;\n    int32_t group_tid_34572;\n    \n    global_tid_34570 = get_global_id(0);\n    local_tid_34571 = get_local_id(0);\n    group_sizze_34574 = get_local_size(0);\n    wave_sizze_34573 = LOCKSTEP_WIDTH;\n    group_tid_34572 = get_group_id(0);\n    \n    int32_t phys_tid_30991;\n    \n    phys_tid_30991 = global_tid_34570;\n    \n    __local char *sync_arr_mem_34575;\n    \n    sync_arr_mem_34575 = (__local char *) sync_arr_mem_34575_backing_0;\n    \n    __local char *red_arr_mem_34577;\n    \n    red_arr_mem_34577 = (__local char *) red_arr_mem_34577_backing_1;\n    \n    int64_t dummy_30989;\n    \n    dummy_30989 = (int64_t) 0;\n    \n    int64_t gtid_30990;\n    \n    gtid_30990 = (int64_t) 0;\n    \n    bool x_acc_34579;\n    int64_t chunk_sizze_34580;\n    \n    chunk_sizze_34580 = smin64(sdiv_up64(maxSizze_29114,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30984 *\n                                         num_groups_30986))),\n    ",
            "                           sdiv_up64(maxSizze_29114 - phys_tid_30991,\n                                         num_threads_34569));\n    \n    bool x_29547;\n    bool x_29548;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_34579 = 1;\n    }\n    for (int64_t i_34584 = 0; i_34584 < chunk_sizze_34580; i_34584++) {\n        gtid_30990 = phys_tid_30991 + num_threads_34569 * i_34584;\n        // apply map function\n        {\n            int32_t x_29550 = ((__global\n                                int32_t *) mem_param_32074)[gtid_30990];\n            bool index_concat_cmp_31884 = sle64(num_segments_29432, gtid_30990);\n            int32_t index_concat_branch_31888;\n            \n            if (index_concat_cmp_31884) {\n                index_concat_branch_31888 = 0;\n            } else {\n                int32_t index_concat_31887 = ((__global\n                                               int32_t *) mem_32199)[gtid_30990];\n                \n                index_concat_branch_31888 = index_concat_31887;\n            }\n            \n            bool defunc_1_f_res_29552 = x_29550 == index_concat_branch_31888;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29547 = x_acc_34579;\n            }\n            // load new values\n            {\n                x_29548 = defunc_1_f_res_29552;\n            }\n            // apply reduction operator\n            {\n                bool x_29549 = x_29547 && x_29548;\n                \n                // store in accumulator\n                {\n                    x_acc_34579 = x_29549;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29547 = x_acc_34579;\n        ((__local bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n            x_29547;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_34585;\n    int32_t skip_waves_34586;\n    \n    skip_waves_34586 = 1;",
            "\n    \n    bool x_34581;\n    bool x_34582;\n    \n    offset_34585 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_34571, sext_i64_i32(segred_group_sizze_30984))) {\n            x_34581 = ((__local\n                        bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                   offset_34585)];\n        }\n    }\n    offset_34585 = 1;\n    while (slt32(offset_34585, wave_sizze_34573)) {\n        if (slt32(local_tid_34571 + offset_34585,\n                  sext_i64_i32(segred_group_sizze_30984)) && ((local_tid_34571 -\n                                                               squot32(local_tid_34571,\n                                                                       wave_sizze_34573) *\n                                                               wave_sizze_34573) &\n                                                              (2 *\n                                                               offset_34585 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_34582 = ((volatile __local\n                            bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                       offset_34585)];\n            }\n            // apply reduction operation\n            {\n                bool x_34583 = x_34581 && x_34582;\n                \n                x_34581 = x_34583;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n                    x_34581;\n            }\n        }\n        offset_34585 *= 2;\n    }\n    while (slt32(skip_waves_34586,\n                 squot32(sext_i64_i32(segred_group_sizze_30984) +\n                         wave_sizze_34573 - 1, wave_sizze_34573))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        off",
            "set_34585 = skip_waves_34586 * wave_sizze_34573;\n        if (slt32(local_tid_34571 + offset_34585,\n                  sext_i64_i32(segred_group_sizze_30984)) && ((local_tid_34571 -\n                                                               squot32(local_tid_34571,\n                                                                       wave_sizze_34573) *\n                                                               wave_sizze_34573) ==\n                                                              0 &&\n                                                              (squot32(local_tid_34571,\n                                                                       wave_sizze_34573) &\n                                                               (2 *\n                                                                skip_waves_34586 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_34582 = ((__local\n                            bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                       offset_34585)];\n            }\n            // apply reduction operation\n            {\n                bool x_34583 = x_34581 && x_34582;\n                \n                x_34581 = x_34583;\n            }\n            // write result of operation\n            {\n                ((__local\n                  bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n                    x_34581;\n            }\n        }\n        skip_waves_34586 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_34571) == (int64_t) 0) {\n            x_acc_34579 = x_34581;\n        }\n    }\n    \n    int32_t old_counter_34587;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_34571 == 0) {\n            ((__global\n              bool *) group_res_a",
            "rr_mem_34567)[sext_i32_i64(group_tid_34572) *\n                                               segred_group_sizze_30984] =\n                x_acc_34579;\n            mem_fence_global();\n            old_counter_34587 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34565)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_34575)[(int64_t) 0] =\n                old_counter_34587 == num_groups_30986 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_34588;\n    \n    is_last_group_34588 = ((__local bool *) sync_arr_mem_34575)[(int64_t) 0];\n    if (is_last_group_34588) {\n        if (local_tid_34571 == 0) {\n            old_counter_34587 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34565)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30986));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_34589 = sdiv_up64(num_groups_30986,\n                                                      segred_group_sizze_30984);\n            \n            x_29547 = 1;\n            for (int64_t i_34590 = 0; i_34590 < read_per_thread_34589;\n                 i_34590++) {\n                int64_t group_res_id_34591 = sext_i32_i64(local_tid_34571) *\n                        read_per_thread_34589 + i_34590;\n                int64_t index_of_group_res_34592 = group_res_id_34591;\n                \n                if (slt64(group_res_id_34591, num_groups_30986)) {\n                    x_29548 = ((__global\n                                bool *) group_res_arr_mem_34567)[index_of_group_res_34592 *\n                                                   ",
            "              segred_group_sizze_30984];\n                    \n                    bool x_29549;\n                    \n                    x_29549 = x_29547 && x_29548;\n                    x_29547 = x_29549;\n                }\n            }\n        }\n        ((__local bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n            x_29547;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_34593;\n            int32_t skip_waves_34594;\n            \n            skip_waves_34594 = 1;\n            \n            bool x_34581;\n            bool x_34582;\n            \n            offset_34593 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_34571,\n                          sext_i64_i32(segred_group_sizze_30984))) {\n                    x_34581 = ((__local\n                                bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                           offset_34593)];\n                }\n            }\n            offset_34593 = 1;\n            while (slt32(offset_34593, wave_sizze_34573)) {\n                if (slt32(local_tid_34571 + offset_34593,\n                          sext_i64_i32(segred_group_sizze_30984)) &&\n                    ((local_tid_34571 - squot32(local_tid_34571,\n                                                wave_sizze_34573) *\n                      wave_sizze_34573) & (2 * offset_34593 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_34582 = ((volatile __local\n                                    bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                               offset_34593)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_34583 = x_34581 && x_34582;\n                        \n                      ",
            "  x_34581 = x_34583;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n                            x_34581;\n                    }\n                }\n                offset_34593 *= 2;\n            }\n            while (slt32(skip_waves_34594,\n                         squot32(sext_i64_i32(segred_group_sizze_30984) +\n                                 wave_sizze_34573 - 1, wave_sizze_34573))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_34593 = skip_waves_34594 * wave_sizze_34573;\n                if (slt32(local_tid_34571 + offset_34593,\n                          sext_i64_i32(segred_group_sizze_30984)) &&\n                    ((local_tid_34571 - squot32(local_tid_34571,\n                                                wave_sizze_34573) *\n                      wave_sizze_34573) == 0 && (squot32(local_tid_34571,\n                                                         wave_sizze_34573) &\n                                                 (2 * skip_waves_34594 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_34582 = ((__local\n                                    bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571 +\n                                                               offset_34593)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_34583 = x_34581 && x_34582;\n                        \n                        x_34581 = x_34583;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          bool *) red_arr_mem_34577)[sext_i32_i64(local_tid_34571)] =\n                            x_34581;\n                    }\n                }\n              ",
            "  skip_waves_34594 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_34571 == 0) {\n                    ((__global bool *) mem_32233)[(int64_t) 0] = x_34581;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30984\n}\n__kernel void test_clusterWithzisegred_nonseg_31001(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_34608_backing_offset_0,\n                                                    uint sync_arr_mem_34606_backing_offset_1,\n                                                    int64_t numVert_28890,\n                                                    int64_t num_groups_30996,\n                                                    int64_t num_threads_34600,\n                                                    __global\n                                                    unsigned char *mem_32220,\n                                                    __global\n                                                    unsigned char *mem_32236,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_34596,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_34598)\n{\n    #define segred_group_sizze_30994 (test_clusterWithzisegred_group_sizze_30993)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34608_backing_1 =\n                  &shared_mem[red_arr_mem_34608_backing_offset_0];\n    volatile char *sync_arr_mem_34606_backing_0 =\n                  &shared_mem[sync_arr_mem_34606_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34601;\n    int32_t",
            " local_tid_34602;\n    int64_t group_sizze_34605;\n    int32_t wave_sizze_34604;\n    int32_t group_tid_34603;\n    \n    global_tid_34601 = get_global_id(0);\n    local_tid_34602 = get_local_id(0);\n    group_sizze_34605 = get_local_size(0);\n    wave_sizze_34604 = LOCKSTEP_WIDTH;\n    group_tid_34603 = get_group_id(0);\n    \n    int32_t phys_tid_31001;\n    \n    phys_tid_31001 = global_tid_34601;\n    \n    __local char *sync_arr_mem_34606;\n    \n    sync_arr_mem_34606 = (__local char *) sync_arr_mem_34606_backing_0;\n    \n    __local char *red_arr_mem_34608;\n    \n    red_arr_mem_34608 = (__local char *) red_arr_mem_34608_backing_1;\n    \n    int64_t dummy_30999;\n    \n    dummy_30999 = (int64_t) 0;\n    \n    int64_t gtid_31000;\n    \n    gtid_31000 = (int64_t) 0;\n    \n    int64_t x_acc_34610;\n    int64_t chunk_sizze_34611;\n    \n    chunk_sizze_34611 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_30994 *\n                                         num_groups_30996))),\n                               sdiv_up64(numVert_28890 - phys_tid_31001,\n                                         num_threads_34600));\n    \n    int64_t x_29556;\n    int64_t x_29557;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_34610 = (int64_t) 0;\n    }\n    for (int64_t i_34615 = 0; i_34615 < chunk_sizze_34611; i_34615++) {\n        gtid_31000 = phys_tid_31001 + num_threads_34600 * i_34615;\n        // apply map function\n        {\n            int64_t x_29559 = ((__global int64_t *) mem_32220)[gtid_31000];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29556 = x_acc_34610;\n            }\n            // load new values\n            {\n                x_29557 = x_29559;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29558 = add64(x_29556, x_29557);\n                \n                // store in ac",
            "cumulator\n                {\n                    x_acc_34610 = defunc_1_op_res_29558;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29556 = x_acc_34610;\n        ((__local int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n            x_29556;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_34616;\n    int32_t skip_waves_34617;\n    \n    skip_waves_34617 = 1;\n    \n    int64_t x_34612;\n    int64_t x_34613;\n    \n    offset_34616 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_34602, sext_i64_i32(segred_group_sizze_30994))) {\n            x_34612 = ((__local\n                        int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                      offset_34616)];\n        }\n    }\n    offset_34616 = 1;\n    while (slt32(offset_34616, wave_sizze_34604)) {\n        if (slt32(local_tid_34602 + offset_34616,\n                  sext_i64_i32(segred_group_sizze_30994)) && ((local_tid_34602 -\n                                                               squot32(local_tid_34602,\n                                                                       wave_sizze_34604) *\n                                                               wave_sizze_34604) &\n                                                              (2 *\n                                                               offset_34616 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_34613 = ((volatile __local\n                            int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                          offset_34616)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34614 = add64(x_34612, x_34613);\n                \n              ",
            "  x_34612 = defunc_1_op_res_34614;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n                    x_34612;\n            }\n        }\n        offset_34616 *= 2;\n    }\n    while (slt32(skip_waves_34617,\n                 squot32(sext_i64_i32(segred_group_sizze_30994) +\n                         wave_sizze_34604 - 1, wave_sizze_34604))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_34616 = skip_waves_34617 * wave_sizze_34604;\n        if (slt32(local_tid_34602 + offset_34616,\n                  sext_i64_i32(segred_group_sizze_30994)) && ((local_tid_34602 -\n                                                               squot32(local_tid_34602,\n                                                                       wave_sizze_34604) *\n                                                               wave_sizze_34604) ==\n                                                              0 &&\n                                                              (squot32(local_tid_34602,\n                                                                       wave_sizze_34604) &\n                                                               (2 *\n                                                                skip_waves_34617 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_34613 = ((__local\n                            int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                          offset_34616)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34614 = add64(x_34612, x_34613);\n                \n                x_34612 = defunc_1_op_res_34614;\n            }\n            // write result of operation\n            {\n                ((__local\n        ",
            "          int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n                    x_34612;\n            }\n        }\n        skip_waves_34617 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_34602) == (int64_t) 0) {\n            x_acc_34610 = x_34612;\n        }\n    }\n    \n    int32_t old_counter_34618;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_34602 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_34598)[sext_i32_i64(group_tid_34603) *\n                                                  segred_group_sizze_30994] =\n                x_acc_34610;\n            mem_fence_global();\n            old_counter_34618 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34596)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_34606)[(int64_t) 0] =\n                old_counter_34618 == num_groups_30996 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_34619;\n    \n    is_last_group_34619 = ((__local bool *) sync_arr_mem_34606)[(int64_t) 0];\n    if (is_last_group_34619) {\n        if (local_tid_34602 == 0) {\n            old_counter_34618 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34596)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_30996));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_34620 = sdiv_up64(num_groups_30996,\n                                                      segred_group_sizze_30994);\n            \n            x_29556 = (",
            "int64_t) 0;\n            for (int64_t i_34621 = 0; i_34621 < read_per_thread_34620;\n                 i_34621++) {\n                int64_t group_res_id_34622 = sext_i32_i64(local_tid_34602) *\n                        read_per_thread_34620 + i_34621;\n                int64_t index_of_group_res_34623 = group_res_id_34622;\n                \n                if (slt64(group_res_id_34622, num_groups_30996)) {\n                    x_29557 = ((__global\n                                int64_t *) group_res_arr_mem_34598)[index_of_group_res_34623 *\n                                                                    segred_group_sizze_30994];\n                    \n                    int64_t defunc_1_op_res_29558;\n                    \n                    defunc_1_op_res_29558 = add64(x_29556, x_29557);\n                    x_29556 = defunc_1_op_res_29558;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n            x_29556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_34624;\n            int32_t skip_waves_34625;\n            \n            skip_waves_34625 = 1;\n            \n            int64_t x_34612;\n            int64_t x_34613;\n            \n            offset_34624 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_34602,\n                          sext_i64_i32(segred_group_sizze_30994))) {\n                    x_34612 = ((__local\n                                int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                              offset_34624)];\n                }\n            }\n            offset_34624 = 1;\n            while (slt32(offset_34624, wave_sizze_34604)) {\n                if (slt32(local_tid_34602 + offset_34624,\n                          sext_i64_i32(segred_group_sizze_30994)) &&\n                    ((local_tid_34602 -",
            " squot32(local_tid_34602,\n                                                wave_sizze_34604) *\n                      wave_sizze_34604) & (2 * offset_34624 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_34613 = ((volatile __local\n                                    int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                                  offset_34624)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34614 = add64(x_34612, x_34613);\n                        \n                        x_34612 = defunc_1_op_res_34614;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n                            x_34612;\n                    }\n                }\n                offset_34624 *= 2;\n            }\n            while (slt32(skip_waves_34625,\n                         squot32(sext_i64_i32(segred_group_sizze_30994) +\n                                 wave_sizze_34604 - 1, wave_sizze_34604))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_34624 = skip_waves_34625 * wave_sizze_34604;\n                if (slt32(local_tid_34602 + offset_34624,\n                          sext_i64_i32(segred_group_sizze_30994)) &&\n                    ((local_tid_34602 - squot32(local_tid_34602,\n                                                wave_sizze_34604) *\n                      wave_sizze_34604) == 0 && (squot32(local_tid_34602,\n                                                         wave_sizze_34604) &\n                                                 (2 * skip_waves_34625 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_34613 = ((__l",
            "ocal\n                                    int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602 +\n                                                                  offset_34624)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34614 = add64(x_34612, x_34613);\n                        \n                        x_34612 = defunc_1_op_res_34614;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_34608)[sext_i32_i64(local_tid_34602)] =\n                            x_34612;\n                    }\n                }\n                skip_waves_34625 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_34602 == 0) {\n                    ((__global int64_t *) mem_32236)[(int64_t) 0] = x_34612;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_30994\n}\n__kernel void test_clusterWithzisegred_nonseg_31011(__global\n                                                    int *global_failure,\n                                                    uint red_arr_mem_34638_backing_offset_0,\n                                                    uint sync_arr_mem_34636_backing_offset_1,\n                                                    int64_t numVert_28890,\n                                                    int64_t num_groups_31006,\n                                                    int64_t num_threads_34630,\n                                                    __global\n                                                    unsigned char *lifted_fromInit_res_mem_32257,\n                                                    __global\n                                                    unsigned char *mem_32260,\n                                                    __glob",
            "al\n                                                    unsigned char *test_clusterWithzicounter_mem_34626,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_34628)\n{\n    #define segred_group_sizze_31004 (test_clusterWithzisegred_group_sizze_31003)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34638_backing_1 =\n                  &shared_mem[red_arr_mem_34638_backing_offset_0];\n    volatile char *sync_arr_mem_34636_backing_0 =\n                  &shared_mem[sync_arr_mem_34636_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34631;\n    int32_t local_tid_34632;\n    int64_t group_sizze_34635;\n    int32_t wave_sizze_34634;\n    int32_t group_tid_34633;\n    \n    global_tid_34631 = get_global_id(0);\n    local_tid_34632 = get_local_id(0);\n    group_sizze_34635 = get_local_size(0);\n    wave_sizze_34634 = LOCKSTEP_WIDTH;\n    group_tid_34633 = get_group_id(0);\n    \n    int32_t phys_tid_31011;\n    \n    phys_tid_31011 = global_tid_34631;\n    \n    __local char *sync_arr_mem_34636;\n    \n    sync_arr_mem_34636 = (__local char *) sync_arr_mem_34636_backing_0;\n    \n    __local char *red_arr_mem_34638;\n    \n    red_arr_mem_34638 = (__local char *) red_arr_mem_34638_backing_1;\n    \n    int64_t dummy_31009;\n    \n    dummy_31009 = (int64_t) 0;\n    \n    int64_t gtid_31010;\n    \n    gtid_31010 = (int64_t) 0;\n    \n    int64_t x_acc_34640;\n    int64_t chunk_sizze_34641;\n    \n    chunk_sizze_34641 = smin64(sdiv_up64(numVert_28890,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_31004 *\n                                         num_groups_31006))),\n                               sdiv_up64(numVert_28890 - phys_tid_31011,\n                                         num_threads_34630));\n    \n    int64_t x_29566;\n    int64_t x_29567;\n    \n    // ",
            "neutral-initialise the accumulators\n    {\n        x_acc_34640 = (int64_t) 0;\n    }\n    for (int64_t i_34645 = 0; i_34645 < chunk_sizze_34641; i_34645++) {\n        gtid_31010 = phys_tid_31011 + num_threads_34630 * i_34645;\n        // apply map function\n        {\n            int64_t x_29569 = ((__global\n                                int64_t *) lifted_fromInit_res_mem_32257)[gtid_31010];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29566 = x_acc_34640;\n            }\n            // load new values\n            {\n                x_29567 = x_29569;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29568 = add64(x_29566, x_29567);\n                \n                // store in accumulator\n                {\n                    x_acc_34640 = defunc_1_op_res_29568;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29566 = x_acc_34640;\n        ((__local int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n            x_29566;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_34646;\n    int32_t skip_waves_34647;\n    \n    skip_waves_34647 = 1;\n    \n    int64_t x_34642;\n    int64_t x_34643;\n    \n    offset_34646 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_34632, sext_i64_i32(segred_group_sizze_31004))) {\n            x_34642 = ((__local\n                        int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                      offset_34646)];\n        }\n    }\n    offset_34646 = 1;\n    while (slt32(offset_34646, wave_sizze_34634)) {\n        if (slt32(local_tid_34632 + offset_34646,\n                  sext_i64_i32(segred_group_sizze_31004)) && ((local_tid_34632 -\n                                                               squot32(local_tid_34632,\n ",
            "                                                                      wave_sizze_34634) *\n                                                               wave_sizze_34634) &\n                                                              (2 *\n                                                               offset_34646 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_34643 = ((volatile __local\n                            int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                          offset_34646)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34644 = add64(x_34642, x_34643);\n                \n                x_34642 = defunc_1_op_res_34644;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n                    x_34642;\n            }\n        }\n        offset_34646 *= 2;\n    }\n    while (slt32(skip_waves_34647,\n                 squot32(sext_i64_i32(segred_group_sizze_31004) +\n                         wave_sizze_34634 - 1, wave_sizze_34634))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_34646 = skip_waves_34647 * wave_sizze_34634;\n        if (slt32(local_tid_34632 + offset_34646,\n                  sext_i64_i32(segred_group_sizze_31004)) && ((local_tid_34632 -\n                                                               squot32(local_tid_34632,\n                                                                       wave_sizze_34634) *\n                                                               wave_sizze_34634) ==\n                                                              0 &&\n                                                              (squot32(local_tid_34632,\n                                                       ",
            "                wave_sizze_34634) &\n                                                               (2 *\n                                                                skip_waves_34647 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_34643 = ((__local\n                            int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                          offset_34646)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34644 = add64(x_34642, x_34643);\n                \n                x_34642 = defunc_1_op_res_34644;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n                    x_34642;\n            }\n        }\n        skip_waves_34647 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_34632) == (int64_t) 0) {\n            x_acc_34640 = x_34642;\n        }\n    }\n    \n    int32_t old_counter_34648;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_34632 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_34628)[sext_i32_i64(group_tid_34633) *\n                                                  segred_group_sizze_31004] =\n                x_acc_34640;\n            mem_fence_global();\n            old_counter_34648 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34626)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_34636)[(int64_t) 0] =\n                old_counter_34648 == num_groups_31006 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_",
            "GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_34649;\n    \n    is_last_group_34649 = ((__local bool *) sync_arr_mem_34636)[(int64_t) 0];\n    if (is_last_group_34649) {\n        if (local_tid_34632 == 0) {\n            old_counter_34648 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34626)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_31006));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_34650 = sdiv_up64(num_groups_31006,\n                                                      segred_group_sizze_31004);\n            \n            x_29566 = (int64_t) 0;\n            for (int64_t i_34651 = 0; i_34651 < read_per_thread_34650;\n                 i_34651++) {\n                int64_t group_res_id_34652 = sext_i32_i64(local_tid_34632) *\n                        read_per_thread_34650 + i_34651;\n                int64_t index_of_group_res_34653 = group_res_id_34652;\n                \n                if (slt64(group_res_id_34652, num_groups_31006)) {\n                    x_29567 = ((__global\n                                int64_t *) group_res_arr_mem_34628)[index_of_group_res_34653 *\n                                                                    segred_group_sizze_31004];\n                    \n                    int64_t defunc_1_op_res_29568;\n                    \n                    defunc_1_op_res_29568 = add64(x_29566, x_29567);\n                    x_29566 = defunc_1_op_res_29568;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n            x_29566;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_34654;\n            int32_t skip_waves_34655;\n            \n            s",
            "kip_waves_34655 = 1;\n            \n            int64_t x_34642;\n            int64_t x_34643;\n            \n            offset_34654 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_34632,\n                          sext_i64_i32(segred_group_sizze_31004))) {\n                    x_34642 = ((__local\n                                int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                              offset_34654)];\n                }\n            }\n            offset_34654 = 1;\n            while (slt32(offset_34654, wave_sizze_34634)) {\n                if (slt32(local_tid_34632 + offset_34654,\n                          sext_i64_i32(segred_group_sizze_31004)) &&\n                    ((local_tid_34632 - squot32(local_tid_34632,\n                                                wave_sizze_34634) *\n                      wave_sizze_34634) & (2 * offset_34654 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_34643 = ((volatile __local\n                                    int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                                  offset_34654)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34644 = add64(x_34642, x_34643);\n                        \n                        x_34642 = defunc_1_op_res_34644;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n                            x_34642;\n                    }\n                }\n                offset_34654 *= 2;\n            }\n            while (slt32(skip_waves_34655,\n                         squot32(sext_i64_i32(segred_group_sizze",
            "_31004) +\n                                 wave_sizze_34634 - 1, wave_sizze_34634))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_34654 = skip_waves_34655 * wave_sizze_34634;\n                if (slt32(local_tid_34632 + offset_34654,\n                          sext_i64_i32(segred_group_sizze_31004)) &&\n                    ((local_tid_34632 - squot32(local_tid_34632,\n                                                wave_sizze_34634) *\n                      wave_sizze_34634) == 0 && (squot32(local_tid_34632,\n                                                         wave_sizze_34634) &\n                                                 (2 * skip_waves_34655 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_34643 = ((__local\n                                    int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632 +\n                                                                  offset_34654)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34644 = add64(x_34642, x_34643);\n                        \n                        x_34642 = defunc_1_op_res_34644;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_34638)[sext_i32_i64(local_tid_34632)] =\n                            x_34642;\n                    }\n                }\n                skip_waves_34655 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_34632 == 0) {\n                    ((__global int64_t *) mem_32260)[(int64_t) 0] = x_34642;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_31004\n}\n__kernel void test_clusterWithzisegred_nonseg_31043(__global\n                          ",
            "                          int *global_failure,\n                                                    uint red_arr_mem_34838_backing_offset_0,\n                                                    uint sync_arr_mem_34836_backing_offset_1,\n                                                    int64_t partition_sizze_29591,\n                                                    int64_t num_groups_31038,\n                                                    int64_t num_threads_34830,\n                                                    __global\n                                                    unsigned char *mem_32292,\n                                                    __global\n                                                    unsigned char *mem_32295,\n                                                    __global\n                                                    unsigned char *test_clusterWithzicounter_mem_34826,\n                                                    __global\n                                                    unsigned char *group_res_arr_mem_34828)\n{\n    #define segred_group_sizze_31036 (test_clusterWithzisegred_group_sizze_31035)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34838_backing_1 =\n                  &shared_mem[red_arr_mem_34838_backing_offset_0];\n    volatile char *sync_arr_mem_34836_backing_0 =\n                  &shared_mem[sync_arr_mem_34836_backing_offset_1];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34831;\n    int32_t local_tid_34832;\n    int64_t group_sizze_34835;\n    int32_t wave_sizze_34834;\n    int32_t group_tid_34833;\n    \n    global_tid_34831 = get_global_id(0);\n    local_tid_34832 = get_local_id(0);\n    group_sizze_34835 = get_local_size(0);\n    wave_sizze_34834 = LOCKSTEP_WIDTH;\n    group_tid_34833 = get_group_id(0);\n    \n    int32_t phys_tid_31043;\n    \n    phys_tid_31043 = global_tid_34831;\n    \n    __local char *sync_a",
            "rr_mem_34836;\n    \n    sync_arr_mem_34836 = (__local char *) sync_arr_mem_34836_backing_0;\n    \n    __local char *red_arr_mem_34838;\n    \n    red_arr_mem_34838 = (__local char *) red_arr_mem_34838_backing_1;\n    \n    int64_t dummy_31041;\n    \n    dummy_31041 = (int64_t) 0;\n    \n    int64_t gtid_31042;\n    \n    gtid_31042 = (int64_t) 0;\n    \n    int64_t x_acc_34840;\n    int64_t chunk_sizze_34841;\n    \n    chunk_sizze_34841 = smin64(sdiv_up64(partition_sizze_29591,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_31036 *\n                                         num_groups_31038))),\n                               sdiv_up64(partition_sizze_29591 - phys_tid_31043,\n                                         num_threads_34830));\n    \n    int64_t x_29635;\n    int64_t x_29636;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_34840 = (int64_t) 0;\n    }\n    for (int64_t i_34845 = 0; i_34845 < chunk_sizze_34841; i_34845++) {\n        gtid_31042 = phys_tid_31043 + num_threads_34830 * i_34845;\n        // apply map function\n        {\n            int64_t x_29638 = ((__global int64_t *) mem_32292)[gtid_31042];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29635 = x_acc_34840;\n            }\n            // load new values\n            {\n                x_29636 = x_29638;\n            }\n            // apply reduction operator\n            {\n                int64_t defunc_1_op_res_29637 = add64(x_29635, x_29636);\n                \n                // store in accumulator\n                {\n                    x_acc_34840 = defunc_1_op_res_29637;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29635 = x_acc_34840;\n        ((__local int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n            x_29635;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_348",
            "46;\n    int32_t skip_waves_34847;\n    \n    skip_waves_34847 = 1;\n    \n    int64_t x_34842;\n    int64_t x_34843;\n    \n    offset_34846 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_34832, sext_i64_i32(segred_group_sizze_31036))) {\n            x_34842 = ((__local\n                        int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                                                      offset_34846)];\n        }\n    }\n    offset_34846 = 1;\n    while (slt32(offset_34846, wave_sizze_34834)) {\n        if (slt32(local_tid_34832 + offset_34846,\n                  sext_i64_i32(segred_group_sizze_31036)) && ((local_tid_34832 -\n                                                               squot32(local_tid_34832,\n                                                                       wave_sizze_34834) *\n                                                               wave_sizze_34834) &\n                                                              (2 *\n                                                               offset_34846 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_34843 = ((volatile __local\n                            int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                                                          offset_34846)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34844 = add64(x_34842, x_34843);\n                \n                x_34842 = defunc_1_op_res_34844;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n                    x_34842;\n            }\n        }\n        offset_34846 *= 2;\n    }\n    while (slt32(skip_waves_34847,\n                 squot32(sext_i64_i32(segred_group_sizze_31036)",
            " +\n                         wave_sizze_34834 - 1, wave_sizze_34834))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_34846 = skip_waves_34847 * wave_sizze_34834;\n        if (slt32(local_tid_34832 + offset_34846,\n                  sext_i64_i32(segred_group_sizze_31036)) && ((local_tid_34832 -\n                                                               squot32(local_tid_34832,\n                                                                       wave_sizze_34834) *\n                                                               wave_sizze_34834) ==\n                                                              0 &&\n                                                              (squot32(local_tid_34832,\n                                                                       wave_sizze_34834) &\n                                                               (2 *\n                                                                skip_waves_34847 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_34843 = ((__local\n                            int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                                                          offset_34846)];\n            }\n            // apply reduction operation\n            {\n                int64_t defunc_1_op_res_34844 = add64(x_34842, x_34843);\n                \n                x_34842 = defunc_1_op_res_34844;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n                    x_34842;\n            }\n        }\n        skip_waves_34847 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_34832) == (int64_t) 0) {\n            x_acc_34840 = x_34842;\n        }\n    }\n    \n    int32_t old_counter_34848;\n  ",
            "  \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_34832 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_34828)[sext_i32_i64(group_tid_34833) *\n                                                  segred_group_sizze_31036] =\n                x_acc_34840;\n            mem_fence_global();\n            old_counter_34848 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34826)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_34836)[(int64_t) 0] =\n                old_counter_34848 == num_groups_31038 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_34849;\n    \n    is_last_group_34849 = ((__local bool *) sync_arr_mem_34836)[(int64_t) 0];\n    if (is_last_group_34849) {\n        if (local_tid_34832 == 0) {\n            old_counter_34848 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test_clusterWithzicounter_mem_34826)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             num_groups_31038));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_34850 = sdiv_up64(num_groups_31038,\n                                                      segred_group_sizze_31036);\n            \n            x_29635 = (int64_t) 0;\n            for (int64_t i_34851 = 0; i_34851 < read_per_thread_34850;\n                 i_34851++) {\n                int64_t group_res_id_34852 = sext_i32_i64(local_tid_34832) *\n                        read_per_thread_34850 + i_34851;\n                int64_t index_of_group_res_34853 = group_res_id_34852;\n                \n                if (slt64(group_res_id_34852, num_groups_31038)) {\n  ",
            "                  x_29636 = ((__global\n                                int64_t *) group_res_arr_mem_34828)[index_of_group_res_34853 *\n                                                                    segred_group_sizze_31036];\n                    \n                    int64_t defunc_1_op_res_29637;\n                    \n                    defunc_1_op_res_29637 = add64(x_29635, x_29636);\n                    x_29635 = defunc_1_op_res_29637;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n            x_29635;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_34854;\n            int32_t skip_waves_34855;\n            \n            skip_waves_34855 = 1;\n            \n            int64_t x_34842;\n            int64_t x_34843;\n            \n            offset_34854 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_34832,\n                          sext_i64_i32(segred_group_sizze_31036))) {\n                    x_34842 = ((__local\n                                int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                                                              offset_34854)];\n                }\n            }\n            offset_34854 = 1;\n            while (slt32(offset_34854, wave_sizze_34834)) {\n                if (slt32(local_tid_34832 + offset_34854,\n                          sext_i64_i32(segred_group_sizze_31036)) &&\n                    ((local_tid_34832 - squot32(local_tid_34832,\n                                                wave_sizze_34834) *\n                      wave_sizze_34834) & (2 * offset_34854 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_34843 = ((volatile __local\n                                    int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                      ",
            "                                            offset_34854)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34844 = add64(x_34842, x_34843);\n                        \n                        x_34842 = defunc_1_op_res_34844;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n                            x_34842;\n                    }\n                }\n                offset_34854 *= 2;\n            }\n            while (slt32(skip_waves_34855,\n                         squot32(sext_i64_i32(segred_group_sizze_31036) +\n                                 wave_sizze_34834 - 1, wave_sizze_34834))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_34854 = skip_waves_34855 * wave_sizze_34834;\n                if (slt32(local_tid_34832 + offset_34854,\n                          sext_i64_i32(segred_group_sizze_31036)) &&\n                    ((local_tid_34832 - squot32(local_tid_34832,\n                                                wave_sizze_34834) *\n                      wave_sizze_34834) == 0 && (squot32(local_tid_34832,\n                                                         wave_sizze_34834) &\n                                                 (2 * skip_waves_34855 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_34843 = ((__local\n                                    int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832 +\n                                                                  offset_34854)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t defunc_1_op_res_34844 = add64(x_34842, x_34843);\n                        \n                     ",
            "   x_34842 = defunc_1_op_res_34844;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_34838)[sext_i32_i64(local_tid_34832)] =\n                            x_34842;\n                    }\n                }\n                skip_waves_34855 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_34832 == 0) {\n                    ((__global int64_t *) mem_32295)[(int64_t) 0] = x_34842;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_31036\n}\n__kernel void test_clusterWithzisegred_small_33339(__global int *global_failure,\n                                                   uint red_arr_mem_33347_backing_offset_0,\n                                                   int64_t defunc_2_reduce_res_29171,\n                                                   int64_t num_groups_30657,\n                                                   int32_t num_subhistos_33260,\n                                                   int64_t segment_sizze_nonzzero_33340,\n                                                   __global\n                                                   unsigned char *mem_32102,\n                                                   __global\n                                                   unsigned char *defunc_1_map_res_subhistos_mem_33261)\n{\n    #define seghist_group_sizze_30655 (test_clusterWithziseghist_group_sizze_30654)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_33347_backing_0 =\n                  &shared_mem[red_arr_mem_33347_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33342;\n    int32_t local_tid_33343;\n    int64_t group_sizze_33346;\n    int32_t wave_sizze_33345;\n    int32_t group_tid_33344;\n    \n",
            "    global_tid_33342 = get_global_id(0);\n    local_tid_33343 = get_local_id(0);\n    group_sizze_33346 = get_local_size(0);\n    wave_sizze_33345 = LOCKSTEP_WIDTH;\n    group_tid_33344 = get_group_id(0);\n    \n    int32_t flat_gtid_33339;\n    \n    flat_gtid_33339 = global_tid_33342;\n    \n    __local char *red_arr_mem_33347;\n    \n    red_arr_mem_33347 = (__local char *) red_arr_mem_33347_backing_0;\n    \n    int32_t phys_group_id_33349;\n    \n    phys_group_id_33349 = get_group_id(0);\n    for (int32_t i_33350 = 0; i_33350 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29171,\n                                          squot64(seghist_group_sizze_30655,\n                                                  segment_sizze_nonzzero_33340))) -\n                   phys_group_id_33349, sext_i64_i32(num_groups_30657));\n         i_33350++) {\n        int32_t virt_group_id_33351 = phys_group_id_33349 + i_33350 *\n                sext_i64_i32(num_groups_30657);\n        int64_t bucket_id_33337 = squot64(sext_i32_i64(local_tid_33343),\n                                          segment_sizze_nonzzero_33340) +\n                sext_i32_i64(virt_group_id_33351) *\n                squot64(seghist_group_sizze_30655,\n                        segment_sizze_nonzzero_33340);\n        int64_t subhistogram_id_33338 = srem64(sext_i32_i64(local_tid_33343),\n                                               num_subhistos_33260);\n        \n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_33260) &&\n                (slt64(bucket_id_33337, defunc_2_reduce_res_29171) &&\n                 slt64(sext_i32_i64(local_tid_33343), num_subhistos_33260 *\n                       squot64(seghist_group_sizze_30655,\n                               segment_sizze_nonzzero_33340)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n            ",
            "            ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_33261)[subhistogram_id_33338 *\n                                                                           defunc_2_reduce_res_29171 +\n                                                                           bucket_id_33337];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n                    (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_33260)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_30661;\n                int64_t x_30662;\n                int64_t x_33352;\n                int64_t x_33353;\n                bool ltid_in_bounds_33355;\n                \n                ltid_in_bounds_33355 = slt64(sext_i32_i64(local_tid_33343),\n                                             num_subhistos_33260 *\n                                             squot64(seghist_group_sizze_30655,\n                                                     segment_sizze_nonzzero_33340));\n                \n                int32_t skip_threads_33356;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_33355) {\n                        x_30662 = ((volatile __local\n                                    int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)];\n                        if ((local_tid_33343 - squot32(local_tid_33343, 32) *\n                             32) == 0) {\n                            x_30661 = x_30662;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_33356 = 1;\n                    while (slt32(skip_threads_33356, 32)) {\n                        if (sle32(skip_threads_33356",
            ", local_tid_33343 -\n                                  squot32(local_tid_33343, 32) * 32) &&\n                            ltid_in_bounds_33355) {\n                            // read operands\n                            {\n                                x_30661 = ((volatile __local\n                                            int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343) -\n                                                                          sext_i32_i64(skip_threads_33356)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_33357 =\n                                     slt64(srem64(sext_i32_i64(local_tid_33343),\n                                                  num_subhistos_33260),\n                                           sext_i32_i64(local_tid_33343) -\n                                           sext_i32_i64(local_tid_33343 -\n                                           skip_threads_33356));\n                                \n                                if (inactive_33357) {\n                                    x_30661 = x_30662;\n                                }\n                                if (!inactive_33357) {\n                                    int64_t defunc_1_f_res_30663 =\n                                            smax64(x_30661, x_30662);\n                                    \n                                    x_30661 = defunc_1_f_res_30663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_33345, skip_threads_33356)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_33356, local_tid_33343 -\n                                  squot32(local_tid_33343, 32) * 32) &&\n                            ltid_in_bounds_33355) {\n                            // write result\n             ",
            "               {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n                                    x_30661;\n                                x_30662 = x_30661;\n                            }\n                        }\n                        if (sle32(wave_sizze_33345, skip_threads_33356)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_33356 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_33343 - squot32(local_tid_33343, 32) * 32) ==\n                        31 && ltid_in_bounds_33355) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_33347)[sext_i32_i64(squot32(local_tid_33343,\n                                                                             32))] =\n                            x_30661;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_33358;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_33343, 32) == 0 &&\n                            ltid_in_bounds_33355) {\n                            x_33353 = ((volatile __local\n                                        int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)];\n                            if ((local_tid_33343 - squot32(local_tid_33343,\n                                                           32) * 32) == 0) {\n                                x_33352 = x_33353;\n                            }\n                        }\n                    ",
            "}\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_33358 = 1;\n                        while (slt32(skip_threads_33358, 32)) {\n                            if (sle32(skip_threads_33358, local_tid_33343 -\n                                      squot32(local_tid_33343, 32) * 32) &&\n                                (squot32(local_tid_33343, 32) == 0 &&\n                                 ltid_in_bounds_33355)) {\n                                // read operands\n                                {\n                                    x_33352 = ((volatile __local\n                                                int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343) -\n                                                                              sext_i32_i64(skip_threads_33358)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_33359 =\n                                         slt64(srem64(sext_i32_i64(local_tid_33343 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_33260),\n                                               sext_i32_i64(local_tid_33343 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_33343 -\n                                                             skip_threads_33358) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_33359) {\n                                        x_33352 = x_33353;\n                                    }\n                                    if (!inactive_33359) {\n                                        int64_t defunc_1_f_res_33354 =\n                                                sma",
            "x64(x_33352, x_33353);\n                                        \n                                        x_33352 = defunc_1_f_res_33354;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_33345, skip_threads_33358)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_33358, local_tid_33343 -\n                                      squot32(local_tid_33343, 32) * 32) &&\n                                (squot32(local_tid_33343, 32) == 0 &&\n                                 ltid_in_bounds_33355)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n                                        x_33352;\n                                    x_33353 = x_33352;\n                                }\n                            }\n                            if (sle32(wave_sizze_33345, skip_threads_33358)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_33358 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_33343, 32) == 0 ||\n                          !ltid_in_bounds_33355)) {\n                        // read operands\n                        {\n                            x_30662 = x_30661;\n                            x_30661 = ((__local\n                                        int64_t *) red_arr_mem_33347)[sext_i32_i64(squot32(local_tid_33343,\n                                                                                           32)) -\n       ",
            "                                                               (int64_t) 1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_33360 =\n                                 slt64(srem64(sext_i32_i64(local_tid_33343),\n                                              num_subhistos_33260),\n                                       sext_i32_i64(local_tid_33343) -\n                                       sext_i32_i64(squot32(local_tid_33343,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_33360) {\n                                x_30661 = x_30662;\n                            }\n                            if (!inactive_33360) {\n                                int64_t defunc_1_f_res_30663 = smax64(x_30661,\n                                                                      x_30662);\n                                \n                                x_30661 = defunc_1_f_res_30663;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n                                x_30661;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_33343, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_33347)[sext_i32_i64(local_tid_33343)] =\n                            x_30662;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i",
            "64(virt_group_id_33351) *\n                      squot64(seghist_group_sizze_30655,\n                              segment_sizze_nonzzero_33340) +\n                      sext_i32_i64(local_tid_33343),\n                      defunc_2_reduce_res_29171) &&\n                slt64(sext_i32_i64(local_tid_33343),\n                      squot64(seghist_group_sizze_30655,\n                              segment_sizze_nonzzero_33340))) {\n                ((__global\n                  int64_t *) mem_32102)[sext_i32_i64(virt_group_id_33351) *\n                                        squot64(seghist_group_sizze_30655,\n                                                segment_sizze_nonzzero_33340) +\n                                        sext_i32_i64(local_tid_33343)] =\n                    ((__local\n                      int64_t *) red_arr_mem_33347)[(sext_i32_i64(local_tid_33343) +\n                                                     (int64_t) 1) *\n                                                    segment_sizze_nonzzero_33340 -\n                                                    (int64_t) 1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_30655\n}\n__kernel void test_clusterWithzisegred_small_34936(__global int *global_failure,\n                                                   uint red_arr_mem_34944_backing_offset_0,\n                                                   int64_t defunc_2_reduce_res_29634,\n                                                   int64_t num_groups_31048,\n                                                   int32_t num_subhistos_34857,\n                                                   int64_t segment_sizze_nonzzero_34937,\n                                                   __global\n                                                   unsigned char *mem_32297,\n                                                   __global\n               ",
            "                                    unsigned char *defunc_1_map_res_subhistos_mem_34858)\n{\n    #define seghist_group_sizze_31046 (test_clusterWithziseghist_group_sizze_31045)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_34944_backing_0 =\n                  &shared_mem[red_arr_mem_34944_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34939;\n    int32_t local_tid_34940;\n    int64_t group_sizze_34943;\n    int32_t wave_sizze_34942;\n    int32_t group_tid_34941;\n    \n    global_tid_34939 = get_global_id(0);\n    local_tid_34940 = get_local_id(0);\n    group_sizze_34943 = get_local_size(0);\n    wave_sizze_34942 = LOCKSTEP_WIDTH;\n    group_tid_34941 = get_group_id(0);\n    \n    int32_t flat_gtid_34936;\n    \n    flat_gtid_34936 = global_tid_34939;\n    \n    __local char *red_arr_mem_34944;\n    \n    red_arr_mem_34944 = (__local char *) red_arr_mem_34944_backing_0;\n    \n    int32_t phys_group_id_34946;\n    \n    phys_group_id_34946 = get_group_id(0);\n    for (int32_t i_34947 = 0; i_34947 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29634,\n                                          squot64(seghist_group_sizze_31046,\n                                                  segment_sizze_nonzzero_34937))) -\n                   phys_group_id_34946, sext_i64_i32(num_groups_31048));\n         i_34947++) {\n        int32_t virt_group_id_34948 = phys_group_id_34946 + i_34947 *\n                sext_i64_i32(num_groups_31048);\n        int64_t bucket_id_34934 = squot64(sext_i32_i64(local_tid_34940),\n                                          segment_sizze_nonzzero_34937) +\n                sext_i32_i64(virt_group_id_34948) *\n                squot64(seghist_group_sizze_31046,\n                        segment_sizze_nonzzero_34937);\n        int64_t subhistogram_id_34935 = srem64(sext_i32_i64(local_tid_34940),\n                                               num_subh",
            "istos_34857);\n        \n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_34857) &&\n                (slt64(bucket_id_34934, defunc_2_reduce_res_29634) &&\n                 slt64(sext_i32_i64(local_tid_34940), num_subhistos_34857 *\n                       squot64(seghist_group_sizze_31046,\n                               segment_sizze_nonzzero_34937)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                        ((__global\n                          int64_t *) defunc_1_map_res_subhistos_mem_34858)[subhistogram_id_34935 *\n                                                                           defunc_2_reduce_res_29634 +\n                                                                           bucket_id_34934];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                    (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_34857)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_31052;\n                int64_t x_31053;\n                int64_t x_34949;\n                int64_t x_34950;\n                bool ltid_in_bounds_34952;\n                \n                ltid_in_bounds_34952 = slt64(sext_i32_i64(local_tid_34940),\n                                             num_subhistos_34857 *\n                                             squot64(seghist_group_sizze_31046,\n                                                     segment_sizze_nonzzero_34937));\n                \n                int32_t skip_threads_34953;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_34952) {\n                        x",
            "_31053 = ((volatile __local\n                                    int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)];\n                        if ((local_tid_34940 - squot32(local_tid_34940, 32) *\n                             32) == 0) {\n                            x_31052 = x_31053;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_34953 = 1;\n                    while (slt32(skip_threads_34953, 32)) {\n                        if (sle32(skip_threads_34953, local_tid_34940 -\n                                  squot32(local_tid_34940, 32) * 32) &&\n                            ltid_in_bounds_34952) {\n                            // read operands\n                            {\n                                x_31052 = ((volatile __local\n                                            int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940) -\n                                                                          sext_i32_i64(skip_threads_34953)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_34954 =\n                                     slt64(srem64(sext_i32_i64(local_tid_34940),\n                                                  num_subhistos_34857),\n                                           sext_i32_i64(local_tid_34940) -\n                                           sext_i32_i64(local_tid_34940 -\n                                           skip_threads_34953));\n                                \n                                if (inactive_34954) {\n                                    x_31052 = x_31053;\n                                }\n                                if (!inactive_34954) {\n                                    int64_t defunc_1_f_res_31054 =\n                                            smax64(x_31052, x_31053);\n           ",
            "                         \n                                    x_31052 = defunc_1_f_res_31054;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_34942, skip_threads_34953)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_34953, local_tid_34940 -\n                                  squot32(local_tid_34940, 32) * 32) &&\n                            ltid_in_bounds_34952) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                                    x_31052;\n                                x_31053 = x_31052;\n                            }\n                        }\n                        if (sle32(wave_sizze_34942, skip_threads_34953)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_34953 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_34940 - squot32(local_tid_34940, 32) * 32) ==\n                        31 && ltid_in_bounds_34952) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_34944)[sext_i32_i64(squot32(local_tid_34940,\n                                                                             32))] =\n                            x_31052;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_34955;\n                    \n                    // read input ",
            "for in-block scan\n                    {\n                        if (squot32(local_tid_34940, 32) == 0 &&\n                            ltid_in_bounds_34952) {\n                            x_34950 = ((volatile __local\n                                        int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)];\n                            if ((local_tid_34940 - squot32(local_tid_34940,\n                                                           32) * 32) == 0) {\n                                x_34949 = x_34950;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_34955 = 1;\n                        while (slt32(skip_threads_34955, 32)) {\n                            if (sle32(skip_threads_34955, local_tid_34940 -\n                                      squot32(local_tid_34940, 32) * 32) &&\n                                (squot32(local_tid_34940, 32) == 0 &&\n                                 ltid_in_bounds_34952)) {\n                                // read operands\n                                {\n                                    x_34949 = ((volatile __local\n                                                int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940) -\n                                                                              sext_i32_i64(skip_threads_34955)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_34956 =\n                                         slt64(srem64(sext_i32_i64(local_tid_34940 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_34857),\n                                               sext_i32_i64(local_tid_34940 *\n                                               32 + 32 - 1) -\n ",
            "                                              sext_i32_i64((local_tid_34940 -\n                                                             skip_threads_34955) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_34956) {\n                                        x_34949 = x_34950;\n                                    }\n                                    if (!inactive_34956) {\n                                        int64_t defunc_1_f_res_34951 =\n                                                smax64(x_34949, x_34950);\n                                        \n                                        x_34949 = defunc_1_f_res_34951;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_34942, skip_threads_34955)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_34955, local_tid_34940 -\n                                      squot32(local_tid_34940, 32) * 32) &&\n                                (squot32(local_tid_34940, 32) == 0 &&\n                                 ltid_in_bounds_34952)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                                        x_34949;\n                                    x_34950 = x_34949;\n                                }\n                            }\n                            if (sle32(wave_sizze_34942, skip_threads_34955)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_34955 *= 2;\n                        }\n                    }\n                }\n                bar",
            "rier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_34940, 32) == 0 ||\n                          !ltid_in_bounds_34952)) {\n                        // read operands\n                        {\n                            x_31053 = x_31052;\n                            x_31052 = ((__local\n                                        int64_t *) red_arr_mem_34944)[sext_i32_i64(squot32(local_tid_34940,\n                                                                                           32)) -\n                                                                      (int64_t) 1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_34957 =\n                                 slt64(srem64(sext_i32_i64(local_tid_34940),\n                                              num_subhistos_34857),\n                                       sext_i32_i64(local_tid_34940) -\n                                       sext_i32_i64(squot32(local_tid_34940,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_34957) {\n                                x_31052 = x_31053;\n                            }\n                            if (!inactive_34957) {\n                                int64_t defunc_1_f_res_31054 = smax64(x_31052,\n                                                                      x_31053);\n                                \n                                x_31052 = defunc_1_f_res_31054;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                                x_31052;\n                        }\n                  ",
            "  }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_34940, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_34944)[sext_i32_i64(local_tid_34940)] =\n                            x_31053;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_34948) *\n                      squot64(seghist_group_sizze_31046,\n                              segment_sizze_nonzzero_34937) +\n                      sext_i32_i64(local_tid_34940),\n                      defunc_2_reduce_res_29634) &&\n                slt64(sext_i32_i64(local_tid_34940),\n                      squot64(seghist_group_sizze_31046,\n                              segment_sizze_nonzzero_34937))) {\n                ((__global\n                  int64_t *) mem_32297)[sext_i32_i64(virt_group_id_34948) *\n                                        squot64(seghist_group_sizze_31046,\n                                                segment_sizze_nonzzero_34937) +\n                                        sext_i32_i64(local_tid_34940)] =\n                    ((__local\n                      int64_t *) red_arr_mem_34944)[(sext_i32_i64(local_tid_34940) +\n                                                     (int64_t) 1) *\n                                                    segment_sizze_nonzzero_34937 -\n                                                    (int64_t) 1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_31046\n}\n__kernel void test_clusterWithzisegscan_30493(__global int *global_failure,\n                                             ",
            " uint local_mem_32511_backing_offset_0,\n                                              int64_t conc_tmp_28900,\n                                              int32_t defunc_2_radix_sort_step_arg_28918,\n                                              int32_t defunc_0_get_bit_arg_28919,\n                                              __global\n                                              unsigned char *mem_param_31959,\n                                              __global unsigned char *mem_31971,\n                                              __global unsigned char *mem_31973,\n                                              __global unsigned char *mem_31975,\n                                              __global unsigned char *mem_31977,\n                                              __global unsigned char *mem_31979,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_32467,\n                                              __global\n                                              unsigned char *status_flags_mem_32469,\n                                              __global\n                                              unsigned char *aggregates_mem_32471,\n                                              __global\n                                              unsigned char *incprefixes_mem_32473,\n                                              __global\n                                              unsigned char *aggregates_mem_32475,\n                                              __global\n                                              unsigned char *incprefixes_mem_32477,\n                                              __global\n                                              unsigned char *aggregates_mem_32479,\n                                              __global\n                                              unsigned char *incprefixes_mem_32481,\n                                              __globa",
            "l\n                                              unsigned char *aggregates_mem_32483,\n                                              __global\n                                              unsigned char *incprefixes_mem_32485)\n{\n    #define segscan_group_sizze_30488 (test_clusterWithzisegscan_group_sizze_30487)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32511_backing_0 =\n                  &shared_mem[local_mem_32511_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32496;\n    int32_t local_tid_32497;\n    int64_t group_sizze_32500;\n    int32_t wave_sizze_32499;\n    int32_t group_tid_32498;\n    \n    global_tid_32496 = get_global_id(0);\n    local_tid_32497 = get_local_id(0);\n    group_sizze_32500 = get_local_size(0);\n    wave_sizze_32499 = LOCKSTEP_WIDTH;\n    group_tid_32498 = get_group_id(0);\n    \n    int32_t phys_tid_30493;\n    \n    phys_tid_30493 = global_tid_32496;\n    \n    int64_t byte_offsets_32501;\n    \n    byte_offsets_32501 = (int64_t) 0;\n    \n    int64_t byte_offsets_32502;\n    \n    byte_offsets_32502 = segscan_group_sizze_30488 * (int64_t) 8;\n    \n    int64_t byte_offsets_32503;\n    \n    byte_offsets_32503 = sdiv_up64(segscan_group_sizze_30488 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_30488 * (int64_t) 8;\n    \n    int64_t byte_offsets_32504;\n    \n    byte_offsets_32504 = sdiv_up64(sdiv_up64(segscan_group_sizze_30488 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_30488 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_30488 * (int64_t) 8;\n    \n    int64_t byte_offsets_32505;\n    \n    byte_offsets_32505 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_30488 * (int64_t) 8,\n                                      (",
            "int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_30488 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_30488 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30488 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32506;\n    \n    warp_byte_offset_32506 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32507;\n    \n    warp_byte_offset_32507 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_32508;\n    \n    warp_byte_offset_32508 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_32509;\n    \n    warp_byte_offset_32509 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_32510;\n    \n    warp_byte_offset_32510 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32511;\n    \n    local_mem_32511 = (__local char *) local_mem_32511_backing_0;\n    \n    int64_t trans_arr_len_32512;\n    \n    trans_arr_len_32512 = (int64_t) 9 * segscan_group_sizze_30488;\n    \n    int32_t dynamic_id_32528;\n    \n    if (local_tid_32497 == 0) {\n        dynamic_id_32528 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_32467)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32511)[(int64_t) 0] = dynamic_id_32528;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32528 = ((__local int32_t *) local_mem_32511)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32529;\n    \n    blockOff_32529 = sext_i32_i64(dynamic_id_32528) * (int64_t) 9 *\n        segscan_group_sizze_30488;\n    \n    int64_t private_mem_32530[9];\n    int64_t private_mem_32532[9];\n    int64_t private_mem_32534[9];\n    int64_t private_mem_32536[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32538 = 0; i_32538 < (int64_t) 9; i_32538++) {\n            int64_t gtid_30492 = blockOff_32529 +\n                 ",
            "   sext_i32_i64(local_tid_32497) + i_32538 *\n                    segscan_group_sizze_30488;\n            \n            if (slt64(gtid_30492, conc_tmp_28900)) {\n                int32_t x_28945 = ((__global\n                                    int32_t *) mem_param_31959)[gtid_30492];\n                int32_t zgzg_res_28946 = ashr32(x_28945,\n                                                defunc_0_get_bit_arg_28919);\n                int32_t za_res_28947 = 1 & zgzg_res_28946;\n                int32_t x_28948 = mul32(2, za_res_28947);\n                int32_t zgzg_res_28949 = ashr32(x_28945,\n                                                defunc_2_radix_sort_step_arg_28918);\n                int32_t za_res_28950 = 1 & zgzg_res_28949;\n                int32_t defunc_0_f_res_28951 = add32(x_28948, za_res_28950);\n                bool cond_28952 = defunc_0_f_res_28951 == 0;\n                int64_t defunc_0_f_res_28953 = btoi_bool_i64(cond_28952);\n                int64_t defunc_0_f_res_28954;\n                int64_t defunc_0_f_res_28955;\n                int64_t defunc_0_f_res_28956;\n                \n                if (cond_28952) {\n                    defunc_0_f_res_28954 = (int64_t) 0;\n                    defunc_0_f_res_28955 = (int64_t) 0;\n                    defunc_0_f_res_28956 = (int64_t) 0;\n                } else {\n                    bool cond_28957 = defunc_0_f_res_28951 == 1;\n                    int64_t defunc_0_f_res_f_res_28958 =\n                            btoi_bool_i64(cond_28957);\n                    int64_t defunc_0_f_res_f_res_28959;\n                    int64_t defunc_0_f_res_f_res_28960;\n                    \n                    if (cond_28957) {\n                        defunc_0_f_res_f_res_28959 = (int64_t) 0;\n                        defunc_0_f_res_f_res_28960 = (int64_t) 0;\n                    } else {\n                        bool cond_28961 = defunc_0_f_res_28951 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_28962 =\n                             ",
            "   btoi_bool_i64(cond_28961);\n                        bool cond_neg_28963 = !cond_28961;\n                        int64_t defunc_0_f_res_f_res_f_res_28964 =\n                                btoi_bool_i64(cond_neg_28963);\n                        \n                        defunc_0_f_res_f_res_28959 =\n                            defunc_0_f_res_f_res_f_res_28962;\n                        defunc_0_f_res_f_res_28960 =\n                            defunc_0_f_res_f_res_f_res_28964;\n                    }\n                    defunc_0_f_res_28954 = defunc_0_f_res_f_res_28958;\n                    defunc_0_f_res_28955 = defunc_0_f_res_f_res_28959;\n                    defunc_0_f_res_28956 = defunc_0_f_res_f_res_28960;\n                }\n                ((__global int32_t *) mem_31979)[gtid_30492] =\n                    defunc_0_f_res_28951;\n                private_mem_32530[i_32538] = defunc_0_f_res_28953;\n                private_mem_32532[i_32538] = defunc_0_f_res_28954;\n                private_mem_32534[i_32538] = defunc_0_f_res_28955;\n                private_mem_32536[i_32538] = defunc_0_f_res_28956;\n            } else {\n                private_mem_32530[i_32538] = (int64_t) 0;\n                private_mem_32532[i_32538] = (int64_t) 0;\n                private_mem_32534[i_32538] = (int64_t) 0;\n                private_mem_32536[i_32538] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32539 = 0; i_32539 < (int64_t) 9; i_32539++) {\n            int64_t sharedIdx_32540 = sext_i32_i64(local_tid_32497) + i_32539 *\n                    segscan_group_sizze_30488;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32540] =\n                private_mem_32530[i_32539];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32541 = 0; i_32541 < 9; i_32541++) {\n            int32_t sharedIdx_32542 = local_tid_32497 * 9 + i_32541;\n            \n            private_mem_32530[s",
            "ext_i32_i64(i_32541)] = ((__local\n                                                         int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32542)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32543 = 0; i_32543 < (int64_t) 9; i_32543++) {\n            int64_t sharedIdx_32544 = sext_i32_i64(local_tid_32497) + i_32543 *\n                    segscan_group_sizze_30488;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32544] =\n                private_mem_32532[i_32543];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32545 = 0; i_32545 < 9; i_32545++) {\n            int32_t sharedIdx_32546 = local_tid_32497 * 9 + i_32545;\n            \n            private_mem_32532[sext_i32_i64(i_32545)] = ((__local\n                                                         int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32546)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32547 = 0; i_32547 < (int64_t) 9; i_32547++) {\n            int64_t sharedIdx_32548 = sext_i32_i64(local_tid_32497) + i_32547 *\n                    segscan_group_sizze_30488;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32548] =\n                private_mem_32534[i_32547];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32549 = 0; i_32549 < 9; i_32549++) {\n            int32_t sharedIdx_32550 = local_tid_32497 * 9 + i_32549;\n            \n            private_mem_32534[sext_i32_i64(i_32549)] = ((__local\n                                                         int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32550)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32551 = 0; i_32551 < (int64_t) 9; i_32551++) {\n            int64_t sharedIdx_32552 = sext_i32_i64(local_tid_32497) + i_32551 *\n                    segscan_group_sizze_30488;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32552] =\n                private_mem_32536[i_",
            "32551];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32553 = 0; i_32553 < 9; i_32553++) {\n            int32_t sharedIdx_32554 = local_tid_32497 * 9 + i_32553;\n            \n            private_mem_32536[sext_i32_i64(i_32553)] = ((__local\n                                                         int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32554)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32555 = 0; i_32555 < (int64_t) 8; i_32555++) {\n            int64_t x_28933;\n            int64_t x_28937;\n            \n            x_28933 = private_mem_32530[i_32555];\n            x_28937 = private_mem_32530[i_32555 + (int64_t) 1];\n            \n            int64_t x_28934;\n            int64_t x_28938;\n            \n            x_28934 = private_mem_32532[i_32555];\n            x_28938 = private_mem_32532[i_32555 + (int64_t) 1];\n            \n            int64_t x_28935;\n            int64_t x_28939;\n            \n            x_28935 = private_mem_32534[i_32555];\n            x_28939 = private_mem_32534[i_32555 + (int64_t) 1];\n            \n            int64_t x_28936;\n            int64_t x_28940;\n            \n            x_28936 = private_mem_32536[i_32555];\n            x_28940 = private_mem_32536[i_32555 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28941;\n            \n            defunc_1_op_res_28941 = add64(x_28933, x_28937);\n            \n            int64_t defunc_1_op_res_28942 = add64(x_28934, x_28938);\n            int64_t defunc_1_op_res_28943 = add64(x_28935, x_28939);\n            int64_t defunc_1_op_res_28944 = add64(x_28936, x_28940);\n            \n            private_mem_32530[i_32555 + (int64_t) 1] = defunc_1_op_res_28941;\n            private_mem_32532[i_32555 + (int64_t) 1] = defunc_1_op_res_28942;\n            private_mem_32534[i_32555 + (int64_t) 1] = defunc_1_op_res_28943;\n            private_mem_32536[i_32555 + (int64_t) 1] = defunc_1_op_res_28944;\n        }\n   ",
            " }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n            private_mem_32530[(int64_t) 8];\n        ((__local int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n            private_mem_32532[(int64_t) 8];\n        ((__local int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n            private_mem_32534[(int64_t) 8];\n        ((__local int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n            private_mem_32536[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32568;\n    int64_t acc_32569;\n    int64_t acc_32570;\n    int64_t acc_32571;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32556;\n        int64_t x_32557;\n        int64_t x_32558;\n        int64_t x_32559;\n        int64_t x_32560;\n        int64_t x_32561;\n        int64_t x_32562;\n        int64_t x_32563;\n        int64_t x_32572;\n        int64_t x_32573;\n        int64_t x_32574;\n        int64_t x_32575;\n        int64_t x_32576;\n        int64_t x_32577;\n        int64_t x_32578;\n        int64_t x_32579;\n        bool ltid_in_bounds_32584;\n        \n        ltid_in_bounds_32584 = slt64(sext_i32_i64(local_tid_32497),\n                                     segscan_group_sizze_30488);\n        \n        int32_t skip_threads_32585;\n        \n        // read input for in-block scan\n        {\n            if (l",
            "tid_in_bounds_32584) {\n                x_32560 = ((volatile __local\n                            int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32497)];\n                x_32561 = ((volatile __local\n                            int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32497)];\n                x_32562 = ((volatile __local\n                            int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32497)];\n                x_32563 = ((volatile __local\n                            int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32497)];\n                if ((local_tid_32497 - squot32(local_tid_32497, 32) * 32) ==\n                    0) {\n                    x_32556 = x_32560;\n                    x_32557 = x_32561;\n                    x_32558 = x_32562;\n                    x_32559 = x_32563;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32585 = 1;\n            while (slt32(skip_threads_32585, 32)) {\n                if (sle32(skip_threads_32585, local_tid_32497 -\n                          squot32(local_tid_32497, 32) * 32) &&\n                    ltid_in_bounds_32584) {\n                    // read operands\n                    {\n                        x_32556 = ((volatile __local\n                                    int64_t *) local_me",
            "m_32511)[squot64(byte_offsets_32501,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32497) -\n                                                                 sext_i32_i64(skip_threads_32585))];\n                        x_32557 = ((volatile __local\n                                    int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32497) -\n                                                                 sext_i32_i64(skip_threads_32585))];\n                        x_32558 = ((volatile __local\n                                    int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32497) -\n                                                                 sext_i32_i64(skip_threads_32585))];\n                        x_32559 = ((volatile __local\n                                    int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32497) -\n                                                                 sext_i32_i64(skip_threads_32585))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32564 = add64(x_32556, x_32560);\n                        int64_t defunc_1_op_res_32565 = add64(x_32557, x_32561);\n                        int64_t defunc_1_op_res_32566 = add64(x_32558, x_32562);\n                        int64_t defunc_1_op_res_32567 = add6",
            "4(x_32559, x_32563);\n                        \n                        x_32556 = defunc_1_op_res_32564;\n                        x_32557 = defunc_1_op_res_32565;\n                        x_32558 = defunc_1_op_res_32566;\n                        x_32559 = defunc_1_op_res_32567;\n                    }\n                }\n                if (sle32(wave_sizze_32499, skip_threads_32585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32585, local_tid_32497 -\n                          squot32(local_tid_32497, 32) * 32) &&\n                    ltid_in_bounds_32584) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32497)] =\n                            x_32556;\n                        x_32560 = x_32556;\n                        ((volatile __local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32497)] =\n                            x_32557;\n                        x_32561 = x_32557;\n                        ((volatile __local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32497)] =\n                            x_32558;\n                        x_32562 = x_32558;\n                        ((volatile __local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                              (int64_t) 8) +\n            ",
            "                                          sext_i32_i64(local_tid_32497)] =\n                            x_32559;\n                        x_32563 = x_32559;\n                    }\n                }\n                if (sle32(wave_sizze_32499, skip_threads_32585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32585 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32497 - squot32(local_tid_32497, 32) * 32) == 31 &&\n                ltid_in_bounds_32584) {\n                ((volatile __local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32497,\n                                                                   32))] =\n                    x_32556;\n                ((volatile __local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32497,\n                                                                   32))] =\n                    x_32557;\n                ((volatile __local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32497,\n                                                                   32))] =\n                    x_32558;\n                ((volatile __local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32497,\n          ",
            "                                                         32))] =\n                    x_32559;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32586;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32497, 32) == 0 && ltid_in_bounds_32584) {\n                    x_32576 = ((volatile __local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32497)];\n                    x_32577 = ((volatile __local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32497)];\n                    x_32578 = ((volatile __local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32497)];\n                    x_32579 = ((volatile __local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32497)];\n                    if ((local_tid_32497 - squot32(local_tid_32497, 32) * 32) ==\n                        0) {\n                        x_32572 = x_32576;\n                        x_32573 = x_32577;\n                        x_32574 = x_32578;\n                        x_32575 = x_32579;\n                    }\n",
            "                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32586 = 1;\n                while (slt32(skip_threads_32586, 32)) {\n                    if (sle32(skip_threads_32586, local_tid_32497 -\n                              squot32(local_tid_32497, 32) * 32) &&\n                        (squot32(local_tid_32497, 32) == 0 &&\n                         ltid_in_bounds_32584)) {\n                        // read operands\n                        {\n                            x_32572 = ((volatile __local\n                                        int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32497) -\n                                                                     sext_i32_i64(skip_threads_32586))];\n                            x_32573 = ((volatile __local\n                                        int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32497) -\n                                                                     sext_i32_i64(skip_threads_32586))];\n                            x_32574 = ((volatile __local\n                                        int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32497) -\n                                                                     sext_i32_i64(skip_threads_32586))];\n                            x_32575 = ((volatile __local\n                                        int64_t *) local_mem_32511)[squot64(",
            "byte_offsets_32504,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32497) -\n                                                                     sext_i32_i64(skip_threads_32586))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32580 = add64(x_32572,\n                                                                  x_32576);\n                            int64_t defunc_1_op_res_32581 = add64(x_32573,\n                                                                  x_32577);\n                            int64_t defunc_1_op_res_32582 = add64(x_32574,\n                                                                  x_32578);\n                            int64_t defunc_1_op_res_32583 = add64(x_32575,\n                                                                  x_32579);\n                            \n                            x_32572 = defunc_1_op_res_32580;\n                            x_32573 = defunc_1_op_res_32581;\n                            x_32574 = defunc_1_op_res_32582;\n                            x_32575 = defunc_1_op_res_32583;\n                        }\n                    }\n                    if (sle32(wave_sizze_32499, skip_threads_32586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32586, local_tid_32497 -\n                              squot32(local_tid_32497, 32) * 32) &&\n                        (squot32(local_tid_32497, 32) == 0 &&\n                         ltid_in_bounds_32584)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                                  (",
            "int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32497)] =\n                                x_32572;\n                            x_32576 = x_32572;\n                            ((volatile __local\n                              int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32497)] =\n                                x_32573;\n                            x_32577 = x_32573;\n                            ((volatile __local\n                              int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32497)] =\n                                x_32574;\n                            x_32578 = x_32574;\n                            ((volatile __local\n                              int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32497)] =\n                                x_32575;\n                            x_32579 = x_32575;\n                        }\n                    }\n                    if (sle32(wave_sizze_32499, skip_threads_32586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32586 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32497, 32) == 0 || !ltid_in_bounds_32584)) {\n                // read operands\n                {\n                    x_32560 = x_32556;\n                    x_32561 = x_32557;\n                    x_32562 = x_325",
            "58;\n                    x_32563 = x_32559;\n                    x_32556 = ((__local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32497,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32557 = ((__local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32497,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32558 = ((__local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32497,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_32559 = ((__local\n                                int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32497,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n  ",
            "              {\n                    int64_t defunc_1_op_res_32564 = add64(x_32556, x_32560);\n                    int64_t defunc_1_op_res_32565 = add64(x_32557, x_32561);\n                    int64_t defunc_1_op_res_32566 = add64(x_32558, x_32562);\n                    int64_t defunc_1_op_res_32567 = add64(x_32559, x_32563);\n                    \n                    x_32556 = defunc_1_op_res_32564;\n                    x_32557 = defunc_1_op_res_32565;\n                    x_32558 = defunc_1_op_res_32566;\n                    x_32559 = defunc_1_op_res_32567;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        x_32556;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        x_32557;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        x_32558;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        x_32559;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32497, ",
            "32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n                    x_32560;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n                    x_32561;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n                    x_32562;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32497)] =\n                    x_32563;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32497 == 0) {\n            acc_32568 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30488 -\n                                                       (int64_t) 1)];\n            acc_32569 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30488 -\n                                                       (int64_t) 1)];\n            acc_32570 = ((__local\n                  ",
            "        int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30488 -\n                                                       (int64_t) 1)];\n            acc_32571 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30488 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32568 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32501,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32497) -\n                                                       (int64_t) 1)];\n            acc_32569 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32502,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32497) -\n                                                       (int64_t) 1)];\n            acc_32570 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32503,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32497) -\n                                                       (int64_t) 1)];\n            acc_32571 = ((__local\n                          int64_t *) local_mem_32511)[squot64(byte_offsets_32504,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32497) -\n             ",
            "                                          (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32587;\n    \n    prefix_32587 = (int64_t) 0;\n    \n    int64_t prefix_32588;\n    \n    prefix_32588 = (int64_t) 0;\n    \n    int64_t prefix_32589;\n    \n    prefix_32589 = (int64_t) 0;\n    \n    int64_t prefix_32590;\n    \n    prefix_32590 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32528 == (int64_t) 0 && local_tid_32497 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32473)[dynamic_id_32528] = acc_32568;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32477)[dynamic_id_32528] = acc_32569;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32481)[dynamic_id_32528] = acc_32570;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32485)[dynamic_id_32528] = acc_32571;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32469)[dynamic_id_32528] = (int8_t) 2;\n            acc_32568 = (int64_t) 0;\n            acc_32569 = (int64_t) 0;\n            acc_32570 = (int64_t) 0;\n            acc_32571 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32528 == (int64_t) 0) && slt32(local_tid_32497,\n                                                        wave_sizze_32499)) {\n            if (local_tid_32497 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32471)[dynamic_id_32528] =\n                    acc_32568;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32475)[dynamic_id_32528] =\n                    acc_32569;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32479)[dynamic_id_32528] =\n                    acc_32570;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32483)[dynamic_id_32528] =\n                    acc_32571;\n                mem_fence_gl",
            "obal();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32469)[dynamic_id_32528] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32511)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32469)[dynamic_id_32528 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32591;\n            \n            status_32591 = ((__local int8_t *) local_mem_32511)[(int64_t) 0];\n            if (status_32591 == (int8_t) 2) {\n                if (local_tid_32497 == 0) {\n                    prefix_32587 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32473)[dynamic_id_32528 -\n                                                                       (int64_t) 1];\n                    prefix_32588 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32477)[dynamic_id_32528 -\n                                                                       (int64_t) 1];\n                    prefix_32589 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32481)[dynamic_id_32528 -\n                                                                       (int64_t) 1];\n                    prefix_32590 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32485)[dynamic_id_32528 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32592 = dynamic_id_32528 -\n                        sext_i32_i64(wave_sizze_32499);\n                \n                while (slt32(wave_sizze_32499 * -1, readOffset_32592)) {\n                    int32_t read_i_32593 = readOffset_32592 + local_tid_32497;\n              ",
            "      int64_t aggr_32594 = (int64_t) 0;\n                    int64_t aggr_32595 = (int64_t) 0;\n                    int64_t aggr_32596 = (int64_t) 0;\n                    int64_t aggr_32597 = (int64_t) 0;\n                    int8_t flag_32598 = (int8_t) 0;\n                    int8_t used_32599 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32593)) {\n                        flag_32598 = ((volatile __global\n                                       int8_t *) status_flags_mem_32469)[sext_i32_i64(read_i_32593)];\n                        if (flag_32598 == (int8_t) 2) {\n                            aggr_32594 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32473)[sext_i32_i64(read_i_32593)];\n                            aggr_32595 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32477)[sext_i32_i64(read_i_32593)];\n                            aggr_32596 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32481)[sext_i32_i64(read_i_32593)];\n                            aggr_32597 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32485)[sext_i32_i64(read_i_32593)];\n                        } else {\n                            if (flag_32598 == (int8_t) 1) {\n                                aggr_32594 = ((volatile __global\n                                               int64_t *) aggregates_mem_32471)[sext_i32_i64(read_i_32593)];\n                                aggr_32595 = ((volatile __global\n                                               int64_t *) aggregates_mem_32475)[sext_i32_i64(read_i_32593)];\n                                aggr_32596 = ((volatile __global\n                                               int64_t *) aggregates_mem_32479)[sext_i32_i64(read_i_32593)];\n                                aggr_32597 = ((volatile __global\n                                               int64_t *) ag",
            "gregates_mem_32483)[sext_i32_i64(read_i_32593)];\n                                used_32599 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(warp_byte_offset_32506,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        aggr_32594;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(warp_byte_offset_32507,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        aggr_32595;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(warp_byte_offset_32508,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        aggr_32596;\n                    ((__local\n                      int64_t *) local_mem_32511)[squot64(warp_byte_offset_32509,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32497)] =\n                        aggr_32597;\n                    \n                    int8_t tmp_32600;\n                    \n                    tmp_32600 = flag_32598 | used_32599 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32511)[sext_i32_i64(local_tid_32497)] =\n                        tmp_32600;\n                    mem_fence_local();\n                    flag_32598 = ((volatile __local\n                                   int8_t *) local_mem_32511)[sext_i32_i64(wave_sizze_32499) -\n                                                              (int64_t) 1];\n                    if (local_tid_32497 ",
            "== 0) {\n                        if (!(flag_32598 == (int8_t) 2)) {\n                            int64_t x_32601 = (int64_t) 0;\n                            int64_t x_32602 = (int64_t) 0;\n                            int64_t x_32603 = (int64_t) 0;\n                            int64_t x_32604 = (int64_t) 0;\n                            int64_t x_32605;\n                            int64_t x_32606;\n                            int64_t x_32607;\n                            int64_t x_32608;\n                            int8_t flag1_32613;\n                            \n                            flag1_32613 = (int8_t) 0;\n                            \n                            int8_t flag2_32614;\n                            int8_t used1_32615;\n                            \n                            used1_32615 = (int8_t) 0;\n                            \n                            int8_t used2_32616;\n                            \n                            for (int32_t i_32617 = 0; i_32617 <\n                                 wave_sizze_32499; i_32617++) {\n                                flag2_32614 = ((__local\n                                                int8_t *) local_mem_32511)[sext_i32_i64(i_32617)];\n                                used2_32616 = lshr8(flag2_32614, (int8_t) 2);\n                                flag2_32614 = flag2_32614 & (int8_t) 3;\n                                x_32605 = ((__local\n                                            int64_t *) local_mem_32511)[squot64(warp_byte_offset_32506,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32617)];\n                                x_32606 = ((__local\n                                            int64_t *) local_mem_32511)[squot64(warp_byte_offset_32507,\n                                                                                (int64_t) 8) +\n                                         ",
            "                               sext_i32_i64(i_32617)];\n                                x_32607 = ((__local\n                                            int64_t *) local_mem_32511)[squot64(warp_byte_offset_32508,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32617)];\n                                x_32608 = ((__local\n                                            int64_t *) local_mem_32511)[squot64(warp_byte_offset_32509,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32617)];\n                                if (!(flag2_32614 == (int8_t) 1)) {\n                                    flag1_32613 = flag2_32614;\n                                    used1_32615 = used2_32616;\n                                    x_32601 = x_32605;\n                                    x_32602 = x_32606;\n                                    x_32603 = x_32607;\n                                    x_32604 = x_32608;\n                                } else {\n                                    used1_32615 += used2_32616;\n                                    \n                                    int64_t defunc_1_op_res_32609;\n                                    \n                                    defunc_1_op_res_32609 = add64(x_32601,\n                                                                  x_32605);\n                                    \n                                    int64_t defunc_1_op_res_32610 =\n                                            add64(x_32602, x_32606);\n                                    int64_t defunc_1_op_res_32611 =\n                                            add64(x_32603, x_32607);\n                                    int64_t defunc_1_op_res_32612 =\n                                            add64(x_32604, x_",
            "32608);\n                                    \n                                    x_32601 = defunc_1_op_res_32609;\n                                    x_32602 = defunc_1_op_res_32610;\n                                    x_32603 = defunc_1_op_res_32611;\n                                    x_32604 = defunc_1_op_res_32612;\n                                }\n                            }\n                            flag_32598 = flag1_32613;\n                            used_32599 = used1_32615;\n                            aggr_32594 = x_32601;\n                            aggr_32595 = x_32602;\n                            aggr_32596 = x_32603;\n                            aggr_32597 = x_32604;\n                        } else {\n                            aggr_32594 = ((__local\n                                           int64_t *) local_mem_32511)[squot64(warp_byte_offset_32506,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32499) -\n                                                                        (int64_t) 1)];\n                            aggr_32595 = ((__local\n                                           int64_t *) local_mem_32511)[squot64(warp_byte_offset_32507,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32499) -\n                                                                        (int64_t) 1)];\n                            aggr_32596 = ((__local\n                                           int64_t *) local_mem_32511)[squot64(warp_byte_offset_32508,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32499) -\n                                         ",
            "                               (int64_t) 1)];\n                            aggr_32597 = ((__local\n                                           int64_t *) local_mem_32511)[squot64(warp_byte_offset_32509,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32499) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32598 == (int8_t) 2) {\n                            readOffset_32592 = wave_sizze_32499 * -1;\n                        } else {\n                            readOffset_32592 -= zext_i8_i32(used_32599);\n                        }\n                        ((__local int32_t *) local_mem_32511)[(int64_t) 0] =\n                            readOffset_32592;\n                        \n                        int64_t x_32618;\n                        \n                        x_32618 = aggr_32594;\n                        \n                        int64_t x_32619;\n                        \n                        x_32619 = aggr_32595;\n                        \n                        int64_t x_32620;\n                        \n                        x_32620 = aggr_32596;\n                        \n                        int64_t x_32621;\n                        \n                        x_32621 = aggr_32597;\n                        \n                        int64_t x_32622;\n                        \n                        x_32622 = prefix_32587;\n                        \n                        int64_t x_32623;\n                        \n                        x_32623 = prefix_32588;\n                        \n                        int64_t x_32624;\n                        \n                        x_32624 = prefix_32589;\n                        \n                        int64_t x_32625;\n                        \n                        x_32625 = prefix_32590;\n   ",
            "                     \n                        int64_t defunc_1_op_res_32626;\n                        \n                        defunc_1_op_res_32626 = add64(x_32618, x_32622);\n                        \n                        int64_t defunc_1_op_res_32627 = add64(x_32619, x_32623);\n                        int64_t defunc_1_op_res_32628 = add64(x_32620, x_32624);\n                        int64_t defunc_1_op_res_32629 = add64(x_32621, x_32625);\n                        \n                        prefix_32587 = defunc_1_op_res_32626;\n                        prefix_32588 = defunc_1_op_res_32627;\n                        prefix_32589 = defunc_1_op_res_32628;\n                        prefix_32590 = defunc_1_op_res_32629;\n                    }\n                    mem_fence_local();\n                    readOffset_32592 = ((__local\n                                         int32_t *) local_mem_32511)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32497 == 0) {\n                int64_t x_32630 = prefix_32587;\n                int64_t x_32631 = prefix_32588;\n                int64_t x_32632 = prefix_32589;\n                int64_t x_32633 = prefix_32590;\n                int64_t x_32634 = acc_32568;\n                int64_t x_32635 = acc_32569;\n                int64_t x_32636 = acc_32570;\n                int64_t x_32637 = acc_32571;\n                int64_t defunc_1_op_res_32638 = add64(x_32630, x_32634);\n                int64_t defunc_1_op_res_32639 = add64(x_32631, x_32635);\n                int64_t defunc_1_op_res_32640 = add64(x_32632, x_32636);\n                int64_t defunc_1_op_res_32641 = add64(x_32633, x_32637);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32473)[dynamic_id_32528] =\n                    defunc_1_op_res_32638;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32477)[dynamic_id_32528] =\n                    defunc_1_op_res_32639;\n                ((volatile __global\n",
            "                  int64_t *) incprefixes_mem_32481)[dynamic_id_32528] =\n                    defunc_1_op_res_32640;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32485)[dynamic_id_32528] =\n                    defunc_1_op_res_32641;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32469)[dynamic_id_32528] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(warp_byte_offset_32506,\n                                                      (int64_t) 8)] =\n                    prefix_32587;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(warp_byte_offset_32507,\n                                                      (int64_t) 8)] =\n                    prefix_32588;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(warp_byte_offset_32508,\n                                                      (int64_t) 8)] =\n                    prefix_32589;\n                ((__local\n                  int64_t *) local_mem_32511)[squot64(warp_byte_offset_32509,\n                                                      (int64_t) 8)] =\n                    prefix_32590;\n                acc_32568 = (int64_t) 0;\n                acc_32569 = (int64_t) 0;\n                acc_32570 = (int64_t) 0;\n                acc_32571 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32528 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32587 = ((__local\n                             int64_t *) local_mem_32511)[squot64(warp_byte_offset_32506,\n                                                                 (int64_t) 8)];\n            prefix_32588 = ((__local\n                             int64_t *) local_mem_32511)[squot64(warp_byte_offset_32507,\n                                                                 (int64_t) 8)];\n            prefix_32589 = ((__loc",
            "al\n                             int64_t *) local_mem_32511)[squot64(warp_byte_offset_32508,\n                                                                 (int64_t) 8)];\n            prefix_32590 = ((__local\n                             int64_t *) local_mem_32511)[squot64(warp_byte_offset_32509,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32642;\n        int64_t x_32646;\n        int64_t x_32654;\n        \n        x_32654 = prefix_32587;\n        \n        int64_t x_32658;\n        \n        x_32658 = acc_32568;\n        \n        int64_t x_32643;\n        int64_t x_32647;\n        int64_t x_32655;\n        \n        x_32655 = prefix_32588;\n        \n        int64_t x_32659;\n        \n        x_32659 = acc_32569;\n        \n        int64_t x_32644;\n        int64_t x_32648;\n        int64_t x_32656;\n        \n        x_32656 = prefix_32589;\n        \n        int64_t x_32660;\n        \n        x_32660 = acc_32570;\n        \n        int64_t x_32645;\n        int64_t x_32649;\n        int64_t x_32657;\n        \n        x_32657 = prefix_32590;\n        \n        int64_t x_32661;\n        \n        x_32661 = acc_32571;\n        \n        int64_t defunc_1_op_res_32662;\n        \n        defunc_1_op_res_32662 = add64(x_32654, x_32658);\n        \n        int64_t defunc_1_op_res_32663 = add64(x_32655, x_32659);\n        int64_t defunc_1_op_res_32664 = add64(x_32656, x_32660);\n        int64_t defunc_1_op_res_32665 = add64(x_32657, x_32661);\n        \n        x_32642 = defunc_1_op_res_32662;\n        x_32643 = defunc_1_op_res_32663;\n        x_32644 = defunc_1_op_res_32664;\n        x_32645 = defunc_1_op_res_32665;\n        for (int64_t i_32666 = 0; i_32666 < (int64_t) 9; i_32666++) {\n            x_32646 = private_mem_32530[i_32666];\n            x_32647 = private_mem_32532[i_32666];\n            x_32648 = private_mem_32534[i_32666];\n            x_32649 = private_mem_32536[i_",
            "32666];\n            \n            int64_t defunc_1_op_res_32650;\n            \n            defunc_1_op_res_32650 = add64(x_32642, x_32646);\n            \n            int64_t defunc_1_op_res_32651 = add64(x_32643, x_32647);\n            int64_t defunc_1_op_res_32652 = add64(x_32644, x_32648);\n            int64_t defunc_1_op_res_32653 = add64(x_32645, x_32649);\n            \n            private_mem_32530[i_32666] = defunc_1_op_res_32650;\n            private_mem_32532[i_32666] = defunc_1_op_res_32651;\n            private_mem_32534[i_32666] = defunc_1_op_res_32652;\n            private_mem_32536[i_32666] = defunc_1_op_res_32653;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32667 = 0; i_32667 < (int64_t) 9; i_32667++) {\n            int64_t sharedIdx_32668 = sext_i32_i64(local_tid_32497 * 9) +\n                    i_32667;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32668] =\n                private_mem_32530[i_32667];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32669 = 0; i_32669 < (int64_t) 9; i_32669++) {\n            int32_t sharedIdx_32670 = local_tid_32497 +\n                    sext_i64_i32(segscan_group_sizze_30488 * i_32669);\n            \n            private_mem_32530[i_32669] = ((__local\n                                           int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32670)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32671 = 0; i_32671 < (int64_t) 9; i_32671++) {\n            int64_t sharedIdx_32672 = sext_i32_i64(local_tid_32497 * 9) +\n                    i_32671;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32672] =\n                private_mem_32532[i_32671];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32673 = 0; i_32673 < (int64_t) 9; i_32673++) {\n            int32_t sharedIdx_32674 = local_tid_32497 +\n                    sext_i64_i32(segscan_group_sizze",
            "_30488 * i_32673);\n            \n            private_mem_32532[i_32673] = ((__local\n                                           int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32674)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32675 = 0; i_32675 < (int64_t) 9; i_32675++) {\n            int64_t sharedIdx_32676 = sext_i32_i64(local_tid_32497 * 9) +\n                    i_32675;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32676] =\n                private_mem_32534[i_32675];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32677 = 0; i_32677 < (int64_t) 9; i_32677++) {\n            int32_t sharedIdx_32678 = local_tid_32497 +\n                    sext_i64_i32(segscan_group_sizze_30488 * i_32677);\n            \n            private_mem_32534[i_32677] = ((__local\n                                           int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32678)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32679 = 0; i_32679 < (int64_t) 9; i_32679++) {\n            int64_t sharedIdx_32680 = sext_i32_i64(local_tid_32497 * 9) +\n                    i_32679;\n            \n            ((__local int64_t *) local_mem_32511)[sharedIdx_32680] =\n                private_mem_32536[i_32679];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32681 = 0; i_32681 < (int64_t) 9; i_32681++) {\n            int32_t sharedIdx_32682 = local_tid_32497 +\n                    sext_i64_i32(segscan_group_sizze_30488 * i_32681);\n            \n            private_mem_32536[i_32681] = ((__local\n                                           int64_t *) local_mem_32511)[sext_i32_i64(sharedIdx_32682)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32683 = 0; i_32683 < (int64_t) 9; i_32683++) {\n            int64_t gtid_30492 = blockOff_32529 + segscan_group_sizze_30488 *\n                    i_32683 + sext_i32_",
            "i64(local_tid_32497);\n            \n            if (slt64(gtid_30492, conc_tmp_28900)) {\n                ((__global int64_t *) mem_31971)[gtid_30492] =\n                    private_mem_32530[i_32683];\n            }\n        }\n        for (int64_t i_32684 = 0; i_32684 < (int64_t) 9; i_32684++) {\n            int64_t gtid_30492 = blockOff_32529 + segscan_group_sizze_30488 *\n                    i_32684 + sext_i32_i64(local_tid_32497);\n            \n            if (slt64(gtid_30492, conc_tmp_28900)) {\n                ((__global int64_t *) mem_31973)[gtid_30492] =\n                    private_mem_32532[i_32684];\n            }\n        }\n        for (int64_t i_32685 = 0; i_32685 < (int64_t) 9; i_32685++) {\n            int64_t gtid_30492 = blockOff_32529 + segscan_group_sizze_30488 *\n                    i_32685 + sext_i32_i64(local_tid_32497);\n            \n            if (slt64(gtid_30492, conc_tmp_28900)) {\n                ((__global int64_t *) mem_31975)[gtid_30492] =\n                    private_mem_32534[i_32685];\n            }\n        }\n        for (int64_t i_32686 = 0; i_32686 < (int64_t) 9; i_32686++) {\n            int64_t gtid_30492 = blockOff_32529 + segscan_group_sizze_30488 *\n                    i_32686 + sext_i32_i64(local_tid_32497);\n            \n            if (slt64(gtid_30492, conc_tmp_28900)) {\n                ((__global int64_t *) mem_31977)[gtid_30492] =\n                    private_mem_32536[i_32686];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32528 == sdiv_up64(conc_tmp_28900,\n                                          segscan_group_sizze_30488 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_32467)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30488\n}\n__kernel void test_clusterWithzisegscan_30575(__global int *global_failure,\n",
            "                                              uint local_mem_32728_backing_offset_0,\n                                              int64_t conc_tmp_28900, __global\n                                              unsigned char *mem_32008, __global\n                                              unsigned char *mem_32011, __global\n                                              unsigned char *mem_32013, __global\n                                              unsigned char *test_clusterWithziid_counter_mem_32705,\n                                              __global\n                                              unsigned char *status_flags_mem_32707,\n                                              __global\n                                              unsigned char *aggregates_mem_32709,\n                                              __global\n                                              unsigned char *incprefixes_mem_32711,\n                                              __global\n                                              unsigned char *aggregates_mem_32713,\n                                              __global\n                                              unsigned char *incprefixes_mem_32715)\n{\n    #define segscan_group_sizze_30570 (test_clusterWithzisegscan_group_sizze_30569)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32728_backing_0 =\n                  &shared_mem[local_mem_32728_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32717;\n    int32_t local_tid_32718;\n    int64_t group_sizze_32721;\n    int32_t wave_sizze_32720;\n    int32_t group_tid_32719;\n    \n    global_tid_32717 = get_global_id(0);\n    local_tid_32718 = get_local_id(0);\n    group_sizze_32721 = get_local_size(0);\n    wave_sizze_32720 = LOCKSTEP_WIDTH;\n    group_tid_32719 = get_group_id(0);\n    \n    int32_t phys_tid_30575;\n    \n    phys_tid_30575 = global_tid_32717;\n    \n    int64_t ",
            "byte_offsets_32722;\n    \n    byte_offsets_32722 = (int64_t) 0;\n    \n    int64_t byte_offsets_32723;\n    \n    byte_offsets_32723 = segscan_group_sizze_30570;\n    \n    int64_t byte_offsets_32724;\n    \n    byte_offsets_32724 = sdiv_up64(segscan_group_sizze_30570, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30570 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32725;\n    \n    warp_byte_offset_32725 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32726;\n    \n    warp_byte_offset_32726 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_32727;\n    \n    warp_byte_offset_32727 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32728;\n    \n    local_mem_32728 = (__local char *) local_mem_32728_backing_0;\n    \n    int64_t trans_arr_len_32729;\n    \n    trans_arr_len_32729 = (int64_t) 9 * segscan_group_sizze_30570;\n    \n    int32_t dynamic_id_32739;\n    \n    if (local_tid_32718 == 0) {\n        dynamic_id_32739 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_32705)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32728)[(int64_t) 0] = dynamic_id_32739;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32739 = ((__local int32_t *) local_mem_32728)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32740;\n    \n    blockOff_32740 = sext_i32_i64(dynamic_id_32739) * (int64_t) 9 *\n        segscan_group_sizze_30570;\n    \n    bool private_mem_32741[9];\n    int64_t private_mem_32743[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32745 = 0; i_32745 < (int64_t) 9; i_32745++) {\n            int64_t gtid_30574 = blockOff_32740 +\n                    sext_i32_i64(local_tid_32718) + i_32745 *\n                    segscan_group_sizze_30570;\n            \n            if (slt64(gtid_30574, conc_tmp_28900)) {\n                bool x_29041 = ((__global bool ",
            "*) mem_32008)[gtid_30574];\n                \n                private_mem_32741[i_32745] = x_29041;\n                private_mem_32743[i_32745] = (int64_t) 1;\n            } else {\n                private_mem_32741[i_32745] = 0;\n                private_mem_32743[i_32745] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32746 = 0; i_32746 < (int64_t) 9; i_32746++) {\n            int64_t sharedIdx_32747 = sext_i32_i64(local_tid_32718) + i_32746 *\n                    segscan_group_sizze_30570;\n            \n            ((__local bool *) local_mem_32728)[sharedIdx_32747] =\n                private_mem_32741[i_32746];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32748 = 0; i_32748 < 9; i_32748++) {\n            int32_t sharedIdx_32749 = local_tid_32718 * 9 + i_32748;\n            \n            private_mem_32741[sext_i32_i64(i_32748)] = ((__local\n                                                         bool *) local_mem_32728)[sext_i32_i64(sharedIdx_32749)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32750 = 0; i_32750 < (int64_t) 9; i_32750++) {\n            int64_t sharedIdx_32751 = sext_i32_i64(local_tid_32718) + i_32750 *\n                    segscan_group_sizze_30570;\n            \n            ((__local int64_t *) local_mem_32728)[sharedIdx_32751] =\n                private_mem_32743[i_32750];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32752 = 0; i_32752 < 9; i_32752++) {\n            int32_t sharedIdx_32753 = local_tid_32718 * 9 + i_32752;\n            \n            private_mem_32743[sext_i32_i64(i_32752)] = ((__local\n                                                         int64_t *) local_mem_32728)[sext_i32_i64(sharedIdx_32753)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32754 = 0; i_32754 < (int64_t) 8; i_32754++) {\n            bool x_29034;\n   ",
            "         bool x_29036;\n            \n            x_29034 = private_mem_32741[i_32754];\n            x_29036 = private_mem_32741[i_32754 + (int64_t) 1];\n            \n            int64_t x_29035;\n            int64_t x_29037;\n            \n            x_29035 = private_mem_32743[i_32754];\n            x_29037 = private_mem_32743[i_32754 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29038;\n            \n            defunc_1_op_res_29038 = x_29034 || x_29036;\n            \n            int64_t defunc_1_op_res_29039;\n            \n            if (x_29036) {\n                defunc_1_op_res_29039 = x_29037;\n            } else {\n                int64_t defunc_1_op_res_29040 = add64(x_29035, x_29037);\n                \n                defunc_1_op_res_29039 = defunc_1_op_res_29040;\n            }\n            private_mem_32741[i_32754 + (int64_t) 1] = defunc_1_op_res_29038;\n            private_mem_32743[i_32754 + (int64_t) 1] = defunc_1_op_res_29039;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_32728)[byte_offsets_32722 +\n                                           sext_i32_i64(local_tid_32718)] =\n            private_mem_32741[(int64_t) 8];\n        ((__local int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32718)] =\n            private_mem_32743[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_32762;\n    int64_t acc_32763;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_32755;\n        int64_t x_32756;\n        bool x_32757;\n        int64_t x_32758;\n        bool x_32764;\n        int64_t x_32765;\n        bool x_32766;\n        int64_t x_32767;\n        bool ltid_in_bounds_32771;\n        \n        ltid_in_bounds_32771 = slt64(sext_i32_i64(local_tid_32718),\n                                     segscan_group_sizze_30570);\n        \n        int32_t",
            " skip_threads_32772;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32771) {\n                x_32757 = ((volatile __local\n                            bool *) local_mem_32728)[byte_offsets_32722 +\n                                                     sext_i32_i64(local_tid_32718)];\n                x_32758 = ((volatile __local\n                            int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32718)];\n                if ((local_tid_32718 - squot32(local_tid_32718, 32) * 32) ==\n                    0) {\n                    x_32755 = x_32757;\n                    x_32756 = x_32758;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32772 = 1;\n            while (slt32(skip_threads_32772, 32)) {\n                if (sle32(skip_threads_32772, local_tid_32718 -\n                          squot32(local_tid_32718, 32) * 32) &&\n                    ltid_in_bounds_32771) {\n                    // read operands\n                    {\n                        x_32755 = ((volatile __local\n                                    bool *) local_mem_32728)[byte_offsets_32722 +\n                                                             (sext_i32_i64(local_tid_32718) -\n                                                              sext_i32_i64(skip_threads_32772))];\n                        x_32756 = ((volatile __local\n                                    int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32718) -\n                                                                 sext_i32_i64(skip_threads_32772))];\n                ",
            "    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_32759 = x_32755 || x_32757;\n                        int64_t defunc_1_op_res_32760;\n                        \n                        if (x_32757) {\n                            defunc_1_op_res_32760 = x_32758;\n                        } else {\n                            int64_t defunc_1_op_res_32761 = add64(x_32756,\n                                                                  x_32758);\n                            \n                            defunc_1_op_res_32760 = defunc_1_op_res_32761;\n                        }\n                        x_32755 = defunc_1_op_res_32759;\n                        x_32756 = defunc_1_op_res_32760;\n                    }\n                }\n                if (sle32(wave_sizze_32720, skip_threads_32772)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32772, local_tid_32718 -\n                          squot32(local_tid_32718, 32) * 32) &&\n                    ltid_in_bounds_32771) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_32728)[byte_offsets_32722 +\n                                                   sext_i32_i64(local_tid_32718)] =\n                            x_32755;\n                        x_32757 = x_32755;\n                        ((volatile __local\n                          int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32718)] =\n                            x_32756;\n                        x_32758 = x_32756;\n                    }\n                }\n                if (sle32(wave_sizze_32720, skip_threads_32772)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_t",
            "hreads_32772 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32718 - squot32(local_tid_32718, 32) * 32) == 31 &&\n                ltid_in_bounds_32771) {\n                ((volatile __local bool *) local_mem_32728)[byte_offsets_32722 +\n                                                            sext_i32_i64(squot32(local_tid_32718,\n                                                                                 32))] =\n                    x_32755;\n                ((volatile __local\n                  int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32718,\n                                                                   32))] =\n                    x_32756;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32773;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32718, 32) == 0 && ltid_in_bounds_32771) {\n                    x_32766 = ((volatile __local\n                                bool *) local_mem_32728)[byte_offsets_32722 +\n                                                         sext_i32_i64(local_tid_32718)];\n                    x_32767 = ((volatile __local\n                                int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32718)];\n                    if ((local_tid_32718 - squot32(local_tid_32718, 32) * 32) ==\n                        0) {\n                        x_32764 = x_32766;\n                        ",
            "x_32765 = x_32767;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32773 = 1;\n                while (slt32(skip_threads_32773, 32)) {\n                    if (sle32(skip_threads_32773, local_tid_32718 -\n                              squot32(local_tid_32718, 32) * 32) &&\n                        (squot32(local_tid_32718, 32) == 0 &&\n                         ltid_in_bounds_32771)) {\n                        // read operands\n                        {\n                            x_32764 = ((volatile __local\n                                        bool *) local_mem_32728)[byte_offsets_32722 +\n                                                                 (sext_i32_i64(local_tid_32718) -\n                                                                  sext_i32_i64(skip_threads_32773))];\n                            x_32765 = ((volatile __local\n                                        int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32718) -\n                                                                     sext_i32_i64(skip_threads_32773))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_32768 = x_32764 || x_32766;\n                            int64_t defunc_1_op_res_32769;\n                            \n                            if (x_32766) {\n                                defunc_1_op_res_32769 = x_32767;\n                            } else {\n                                int64_t defunc_1_op_res_32770 = add64(x_32765,\n                                                                      x_32767);\n                                \n                                defunc_1_op_res_32",
            "769 = defunc_1_op_res_32770;\n                            }\n                            x_32764 = defunc_1_op_res_32768;\n                            x_32765 = defunc_1_op_res_32769;\n                        }\n                    }\n                    if (sle32(wave_sizze_32720, skip_threads_32773)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32773, local_tid_32718 -\n                              squot32(local_tid_32718, 32) * 32) &&\n                        (squot32(local_tid_32718, 32) == 0 &&\n                         ltid_in_bounds_32771)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_32728)[byte_offsets_32722 +\n                                                       sext_i32_i64(local_tid_32718)] =\n                                x_32764;\n                            x_32766 = x_32764;\n                            ((volatile __local\n                              int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32718)] =\n                                x_32765;\n                            x_32767 = x_32765;\n                        }\n                    }\n                    if (sle32(wave_sizze_32720, skip_threads_32773)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32773 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32718, 32) == 0 || !ltid_in_bounds_32771)) {\n                // read operands\n                {\n                    x_32757 = x_32755;\n                    x_32758 = x_32756;\n                    x_327",
            "55 = ((__local\n                                bool *) local_mem_32728)[byte_offsets_32722 +\n                                                         (sext_i32_i64(squot32(local_tid_32718,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_32756 = ((__local\n                                int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32718,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_32759 = x_32755 || x_32757;\n                    int64_t defunc_1_op_res_32760;\n                    \n                    if (x_32757) {\n                        defunc_1_op_res_32760 = x_32758;\n                    } else {\n                        int64_t defunc_1_op_res_32761 = add64(x_32756, x_32758);\n                        \n                        defunc_1_op_res_32760 = defunc_1_op_res_32761;\n                    }\n                    x_32755 = defunc_1_op_res_32759;\n                    x_32756 = defunc_1_op_res_32760;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_32728)[byte_offsets_32722 +\n                                                       sext_i32_i64(local_tid_32718)] =\n                        x_32755;\n                    ((__local\n                      int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32718)] =\n  ",
            "                      x_32756;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32718, 32) == 0) {\n                ((__local bool *) local_mem_32728)[byte_offsets_32722 +\n                                                   sext_i32_i64(local_tid_32718)] =\n                    x_32757;\n                ((__local\n                  int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32718)] =\n                    x_32758;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32718 == 0) {\n            acc_32762 = ((__local bool *) local_mem_32728)[byte_offsets_32722 +\n                                                           (segscan_group_sizze_30570 -\n                                                            (int64_t) 1)];\n            acc_32763 = ((__local\n                          int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30570 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32762 = ((__local bool *) local_mem_32728)[byte_offsets_32722 +\n                                                           (sext_i32_i64(local_tid_32718) -\n                                                            (int64_t) 1)];\n            acc_32763 = ((__local\n                          int64_t *) local_mem_32728)[squot64(byte_offsets_32723,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32718) -\n                                             ",
            "          (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_32774;\n    \n    prefix_32774 = 0;\n    \n    int64_t prefix_32775;\n    \n    prefix_32775 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32739 == (int64_t) 0 && local_tid_32718 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_32711)[dynamic_id_32739] = acc_32762;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32715)[dynamic_id_32739] = acc_32763;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32707)[dynamic_id_32739] = (int8_t) 2;\n            acc_32762 = 0;\n            acc_32763 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32739 == (int64_t) 0) && slt32(local_tid_32718,\n                                                        wave_sizze_32720)) {\n            if (local_tid_32718 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_32709)[dynamic_id_32739] = acc_32762;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32713)[dynamic_id_32739] =\n                    acc_32763;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32707)[dynamic_id_32739] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32728)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32707)[dynamic_id_32739 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32776;\n            \n            status_32776 = ((__local int8_t *) local_mem_32728)[(int64_t) 0];\n            if (status_32776 == (int8_t) 2) {\n                if (local_tid_32718 == 0) {\n                    prefix_32774 = ((volatile __g",
            "lobal\n                                     bool *) incprefixes_mem_32711)[dynamic_id_32739 -\n                                                                    (int64_t) 1];\n                    prefix_32775 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32715)[dynamic_id_32739 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32777 = dynamic_id_32739 -\n                        sext_i32_i64(wave_sizze_32720);\n                \n                while (slt32(wave_sizze_32720 * -1, readOffset_32777)) {\n                    int32_t read_i_32778 = readOffset_32777 + local_tid_32718;\n                    bool aggr_32779 = 0;\n                    int64_t aggr_32780 = (int64_t) 0;\n                    int8_t flag_32781 = (int8_t) 0;\n                    int8_t used_32782 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32778)) {\n                        flag_32781 = ((volatile __global\n                                       int8_t *) status_flags_mem_32707)[sext_i32_i64(read_i_32778)];\n                        if (flag_32781 == (int8_t) 2) {\n                            aggr_32779 = ((volatile __global\n                                           bool *) incprefixes_mem_32711)[sext_i32_i64(read_i_32778)];\n                            aggr_32780 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32715)[sext_i32_i64(read_i_32778)];\n                        } else {\n                            if (flag_32781 == (int8_t) 1) {\n                                aggr_32779 = ((volatile __global\n                                               bool *) aggregates_mem_32709)[sext_i32_i64(read_i_32778)];\n                                aggr_32780 = ((volatile __global\n                                               int64_t *) aggregates_mem_32713)[sext_i32_i64(read_i_32778)];\n               ",
            "                 used_32782 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_32728)[warp_byte_offset_32725 +\n                                                       sext_i32_i64(local_tid_32718)] =\n                        aggr_32779;\n                    ((__local\n                      int64_t *) local_mem_32728)[squot64(warp_byte_offset_32726,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32718)] =\n                        aggr_32780;\n                    \n                    int8_t tmp_32783;\n                    \n                    tmp_32783 = flag_32781 | used_32782 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32728)[sext_i32_i64(local_tid_32718)] =\n                        tmp_32783;\n                    mem_fence_local();\n                    flag_32781 = ((volatile __local\n                                   int8_t *) local_mem_32728)[sext_i32_i64(wave_sizze_32720) -\n                                                              (int64_t) 1];\n                    if (local_tid_32718 == 0) {\n                        if (!(flag_32781 == (int8_t) 2)) {\n                            bool x_32784 = 0;\n                            int64_t x_32785 = (int64_t) 0;\n                            bool x_32786;\n                            int64_t x_32787;\n                            int8_t flag1_32791;\n                            \n                            flag1_32791 = (int8_t) 0;\n                            \n                            int8_t flag2_32792;\n                            int8_t used1_32793;\n                            \n                            used1_32793 = (int8_t) 0;\n                            \n                            int8_t used2_32794;\n                            \n                            for (int32_t i_32795 = 0; i_32795 <\n    ",
            "                             wave_sizze_32720; i_32795++) {\n                                flag2_32792 = ((__local\n                                                int8_t *) local_mem_32728)[sext_i32_i64(i_32795)];\n                                used2_32794 = lshr8(flag2_32792, (int8_t) 2);\n                                flag2_32792 = flag2_32792 & (int8_t) 3;\n                                x_32786 = ((__local\n                                            bool *) local_mem_32728)[warp_byte_offset_32725 +\n                                                                     sext_i32_i64(i_32795)];\n                                x_32787 = ((__local\n                                            int64_t *) local_mem_32728)[squot64(warp_byte_offset_32726,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32795)];\n                                if (!(flag2_32792 == (int8_t) 1)) {\n                                    flag1_32791 = flag2_32792;\n                                    used1_32793 = used2_32794;\n                                    x_32784 = x_32786;\n                                    x_32785 = x_32787;\n                                } else {\n                                    used1_32793 += used2_32794;\n                                    \n                                    bool defunc_1_op_res_32788;\n                                    \n                                    defunc_1_op_res_32788 = x_32784 || x_32786;\n                                    \n                                    int64_t defunc_1_op_res_32789;\n                                    \n                                    if (x_32786) {\n                                        defunc_1_op_res_32789 = x_32787;\n                                    } else {\n                                        int64_t defunc_1_op_res_32790 =\n                                        ",
            "        add64(x_32785, x_32787);\n                                        \n                                        defunc_1_op_res_32789 =\n                                            defunc_1_op_res_32790;\n                                    }\n                                    x_32784 = defunc_1_op_res_32788;\n                                    x_32785 = defunc_1_op_res_32789;\n                                }\n                            }\n                            flag_32781 = flag1_32791;\n                            used_32782 = used1_32793;\n                            aggr_32779 = x_32784;\n                            aggr_32780 = x_32785;\n                        } else {\n                            aggr_32779 = ((__local\n                                           bool *) local_mem_32728)[warp_byte_offset_32725 +\n                                                                    (sext_i32_i64(wave_sizze_32720) -\n                                                                     (int64_t) 1)];\n                            aggr_32780 = ((__local\n                                           int64_t *) local_mem_32728)[squot64(warp_byte_offset_32726,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32720) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32781 == (int8_t) 2) {\n                            readOffset_32777 = wave_sizze_32720 * -1;\n                        } else {\n                            readOffset_32777 -= zext_i8_i32(used_32782);\n                        }\n                        ((__local int32_t *) local_mem_32728)[(int64_t) 0] =\n                            readOffset_32777;\n                        \n                        bool x_32796;\n                        \n                        x_32796 = aggr_32779;\n   ",
            "                     \n                        int64_t x_32797;\n                        \n                        x_32797 = aggr_32780;\n                        \n                        bool x_32798;\n                        \n                        x_32798 = prefix_32774;\n                        \n                        int64_t x_32799;\n                        \n                        x_32799 = prefix_32775;\n                        \n                        bool defunc_1_op_res_32800;\n                        \n                        defunc_1_op_res_32800 = x_32796 || x_32798;\n                        \n                        int64_t defunc_1_op_res_32801;\n                        \n                        if (x_32798) {\n                            defunc_1_op_res_32801 = x_32799;\n                        } else {\n                            int64_t defunc_1_op_res_32802 = add64(x_32797,\n                                                                  x_32799);\n                            \n                            defunc_1_op_res_32801 = defunc_1_op_res_32802;\n                        }\n                        prefix_32774 = defunc_1_op_res_32800;\n                        prefix_32775 = defunc_1_op_res_32801;\n                    }\n                    mem_fence_local();\n                    readOffset_32777 = ((__local\n                                         int32_t *) local_mem_32728)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32718 == 0) {\n                bool x_32803 = prefix_32774;\n                int64_t x_32804 = prefix_32775;\n                bool x_32805 = acc_32762;\n                int64_t x_32806 = acc_32763;\n                bool defunc_1_op_res_32807 = x_32803 || x_32805;\n                int64_t defunc_1_op_res_32808;\n                \n                if (x_32805) {\n                    defunc_1_op_res_32808 = x_32806;\n                } else {\n                    int64_t defunc_1_op_res_32809 = add64(x_32804, x_32806);\n                  ",
            "  \n                    defunc_1_op_res_32808 = defunc_1_op_res_32809;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_32711)[dynamic_id_32739] =\n                    defunc_1_op_res_32807;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32715)[dynamic_id_32739] =\n                    defunc_1_op_res_32808;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32707)[dynamic_id_32739] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_32728)[warp_byte_offset_32725] =\n                    prefix_32774;\n                ((__local\n                  int64_t *) local_mem_32728)[squot64(warp_byte_offset_32726,\n                                                      (int64_t) 8)] =\n                    prefix_32775;\n                acc_32762 = 0;\n                acc_32763 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32739 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32774 = ((__local\n                             bool *) local_mem_32728)[warp_byte_offset_32725];\n            prefix_32775 = ((__local\n                             int64_t *) local_mem_32728)[squot64(warp_byte_offset_32726,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_32810;\n        bool x_32812;\n        bool x_32817;\n        \n        x_32817 = prefix_32774;\n        \n        bool x_32819;\n        \n        x_32819 = acc_32762;\n        \n        int64_t x_32811;\n        int64_t x_32813;\n        int64_t x_32818;\n        \n        x_32818 = prefix_32775;\n        \n        int64_t x_32820;\n        \n        x_32820 = acc_32763;\n        \n        bool defunc_1_op_res_32821;\n        \n        defunc_1_op_res_32821 = x_32817 || x_32819;\n        \n        int64_t defunc_1_op_re",
            "s_32822;\n        \n        if (x_32819) {\n            defunc_1_op_res_32822 = x_32820;\n        } else {\n            int64_t defunc_1_op_res_32823 = add64(x_32818, x_32820);\n            \n            defunc_1_op_res_32822 = defunc_1_op_res_32823;\n        }\n        x_32810 = defunc_1_op_res_32821;\n        x_32811 = defunc_1_op_res_32822;\n        for (int64_t i_32824 = 0; i_32824 < (int64_t) 9; i_32824++) {\n            x_32812 = private_mem_32741[i_32824];\n            x_32813 = private_mem_32743[i_32824];\n            \n            bool defunc_1_op_res_32814;\n            \n            defunc_1_op_res_32814 = x_32810 || x_32812;\n            \n            int64_t defunc_1_op_res_32815;\n            \n            if (x_32812) {\n                defunc_1_op_res_32815 = x_32813;\n            } else {\n                int64_t defunc_1_op_res_32816 = add64(x_32811, x_32813);\n                \n                defunc_1_op_res_32815 = defunc_1_op_res_32816;\n            }\n            private_mem_32741[i_32824] = defunc_1_op_res_32814;\n            private_mem_32743[i_32824] = defunc_1_op_res_32815;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32825 = 0; i_32825 < (int64_t) 9; i_32825++) {\n            int64_t sharedIdx_32826 = sext_i32_i64(local_tid_32718 * 9) +\n                    i_32825;\n            \n            ((__local bool *) local_mem_32728)[sharedIdx_32826] =\n                private_mem_32741[i_32825];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32827 = 0; i_32827 < (int64_t) 9; i_32827++) {\n            int32_t sharedIdx_32828 = local_tid_32718 +\n                    sext_i64_i32(segscan_group_sizze_30570 * i_32827);\n            \n            private_mem_32741[i_32827] = ((__local\n                                           bool *) local_mem_32728)[sext_i32_i64(sharedIdx_32828)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32829 = 0; i_32829 < (int64_t) 9; i_32829++) {",
            "\n            int64_t sharedIdx_32830 = sext_i32_i64(local_tid_32718 * 9) +\n                    i_32829;\n            \n            ((__local int64_t *) local_mem_32728)[sharedIdx_32830] =\n                private_mem_32743[i_32829];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32831 = 0; i_32831 < (int64_t) 9; i_32831++) {\n            int32_t sharedIdx_32832 = local_tid_32718 +\n                    sext_i64_i32(segscan_group_sizze_30570 * i_32831);\n            \n            private_mem_32743[i_32831] = ((__local\n                                           int64_t *) local_mem_32728)[sext_i32_i64(sharedIdx_32832)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32833 = 0; i_32833 < (int64_t) 9; i_32833++) {\n            int64_t gtid_30574 = blockOff_32740 + segscan_group_sizze_30570 *\n                    i_32833 + sext_i32_i64(local_tid_32718);\n            \n            if (slt64(gtid_30574, conc_tmp_28900)) {\n                ((__global bool *) mem_32011)[gtid_30574] =\n                    private_mem_32741[i_32833];\n            }\n        }\n        for (int64_t i_32834 = 0; i_32834 < (int64_t) 9; i_32834++) {\n            int64_t gtid_30574 = blockOff_32740 + segscan_group_sizze_30570 *\n                    i_32834 + sext_i32_i64(local_tid_32718);\n            \n            if (slt64(gtid_30574, conc_tmp_28900)) {\n                ((__global int64_t *) mem_32013)[gtid_30574] =\n                    private_mem_32743[i_32834];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32739 == sdiv_up64(conc_tmp_28900,\n                                          segscan_group_sizze_30570 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_32705)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n",
            "    #undef segscan_group_sizze_30570\n}\n__kernel void test_clusterWithzisegscan_30583(__global int *global_failure,\n                                              uint local_mem_32855_backing_offset_0,\n                                              int64_t conc_tmp_28900, __global\n                                              unsigned char *mem_32008, __global\n                                              unsigned char *mem_32016, __global\n                                              unsigned char *test_clusterWithziid_counter_mem_32838,\n                                              __global\n                                              unsigned char *status_flags_mem_32840,\n                                              __global\n                                              unsigned char *aggregates_mem_32842,\n                                              __global\n                                              unsigned char *incprefixes_mem_32844)\n{\n    #define segscan_group_sizze_30578 (test_clusterWithzisegscan_group_sizze_30577)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32855_backing_0 =\n                  &shared_mem[local_mem_32855_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32846;\n    int32_t local_tid_32847;\n    int64_t group_sizze_32850;\n    int32_t wave_sizze_32849;\n    int32_t group_tid_32848;\n    \n    global_tid_32846 = get_global_id(0);\n    local_tid_32847 = get_local_id(0);\n    group_sizze_32850 = get_local_size(0);\n    wave_sizze_32849 = LOCKSTEP_WIDTH;\n    group_tid_32848 = get_group_id(0);\n    \n    int32_t phys_tid_30583;\n    \n    phys_tid_30583 = global_tid_32846;\n    \n    int64_t byte_offsets_32851;\n    \n    byte_offsets_32851 = (int64_t) 0;\n    \n    int64_t byte_offsets_32852;\n    \n    byte_offsets_32852 = segscan_group_sizze_30578 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32853;\n    \n    warp_byte_offset_32853",
            " = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32854;\n    \n    warp_byte_offset_32854 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32855;\n    \n    local_mem_32855 = (__local char *) local_mem_32855_backing_0;\n    \n    int64_t trans_arr_len_32856;\n    \n    trans_arr_len_32856 = (int64_t) 9 * segscan_group_sizze_30578;\n    \n    int32_t dynamic_id_32863;\n    \n    if (local_tid_32847 == 0) {\n        dynamic_id_32863 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_32838)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32855)[(int64_t) 0] = dynamic_id_32863;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32863 = ((__local int32_t *) local_mem_32855)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32864;\n    \n    blockOff_32864 = sext_i32_i64(dynamic_id_32863) * (int64_t) 9 *\n        segscan_group_sizze_30578;\n    \n    int64_t private_mem_32865[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32867 = 0; i_32867 < (int64_t) 9; i_32867++) {\n            int64_t gtid_30582 = blockOff_32864 +\n                    sext_i32_i64(local_tid_32847) + i_32867 *\n                    segscan_group_sizze_30578;\n            \n            if (slt64(gtid_30582, conc_tmp_28900)) {\n                int64_t i_p_o_31852 = add64((int64_t) 1, gtid_30582);\n                int64_t rot_i_31853 = smod64(i_p_o_31852, conc_tmp_28900);\n                bool x_29048 = ((__global bool *) mem_32008)[rot_i_31853];\n                int64_t defunc_0_f_res_29049 = btoi_bool_i64(x_29048);\n                \n                private_mem_32865[i_32867] = defunc_0_f_res_29049;\n            } else {\n                private_mem_32865[i_32867] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t ",
            "i_32868 = 0; i_32868 < (int64_t) 9; i_32868++) {\n            int64_t sharedIdx_32869 = sext_i32_i64(local_tid_32847) + i_32868 *\n                    segscan_group_sizze_30578;\n            \n            ((__local int64_t *) local_mem_32855)[sharedIdx_32869] =\n                private_mem_32865[i_32868];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32870 = 0; i_32870 < 9; i_32870++) {\n            int32_t sharedIdx_32871 = local_tid_32847 * 9 + i_32870;\n            \n            private_mem_32865[sext_i32_i64(i_32870)] = ((__local\n                                                         int64_t *) local_mem_32855)[sext_i32_i64(sharedIdx_32871)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32872 = 0; i_32872 < (int64_t) 8; i_32872++) {\n            int64_t x_29045;\n            int64_t x_29046;\n            \n            x_29045 = private_mem_32865[i_32872];\n            x_29046 = private_mem_32865[i_32872 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29047;\n            \n            defunc_1_op_res_29047 = add64(x_29045, x_29046);\n            private_mem_32865[i_32872 + (int64_t) 1] = defunc_1_op_res_29047;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32847)] =\n            private_mem_32865[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32876;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32873;\n        int64_t x_32874;\n        int64_t x_32877;\n        int64_t x_32878;\n        bool ltid_in_bounds_32880;\n        \n        ltid_in_bounds_32880 = slt64(sext_i32_i64(local_tid_32847),\n                                     segscan_group_sizze_30578);\n        \n        int32_t skip_threads_32881;\n        \n ",
            "       // read input for in-block scan\n        {\n            if (ltid_in_bounds_32880) {\n                x_32874 = ((volatile __local\n                            int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32847)];\n                if ((local_tid_32847 - squot32(local_tid_32847, 32) * 32) ==\n                    0) {\n                    x_32873 = x_32874;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32881 = 1;\n            while (slt32(skip_threads_32881, 32)) {\n                if (sle32(skip_threads_32881, local_tid_32847 -\n                          squot32(local_tid_32847, 32) * 32) &&\n                    ltid_in_bounds_32880) {\n                    // read operands\n                    {\n                        x_32873 = ((volatile __local\n                                    int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32847) -\n                                                                 sext_i32_i64(skip_threads_32881))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32875 = add64(x_32873, x_32874);\n                        \n                        x_32873 = defunc_1_op_res_32875;\n                    }\n                }\n                if (sle32(wave_sizze_32849, skip_threads_32881)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32881, local_tid_32847 -\n                          squot32(local_tid_32847, 32) * 32) &&\n                    ltid_in_bounds_32880) {\n                    //",
            " write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32847)] =\n                            x_32873;\n                        x_32874 = x_32873;\n                    }\n                }\n                if (sle32(wave_sizze_32849, skip_threads_32881)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32881 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32847 - squot32(local_tid_32847, 32) * 32) == 31 &&\n                ltid_in_bounds_32880) {\n                ((volatile __local\n                  int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32847,\n                                                                   32))] =\n                    x_32873;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32882;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32847, 32) == 0 && ltid_in_bounds_32880) {\n                    x_32878 = ((volatile __local\n                                int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32847)];\n                    if ((local_tid_32847 - squot32(local_tid_32847, 32) * 32) ==\n       ",
            "                 0) {\n                        x_32877 = x_32878;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32882 = 1;\n                while (slt32(skip_threads_32882, 32)) {\n                    if (sle32(skip_threads_32882, local_tid_32847 -\n                              squot32(local_tid_32847, 32) * 32) &&\n                        (squot32(local_tid_32847, 32) == 0 &&\n                         ltid_in_bounds_32880)) {\n                        // read operands\n                        {\n                            x_32877 = ((volatile __local\n                                        int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32847) -\n                                                                     sext_i32_i64(skip_threads_32882))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32879 = add64(x_32877,\n                                                                  x_32878);\n                            \n                            x_32877 = defunc_1_op_res_32879;\n                        }\n                    }\n                    if (sle32(wave_sizze_32849, skip_threads_32882)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32882, local_tid_32847 -\n                              squot32(local_tid_32847, 32) * 32) &&\n                        (squot32(local_tid_32847, 32) == 0 &&\n                         ltid_in_bounds_32880)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_3",
            "2855)[squot64(byte_offsets_32851,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32847)] =\n                                x_32877;\n                            x_32878 = x_32877;\n                        }\n                    }\n                    if (sle32(wave_sizze_32849, skip_threads_32882)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32882 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32847, 32) == 0 || !ltid_in_bounds_32880)) {\n                // read operands\n                {\n                    x_32874 = x_32873;\n                    x_32873 = ((__local\n                                int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32847,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32875 = add64(x_32873, x_32874);\n                    \n                    x_32873 = defunc_1_op_res_32875;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32847)] =\n                        x_32873;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n  ",
            "      // restore correct values for first block\n        {\n            if (squot32(local_tid_32847, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32847)] =\n                    x_32874;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32847 == 0) {\n            acc_32876 = ((__local\n                          int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30578 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32876 = ((__local\n                          int64_t *) local_mem_32855)[squot64(byte_offsets_32851,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32847) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32883;\n    \n    prefix_32883 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32863 == (int64_t) 0 && local_tid_32847 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32844)[dynamic_id_32863] = acc_32876;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32840)[dynamic_id_32863] = (int8_t) 2;\n            acc_32876 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32863 == (int64_t) 0) && slt32(local_tid_32847,\n                                                        wave_sizze_32849)) {\n            if (local_tid_32847 == 0) {\n                ((volatile __global\n            ",
            "      int64_t *) aggregates_mem_32842)[dynamic_id_32863] =\n                    acc_32876;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32840)[dynamic_id_32863] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32855)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32840)[dynamic_id_32863 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32884;\n            \n            status_32884 = ((__local int8_t *) local_mem_32855)[(int64_t) 0];\n            if (status_32884 == (int8_t) 2) {\n                if (local_tid_32847 == 0) {\n                    prefix_32883 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32844)[dynamic_id_32863 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32885 = dynamic_id_32863 -\n                        sext_i32_i64(wave_sizze_32849);\n                \n                while (slt32(wave_sizze_32849 * -1, readOffset_32885)) {\n                    int32_t read_i_32886 = readOffset_32885 + local_tid_32847;\n                    int64_t aggr_32887 = (int64_t) 0;\n                    int8_t flag_32888 = (int8_t) 0;\n                    int8_t used_32889 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32886)) {\n                        flag_32888 = ((volatile __global\n                                       int8_t *) status_flags_mem_32840)[sext_i32_i64(read_i_32886)];\n                        if (flag_32888 == (int8_t) 2) {\n                            aggr_32887 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32844)[sext",
            "_i32_i64(read_i_32886)];\n                        } else {\n                            if (flag_32888 == (int8_t) 1) {\n                                aggr_32887 = ((volatile __global\n                                               int64_t *) aggregates_mem_32842)[sext_i32_i64(read_i_32886)];\n                                used_32889 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32855)[squot64(warp_byte_offset_32853,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32847)] =\n                        aggr_32887;\n                    \n                    int8_t tmp_32890;\n                    \n                    tmp_32890 = flag_32888 | used_32889 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32855)[sext_i32_i64(local_tid_32847)] =\n                        tmp_32890;\n                    mem_fence_local();\n                    flag_32888 = ((volatile __local\n                                   int8_t *) local_mem_32855)[sext_i32_i64(wave_sizze_32849) -\n                                                              (int64_t) 1];\n                    if (local_tid_32847 == 0) {\n                        if (!(flag_32888 == (int8_t) 2)) {\n                            int64_t x_32891 = (int64_t) 0;\n                            int64_t x_32892;\n                            int8_t flag1_32894;\n                            \n                            flag1_32894 = (int8_t) 0;\n                            \n                            int8_t flag2_32895;\n                            int8_t used1_32896;\n                            \n                            used1_32896 = (int8_t) 0;\n                            \n                            int8_t used2_32897;\n                            \n                            for (int32_t i_32898 = 0;",
            " i_32898 <\n                                 wave_sizze_32849; i_32898++) {\n                                flag2_32895 = ((__local\n                                                int8_t *) local_mem_32855)[sext_i32_i64(i_32898)];\n                                used2_32897 = lshr8(flag2_32895, (int8_t) 2);\n                                flag2_32895 = flag2_32895 & (int8_t) 3;\n                                x_32892 = ((__local\n                                            int64_t *) local_mem_32855)[squot64(warp_byte_offset_32853,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32898)];\n                                if (!(flag2_32895 == (int8_t) 1)) {\n                                    flag1_32894 = flag2_32895;\n                                    used1_32896 = used2_32897;\n                                    x_32891 = x_32892;\n                                } else {\n                                    used1_32896 += used2_32897;\n                                    \n                                    int64_t defunc_1_op_res_32893;\n                                    \n                                    defunc_1_op_res_32893 = add64(x_32891,\n                                                                  x_32892);\n                                    x_32891 = defunc_1_op_res_32893;\n                                }\n                            }\n                            flag_32888 = flag1_32894;\n                            used_32889 = used1_32896;\n                            aggr_32887 = x_32891;\n                        } else {\n                            aggr_32887 = ((__local\n                                           int64_t *) local_mem_32855)[squot64(warp_byte_offset_32853,\n                                                                               (int64_t) 8) +\n                                                       ",
            "                (sext_i32_i64(wave_sizze_32849) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32888 == (int8_t) 2) {\n                            readOffset_32885 = wave_sizze_32849 * -1;\n                        } else {\n                            readOffset_32885 -= zext_i8_i32(used_32889);\n                        }\n                        ((__local int32_t *) local_mem_32855)[(int64_t) 0] =\n                            readOffset_32885;\n                        \n                        int64_t x_32899;\n                        \n                        x_32899 = aggr_32887;\n                        \n                        int64_t x_32900;\n                        \n                        x_32900 = prefix_32883;\n                        \n                        int64_t defunc_1_op_res_32901;\n                        \n                        defunc_1_op_res_32901 = add64(x_32899, x_32900);\n                        prefix_32883 = defunc_1_op_res_32901;\n                    }\n                    mem_fence_local();\n                    readOffset_32885 = ((__local\n                                         int32_t *) local_mem_32855)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32847 == 0) {\n                int64_t x_32902 = prefix_32883;\n                int64_t x_32903 = acc_32876;\n                int64_t defunc_1_op_res_32904 = add64(x_32902, x_32903);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32844)[dynamic_id_32863] =\n                    defunc_1_op_res_32904;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32840)[dynamic_id_32863] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32855)[squot64(warp_byte_offset_32853,\n                                                      (int64_",
            "t) 8)] =\n                    prefix_32883;\n                acc_32876 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32863 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32883 = ((__local\n                             int64_t *) local_mem_32855)[squot64(warp_byte_offset_32853,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32905;\n        int64_t x_32906;\n        int64_t x_32908;\n        \n        x_32908 = prefix_32883;\n        \n        int64_t x_32909;\n        \n        x_32909 = acc_32876;\n        \n        int64_t defunc_1_op_res_32910;\n        \n        defunc_1_op_res_32910 = add64(x_32908, x_32909);\n        x_32905 = defunc_1_op_res_32910;\n        for (int64_t i_32911 = 0; i_32911 < (int64_t) 9; i_32911++) {\n            x_32906 = private_mem_32865[i_32911];\n            \n            int64_t defunc_1_op_res_32907;\n            \n            defunc_1_op_res_32907 = add64(x_32905, x_32906);\n            private_mem_32865[i_32911] = defunc_1_op_res_32907;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32912 = 0; i_32912 < (int64_t) 9; i_32912++) {\n            int64_t sharedIdx_32913 = sext_i32_i64(local_tid_32847 * 9) +\n                    i_32912;\n            \n            ((__local int64_t *) local_mem_32855)[sharedIdx_32913] =\n                private_mem_32865[i_32912];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32914 = 0; i_32914 < (int64_t) 9; i_32914++) {\n            int32_t sharedIdx_32915 = local_tid_32847 +\n                    sext_i64_i32(segscan_group_sizze_30578 * i_32914);\n            \n            private_mem_32865[i_32914] = ((__local\n                                           int64_t *) local_mem_32855)[sext_i32_i64(sharedIdx_32915)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);",
            "\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32916 = 0; i_32916 < (int64_t) 9; i_32916++) {\n            int64_t gtid_30582 = blockOff_32864 + segscan_group_sizze_30578 *\n                    i_32916 + sext_i32_i64(local_tid_32847);\n            \n            if (slt64(gtid_30582, conc_tmp_28900)) {\n                ((__global int64_t *) mem_32016)[gtid_30582] =\n                    private_mem_32865[i_32916];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32863 == sdiv_up64(conc_tmp_28900,\n                                          segscan_group_sizze_30578 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_32838)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30578\n}\n__kernel void test_clusterWithzisegscan_30597(__global int *global_failure,\n                                              uint local_mem_32951_backing_offset_0,\n                                              int64_t num_segments_29050,\n                                              __global unsigned char *mem_32018,\n                                              __global unsigned char *mem_32022,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_32934,\n                                              __global\n                                              unsigned char *status_flags_mem_32936,\n                                              __global\n                                              unsigned char *aggregates_mem_32938,\n                                              __global\n                                              unsigned char *incprefixes_mem_32940)\n{\n    #define segscan_group_sizze_30592 (test_clusterWithzisegscan_group_sizze_30591)\n ",
            "   \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32951_backing_0 =\n                  &shared_mem[local_mem_32951_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32942;\n    int32_t local_tid_32943;\n    int64_t group_sizze_32946;\n    int32_t wave_sizze_32945;\n    int32_t group_tid_32944;\n    \n    global_tid_32942 = get_global_id(0);\n    local_tid_32943 = get_local_id(0);\n    group_sizze_32946 = get_local_size(0);\n    wave_sizze_32945 = LOCKSTEP_WIDTH;\n    group_tid_32944 = get_group_id(0);\n    \n    int32_t phys_tid_30597;\n    \n    phys_tid_30597 = global_tid_32942;\n    \n    int64_t byte_offsets_32947;\n    \n    byte_offsets_32947 = (int64_t) 0;\n    \n    int64_t byte_offsets_32948;\n    \n    byte_offsets_32948 = segscan_group_sizze_30592 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32949;\n    \n    warp_byte_offset_32949 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32950;\n    \n    warp_byte_offset_32950 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32951;\n    \n    local_mem_32951 = (__local char *) local_mem_32951_backing_0;\n    \n    int64_t trans_arr_len_32952;\n    \n    trans_arr_len_32952 = (int64_t) 9 * segscan_group_sizze_30592;\n    \n    int32_t dynamic_id_32959;\n    \n    if (local_tid_32943 == 0) {\n        dynamic_id_32959 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_32934)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32951)[(int64_t) 0] = dynamic_id_32959;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32959 = ((__local int32_t *) local_mem_32951)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32960;\n    \n    blockOff_32960 = sext_i32_i64(dynamic_id_32959) * (int64_t) 9 *\n        segscan_group_si",
            "zze_30592;\n    \n    int64_t private_mem_32961[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32963 = 0; i_32963 < (int64_t) 9; i_32963++) {\n            int64_t gtid_30596 = blockOff_32960 +\n                    sext_i32_i64(local_tid_32943) + i_32963 *\n                    segscan_group_sizze_30592;\n            \n            if (slt64(gtid_30596, num_segments_29050)) {\n                int64_t x_29067 = ((__global int64_t *) mem_32018)[gtid_30596];\n                \n                private_mem_32961[i_32963] = x_29067;\n            } else {\n                private_mem_32961[i_32963] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32964 = 0; i_32964 < (int64_t) 9; i_32964++) {\n            int64_t sharedIdx_32965 = sext_i32_i64(local_tid_32943) + i_32964 *\n                    segscan_group_sizze_30592;\n            \n            ((__local int64_t *) local_mem_32951)[sharedIdx_32965] =\n                private_mem_32961[i_32964];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32966 = 0; i_32966 < 9; i_32966++) {\n            int32_t sharedIdx_32967 = local_tid_32943 * 9 + i_32966;\n            \n            private_mem_32961[sext_i32_i64(i_32966)] = ((__local\n                                                         int64_t *) local_mem_32951)[sext_i32_i64(sharedIdx_32967)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32968 = 0; i_32968 < (int64_t) 8; i_32968++) {\n            int64_t x_29064;\n            int64_t x_29065;\n            \n            x_29064 = private_mem_32961[i_32968];\n            x_29065 = private_mem_32961[i_32968 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29066;\n            \n            defunc_1_op_res_29066 = add64(x_29064, x_29065);\n            private_mem_32961[i_32968 + (int64_t) 1] = defunc_1_op_res_29066;\n        }\n    }\n    // Publish results in shar",
            "ed memory\n    {\n        ((__local int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32943)] =\n            private_mem_32961[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32972;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32969;\n        int64_t x_32970;\n        int64_t x_32973;\n        int64_t x_32974;\n        bool ltid_in_bounds_32976;\n        \n        ltid_in_bounds_32976 = slt64(sext_i32_i64(local_tid_32943),\n                                     segscan_group_sizze_30592);\n        \n        int32_t skip_threads_32977;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32976) {\n                x_32970 = ((volatile __local\n                            int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32943)];\n                if ((local_tid_32943 - squot32(local_tid_32943, 32) * 32) ==\n                    0) {\n                    x_32969 = x_32970;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32977 = 1;\n            while (slt32(skip_threads_32977, 32)) {\n                if (sle32(skip_threads_32977, local_tid_32943 -\n                          squot32(local_tid_32943, 32) * 32) &&\n                    ltid_in_bounds_32976) {\n                    // read operands\n                    {\n                        x_32969 = ((volatile __local\n                                    int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(loc",
            "al_tid_32943) -\n                                                                 sext_i32_i64(skip_threads_32977))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32971 = add64(x_32969, x_32970);\n                        \n                        x_32969 = defunc_1_op_res_32971;\n                    }\n                }\n                if (sle32(wave_sizze_32945, skip_threads_32977)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32977, local_tid_32943 -\n                          squot32(local_tid_32943, 32) * 32) &&\n                    ltid_in_bounds_32976) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32943)] =\n                            x_32969;\n                        x_32970 = x_32969;\n                    }\n                }\n                if (sle32(wave_sizze_32945, skip_threads_32977)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32977 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32943 - squot32(local_tid_32943, 32) * 32) == 31 &&\n                ltid_in_bounds_32976) {\n                ((volatile __local\n                  int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32943,\n                                                                   32))] =\n                    x_32969;\n            }\n      ",
            "  }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32978;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32943, 32) == 0 && ltid_in_bounds_32976) {\n                    x_32974 = ((volatile __local\n                                int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32943)];\n                    if ((local_tid_32943 - squot32(local_tid_32943, 32) * 32) ==\n                        0) {\n                        x_32973 = x_32974;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32978 = 1;\n                while (slt32(skip_threads_32978, 32)) {\n                    if (sle32(skip_threads_32978, local_tid_32943 -\n                              squot32(local_tid_32943, 32) * 32) &&\n                        (squot32(local_tid_32943, 32) == 0 &&\n                         ltid_in_bounds_32976)) {\n                        // read operands\n                        {\n                            x_32973 = ((volatile __local\n                                        int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32943) -\n                                                                     sext_i32_i64(skip_threads_32978))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32975 = add64(x_32973,\n                                        ",
            "                          x_32974);\n                            \n                            x_32973 = defunc_1_op_res_32975;\n                        }\n                    }\n                    if (sle32(wave_sizze_32945, skip_threads_32978)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32978, local_tid_32943 -\n                              squot32(local_tid_32943, 32) * 32) &&\n                        (squot32(local_tid_32943, 32) == 0 &&\n                         ltid_in_bounds_32976)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32943)] =\n                                x_32973;\n                            x_32974 = x_32973;\n                        }\n                    }\n                    if (sle32(wave_sizze_32945, skip_threads_32978)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32978 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32943, 32) == 0 || !ltid_in_bounds_32976)) {\n                // read operands\n                {\n                    x_32970 = x_32969;\n                    x_32969 = ((__local\n                                int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32943,\n                                                                                  32)) -\n                   ",
            "                                          (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32971 = add64(x_32969, x_32970);\n                    \n                    x_32969 = defunc_1_op_res_32971;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32943)] =\n                        x_32969;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32943, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32943)] =\n                    x_32970;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32943 == 0) {\n            acc_32972 = ((__local\n                          int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30592 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32972 = ((__local\n                          int64_t *) local_mem_32951)[squot64(byte_offsets_32947,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32943) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK",
            "_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32979;\n    \n    prefix_32979 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32959 == (int64_t) 0 && local_tid_32943 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32940)[dynamic_id_32959] = acc_32972;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32936)[dynamic_id_32959] = (int8_t) 2;\n            acc_32972 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32959 == (int64_t) 0) && slt32(local_tid_32943,\n                                                        wave_sizze_32945)) {\n            if (local_tid_32943 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32938)[dynamic_id_32959] =\n                    acc_32972;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32936)[dynamic_id_32959] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32951)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32936)[dynamic_id_32959 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32980;\n            \n            status_32980 = ((__local int8_t *) local_mem_32951)[(int64_t) 0];\n            if (status_32980 == (int8_t) 2) {\n                if (local_tid_32943 == 0) {\n                    prefix_32979 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32940)[dynamic_id_32959 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32981 = dynamic_id_32959 -\n                        sext_i32_i64(wave_sizze_32945);\n                \n    ",
            "            while (slt32(wave_sizze_32945 * -1, readOffset_32981)) {\n                    int32_t read_i_32982 = readOffset_32981 + local_tid_32943;\n                    int64_t aggr_32983 = (int64_t) 0;\n                    int8_t flag_32984 = (int8_t) 0;\n                    int8_t used_32985 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32982)) {\n                        flag_32984 = ((volatile __global\n                                       int8_t *) status_flags_mem_32936)[sext_i32_i64(read_i_32982)];\n                        if (flag_32984 == (int8_t) 2) {\n                            aggr_32983 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32940)[sext_i32_i64(read_i_32982)];\n                        } else {\n                            if (flag_32984 == (int8_t) 1) {\n                                aggr_32983 = ((volatile __global\n                                               int64_t *) aggregates_mem_32938)[sext_i32_i64(read_i_32982)];\n                                used_32985 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32951)[squot64(warp_byte_offset_32949,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32943)] =\n                        aggr_32983;\n                    \n                    int8_t tmp_32986;\n                    \n                    tmp_32986 = flag_32984 | used_32985 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32951)[sext_i32_i64(local_tid_32943)] =\n                        tmp_32986;\n                    mem_fence_local();\n                    flag_32984 = ((volatile __local\n                                   int8_t *) local_mem_32951)[sext_i32_i64(wave_sizze_32945) -\n                                                   ",
            "           (int64_t) 1];\n                    if (local_tid_32943 == 0) {\n                        if (!(flag_32984 == (int8_t) 2)) {\n                            int64_t x_32987 = (int64_t) 0;\n                            int64_t x_32988;\n                            int8_t flag1_32990;\n                            \n                            flag1_32990 = (int8_t) 0;\n                            \n                            int8_t flag2_32991;\n                            int8_t used1_32992;\n                            \n                            used1_32992 = (int8_t) 0;\n                            \n                            int8_t used2_32993;\n                            \n                            for (int32_t i_32994 = 0; i_32994 <\n                                 wave_sizze_32945; i_32994++) {\n                                flag2_32991 = ((__local\n                                                int8_t *) local_mem_32951)[sext_i32_i64(i_32994)];\n                                used2_32993 = lshr8(flag2_32991, (int8_t) 2);\n                                flag2_32991 = flag2_32991 & (int8_t) 3;\n                                x_32988 = ((__local\n                                            int64_t *) local_mem_32951)[squot64(warp_byte_offset_32949,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32994)];\n                                if (!(flag2_32991 == (int8_t) 1)) {\n                                    flag1_32990 = flag2_32991;\n                                    used1_32992 = used2_32993;\n                                    x_32987 = x_32988;\n                                } else {\n                                    used1_32992 += used2_32993;\n                                    \n                                    int64_t defunc_1_op_res_32989;\n                                    \n                                    defunc_1",
            "_op_res_32989 = add64(x_32987,\n                                                                  x_32988);\n                                    x_32987 = defunc_1_op_res_32989;\n                                }\n                            }\n                            flag_32984 = flag1_32990;\n                            used_32985 = used1_32992;\n                            aggr_32983 = x_32987;\n                        } else {\n                            aggr_32983 = ((__local\n                                           int64_t *) local_mem_32951)[squot64(warp_byte_offset_32949,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32945) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32984 == (int8_t) 2) {\n                            readOffset_32981 = wave_sizze_32945 * -1;\n                        } else {\n                            readOffset_32981 -= zext_i8_i32(used_32985);\n                        }\n                        ((__local int32_t *) local_mem_32951)[(int64_t) 0] =\n                            readOffset_32981;\n                        \n                        int64_t x_32995;\n                        \n                        x_32995 = aggr_32983;\n                        \n                        int64_t x_32996;\n                        \n                        x_32996 = prefix_32979;\n                        \n                        int64_t defunc_1_op_res_32997;\n                        \n                        defunc_1_op_res_32997 = add64(x_32995, x_32996);\n                        prefix_32979 = defunc_1_op_res_32997;\n                    }\n                    mem_fence_local();\n                    readOffset_32981 = ((__local\n                                         int32_t *) local_mem_32951)[(int64_t) 0];\n             ",
            "   }\n            }\n            if (local_tid_32943 == 0) {\n                int64_t x_32998 = prefix_32979;\n                int64_t x_32999 = acc_32972;\n                int64_t defunc_1_op_res_33000 = add64(x_32998, x_32999);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32940)[dynamic_id_32959] =\n                    defunc_1_op_res_33000;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32936)[dynamic_id_32959] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32951)[squot64(warp_byte_offset_32949,\n                                                      (int64_t) 8)] =\n                    prefix_32979;\n                acc_32972 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32959 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32979 = ((__local\n                             int64_t *) local_mem_32951)[squot64(warp_byte_offset_32949,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33001;\n        int64_t x_33002;\n        int64_t x_33004;\n        \n        x_33004 = prefix_32979;\n        \n        int64_t x_33005;\n        \n        x_33005 = acc_32972;\n        \n        int64_t defunc_1_op_res_33006;\n        \n        defunc_1_op_res_33006 = add64(x_33004, x_33005);\n        x_33001 = defunc_1_op_res_33006;\n        for (int64_t i_33007 = 0; i_33007 < (int64_t) 9; i_33007++) {\n            x_33002 = private_mem_32961[i_33007];\n            \n            int64_t defunc_1_op_res_33003;\n            \n            defunc_1_op_res_33003 = add64(x_33001, x_33002);\n            private_mem_32961[i_33007] = defunc_1_op_res_33003;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_3",
            "3008 = 0; i_33008 < (int64_t) 9; i_33008++) {\n            int64_t sharedIdx_33009 = sext_i32_i64(local_tid_32943 * 9) +\n                    i_33008;\n            \n            ((__local int64_t *) local_mem_32951)[sharedIdx_33009] =\n                private_mem_32961[i_33008];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33010 = 0; i_33010 < (int64_t) 9; i_33010++) {\n            int32_t sharedIdx_33011 = local_tid_32943 +\n                    sext_i64_i32(segscan_group_sizze_30592 * i_33010);\n            \n            private_mem_32961[i_33010] = ((__local\n                                           int64_t *) local_mem_32951)[sext_i32_i64(sharedIdx_33011)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33012 = 0; i_33012 < (int64_t) 9; i_33012++) {\n            int64_t gtid_30596 = blockOff_32960 + segscan_group_sizze_30592 *\n                    i_33012 + sext_i32_i64(local_tid_32943);\n            \n            if (slt64(gtid_30596, num_segments_29050)) {\n                ((__global int64_t *) mem_32022)[gtid_30596] =\n                    private_mem_32961[i_33012];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32959 == sdiv_up64(num_segments_29050,\n                                          segscan_group_sizze_30592 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_32934)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30592\n}\n__kernel void test_clusterWithzisegscan_30642(__global int *global_failure,\n                                              int failure_is_an_option, __global\n                                              int64_t *global_failure_args,\n                                              uint local_mem_33168_backing_offset_",
            "0,\n                                              int64_t numVert_28890,\n                                              int64_t maxSizze_29114, __global\n                                              unsigned char *mem_32038, __global\n                                              unsigned char *mem_param_32074,\n                                              __global\n                                              unsigned char *mem_param_32079,\n                                              __global\n                                              unsigned char *mem_param_32084,\n                                              __global unsigned char *mem_32093,\n                                              __global unsigned char *mem_32095,\n                                              __global unsigned char *mem_32097,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_33151,\n                                              __global\n                                              unsigned char *status_flags_mem_33153,\n                                              __global\n                                              unsigned char *aggregates_mem_33155,\n                                              __global\n                                              unsigned char *incprefixes_mem_33157)\n{\n    #define segscan_group_sizze_30637 (test_clusterWithzisegscan_group_sizze_30636)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33168_backing_0 =\n                  &shared_mem[local_mem_33168_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_33159;\n    int32_t local_tid_33160;\n    int64_t gr",
            "oup_sizze_33163;\n    int32_t wave_sizze_33162;\n    int32_t group_tid_33161;\n    \n    global_tid_33159 = get_global_id(0);\n    local_tid_33160 = get_local_id(0);\n    group_sizze_33163 = get_local_size(0);\n    wave_sizze_33162 = LOCKSTEP_WIDTH;\n    group_tid_33161 = get_group_id(0);\n    \n    int32_t phys_tid_30642;\n    \n    phys_tid_30642 = global_tid_33159;\n    \n    int64_t byte_offsets_33164;\n    \n    byte_offsets_33164 = (int64_t) 0;\n    \n    int64_t byte_offsets_33165;\n    \n    byte_offsets_33165 = segscan_group_sizze_30637 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33166;\n    \n    warp_byte_offset_33166 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33167;\n    \n    warp_byte_offset_33167 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33168;\n    \n    local_mem_33168 = (__local char *) local_mem_33168_backing_0;\n    \n    int64_t trans_arr_len_33169;\n    \n    trans_arr_len_33169 = (int64_t) 9 * segscan_group_sizze_30637;\n    \n    int32_t dynamic_id_33176;\n    \n    if (local_tid_33160 == 0) {\n        dynamic_id_33176 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_33151)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33168)[(int64_t) 0] = dynamic_id_33176;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33176 = ((__local int32_t *) local_mem_33168)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33177;\n    \n    blockOff_33177 = sext_i32_i64(dynamic_id_33176) * (int64_t) 9 *\n        segscan_group_sizze_30637;\n    \n    int64_t private_mem_33178[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33180 = 0; i_33180 < (int64_t) 9; i_33180++) {\n            int64_t gtid_30641 = blockOff_33177 +\n                    sext_i32_i64(local_tid_33160) + i_33180 *\n                    segscan_group_sizze_30637;\n            \n            ",
            "if (slt64(gtid_30641, numVert_28890)) {\n                int64_t x_29156 = ((__global\n                                    int64_t *) mem_param_32079)[gtid_30641];\n                int32_t x_29157 = ((__global int32_t *) mem_32038)[gtid_30641];\n                bool x_29158 = sle64((int64_t) 0, x_29156);\n                bool y_29159 = slt64(x_29156, maxSizze_29114);\n                bool bounds_check_29160 = x_29158 && y_29159;\n                bool index_certs_29161;\n                \n                if (!bounds_check_29160) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 11) ==\n                            -1) {\n                            global_failure_args[0] = x_29156;\n                            global_failure_args[1] = maxSizze_29114;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int32_t defunc_0_f_res_29162 = ((__global\n                                                 int32_t *) mem_param_32074)[x_29156];\n                int64_t v_29163 = sext_i32_i64(x_29157);\n                bool x_29164 = sle64((int64_t) 0, v_29163);\n                bool y_29165 = slt64(v_29163, numVert_28890);\n                bool bounds_check_29166 = x_29164 && y_29165;\n                bool index_certs_29167;\n                \n                if (!bounds_check_29166) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 12) ==\n                            -1) {\n                            global_failure_args[0] = v_29163;\n                            global_failure_args[1] = numVert_28890;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t x_29168 = ((__global\n             ",
            "                       int64_t *) mem_param_32084)[v_29163];\n                int64_t defunc_0_f_res_29169 = x_29168 << (int64_t) 1;\n                \n                ((__global int64_t *) mem_32095)[gtid_30641] =\n                    defunc_0_f_res_29169;\n                ((__global int32_t *) mem_32097)[gtid_30641] =\n                    defunc_0_f_res_29162;\n                private_mem_33178[i_33180] = defunc_0_f_res_29169;\n            } else {\n                private_mem_33178[i_33180] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33181 = 0; i_33181 < (int64_t) 9; i_33181++) {\n            int64_t sharedIdx_33182 = sext_i32_i64(local_tid_33160) + i_33181 *\n                    segscan_group_sizze_30637;\n            \n            ((__local int64_t *) local_mem_33168)[sharedIdx_33182] =\n                private_mem_33178[i_33181];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33183 = 0; i_33183 < 9; i_33183++) {\n            int32_t sharedIdx_33184 = local_tid_33160 * 9 + i_33183;\n            \n            private_mem_33178[sext_i32_i64(i_33183)] = ((__local\n                                                         int64_t *) local_mem_33168)[sext_i32_i64(sharedIdx_33184)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33185 = 0; i_33185 < (int64_t) 8; i_33185++) {\n            int64_t x_29153;\n            int64_t x_29154;\n            \n            x_29153 = private_mem_33178[i_33185];\n            x_29154 = private_mem_33178[i_33185 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29155;\n            \n            defunc_1_op_res_29155 = add64(x_29153, x_29154);\n            private_mem_33178[i_33185 + (int64_t) 1] = defunc_1_op_res_29155;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n               ",
            "                                       (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33160)] =\n            private_mem_33178[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_33189;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_33186;\n        int64_t x_33187;\n        int64_t x_33190;\n        int64_t x_33191;\n        bool ltid_in_bounds_33193;\n        \n        ltid_in_bounds_33193 = slt64(sext_i32_i64(local_tid_33160),\n                                     segscan_group_sizze_30637);\n        \n        int32_t skip_threads_33194;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33193) {\n                x_33187 = ((volatile __local\n                            int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33160)];\n                if ((local_tid_33160 - squot32(local_tid_33160, 32) * 32) ==\n                    0) {\n                    x_33186 = x_33187;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33194 = 1;\n            while (slt32(skip_threads_33194, 32)) {\n                if (sle32(skip_threads_33194, local_tid_33160 -\n                          squot32(local_tid_33160, 32) * 32) &&\n                    ltid_in_bounds_33193) {\n                    // read operands\n                    {\n                        x_33186 = ((volatile __local\n                                    int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33160) -\n                                                                 sext_i32_i64(skip_thread",
            "s_33194))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_33188 = add64(x_33186, x_33187);\n                        \n                        x_33186 = defunc_1_op_res_33188;\n                    }\n                }\n                if (sle32(wave_sizze_33162, skip_threads_33194)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33194, local_tid_33160 -\n                          squot32(local_tid_33160, 32) * 32) &&\n                    ltid_in_bounds_33193) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33160)] =\n                            x_33186;\n                        x_33187 = x_33186;\n                    }\n                }\n                if (sle32(wave_sizze_33162, skip_threads_33194)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33194 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33160 - squot32(local_tid_33160, 32) * 32) == 31 &&\n                ltid_in_bounds_33193) {\n                ((volatile __local\n                  int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33160,\n                                                                   32))] =\n                    x_33186;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contain",
            "s carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33195;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33160, 32) == 0 && ltid_in_bounds_33193) {\n                    x_33191 = ((volatile __local\n                                int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33160)];\n                    if ((local_tid_33160 - squot32(local_tid_33160, 32) * 32) ==\n                        0) {\n                        x_33190 = x_33191;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33195 = 1;\n                while (slt32(skip_threads_33195, 32)) {\n                    if (sle32(skip_threads_33195, local_tid_33160 -\n                              squot32(local_tid_33160, 32) * 32) &&\n                        (squot32(local_tid_33160, 32) == 0 &&\n                         ltid_in_bounds_33193)) {\n                        // read operands\n                        {\n                            x_33190 = ((volatile __local\n                                        int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33160) -\n                                                                     sext_i32_i64(skip_threads_33195))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_33192 = add64(x_33190,\n                                                                  x_33191);\n                            \n                            x_33190 = de",
            "func_1_op_res_33192;\n                        }\n                    }\n                    if (sle32(wave_sizze_33162, skip_threads_33195)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33195, local_tid_33160 -\n                              squot32(local_tid_33160, 32) * 32) &&\n                        (squot32(local_tid_33160, 32) == 0 &&\n                         ltid_in_bounds_33193)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33160)] =\n                                x_33190;\n                            x_33191 = x_33190;\n                        }\n                    }\n                    if (sle32(wave_sizze_33162, skip_threads_33195)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33195 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33160, 32) == 0 || !ltid_in_bounds_33193)) {\n                // read operands\n                {\n                    x_33187 = x_33186;\n                    x_33186 = ((__local\n                                int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33160,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform ope",
            "ration\n                {\n                    int64_t defunc_1_op_res_33188 = add64(x_33186, x_33187);\n                    \n                    x_33186 = defunc_1_op_res_33188;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33160)] =\n                        x_33186;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33160, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33160)] =\n                    x_33187;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33160 == 0) {\n            acc_33189 = ((__local\n                          int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30637 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33189 = ((__local\n                          int64_t *) local_mem_33168)[squot64(byte_offsets_33164,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33160) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_33196;\n    \n    prefix_33196 = (int64_t) 0;\n    // Perfo",
            "rm lookback\n    {\n        if (dynamic_id_33176 == (int64_t) 0 && local_tid_33160 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_33157)[dynamic_id_33176] = acc_33189;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33153)[dynamic_id_33176] = (int8_t) 2;\n            acc_33189 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33176 == (int64_t) 0) && slt32(local_tid_33160,\n                                                        wave_sizze_33162)) {\n            if (local_tid_33160 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_33155)[dynamic_id_33176] =\n                    acc_33189;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33153)[dynamic_id_33176] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33168)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33153)[dynamic_id_33176 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33197;\n            \n            status_33197 = ((__local int8_t *) local_mem_33168)[(int64_t) 0];\n            if (status_33197 == (int8_t) 2) {\n                if (local_tid_33160 == 0) {\n                    prefix_33196 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33157)[dynamic_id_33176 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33198 = dynamic_id_33176 -\n                        sext_i32_i64(wave_sizze_33162);\n                \n                while (slt32(wave_sizze_33162 * -1, readOffset_33198)) {\n                    int32_t read_i_3",
            "3199 = readOffset_33198 + local_tid_33160;\n                    int64_t aggr_33200 = (int64_t) 0;\n                    int8_t flag_33201 = (int8_t) 0;\n                    int8_t used_33202 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33199)) {\n                        flag_33201 = ((volatile __global\n                                       int8_t *) status_flags_mem_33153)[sext_i32_i64(read_i_33199)];\n                        if (flag_33201 == (int8_t) 2) {\n                            aggr_33200 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33157)[sext_i32_i64(read_i_33199)];\n                        } else {\n                            if (flag_33201 == (int8_t) 1) {\n                                aggr_33200 = ((volatile __global\n                                               int64_t *) aggregates_mem_33155)[sext_i32_i64(read_i_33199)];\n                                used_33202 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_33168)[squot64(warp_byte_offset_33166,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33160)] =\n                        aggr_33200;\n                    \n                    int8_t tmp_33203;\n                    \n                    tmp_33203 = flag_33201 | used_33202 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33168)[sext_i32_i64(local_tid_33160)] =\n                        tmp_33203;\n                    mem_fence_local();\n                    flag_33201 = ((volatile __local\n                                   int8_t *) local_mem_33168)[sext_i32_i64(wave_sizze_33162) -\n                                                              (int64_t) 1];\n                    if (local_tid_33160 == 0) {\n                        if (!(fl",
            "ag_33201 == (int8_t) 2)) {\n                            int64_t x_33204 = (int64_t) 0;\n                            int64_t x_33205;\n                            int8_t flag1_33207;\n                            \n                            flag1_33207 = (int8_t) 0;\n                            \n                            int8_t flag2_33208;\n                            int8_t used1_33209;\n                            \n                            used1_33209 = (int8_t) 0;\n                            \n                            int8_t used2_33210;\n                            \n                            for (int32_t i_33211 = 0; i_33211 <\n                                 wave_sizze_33162; i_33211++) {\n                                flag2_33208 = ((__local\n                                                int8_t *) local_mem_33168)[sext_i32_i64(i_33211)];\n                                used2_33210 = lshr8(flag2_33208, (int8_t) 2);\n                                flag2_33208 = flag2_33208 & (int8_t) 3;\n                                x_33205 = ((__local\n                                            int64_t *) local_mem_33168)[squot64(warp_byte_offset_33166,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33211)];\n                                if (!(flag2_33208 == (int8_t) 1)) {\n                                    flag1_33207 = flag2_33208;\n                                    used1_33209 = used2_33210;\n                                    x_33204 = x_33205;\n                                } else {\n                                    used1_33209 += used2_33210;\n                                    \n                                    int64_t defunc_1_op_res_33206;\n                                    \n                                    defunc_1_op_res_33206 = add64(x_33204,\n                                                                  x_33205)",
            ";\n                                    x_33204 = defunc_1_op_res_33206;\n                                }\n                            }\n                            flag_33201 = flag1_33207;\n                            used_33202 = used1_33209;\n                            aggr_33200 = x_33204;\n                        } else {\n                            aggr_33200 = ((__local\n                                           int64_t *) local_mem_33168)[squot64(warp_byte_offset_33166,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33162) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33201 == (int8_t) 2) {\n                            readOffset_33198 = wave_sizze_33162 * -1;\n                        } else {\n                            readOffset_33198 -= zext_i8_i32(used_33202);\n                        }\n                        ((__local int32_t *) local_mem_33168)[(int64_t) 0] =\n                            readOffset_33198;\n                        \n                        int64_t x_33212;\n                        \n                        x_33212 = aggr_33200;\n                        \n                        int64_t x_33213;\n                        \n                        x_33213 = prefix_33196;\n                        \n                        int64_t defunc_1_op_res_33214;\n                        \n                        defunc_1_op_res_33214 = add64(x_33212, x_33213);\n                        prefix_33196 = defunc_1_op_res_33214;\n                    }\n                    mem_fence_local();\n                    readOffset_33198 = ((__local\n                                         int32_t *) local_mem_33168)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33160 == 0) {\n                int64_t x_33215 = prefix_33196",
            ";\n                int64_t x_33216 = acc_33189;\n                int64_t defunc_1_op_res_33217 = add64(x_33215, x_33216);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_33157)[dynamic_id_33176] =\n                    defunc_1_op_res_33217;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33153)[dynamic_id_33176] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_33168)[squot64(warp_byte_offset_33166,\n                                                      (int64_t) 8)] =\n                    prefix_33196;\n                acc_33189 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33176 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33196 = ((__local\n                             int64_t *) local_mem_33168)[squot64(warp_byte_offset_33166,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33218;\n        int64_t x_33219;\n        int64_t x_33221;\n        \n        x_33221 = prefix_33196;\n        \n        int64_t x_33222;\n        \n        x_33222 = acc_33189;\n        \n        int64_t defunc_1_op_res_33223;\n        \n        defunc_1_op_res_33223 = add64(x_33221, x_33222);\n        x_33218 = defunc_1_op_res_33223;\n        for (int64_t i_33224 = 0; i_33224 < (int64_t) 9; i_33224++) {\n            x_33219 = private_mem_33178[i_33224];\n            \n            int64_t defunc_1_op_res_33220;\n            \n            defunc_1_op_res_33220 = add64(x_33218, x_33219);\n            private_mem_33178[i_33224] = defunc_1_op_res_33220;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33225 = 0; i_33225 < (int64_t) 9; i_33225++) {\n            int64_t sharedIdx_33226 = sext_i32_i64(local_ti",
            "d_33160 * 9) +\n                    i_33225;\n            \n            ((__local int64_t *) local_mem_33168)[sharedIdx_33226] =\n                private_mem_33178[i_33225];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33227 = 0; i_33227 < (int64_t) 9; i_33227++) {\n            int32_t sharedIdx_33228 = local_tid_33160 +\n                    sext_i64_i32(segscan_group_sizze_30637 * i_33227);\n            \n            private_mem_33178[i_33227] = ((__local\n                                           int64_t *) local_mem_33168)[sext_i32_i64(sharedIdx_33228)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33229 = 0; i_33229 < (int64_t) 9; i_33229++) {\n            int64_t gtid_30641 = blockOff_33177 + segscan_group_sizze_30637 *\n                    i_33229 + sext_i32_i64(local_tid_33160);\n            \n            if (slt64(gtid_30641, numVert_28890)) {\n                ((__global int64_t *) mem_32093)[gtid_30641] =\n                    private_mem_33178[i_33229];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33176 == sdiv_up64(numVert_28890,\n                                          segscan_group_sizze_30637 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_33151)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30637\n}\n__kernel void test_clusterWithzisegscan_30675(__global int *global_failure,\n                                              uint local_mem_33426_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29171,\n                                              __global unsigned char *mem_32102,\n                                              __global unsigned char *mem_32106,\n                          ",
            "                    __global unsigned char *mem_32108,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_33403,\n                                              __global\n                                              unsigned char *status_flags_mem_33405,\n                                              __global\n                                              unsigned char *aggregates_mem_33407,\n                                              __global\n                                              unsigned char *incprefixes_mem_33409,\n                                              __global\n                                              unsigned char *aggregates_mem_33411,\n                                              __global\n                                              unsigned char *incprefixes_mem_33413)\n{\n    #define segscan_group_sizze_30670 (test_clusterWithzisegscan_group_sizze_30669)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33426_backing_0 =\n                  &shared_mem[local_mem_33426_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33415;\n    int32_t local_tid_33416;\n    int64_t group_sizze_33419;\n    int32_t wave_sizze_33418;\n    int32_t group_tid_33417;\n    \n    global_tid_33415 = get_global_id(0);\n    local_tid_33416 = get_local_id(0);\n    group_sizze_33419 = get_local_size(0);\n    wave_sizze_33418 = LOCKSTEP_WIDTH;\n    group_tid_33417 = get_group_id(0);\n    \n    int32_t phys_tid_30675;\n    \n    phys_tid_30675 = global_tid_33415;\n    \n    int64_t byte_offsets_33420;\n    \n    byte_offsets_33420 = (int64_t) 0;\n    \n    int64_t byte_offsets_33421;\n    \n    byte_offsets_33421 = segscan_group_sizze_30670;\n    \n    int64_t byte_offsets_33422;\n    \n    byte_offsets_33422 = sdiv_up64(segscan_group_sizze_30670, (int64_t) 8) *\n        (int64_t) 8 +",
            " segscan_group_sizze_30670 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33423;\n    \n    warp_byte_offset_33423 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33424;\n    \n    warp_byte_offset_33424 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_33425;\n    \n    warp_byte_offset_33425 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33426;\n    \n    local_mem_33426 = (__local char *) local_mem_33426_backing_0;\n    \n    int64_t trans_arr_len_33427;\n    \n    trans_arr_len_33427 = (int64_t) 9 * segscan_group_sizze_30670;\n    \n    int32_t dynamic_id_33437;\n    \n    if (local_tid_33416 == 0) {\n        dynamic_id_33437 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_33403)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33426)[(int64_t) 0] = dynamic_id_33437;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33437 = ((__local int32_t *) local_mem_33426)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33438;\n    \n    blockOff_33438 = sext_i32_i64(dynamic_id_33437) * (int64_t) 9 *\n        segscan_group_sizze_30670;\n    \n    bool private_mem_33439[9];\n    int64_t private_mem_33441[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33443 = 0; i_33443 < (int64_t) 9; i_33443++) {\n            int64_t gtid_30674 = blockOff_33438 +\n                    sext_i32_i64(local_tid_33416) + i_33443 *\n                    segscan_group_sizze_30670;\n            \n            if (slt64(gtid_30674, defunc_2_reduce_res_29171)) {\n                int64_t x_29197 = ((__global int64_t *) mem_32102)[gtid_30674];\n                bool defunc_0_f_res_29198 = slt64((int64_t) 0, x_29197);\n                \n                private_mem_33439[i_33443] = defunc_0_f_res_29198;\n                private_mem_33441[i_33443] = x_29197;\n            } else {\n                priva",
            "te_mem_33439[i_33443] = 0;\n                private_mem_33441[i_33443] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33444 = 0; i_33444 < (int64_t) 9; i_33444++) {\n            int64_t sharedIdx_33445 = sext_i32_i64(local_tid_33416) + i_33444 *\n                    segscan_group_sizze_30670;\n            \n            ((__local bool *) local_mem_33426)[sharedIdx_33445] =\n                private_mem_33439[i_33444];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33446 = 0; i_33446 < 9; i_33446++) {\n            int32_t sharedIdx_33447 = local_tid_33416 * 9 + i_33446;\n            \n            private_mem_33439[sext_i32_i64(i_33446)] = ((__local\n                                                         bool *) local_mem_33426)[sext_i32_i64(sharedIdx_33447)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33448 = 0; i_33448 < (int64_t) 9; i_33448++) {\n            int64_t sharedIdx_33449 = sext_i32_i64(local_tid_33416) + i_33448 *\n                    segscan_group_sizze_30670;\n            \n            ((__local int64_t *) local_mem_33426)[sharedIdx_33449] =\n                private_mem_33441[i_33448];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33450 = 0; i_33450 < 9; i_33450++) {\n            int32_t sharedIdx_33451 = local_tid_33416 * 9 + i_33450;\n            \n            private_mem_33441[sext_i32_i64(i_33450)] = ((__local\n                                                         int64_t *) local_mem_33426)[sext_i32_i64(sharedIdx_33451)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33452 = 0; i_33452 < (int64_t) 8; i_33452++) {\n            bool x_29190;\n            bool x_29192;\n            \n            x_29190 = private_mem_33439[i_33452];\n            x_29192 = private_mem_33439[i_33452 + (int64_t) 1];\n            \n            int64_t x_29191;\n      ",
            "      int64_t x_29193;\n            \n            x_29191 = private_mem_33441[i_33452];\n            x_29193 = private_mem_33441[i_33452 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29194;\n            \n            defunc_1_op_res_29194 = x_29190 || x_29192;\n            \n            int64_t defunc_1_op_res_29195;\n            \n            if (x_29192) {\n                defunc_1_op_res_29195 = x_29193;\n            } else {\n                int64_t defunc_1_op_res_29196 = add64(x_29191, x_29193);\n                \n                defunc_1_op_res_29195 = defunc_1_op_res_29196;\n            }\n            private_mem_33439[i_33452 + (int64_t) 1] = defunc_1_op_res_29194;\n            private_mem_33441[i_33452 + (int64_t) 1] = defunc_1_op_res_29195;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_33426)[byte_offsets_33420 +\n                                           sext_i32_i64(local_tid_33416)] =\n            private_mem_33439[(int64_t) 8];\n        ((__local int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33416)] =\n            private_mem_33441[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_33460;\n    int64_t acc_33461;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_33453;\n        int64_t x_33454;\n        bool x_33455;\n        int64_t x_33456;\n        bool x_33462;\n        int64_t x_33463;\n        bool x_33464;\n        int64_t x_33465;\n        bool ltid_in_bounds_33469;\n        \n        ltid_in_bounds_33469 = slt64(sext_i32_i64(local_tid_33416),\n                                     segscan_group_sizze_30670);\n        \n        int32_t skip_threads_33470;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33469) {\n                x_33455 = ((volatile __local\n                            bool ",
            "*) local_mem_33426)[byte_offsets_33420 +\n                                                     sext_i32_i64(local_tid_33416)];\n                x_33456 = ((volatile __local\n                            int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33416)];\n                if ((local_tid_33416 - squot32(local_tid_33416, 32) * 32) ==\n                    0) {\n                    x_33453 = x_33455;\n                    x_33454 = x_33456;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33470 = 1;\n            while (slt32(skip_threads_33470, 32)) {\n                if (sle32(skip_threads_33470, local_tid_33416 -\n                          squot32(local_tid_33416, 32) * 32) &&\n                    ltid_in_bounds_33469) {\n                    // read operands\n                    {\n                        x_33453 = ((volatile __local\n                                    bool *) local_mem_33426)[byte_offsets_33420 +\n                                                             (sext_i32_i64(local_tid_33416) -\n                                                              sext_i32_i64(skip_threads_33470))];\n                        x_33454 = ((volatile __local\n                                    int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33416) -\n                                                                 sext_i32_i64(skip_threads_33470))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_33457 = x_33453 || x_33455;\n                        int64_t defunc_1_op_res_33458;\n ",
            "                       \n                        if (x_33455) {\n                            defunc_1_op_res_33458 = x_33456;\n                        } else {\n                            int64_t defunc_1_op_res_33459 = add64(x_33454,\n                                                                  x_33456);\n                            \n                            defunc_1_op_res_33458 = defunc_1_op_res_33459;\n                        }\n                        x_33453 = defunc_1_op_res_33457;\n                        x_33454 = defunc_1_op_res_33458;\n                    }\n                }\n                if (sle32(wave_sizze_33418, skip_threads_33470)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33470, local_tid_33416 -\n                          squot32(local_tid_33416, 32) * 32) &&\n                    ltid_in_bounds_33469) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_33426)[byte_offsets_33420 +\n                                                   sext_i32_i64(local_tid_33416)] =\n                            x_33453;\n                        x_33455 = x_33453;\n                        ((volatile __local\n                          int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33416)] =\n                            x_33454;\n                        x_33456 = x_33454;\n                    }\n                }\n                if (sle32(wave_sizze_33418, skip_threads_33470)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33470 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33416 - squo",
            "t32(local_tid_33416, 32) * 32) == 31 &&\n                ltid_in_bounds_33469) {\n                ((volatile __local bool *) local_mem_33426)[byte_offsets_33420 +\n                                                            sext_i32_i64(squot32(local_tid_33416,\n                                                                                 32))] =\n                    x_33453;\n                ((volatile __local\n                  int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33416,\n                                                                   32))] =\n                    x_33454;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33471;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33416, 32) == 0 && ltid_in_bounds_33469) {\n                    x_33464 = ((volatile __local\n                                bool *) local_mem_33426)[byte_offsets_33420 +\n                                                         sext_i32_i64(local_tid_33416)];\n                    x_33465 = ((volatile __local\n                                int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33416)];\n                    if ((local_tid_33416 - squot32(local_tid_33416, 32) * 32) ==\n                        0) {\n                        x_33462 = x_33464;\n                        x_33463 = x_33465;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33471 = 1;\n           ",
            "     while (slt32(skip_threads_33471, 32)) {\n                    if (sle32(skip_threads_33471, local_tid_33416 -\n                              squot32(local_tid_33416, 32) * 32) &&\n                        (squot32(local_tid_33416, 32) == 0 &&\n                         ltid_in_bounds_33469)) {\n                        // read operands\n                        {\n                            x_33462 = ((volatile __local\n                                        bool *) local_mem_33426)[byte_offsets_33420 +\n                                                                 (sext_i32_i64(local_tid_33416) -\n                                                                  sext_i32_i64(skip_threads_33471))];\n                            x_33463 = ((volatile __local\n                                        int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33416) -\n                                                                     sext_i32_i64(skip_threads_33471))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_33466 = x_33462 || x_33464;\n                            int64_t defunc_1_op_res_33467;\n                            \n                            if (x_33464) {\n                                defunc_1_op_res_33467 = x_33465;\n                            } else {\n                                int64_t defunc_1_op_res_33468 = add64(x_33463,\n                                                                      x_33465);\n                                \n                                defunc_1_op_res_33467 = defunc_1_op_res_33468;\n                            }\n                            x_33462 = defunc_1_op_res_33466;\n                            x_33463 = defunc_1_op_res_33467;\n                 ",
            "       }\n                    }\n                    if (sle32(wave_sizze_33418, skip_threads_33471)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33471, local_tid_33416 -\n                              squot32(local_tid_33416, 32) * 32) &&\n                        (squot32(local_tid_33416, 32) == 0 &&\n                         ltid_in_bounds_33469)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_33426)[byte_offsets_33420 +\n                                                       sext_i32_i64(local_tid_33416)] =\n                                x_33462;\n                            x_33464 = x_33462;\n                            ((volatile __local\n                              int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33416)] =\n                                x_33463;\n                            x_33465 = x_33463;\n                        }\n                    }\n                    if (sle32(wave_sizze_33418, skip_threads_33471)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33471 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33416, 32) == 0 || !ltid_in_bounds_33469)) {\n                // read operands\n                {\n                    x_33455 = x_33453;\n                    x_33456 = x_33454;\n                    x_33453 = ((__local\n                                bool *) local_mem_33426)[byte_offsets_33420 +\n                                                         (sext_i32_i64(squot32(local_tid_33416,\n         ",
            "                                                                      32)) -\n                                                          (int64_t) 1)];\n                    x_33454 = ((__local\n                                int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33416,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_33457 = x_33453 || x_33455;\n                    int64_t defunc_1_op_res_33458;\n                    \n                    if (x_33455) {\n                        defunc_1_op_res_33458 = x_33456;\n                    } else {\n                        int64_t defunc_1_op_res_33459 = add64(x_33454, x_33456);\n                        \n                        defunc_1_op_res_33458 = defunc_1_op_res_33459;\n                    }\n                    x_33453 = defunc_1_op_res_33457;\n                    x_33454 = defunc_1_op_res_33458;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_33426)[byte_offsets_33420 +\n                                                       sext_i32_i64(local_tid_33416)] =\n                        x_33453;\n                    ((__local\n                      int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33416)] =\n                        x_33454;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(loc",
            "al_tid_33416, 32) == 0) {\n                ((__local bool *) local_mem_33426)[byte_offsets_33420 +\n                                                   sext_i32_i64(local_tid_33416)] =\n                    x_33455;\n                ((__local\n                  int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33416)] =\n                    x_33456;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33416 == 0) {\n            acc_33460 = ((__local bool *) local_mem_33426)[byte_offsets_33420 +\n                                                           (segscan_group_sizze_30670 -\n                                                            (int64_t) 1)];\n            acc_33461 = ((__local\n                          int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30670 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33460 = ((__local bool *) local_mem_33426)[byte_offsets_33420 +\n                                                           (sext_i32_i64(local_tid_33416) -\n                                                            (int64_t) 1)];\n            acc_33461 = ((__local\n                          int64_t *) local_mem_33426)[squot64(byte_offsets_33421,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33416) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_33472;\n    \n    prefix_33472 = 0;\n    \n    int64_t prefix_33473;\n    \n    prefix_33473 = (int64_t)",
            " 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33437 == (int64_t) 0 && local_tid_33416 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_33409)[dynamic_id_33437] = acc_33460;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33413)[dynamic_id_33437] = acc_33461;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33405)[dynamic_id_33437] = (int8_t) 2;\n            acc_33460 = 0;\n            acc_33461 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33437 == (int64_t) 0) && slt32(local_tid_33416,\n                                                        wave_sizze_33418)) {\n            if (local_tid_33416 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_33407)[dynamic_id_33437] = acc_33460;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33411)[dynamic_id_33437] =\n                    acc_33461;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33405)[dynamic_id_33437] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33426)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33405)[dynamic_id_33437 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33474;\n            \n            status_33474 = ((__local int8_t *) local_mem_33426)[(int64_t) 0];\n            if (status_33474 == (int8_t) 2) {\n                if (local_tid_33416 == 0) {\n                    prefix_33472 = ((volatile __global\n                                     bool *) incprefixes_mem_33409)[dynamic_id_33437 -\n                                                                    (int64_t) 1];\n                    pre",
            "fix_33473 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33413)[dynamic_id_33437 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33475 = dynamic_id_33437 -\n                        sext_i32_i64(wave_sizze_33418);\n                \n                while (slt32(wave_sizze_33418 * -1, readOffset_33475)) {\n                    int32_t read_i_33476 = readOffset_33475 + local_tid_33416;\n                    bool aggr_33477 = 0;\n                    int64_t aggr_33478 = (int64_t) 0;\n                    int8_t flag_33479 = (int8_t) 0;\n                    int8_t used_33480 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33476)) {\n                        flag_33479 = ((volatile __global\n                                       int8_t *) status_flags_mem_33405)[sext_i32_i64(read_i_33476)];\n                        if (flag_33479 == (int8_t) 2) {\n                            aggr_33477 = ((volatile __global\n                                           bool *) incprefixes_mem_33409)[sext_i32_i64(read_i_33476)];\n                            aggr_33478 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33413)[sext_i32_i64(read_i_33476)];\n                        } else {\n                            if (flag_33479 == (int8_t) 1) {\n                                aggr_33477 = ((volatile __global\n                                               bool *) aggregates_mem_33407)[sext_i32_i64(read_i_33476)];\n                                aggr_33478 = ((volatile __global\n                                               int64_t *) aggregates_mem_33411)[sext_i32_i64(read_i_33476)];\n                                used_33480 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_33426)[warp_byte_offset_33423 ",
            "+\n                                                       sext_i32_i64(local_tid_33416)] =\n                        aggr_33477;\n                    ((__local\n                      int64_t *) local_mem_33426)[squot64(warp_byte_offset_33424,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33416)] =\n                        aggr_33478;\n                    \n                    int8_t tmp_33481;\n                    \n                    tmp_33481 = flag_33479 | used_33480 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33426)[sext_i32_i64(local_tid_33416)] =\n                        tmp_33481;\n                    mem_fence_local();\n                    flag_33479 = ((volatile __local\n                                   int8_t *) local_mem_33426)[sext_i32_i64(wave_sizze_33418) -\n                                                              (int64_t) 1];\n                    if (local_tid_33416 == 0) {\n                        if (!(flag_33479 == (int8_t) 2)) {\n                            bool x_33482 = 0;\n                            int64_t x_33483 = (int64_t) 0;\n                            bool x_33484;\n                            int64_t x_33485;\n                            int8_t flag1_33489;\n                            \n                            flag1_33489 = (int8_t) 0;\n                            \n                            int8_t flag2_33490;\n                            int8_t used1_33491;\n                            \n                            used1_33491 = (int8_t) 0;\n                            \n                            int8_t used2_33492;\n                            \n                            for (int32_t i_33493 = 0; i_33493 <\n                                 wave_sizze_33418; i_33493++) {\n                                flag2_33490 = ((__local\n                                                int8_t *) local_mem_33426)[sext_i3",
            "2_i64(i_33493)];\n                                used2_33492 = lshr8(flag2_33490, (int8_t) 2);\n                                flag2_33490 = flag2_33490 & (int8_t) 3;\n                                x_33484 = ((__local\n                                            bool *) local_mem_33426)[warp_byte_offset_33423 +\n                                                                     sext_i32_i64(i_33493)];\n                                x_33485 = ((__local\n                                            int64_t *) local_mem_33426)[squot64(warp_byte_offset_33424,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33493)];\n                                if (!(flag2_33490 == (int8_t) 1)) {\n                                    flag1_33489 = flag2_33490;\n                                    used1_33491 = used2_33492;\n                                    x_33482 = x_33484;\n                                    x_33483 = x_33485;\n                                } else {\n                                    used1_33491 += used2_33492;\n                                    \n                                    bool defunc_1_op_res_33486;\n                                    \n                                    defunc_1_op_res_33486 = x_33482 || x_33484;\n                                    \n                                    int64_t defunc_1_op_res_33487;\n                                    \n                                    if (x_33484) {\n                                        defunc_1_op_res_33487 = x_33485;\n                                    } else {\n                                        int64_t defunc_1_op_res_33488 =\n                                                add64(x_33483, x_33485);\n                                        \n                                        defunc_1_op_res_33487 =\n                                            defunc_1_op_res_",
            "33488;\n                                    }\n                                    x_33482 = defunc_1_op_res_33486;\n                                    x_33483 = defunc_1_op_res_33487;\n                                }\n                            }\n                            flag_33479 = flag1_33489;\n                            used_33480 = used1_33491;\n                            aggr_33477 = x_33482;\n                            aggr_33478 = x_33483;\n                        } else {\n                            aggr_33477 = ((__local\n                                           bool *) local_mem_33426)[warp_byte_offset_33423 +\n                                                                    (sext_i32_i64(wave_sizze_33418) -\n                                                                     (int64_t) 1)];\n                            aggr_33478 = ((__local\n                                           int64_t *) local_mem_33426)[squot64(warp_byte_offset_33424,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33418) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33479 == (int8_t) 2) {\n                            readOffset_33475 = wave_sizze_33418 * -1;\n                        } else {\n                            readOffset_33475 -= zext_i8_i32(used_33480);\n                        }\n                        ((__local int32_t *) local_mem_33426)[(int64_t) 0] =\n                            readOffset_33475;\n                        \n                        bool x_33494;\n                        \n                        x_33494 = aggr_33477;\n                        \n                        int64_t x_33495;\n                        \n                        x_33495 = aggr_33478;\n                        \n                        bool x_33496;\n ",
            "                       \n                        x_33496 = prefix_33472;\n                        \n                        int64_t x_33497;\n                        \n                        x_33497 = prefix_33473;\n                        \n                        bool defunc_1_op_res_33498;\n                        \n                        defunc_1_op_res_33498 = x_33494 || x_33496;\n                        \n                        int64_t defunc_1_op_res_33499;\n                        \n                        if (x_33496) {\n                            defunc_1_op_res_33499 = x_33497;\n                        } else {\n                            int64_t defunc_1_op_res_33500 = add64(x_33495,\n                                                                  x_33497);\n                            \n                            defunc_1_op_res_33499 = defunc_1_op_res_33500;\n                        }\n                        prefix_33472 = defunc_1_op_res_33498;\n                        prefix_33473 = defunc_1_op_res_33499;\n                    }\n                    mem_fence_local();\n                    readOffset_33475 = ((__local\n                                         int32_t *) local_mem_33426)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33416 == 0) {\n                bool x_33501 = prefix_33472;\n                int64_t x_33502 = prefix_33473;\n                bool x_33503 = acc_33460;\n                int64_t x_33504 = acc_33461;\n                bool defunc_1_op_res_33505 = x_33501 || x_33503;\n                int64_t defunc_1_op_res_33506;\n                \n                if (x_33503) {\n                    defunc_1_op_res_33506 = x_33504;\n                } else {\n                    int64_t defunc_1_op_res_33507 = add64(x_33502, x_33504);\n                    \n                    defunc_1_op_res_33506 = defunc_1_op_res_33507;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_33409)[dynamic_id_33437] =\n     ",
            "               defunc_1_op_res_33505;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33413)[dynamic_id_33437] =\n                    defunc_1_op_res_33506;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33405)[dynamic_id_33437] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_33426)[warp_byte_offset_33423] =\n                    prefix_33472;\n                ((__local\n                  int64_t *) local_mem_33426)[squot64(warp_byte_offset_33424,\n                                                      (int64_t) 8)] =\n                    prefix_33473;\n                acc_33460 = 0;\n                acc_33461 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33437 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33472 = ((__local\n                             bool *) local_mem_33426)[warp_byte_offset_33423];\n            prefix_33473 = ((__local\n                             int64_t *) local_mem_33426)[squot64(warp_byte_offset_33424,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_33508;\n        bool x_33510;\n        bool x_33515;\n        \n        x_33515 = prefix_33472;\n        \n        bool x_33517;\n        \n        x_33517 = acc_33460;\n        \n        int64_t x_33509;\n        int64_t x_33511;\n        int64_t x_33516;\n        \n        x_33516 = prefix_33473;\n        \n        int64_t x_33518;\n        \n        x_33518 = acc_33461;\n        \n        bool defunc_1_op_res_33519;\n        \n        defunc_1_op_res_33519 = x_33515 || x_33517;\n        \n        int64_t defunc_1_op_res_33520;\n        \n        if (x_33517) {\n            defunc_1_op_res_33520 = x_33518;\n        } else {\n            int64_t defunc_1_op_res_33521 = add64(x_33516, x_33518);\n            \n            d",
            "efunc_1_op_res_33520 = defunc_1_op_res_33521;\n        }\n        x_33508 = defunc_1_op_res_33519;\n        x_33509 = defunc_1_op_res_33520;\n        for (int64_t i_33522 = 0; i_33522 < (int64_t) 9; i_33522++) {\n            x_33510 = private_mem_33439[i_33522];\n            x_33511 = private_mem_33441[i_33522];\n            \n            bool defunc_1_op_res_33512;\n            \n            defunc_1_op_res_33512 = x_33508 || x_33510;\n            \n            int64_t defunc_1_op_res_33513;\n            \n            if (x_33510) {\n                defunc_1_op_res_33513 = x_33511;\n            } else {\n                int64_t defunc_1_op_res_33514 = add64(x_33509, x_33511);\n                \n                defunc_1_op_res_33513 = defunc_1_op_res_33514;\n            }\n            private_mem_33439[i_33522] = defunc_1_op_res_33512;\n            private_mem_33441[i_33522] = defunc_1_op_res_33513;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33523 = 0; i_33523 < (int64_t) 9; i_33523++) {\n            int64_t sharedIdx_33524 = sext_i32_i64(local_tid_33416 * 9) +\n                    i_33523;\n            \n            ((__local bool *) local_mem_33426)[sharedIdx_33524] =\n                private_mem_33439[i_33523];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33525 = 0; i_33525 < (int64_t) 9; i_33525++) {\n            int32_t sharedIdx_33526 = local_tid_33416 +\n                    sext_i64_i32(segscan_group_sizze_30670 * i_33525);\n            \n            private_mem_33439[i_33525] = ((__local\n                                           bool *) local_mem_33426)[sext_i32_i64(sharedIdx_33526)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33527 = 0; i_33527 < (int64_t) 9; i_33527++) {\n            int64_t sharedIdx_33528 = sext_i32_i64(local_tid_33416 * 9) +\n                    i_33527;\n            \n            ((__local int64_t *) local_mem_33426)[sharedIdx_33528] =\n            ",
            "    private_mem_33441[i_33527];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33529 = 0; i_33529 < (int64_t) 9; i_33529++) {\n            int32_t sharedIdx_33530 = local_tid_33416 +\n                    sext_i64_i32(segscan_group_sizze_30670 * i_33529);\n            \n            private_mem_33441[i_33529] = ((__local\n                                           int64_t *) local_mem_33426)[sext_i32_i64(sharedIdx_33530)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33531 = 0; i_33531 < (int64_t) 9; i_33531++) {\n            int64_t gtid_30674 = blockOff_33438 + segscan_group_sizze_30670 *\n                    i_33531 + sext_i32_i64(local_tid_33416);\n            \n            if (slt64(gtid_30674, defunc_2_reduce_res_29171)) {\n                ((__global bool *) mem_32106)[gtid_30674] =\n                    private_mem_33439[i_33531];\n            }\n        }\n        for (int64_t i_33532 = 0; i_33532 < (int64_t) 9; i_33532++) {\n            int64_t gtid_30674 = blockOff_33438 + segscan_group_sizze_30670 *\n                    i_33532 + sext_i32_i64(local_tid_33416);\n            \n            if (slt64(gtid_30674, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32108)[gtid_30674] =\n                    private_mem_33441[i_33532];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33437 == sdiv_up64(defunc_2_reduce_res_29171,\n                                          segscan_group_sizze_30670 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_33403)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30670\n}\n__kernel void test_clusterWithzisegscan_30683(__global int *global_failure,\n                                              uint",
            " local_mem_33559_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29171,\n                                              __global unsigned char *mem_32108,\n                                              __global unsigned char *mem_32111,\n                                              __global unsigned char *mem_32113,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_33536,\n                                              __global\n                                              unsigned char *status_flags_mem_33538,\n                                              __global\n                                              unsigned char *aggregates_mem_33540,\n                                              __global\n                                              unsigned char *incprefixes_mem_33542,\n                                              __global\n                                              unsigned char *aggregates_mem_33544,\n                                              __global\n                                              unsigned char *incprefixes_mem_33546)\n{\n    #define segscan_group_sizze_30678 (test_clusterWithzisegscan_group_sizze_30677)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33559_backing_0 =\n                  &shared_mem[local_mem_33559_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33548;\n    int32_t local_tid_33549;\n    int64_t group_sizze_33552;\n    int32_t wave_sizze_33551;\n    int32_t group_tid_33550;\n    \n    global_tid_33548 = get_global_id(0);\n    local_tid_33549 = get_local_id(0);\n    group_sizze_33552 = get_local_size(0);\n    wave_sizze_33551 = LOCKSTEP_WIDTH;\n    group_tid_33550 = get_group_id(0);\n    \n    int32_t phys_tid_30683;\n    \n    phys_tid_30683 = global_tid_33548;\n    \n    i",
            "nt64_t byte_offsets_33553;\n    \n    byte_offsets_33553 = (int64_t) 0;\n    \n    int64_t byte_offsets_33554;\n    \n    byte_offsets_33554 = segscan_group_sizze_30678;\n    \n    int64_t byte_offsets_33555;\n    \n    byte_offsets_33555 = sdiv_up64(segscan_group_sizze_30678, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30678 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33556;\n    \n    warp_byte_offset_33556 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33557;\n    \n    warp_byte_offset_33557 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_33558;\n    \n    warp_byte_offset_33558 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33559;\n    \n    local_mem_33559 = (__local char *) local_mem_33559_backing_0;\n    \n    int64_t trans_arr_len_33560;\n    \n    trans_arr_len_33560 = (int64_t) 9 * segscan_group_sizze_30678;\n    \n    int32_t dynamic_id_33570;\n    \n    if (local_tid_33549 == 0) {\n        dynamic_id_33570 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_33536)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33559)[(int64_t) 0] = dynamic_id_33570;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33570 = ((__local int32_t *) local_mem_33559)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33571;\n    \n    blockOff_33571 = sext_i32_i64(dynamic_id_33570) * (int64_t) 9 *\n        segscan_group_sizze_30678;\n    \n    bool private_mem_33572[9];\n    int64_t private_mem_33574[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33576 = 0; i_33576 < (int64_t) 9; i_33576++) {\n            int64_t gtid_30682 = blockOff_33571 +\n                    sext_i32_i64(local_tid_33549) + i_33576 *\n                    segscan_group_sizze_30678;\n            \n            if (slt64(gtid_30682, defunc_2_reduce_res_29171)) {\n                int64_t x_292",
            "21 = ((__global int64_t *) mem_32108)[gtid_30682];\n                int64_t i_p_o_31868 = add64((int64_t) -1, gtid_30682);\n                int64_t rot_i_31869 = smod64(i_p_o_31868,\n                                             defunc_2_reduce_res_29171);\n                int64_t x_29222 = ((__global int64_t *) mem_32108)[rot_i_31869];\n                bool defunc_1_f_res_29224 = x_29221 == x_29222;\n                bool defunc_1_f_res_29225 = !defunc_1_f_res_29224;\n                \n                private_mem_33572[i_33576] = defunc_1_f_res_29225;\n                private_mem_33574[i_33576] = (int64_t) 1;\n            } else {\n                private_mem_33572[i_33576] = 0;\n                private_mem_33574[i_33576] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33577 = 0; i_33577 < (int64_t) 9; i_33577++) {\n            int64_t sharedIdx_33578 = sext_i32_i64(local_tid_33549) + i_33577 *\n                    segscan_group_sizze_30678;\n            \n            ((__local bool *) local_mem_33559)[sharedIdx_33578] =\n                private_mem_33572[i_33577];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33579 = 0; i_33579 < 9; i_33579++) {\n            int32_t sharedIdx_33580 = local_tid_33549 * 9 + i_33579;\n            \n            private_mem_33572[sext_i32_i64(i_33579)] = ((__local\n                                                         bool *) local_mem_33559)[sext_i32_i64(sharedIdx_33580)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33581 = 0; i_33581 < (int64_t) 9; i_33581++) {\n            int64_t sharedIdx_33582 = sext_i32_i64(local_tid_33549) + i_33581 *\n                    segscan_group_sizze_30678;\n            \n            ((__local int64_t *) local_mem_33559)[sharedIdx_33582] =\n                private_mem_33574[i_33581];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33583 = 0; i_33583 < 9; i_33583+",
            "+) {\n            int32_t sharedIdx_33584 = local_tid_33549 * 9 + i_33583;\n            \n            private_mem_33574[sext_i32_i64(i_33583)] = ((__local\n                                                         int64_t *) local_mem_33559)[sext_i32_i64(sharedIdx_33584)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33585 = 0; i_33585 < (int64_t) 8; i_33585++) {\n            bool x_29214;\n            bool x_29216;\n            \n            x_29214 = private_mem_33572[i_33585];\n            x_29216 = private_mem_33572[i_33585 + (int64_t) 1];\n            \n            int64_t x_29215;\n            int64_t x_29217;\n            \n            x_29215 = private_mem_33574[i_33585];\n            x_29217 = private_mem_33574[i_33585 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29218;\n            \n            defunc_1_op_res_29218 = x_29214 || x_29216;\n            \n            int64_t defunc_1_op_res_29219;\n            \n            if (x_29216) {\n                defunc_1_op_res_29219 = x_29217;\n            } else {\n                int64_t defunc_1_op_res_29220 = add64(x_29215, x_29217);\n                \n                defunc_1_op_res_29219 = defunc_1_op_res_29220;\n            }\n            private_mem_33572[i_33585 + (int64_t) 1] = defunc_1_op_res_29218;\n            private_mem_33574[i_33585 + (int64_t) 1] = defunc_1_op_res_29219;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_33559)[byte_offsets_33553 +\n                                           sext_i32_i64(local_tid_33549)] =\n            private_mem_33572[(int64_t) 8];\n        ((__local int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33549)] =\n            private_mem_33574[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_33593;\n    int64",
            "_t acc_33594;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_33586;\n        int64_t x_33587;\n        bool x_33588;\n        int64_t x_33589;\n        bool x_33595;\n        int64_t x_33596;\n        bool x_33597;\n        int64_t x_33598;\n        bool ltid_in_bounds_33602;\n        \n        ltid_in_bounds_33602 = slt64(sext_i32_i64(local_tid_33549),\n                                     segscan_group_sizze_30678);\n        \n        int32_t skip_threads_33603;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33602) {\n                x_33588 = ((volatile __local\n                            bool *) local_mem_33559)[byte_offsets_33553 +\n                                                     sext_i32_i64(local_tid_33549)];\n                x_33589 = ((volatile __local\n                            int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33549)];\n                if ((local_tid_33549 - squot32(local_tid_33549, 32) * 32) ==\n                    0) {\n                    x_33586 = x_33588;\n                    x_33587 = x_33589;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33603 = 1;\n            while (slt32(skip_threads_33603, 32)) {\n                if (sle32(skip_threads_33603, local_tid_33549 -\n                          squot32(local_tid_33549, 32) * 32) &&\n                    ltid_in_bounds_33602) {\n                    // read operands\n                    {\n                        x_33586 = ((volatile __local\n                                    bool *) local_mem_33559)[byte_offsets_33553 +\n                                                             (sext_i32_i64(local_tid_33549) -\n                                                              sext_i32_i64(skip_threads_33603",
            "))];\n                        x_33587 = ((volatile __local\n                                    int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33549) -\n                                                                 sext_i32_i64(skip_threads_33603))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_33590 = x_33586 || x_33588;\n                        int64_t defunc_1_op_res_33591;\n                        \n                        if (x_33588) {\n                            defunc_1_op_res_33591 = x_33589;\n                        } else {\n                            int64_t defunc_1_op_res_33592 = add64(x_33587,\n                                                                  x_33589);\n                            \n                            defunc_1_op_res_33591 = defunc_1_op_res_33592;\n                        }\n                        x_33586 = defunc_1_op_res_33590;\n                        x_33587 = defunc_1_op_res_33591;\n                    }\n                }\n                if (sle32(wave_sizze_33551, skip_threads_33603)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33603, local_tid_33549 -\n                          squot32(local_tid_33549, 32) * 32) &&\n                    ltid_in_bounds_33602) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_33559)[byte_offsets_33553 +\n                                                   sext_i32_i64(local_tid_33549)] =\n                            x_33586;\n                        x_33588 = x_33586;\n                        ((volatile __local\n                          int64_t *) local_mem_33559)[squot64(byte_offse",
            "ts_33554,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33549)] =\n                            x_33587;\n                        x_33589 = x_33587;\n                    }\n                }\n                if (sle32(wave_sizze_33551, skip_threads_33603)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33603 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33549 - squot32(local_tid_33549, 32) * 32) == 31 &&\n                ltid_in_bounds_33602) {\n                ((volatile __local bool *) local_mem_33559)[byte_offsets_33553 +\n                                                            sext_i32_i64(squot32(local_tid_33549,\n                                                                                 32))] =\n                    x_33586;\n                ((volatile __local\n                  int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33549,\n                                                                   32))] =\n                    x_33587;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33604;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33549, 32) == 0 && ltid_in_bounds_33602) {\n                    x_33597 = ((volatile __local\n                                bool *) local_mem_33559)[byte_offsets_33553 +\n                                                         sext_i32_i64(local_tid_33549)];\n                    x_33598 = ((volati",
            "le __local\n                                int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33549)];\n                    if ((local_tid_33549 - squot32(local_tid_33549, 32) * 32) ==\n                        0) {\n                        x_33595 = x_33597;\n                        x_33596 = x_33598;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33604 = 1;\n                while (slt32(skip_threads_33604, 32)) {\n                    if (sle32(skip_threads_33604, local_tid_33549 -\n                              squot32(local_tid_33549, 32) * 32) &&\n                        (squot32(local_tid_33549, 32) == 0 &&\n                         ltid_in_bounds_33602)) {\n                        // read operands\n                        {\n                            x_33595 = ((volatile __local\n                                        bool *) local_mem_33559)[byte_offsets_33553 +\n                                                                 (sext_i32_i64(local_tid_33549) -\n                                                                  sext_i32_i64(skip_threads_33604))];\n                            x_33596 = ((volatile __local\n                                        int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33549) -\n                                                                     sext_i32_i64(skip_threads_33604))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_33599 = x_33595 || x_33597;\n                        ",
            "    int64_t defunc_1_op_res_33600;\n                            \n                            if (x_33597) {\n                                defunc_1_op_res_33600 = x_33598;\n                            } else {\n                                int64_t defunc_1_op_res_33601 = add64(x_33596,\n                                                                      x_33598);\n                                \n                                defunc_1_op_res_33600 = defunc_1_op_res_33601;\n                            }\n                            x_33595 = defunc_1_op_res_33599;\n                            x_33596 = defunc_1_op_res_33600;\n                        }\n                    }\n                    if (sle32(wave_sizze_33551, skip_threads_33604)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33604, local_tid_33549 -\n                              squot32(local_tid_33549, 32) * 32) &&\n                        (squot32(local_tid_33549, 32) == 0 &&\n                         ltid_in_bounds_33602)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_33559)[byte_offsets_33553 +\n                                                       sext_i32_i64(local_tid_33549)] =\n                                x_33595;\n                            x_33597 = x_33595;\n                            ((volatile __local\n                              int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33549)] =\n                                x_33596;\n                            x_33598 = x_33596;\n                        }\n                    }\n                    if (sle32(wave_sizze_33551, skip_threads_33604)) {\n                        barrier(CLK_LOCAL_MEM_FE",
            "NCE);\n                    }\n                    skip_threads_33604 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33549, 32) == 0 || !ltid_in_bounds_33602)) {\n                // read operands\n                {\n                    x_33588 = x_33586;\n                    x_33589 = x_33587;\n                    x_33586 = ((__local\n                                bool *) local_mem_33559)[byte_offsets_33553 +\n                                                         (sext_i32_i64(squot32(local_tid_33549,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_33587 = ((__local\n                                int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33549,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_33590 = x_33586 || x_33588;\n                    int64_t defunc_1_op_res_33591;\n                    \n                    if (x_33588) {\n                        defunc_1_op_res_33591 = x_33589;\n                    } else {\n                        int64_t defunc_1_op_res_33592 = add64(x_33587, x_33589);\n                        \n                        defunc_1_op_res_33591 = defunc_1_op_res_33592;\n                    }\n                    x_33586 = defunc_1_op_res_33590;\n                    x_33587 = defunc_1_op_res_33591;\n                }\n                // write final result\n                {\n            ",
            "        ((__local bool *) local_mem_33559)[byte_offsets_33553 +\n                                                       sext_i32_i64(local_tid_33549)] =\n                        x_33586;\n                    ((__local\n                      int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33549)] =\n                        x_33587;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33549, 32) == 0) {\n                ((__local bool *) local_mem_33559)[byte_offsets_33553 +\n                                                   sext_i32_i64(local_tid_33549)] =\n                    x_33588;\n                ((__local\n                  int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33549)] =\n                    x_33589;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33549 == 0) {\n            acc_33593 = ((__local bool *) local_mem_33559)[byte_offsets_33553 +\n                                                           (segscan_group_sizze_30678 -\n                                                            (int64_t) 1)];\n            acc_33594 = ((__local\n                          int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30678 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33593 = ((__local bool *) local_mem_33559)[byte_offsets_33553 +\n                                         ",
            "                  (sext_i32_i64(local_tid_33549) -\n                                                            (int64_t) 1)];\n            acc_33594 = ((__local\n                          int64_t *) local_mem_33559)[squot64(byte_offsets_33554,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33549) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_33605;\n    \n    prefix_33605 = 0;\n    \n    int64_t prefix_33606;\n    \n    prefix_33606 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33570 == (int64_t) 0 && local_tid_33549 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_33542)[dynamic_id_33570] = acc_33593;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33546)[dynamic_id_33570] = acc_33594;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33538)[dynamic_id_33570] = (int8_t) 2;\n            acc_33593 = 0;\n            acc_33594 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33570 == (int64_t) 0) && slt32(local_tid_33549,\n                                                        wave_sizze_33551)) {\n            if (local_tid_33549 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_33540)[dynamic_id_33570] = acc_33593;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33544)[dynamic_id_33570] =\n                    acc_33594;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33538)[dynamic_id_33570] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33559)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33538)[dynamic",
            "_id_33570 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33607;\n            \n            status_33607 = ((__local int8_t *) local_mem_33559)[(int64_t) 0];\n            if (status_33607 == (int8_t) 2) {\n                if (local_tid_33549 == 0) {\n                    prefix_33605 = ((volatile __global\n                                     bool *) incprefixes_mem_33542)[dynamic_id_33570 -\n                                                                    (int64_t) 1];\n                    prefix_33606 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33546)[dynamic_id_33570 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33608 = dynamic_id_33570 -\n                        sext_i32_i64(wave_sizze_33551);\n                \n                while (slt32(wave_sizze_33551 * -1, readOffset_33608)) {\n                    int32_t read_i_33609 = readOffset_33608 + local_tid_33549;\n                    bool aggr_33610 = 0;\n                    int64_t aggr_33611 = (int64_t) 0;\n                    int8_t flag_33612 = (int8_t) 0;\n                    int8_t used_33613 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33609)) {\n                        flag_33612 = ((volatile __global\n                                       int8_t *) status_flags_mem_33538)[sext_i32_i64(read_i_33609)];\n                        if (flag_33612 == (int8_t) 2) {\n                            aggr_33610 = ((volatile __global\n                                           bool *) incprefixes_mem_33542)[sext_i32_i64(read_i_33609)];\n                            aggr_33611 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33546)[sext_i32_i64(read_i_33609)];\n  ",
            "                      } else {\n                            if (flag_33612 == (int8_t) 1) {\n                                aggr_33610 = ((volatile __global\n                                               bool *) aggregates_mem_33540)[sext_i32_i64(read_i_33609)];\n                                aggr_33611 = ((volatile __global\n                                               int64_t *) aggregates_mem_33544)[sext_i32_i64(read_i_33609)];\n                                used_33613 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_33559)[warp_byte_offset_33556 +\n                                                       sext_i32_i64(local_tid_33549)] =\n                        aggr_33610;\n                    ((__local\n                      int64_t *) local_mem_33559)[squot64(warp_byte_offset_33557,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33549)] =\n                        aggr_33611;\n                    \n                    int8_t tmp_33614;\n                    \n                    tmp_33614 = flag_33612 | used_33613 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33559)[sext_i32_i64(local_tid_33549)] =\n                        tmp_33614;\n                    mem_fence_local();\n                    flag_33612 = ((volatile __local\n                                   int8_t *) local_mem_33559)[sext_i32_i64(wave_sizze_33551) -\n                                                              (int64_t) 1];\n                    if (local_tid_33549 == 0) {\n                        if (!(flag_33612 == (int8_t) 2)) {\n                            bool x_33615 = 0;\n                            int64_t x_33616 = (int64_t) 0;\n                            bool x_33617;\n                            int64_t x_33618;\n                            int8_t flag1_33622;\n              ",
            "              \n                            flag1_33622 = (int8_t) 0;\n                            \n                            int8_t flag2_33623;\n                            int8_t used1_33624;\n                            \n                            used1_33624 = (int8_t) 0;\n                            \n                            int8_t used2_33625;\n                            \n                            for (int32_t i_33626 = 0; i_33626 <\n                                 wave_sizze_33551; i_33626++) {\n                                flag2_33623 = ((__local\n                                                int8_t *) local_mem_33559)[sext_i32_i64(i_33626)];\n                                used2_33625 = lshr8(flag2_33623, (int8_t) 2);\n                                flag2_33623 = flag2_33623 & (int8_t) 3;\n                                x_33617 = ((__local\n                                            bool *) local_mem_33559)[warp_byte_offset_33556 +\n                                                                     sext_i32_i64(i_33626)];\n                                x_33618 = ((__local\n                                            int64_t *) local_mem_33559)[squot64(warp_byte_offset_33557,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33626)];\n                                if (!(flag2_33623 == (int8_t) 1)) {\n                                    flag1_33622 = flag2_33623;\n                                    used1_33624 = used2_33625;\n                                    x_33615 = x_33617;\n                                    x_33616 = x_33618;\n                                } else {\n                                    used1_33624 += used2_33625;\n                                    \n                                    bool defunc_1_op_res_33619;\n                                    \n                                    defunc_1_op_res",
            "_33619 = x_33615 || x_33617;\n                                    \n                                    int64_t defunc_1_op_res_33620;\n                                    \n                                    if (x_33617) {\n                                        defunc_1_op_res_33620 = x_33618;\n                                    } else {\n                                        int64_t defunc_1_op_res_33621 =\n                                                add64(x_33616, x_33618);\n                                        \n                                        defunc_1_op_res_33620 =\n                                            defunc_1_op_res_33621;\n                                    }\n                                    x_33615 = defunc_1_op_res_33619;\n                                    x_33616 = defunc_1_op_res_33620;\n                                }\n                            }\n                            flag_33612 = flag1_33622;\n                            used_33613 = used1_33624;\n                            aggr_33610 = x_33615;\n                            aggr_33611 = x_33616;\n                        } else {\n                            aggr_33610 = ((__local\n                                           bool *) local_mem_33559)[warp_byte_offset_33556 +\n                                                                    (sext_i32_i64(wave_sizze_33551) -\n                                                                     (int64_t) 1)];\n                            aggr_33611 = ((__local\n                                           int64_t *) local_mem_33559)[squot64(warp_byte_offset_33557,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33551) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33612 == (int8_t) 2) {\n           ",
            "                 readOffset_33608 = wave_sizze_33551 * -1;\n                        } else {\n                            readOffset_33608 -= zext_i8_i32(used_33613);\n                        }\n                        ((__local int32_t *) local_mem_33559)[(int64_t) 0] =\n                            readOffset_33608;\n                        \n                        bool x_33627;\n                        \n                        x_33627 = aggr_33610;\n                        \n                        int64_t x_33628;\n                        \n                        x_33628 = aggr_33611;\n                        \n                        bool x_33629;\n                        \n                        x_33629 = prefix_33605;\n                        \n                        int64_t x_33630;\n                        \n                        x_33630 = prefix_33606;\n                        \n                        bool defunc_1_op_res_33631;\n                        \n                        defunc_1_op_res_33631 = x_33627 || x_33629;\n                        \n                        int64_t defunc_1_op_res_33632;\n                        \n                        if (x_33629) {\n                            defunc_1_op_res_33632 = x_33630;\n                        } else {\n                            int64_t defunc_1_op_res_33633 = add64(x_33628,\n                                                                  x_33630);\n                            \n                            defunc_1_op_res_33632 = defunc_1_op_res_33633;\n                        }\n                        prefix_33605 = defunc_1_op_res_33631;\n                        prefix_33606 = defunc_1_op_res_33632;\n                    }\n                    mem_fence_local();\n                    readOffset_33608 = ((__local\n                                         int32_t *) local_mem_33559)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33549 == 0) {\n                bool x_33634 = prefix_33605;\n                i",
            "nt64_t x_33635 = prefix_33606;\n                bool x_33636 = acc_33593;\n                int64_t x_33637 = acc_33594;\n                bool defunc_1_op_res_33638 = x_33634 || x_33636;\n                int64_t defunc_1_op_res_33639;\n                \n                if (x_33636) {\n                    defunc_1_op_res_33639 = x_33637;\n                } else {\n                    int64_t defunc_1_op_res_33640 = add64(x_33635, x_33637);\n                    \n                    defunc_1_op_res_33639 = defunc_1_op_res_33640;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_33542)[dynamic_id_33570] =\n                    defunc_1_op_res_33638;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33546)[dynamic_id_33570] =\n                    defunc_1_op_res_33639;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33538)[dynamic_id_33570] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_33559)[warp_byte_offset_33556] =\n                    prefix_33605;\n                ((__local\n                  int64_t *) local_mem_33559)[squot64(warp_byte_offset_33557,\n                                                      (int64_t) 8)] =\n                    prefix_33606;\n                acc_33593 = 0;\n                acc_33594 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33570 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33605 = ((__local\n                             bool *) local_mem_33559)[warp_byte_offset_33556];\n            prefix_33606 = ((__local\n                             int64_t *) local_mem_33559)[squot64(warp_byte_offset_33557,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_33641;\n        bool x_33643;\n        bool x_33648;\n ",
            "       \n        x_33648 = prefix_33605;\n        \n        bool x_33650;\n        \n        x_33650 = acc_33593;\n        \n        int64_t x_33642;\n        int64_t x_33644;\n        int64_t x_33649;\n        \n        x_33649 = prefix_33606;\n        \n        int64_t x_33651;\n        \n        x_33651 = acc_33594;\n        \n        bool defunc_1_op_res_33652;\n        \n        defunc_1_op_res_33652 = x_33648 || x_33650;\n        \n        int64_t defunc_1_op_res_33653;\n        \n        if (x_33650) {\n            defunc_1_op_res_33653 = x_33651;\n        } else {\n            int64_t defunc_1_op_res_33654 = add64(x_33649, x_33651);\n            \n            defunc_1_op_res_33653 = defunc_1_op_res_33654;\n        }\n        x_33641 = defunc_1_op_res_33652;\n        x_33642 = defunc_1_op_res_33653;\n        for (int64_t i_33655 = 0; i_33655 < (int64_t) 9; i_33655++) {\n            x_33643 = private_mem_33572[i_33655];\n            x_33644 = private_mem_33574[i_33655];\n            \n            bool defunc_1_op_res_33645;\n            \n            defunc_1_op_res_33645 = x_33641 || x_33643;\n            \n            int64_t defunc_1_op_res_33646;\n            \n            if (x_33643) {\n                defunc_1_op_res_33646 = x_33644;\n            } else {\n                int64_t defunc_1_op_res_33647 = add64(x_33642, x_33644);\n                \n                defunc_1_op_res_33646 = defunc_1_op_res_33647;\n            }\n            private_mem_33572[i_33655] = defunc_1_op_res_33645;\n            private_mem_33574[i_33655] = defunc_1_op_res_33646;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33656 = 0; i_33656 < (int64_t) 9; i_33656++) {\n            int64_t sharedIdx_33657 = sext_i32_i64(local_tid_33549 * 9) +\n                    i_33656;\n            \n            ((__local bool *) local_mem_33559)[sharedIdx_33657] =\n                private_mem_33572[i_33656];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_3365",
            "8 = 0; i_33658 < (int64_t) 9; i_33658++) {\n            int32_t sharedIdx_33659 = local_tid_33549 +\n                    sext_i64_i32(segscan_group_sizze_30678 * i_33658);\n            \n            private_mem_33572[i_33658] = ((__local\n                                           bool *) local_mem_33559)[sext_i32_i64(sharedIdx_33659)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33660 = 0; i_33660 < (int64_t) 9; i_33660++) {\n            int64_t sharedIdx_33661 = sext_i32_i64(local_tid_33549 * 9) +\n                    i_33660;\n            \n            ((__local int64_t *) local_mem_33559)[sharedIdx_33661] =\n                private_mem_33574[i_33660];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33662 = 0; i_33662 < (int64_t) 9; i_33662++) {\n            int32_t sharedIdx_33663 = local_tid_33549 +\n                    sext_i64_i32(segscan_group_sizze_30678 * i_33662);\n            \n            private_mem_33574[i_33662] = ((__local\n                                           int64_t *) local_mem_33559)[sext_i32_i64(sharedIdx_33663)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33664 = 0; i_33664 < (int64_t) 9; i_33664++) {\n            int64_t gtid_30682 = blockOff_33571 + segscan_group_sizze_30678 *\n                    i_33664 + sext_i32_i64(local_tid_33549);\n            \n            if (slt64(gtid_30682, defunc_2_reduce_res_29171)) {\n                ((__global bool *) mem_32111)[gtid_30682] =\n                    private_mem_33572[i_33664];\n            }\n        }\n        for (int64_t i_33665 = 0; i_33665 < (int64_t) 9; i_33665++) {\n            int64_t gtid_30682 = blockOff_33571 + segscan_group_sizze_30678 *\n                    i_33665 + sext_i32_i64(local_tid_33549);\n            \n            if (slt64(gtid_30682, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32113)[gtid_30682] =\n                    private_mem",
            "_33574[i_33665];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33570 == sdiv_up64(defunc_2_reduce_res_29171,\n                                          segscan_group_sizze_30678 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_33536)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30678\n}\n__kernel void test_clusterWithzisegscan_30801(__global int *global_failure,\n                                              uint local_mem_33713_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29171,\n                                              int64_t i32_res_29305,\n                                              int64_t i32_res_29306, __global\n                                              unsigned char *mem_param_32127,\n                                              __global unsigned char *mem_32139,\n                                              __global unsigned char *mem_32141,\n                                              __global unsigned char *mem_32143,\n                                              __global unsigned char *mem_32145,\n                                              __global unsigned char *mem_32147,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_33678,\n                                              __global\n                                              unsigned char *status_flags_mem_33680,\n                                              __global\n                                              unsigned char *aggregates_mem_33682,\n                                              __global\n                                              unsigned char *incprefixes_mem_33684,\n                                ",
            "              __global\n                                              unsigned char *aggregates_mem_33686,\n                                              __global\n                                              unsigned char *incprefixes_mem_33688,\n                                              __global\n                                              unsigned char *aggregates_mem_33690,\n                                              __global\n                                              unsigned char *incprefixes_mem_33692,\n                                              __global\n                                              unsigned char *aggregates_mem_33694,\n                                              __global\n                                              unsigned char *incprefixes_mem_33696)\n{\n    #define segscan_group_sizze_30796 (test_clusterWithzisegscan_group_sizze_30795)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33713_backing_0 =\n                  &shared_mem[local_mem_33713_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33698;\n    int32_t local_tid_33699;\n    int64_t group_sizze_33702;\n    int32_t wave_sizze_33701;\n    int32_t group_tid_33700;\n    \n    global_tid_33698 = get_global_id(0);\n    local_tid_33699 = get_local_id(0);\n    group_sizze_33702 = get_local_size(0);\n    wave_sizze_33701 = LOCKSTEP_WIDTH;\n    group_tid_33700 = get_group_id(0);\n    \n    int32_t phys_tid_30801;\n    \n    phys_tid_30801 = global_tid_33698;\n    \n    int64_t byte_offsets_33703;\n    \n    byte_offsets_33703 = (int64_t) 0;\n    \n    int64_t byte_offsets_33704;\n    \n    byte_offsets_33704 = segscan_group_sizze_30796 * (int64_t) 8;\n    \n    int64_t byte_offsets_33705;\n    \n    byte_offsets_33705 = sdiv_up64(segscan_group_sizze_30796 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_30796 * (int64_t) 8;\n ",
            "   \n    int64_t byte_offsets_33706;\n    \n    byte_offsets_33706 = sdiv_up64(sdiv_up64(segscan_group_sizze_30796 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_30796 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_30796 * (int64_t) 8;\n    \n    int64_t byte_offsets_33707;\n    \n    byte_offsets_33707 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_30796 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_30796 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_30796 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30796 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33708;\n    \n    warp_byte_offset_33708 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33709;\n    \n    warp_byte_offset_33709 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_33710;\n    \n    warp_byte_offset_33710 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_33711;\n    \n    warp_byte_offset_33711 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_33712;\n    \n    warp_byte_offset_33712 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33713;\n    \n    local_mem_33713 = (__local char *) local_mem_33713_backing_0;\n    \n    int64_t trans_arr_len_33714;\n    \n    trans_arr_len_33714 = (int64_t) 9 * segscan_group_sizze_30796;\n    \n    int32_t dynamic_id_33730;\n    \n    if (local_tid_33699 == 0) {\n        dynamic_id_33730 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_33678)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33713)[(int64_t) 0] = dynamic_id_33730;\n    }\n    barrier(CLK_LO",
            "CAL_MEM_FENCE);\n    dynamic_id_33730 = ((__local int32_t *) local_mem_33713)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33731;\n    \n    blockOff_33731 = sext_i32_i64(dynamic_id_33730) * (int64_t) 9 *\n        segscan_group_sizze_30796;\n    \n    int64_t private_mem_33732[9];\n    int64_t private_mem_33734[9];\n    int64_t private_mem_33736[9];\n    int64_t private_mem_33738[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33740 = 0; i_33740 < (int64_t) 9; i_33740++) {\n            int64_t gtid_30800 = blockOff_33731 +\n                    sext_i32_i64(local_tid_33699) + i_33740 *\n                    segscan_group_sizze_30796;\n            \n            if (slt64(gtid_30800, defunc_2_reduce_res_29171)) {\n                int64_t x_29334 = ((__global\n                                    int64_t *) mem_param_32127)[gtid_30800];\n                int64_t zgzg_res_29335 = ashr64(x_29334, i32_res_29305);\n                int64_t za_res_29336 = (int64_t) 1 & zgzg_res_29335;\n                int32_t to_i32_res_29337 = sext_i64_i32(za_res_29336);\n                int32_t x_29338 = mul32(2, to_i32_res_29337);\n                int64_t zgzg_res_29339 = ashr64(x_29334, i32_res_29306);\n                int64_t za_res_29340 = (int64_t) 1 & zgzg_res_29339;\n                int32_t to_i32_res_29341 = sext_i64_i32(za_res_29340);\n                int32_t defunc_0_f_res_29342 = add32(x_29338, to_i32_res_29341);\n                bool cond_29343 = defunc_0_f_res_29342 == 0;\n                int64_t defunc_0_f_res_29344 = btoi_bool_i64(cond_29343);\n                int64_t defunc_0_f_res_29345;\n                int64_t defunc_0_f_res_29346;\n                int64_t defunc_0_f_res_29347;\n                \n                if (cond_29343) {\n                    defunc_0_f_res_29345 = (int64_t) 0;\n                    defunc_0_f_res_29346 = (int64_t) 0;\n                    defunc_0_f_res_29347 = (int64_t) 0;\n                } else {\n                    bool cond_29348 = defunc_0_f",
            "_res_29342 == 1;\n                    int64_t defunc_0_f_res_f_res_29349 =\n                            btoi_bool_i64(cond_29348);\n                    int64_t defunc_0_f_res_f_res_29350;\n                    int64_t defunc_0_f_res_f_res_29351;\n                    \n                    if (cond_29348) {\n                        defunc_0_f_res_f_res_29350 = (int64_t) 0;\n                        defunc_0_f_res_f_res_29351 = (int64_t) 0;\n                    } else {\n                        bool cond_29352 = defunc_0_f_res_29342 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_29353 =\n                                btoi_bool_i64(cond_29352);\n                        bool cond_neg_29354 = !cond_29352;\n                        int64_t defunc_0_f_res_f_res_f_res_29355 =\n                                btoi_bool_i64(cond_neg_29354);\n                        \n                        defunc_0_f_res_f_res_29350 =\n                            defunc_0_f_res_f_res_f_res_29353;\n                        defunc_0_f_res_f_res_29351 =\n                            defunc_0_f_res_f_res_f_res_29355;\n                    }\n                    defunc_0_f_res_29345 = defunc_0_f_res_f_res_29349;\n                    defunc_0_f_res_29346 = defunc_0_f_res_f_res_29350;\n                    defunc_0_f_res_29347 = defunc_0_f_res_f_res_29351;\n                }\n                ((__global int32_t *) mem_32147)[gtid_30800] =\n                    defunc_0_f_res_29342;\n                private_mem_33732[i_33740] = defunc_0_f_res_29344;\n                private_mem_33734[i_33740] = defunc_0_f_res_29345;\n                private_mem_33736[i_33740] = defunc_0_f_res_29346;\n                private_mem_33738[i_33740] = defunc_0_f_res_29347;\n            } else {\n                private_mem_33732[i_33740] = (int64_t) 0;\n                private_mem_33734[i_33740] = (int64_t) 0;\n                private_mem_33736[i_33740] = (int64_t) 0;\n                private_mem_33738[i_33740] = (int64_t) 0;\n            }\n       ",
            " }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33741 = 0; i_33741 < (int64_t) 9; i_33741++) {\n            int64_t sharedIdx_33742 = sext_i32_i64(local_tid_33699) + i_33741 *\n                    segscan_group_sizze_30796;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33742] =\n                private_mem_33732[i_33741];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33743 = 0; i_33743 < 9; i_33743++) {\n            int32_t sharedIdx_33744 = local_tid_33699 * 9 + i_33743;\n            \n            private_mem_33732[sext_i32_i64(i_33743)] = ((__local\n                                                         int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33744)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33745 = 0; i_33745 < (int64_t) 9; i_33745++) {\n            int64_t sharedIdx_33746 = sext_i32_i64(local_tid_33699) + i_33745 *\n                    segscan_group_sizze_30796;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33746] =\n                private_mem_33734[i_33745];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33747 = 0; i_33747 < 9; i_33747++) {\n            int32_t sharedIdx_33748 = local_tid_33699 * 9 + i_33747;\n            \n            private_mem_33734[sext_i32_i64(i_33747)] = ((__local\n                                                         int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33748)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33749 = 0; i_33749 < (int64_t) 9; i_33749++) {\n            int64_t sharedIdx_33750 = sext_i32_i64(local_tid_33699) + i_33749 *\n                    segscan_group_sizze_30796;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33750] =\n                private_mem_33736[i_33749];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33751 = 0; i_33751 < 9; i_33751++) {\n ",
            "           int32_t sharedIdx_33752 = local_tid_33699 * 9 + i_33751;\n            \n            private_mem_33736[sext_i32_i64(i_33751)] = ((__local\n                                                         int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33752)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33753 = 0; i_33753 < (int64_t) 9; i_33753++) {\n            int64_t sharedIdx_33754 = sext_i32_i64(local_tid_33699) + i_33753 *\n                    segscan_group_sizze_30796;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33754] =\n                private_mem_33738[i_33753];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33755 = 0; i_33755 < 9; i_33755++) {\n            int32_t sharedIdx_33756 = local_tid_33699 * 9 + i_33755;\n            \n            private_mem_33738[sext_i32_i64(i_33755)] = ((__local\n                                                         int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33756)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33757 = 0; i_33757 < (int64_t) 8; i_33757++) {\n            int64_t x_29322;\n            int64_t x_29326;\n            \n            x_29322 = private_mem_33732[i_33757];\n            x_29326 = private_mem_33732[i_33757 + (int64_t) 1];\n            \n            int64_t x_29323;\n            int64_t x_29327;\n            \n            x_29323 = private_mem_33734[i_33757];\n            x_29327 = private_mem_33734[i_33757 + (int64_t) 1];\n            \n            int64_t x_29324;\n            int64_t x_29328;\n            \n            x_29324 = private_mem_33736[i_33757];\n            x_29328 = private_mem_33736[i_33757 + (int64_t) 1];\n            \n            int64_t x_29325;\n            int64_t x_29329;\n            \n            x_29325 = private_mem_33738[i_33757];\n            x_29329 = private_mem_33738[i_33757 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29330;\n      ",
            "      \n            defunc_1_op_res_29330 = add64(x_29322, x_29326);\n            \n            int64_t defunc_1_op_res_29331 = add64(x_29323, x_29327);\n            int64_t defunc_1_op_res_29332 = add64(x_29324, x_29328);\n            int64_t defunc_1_op_res_29333 = add64(x_29325, x_29329);\n            \n            private_mem_33732[i_33757 + (int64_t) 1] = defunc_1_op_res_29330;\n            private_mem_33734[i_33757 + (int64_t) 1] = defunc_1_op_res_29331;\n            private_mem_33736[i_33757 + (int64_t) 1] = defunc_1_op_res_29332;\n            private_mem_33738[i_33757 + (int64_t) 1] = defunc_1_op_res_29333;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n            private_mem_33732[(int64_t) 8];\n        ((__local int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n            private_mem_33734[(int64_t) 8];\n        ((__local int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n            private_mem_33736[(int64_t) 8];\n        ((__local int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n            private_mem_33738[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_33770;\n    int64_t acc_33771;\n    int64_t acc_33772;\n    int64_t acc_33773;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_33758;\n        int64_t x_33759;\n        int64_t x_3376",
            "0;\n        int64_t x_33761;\n        int64_t x_33762;\n        int64_t x_33763;\n        int64_t x_33764;\n        int64_t x_33765;\n        int64_t x_33774;\n        int64_t x_33775;\n        int64_t x_33776;\n        int64_t x_33777;\n        int64_t x_33778;\n        int64_t x_33779;\n        int64_t x_33780;\n        int64_t x_33781;\n        bool ltid_in_bounds_33786;\n        \n        ltid_in_bounds_33786 = slt64(sext_i32_i64(local_tid_33699),\n                                     segscan_group_sizze_30796);\n        \n        int32_t skip_threads_33787;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33786) {\n                x_33762 = ((volatile __local\n                            int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33699)];\n                x_33763 = ((volatile __local\n                            int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33699)];\n                x_33764 = ((volatile __local\n                            int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33699)];\n                x_33765 = ((volatile __local\n                            int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33699)];\n                if ((local_tid_33699 - squot32(local_tid_33699, 32) * 32) ==\n                    0) {\n                    x_33758 = x_33762;\n                    x_3375",
            "9 = x_33763;\n                    x_33760 = x_33764;\n                    x_33761 = x_33765;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33787 = 1;\n            while (slt32(skip_threads_33787, 32)) {\n                if (sle32(skip_threads_33787, local_tid_33699 -\n                          squot32(local_tid_33699, 32) * 32) &&\n                    ltid_in_bounds_33786) {\n                    // read operands\n                    {\n                        x_33758 = ((volatile __local\n                                    int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33699) -\n                                                                 sext_i32_i64(skip_threads_33787))];\n                        x_33759 = ((volatile __local\n                                    int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33699) -\n                                                                 sext_i32_i64(skip_threads_33787))];\n                        x_33760 = ((volatile __local\n                                    int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33699) -\n                                                                 sext_i32_i64(skip_threads_33787))];\n                        x_33761 = ((volatile __local\n                                    int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                               ",
            "                         (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33699) -\n                                                                 sext_i32_i64(skip_threads_33787))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_33766 = add64(x_33758, x_33762);\n                        int64_t defunc_1_op_res_33767 = add64(x_33759, x_33763);\n                        int64_t defunc_1_op_res_33768 = add64(x_33760, x_33764);\n                        int64_t defunc_1_op_res_33769 = add64(x_33761, x_33765);\n                        \n                        x_33758 = defunc_1_op_res_33766;\n                        x_33759 = defunc_1_op_res_33767;\n                        x_33760 = defunc_1_op_res_33768;\n                        x_33761 = defunc_1_op_res_33769;\n                    }\n                }\n                if (sle32(wave_sizze_33701, skip_threads_33787)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33787, local_tid_33699 -\n                          squot32(local_tid_33699, 32) * 32) &&\n                    ltid_in_bounds_33786) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33699)] =\n                            x_33758;\n                        x_33762 = x_33758;\n                        ((volatile __local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33699)] =\n                            x_33759;\n",
            "                        x_33763 = x_33759;\n                        ((volatile __local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33699)] =\n                            x_33760;\n                        x_33764 = x_33760;\n                        ((volatile __local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33699)] =\n                            x_33761;\n                        x_33765 = x_33761;\n                    }\n                }\n                if (sle32(wave_sizze_33701, skip_threads_33787)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33787 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33699 - squot32(local_tid_33699, 32) * 32) == 31 &&\n                ltid_in_bounds_33786) {\n                ((volatile __local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33699,\n                                                                   32))] =\n                    x_33758;\n                ((volatile __local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33699,\n                                                                   32))] =\n                    x_33759;\n            ",
            "    ((volatile __local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33699,\n                                                                   32))] =\n                    x_33760;\n                ((volatile __local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33699,\n                                                                   32))] =\n                    x_33761;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33788;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_33699, 32) == 0 && ltid_in_bounds_33786) {\n                    x_33778 = ((volatile __local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33699)];\n                    x_33779 = ((volatile __local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33699)];\n                    x_33780 = ((volatile __local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid",
            "_33699)];\n                    x_33781 = ((volatile __local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33699)];\n                    if ((local_tid_33699 - squot32(local_tid_33699, 32) * 32) ==\n                        0) {\n                        x_33774 = x_33778;\n                        x_33775 = x_33779;\n                        x_33776 = x_33780;\n                        x_33777 = x_33781;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33788 = 1;\n                while (slt32(skip_threads_33788, 32)) {\n                    if (sle32(skip_threads_33788, local_tid_33699 -\n                              squot32(local_tid_33699, 32) * 32) &&\n                        (squot32(local_tid_33699, 32) == 0 &&\n                         ltid_in_bounds_33786)) {\n                        // read operands\n                        {\n                            x_33774 = ((volatile __local\n                                        int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33699) -\n                                                                     sext_i32_i64(skip_threads_33788))];\n                            x_33775 = ((volatile __local\n                                        int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33699) -\n                                                              ",
            "       sext_i32_i64(skip_threads_33788))];\n                            x_33776 = ((volatile __local\n                                        int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33699) -\n                                                                     sext_i32_i64(skip_threads_33788))];\n                            x_33777 = ((volatile __local\n                                        int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33699) -\n                                                                     sext_i32_i64(skip_threads_33788))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_33782 = add64(x_33774,\n                                                                  x_33778);\n                            int64_t defunc_1_op_res_33783 = add64(x_33775,\n                                                                  x_33779);\n                            int64_t defunc_1_op_res_33784 = add64(x_33776,\n                                                                  x_33780);\n                            int64_t defunc_1_op_res_33785 = add64(x_33777,\n                                                                  x_33781);\n                            \n                            x_33774 = defunc_1_op_res_33782;\n                            x_33775 = defunc_1_op_res_33783;\n                            x_33776 = defunc_1_op_res_33784;\n                            x_33777 = defunc_1_op_res_33785;\n                        }\n                    }\n                    if (sle32(wave_",
            "sizze_33701, skip_threads_33788)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33788, local_tid_33699 -\n                              squot32(local_tid_33699, 32) * 32) &&\n                        (squot32(local_tid_33699, 32) == 0 &&\n                         ltid_in_bounds_33786)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33699)] =\n                                x_33774;\n                            x_33778 = x_33774;\n                            ((volatile __local\n                              int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33699)] =\n                                x_33775;\n                            x_33779 = x_33775;\n                            ((volatile __local\n                              int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33699)] =\n                                x_33776;\n                            x_33780 = x_33776;\n                            ((volatile __local\n                              int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_33699)] =\n                                x_33777;\n                            x_33781 = x_33777;\n  ",
            "                      }\n                    }\n                    if (sle32(wave_sizze_33701, skip_threads_33788)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33788 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33699, 32) == 0 || !ltid_in_bounds_33786)) {\n                // read operands\n                {\n                    x_33762 = x_33758;\n                    x_33763 = x_33759;\n                    x_33764 = x_33760;\n                    x_33765 = x_33761;\n                    x_33758 = ((__local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33699,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_33759 = ((__local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33699,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_33760 = ((__local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33699,\n                                                                       ",
            "           32)) -\n                                                             (int64_t) 1)];\n                    x_33761 = ((__local\n                                int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33699,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_33766 = add64(x_33758, x_33762);\n                    int64_t defunc_1_op_res_33767 = add64(x_33759, x_33763);\n                    int64_t defunc_1_op_res_33768 = add64(x_33760, x_33764);\n                    int64_t defunc_1_op_res_33769 = add64(x_33761, x_33765);\n                    \n                    x_33758 = defunc_1_op_res_33766;\n                    x_33759 = defunc_1_op_res_33767;\n                    x_33760 = defunc_1_op_res_33768;\n                    x_33761 = defunc_1_op_res_33769;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        x_33758;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        x_33759;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                         ",
            "                 (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        x_33760;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        x_33761;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33699, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n                    x_33762;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n                    x_33763;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n                    x_33764;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33699)] =\n                    x_33765;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33699 == 0) {\n            acc_33770 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n  ",
            "                                                            (int64_t) 8) +\n                                                      (segscan_group_sizze_30796 -\n                                                       (int64_t) 1)];\n            acc_33771 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30796 -\n                                                       (int64_t) 1)];\n            acc_33772 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30796 -\n                                                       (int64_t) 1)];\n            acc_33773 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30796 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33770 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33703,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33699) -\n                                                       (int64_t) 1)];\n            acc_33771 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33704,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33699) -\n                                                       (int64_t) 1)];\n            acc_3",
            "3772 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33705,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33699) -\n                                                       (int64_t) 1)];\n            acc_33773 = ((__local\n                          int64_t *) local_mem_33713)[squot64(byte_offsets_33706,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33699) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_33789;\n    \n    prefix_33789 = (int64_t) 0;\n    \n    int64_t prefix_33790;\n    \n    prefix_33790 = (int64_t) 0;\n    \n    int64_t prefix_33791;\n    \n    prefix_33791 = (int64_t) 0;\n    \n    int64_t prefix_33792;\n    \n    prefix_33792 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33730 == (int64_t) 0 && local_tid_33699 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_33684)[dynamic_id_33730] = acc_33770;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33688)[dynamic_id_33730] = acc_33771;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33692)[dynamic_id_33730] = acc_33772;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33696)[dynamic_id_33730] = acc_33773;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33680)[dynamic_id_33730] = (int8_t) 2;\n            acc_33770 = (int64_t) 0;\n            acc_33771 = (int64_t) 0;\n            acc_33772 = (int64_t) 0;\n            acc_33773 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33730 == (int64_t) 0) && slt32(local_tid_33699,\n                                                        wave_sizze_3370",
            "1)) {\n            if (local_tid_33699 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_33682)[dynamic_id_33730] =\n                    acc_33770;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33686)[dynamic_id_33730] =\n                    acc_33771;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33690)[dynamic_id_33730] =\n                    acc_33772;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33694)[dynamic_id_33730] =\n                    acc_33773;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33680)[dynamic_id_33730] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33713)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33680)[dynamic_id_33730 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33793;\n            \n            status_33793 = ((__local int8_t *) local_mem_33713)[(int64_t) 0];\n            if (status_33793 == (int8_t) 2) {\n                if (local_tid_33699 == 0) {\n                    prefix_33789 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33684)[dynamic_id_33730 -\n                                                                       (int64_t) 1];\n                    prefix_33790 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33688)[dynamic_id_33730 -\n                                                                       (int64_t) 1];\n                    prefix_33791 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33692)[dynamic_id_33730 -\n                             ",
            "                                          (int64_t) 1];\n                    prefix_33792 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33696)[dynamic_id_33730 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33794 = dynamic_id_33730 -\n                        sext_i32_i64(wave_sizze_33701);\n                \n                while (slt32(wave_sizze_33701 * -1, readOffset_33794)) {\n                    int32_t read_i_33795 = readOffset_33794 + local_tid_33699;\n                    int64_t aggr_33796 = (int64_t) 0;\n                    int64_t aggr_33797 = (int64_t) 0;\n                    int64_t aggr_33798 = (int64_t) 0;\n                    int64_t aggr_33799 = (int64_t) 0;\n                    int8_t flag_33800 = (int8_t) 0;\n                    int8_t used_33801 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33795)) {\n                        flag_33800 = ((volatile __global\n                                       int8_t *) status_flags_mem_33680)[sext_i32_i64(read_i_33795)];\n                        if (flag_33800 == (int8_t) 2) {\n                            aggr_33796 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33684)[sext_i32_i64(read_i_33795)];\n                            aggr_33797 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33688)[sext_i32_i64(read_i_33795)];\n                            aggr_33798 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33692)[sext_i32_i64(read_i_33795)];\n                            aggr_33799 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33696)[sext_i32_i64(read_i_33795)];\n                        } else {\n                            if (flag_33800 == (int8_t) 1) {\n                     ",
            "           aggr_33796 = ((volatile __global\n                                               int64_t *) aggregates_mem_33682)[sext_i32_i64(read_i_33795)];\n                                aggr_33797 = ((volatile __global\n                                               int64_t *) aggregates_mem_33686)[sext_i32_i64(read_i_33795)];\n                                aggr_33798 = ((volatile __global\n                                               int64_t *) aggregates_mem_33690)[sext_i32_i64(read_i_33795)];\n                                aggr_33799 = ((volatile __global\n                                               int64_t *) aggregates_mem_33694)[sext_i32_i64(read_i_33795)];\n                                used_33801 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(warp_byte_offset_33708,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        aggr_33796;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(warp_byte_offset_33709,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        aggr_33797;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(warp_byte_offset_33710,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n                        aggr_33798;\n                    ((__local\n                      int64_t *) local_mem_33713)[squot64(warp_byte_offset_33711,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33699)] =\n          ",
            "              aggr_33799;\n                    \n                    int8_t tmp_33802;\n                    \n                    tmp_33802 = flag_33800 | used_33801 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33713)[sext_i32_i64(local_tid_33699)] =\n                        tmp_33802;\n                    mem_fence_local();\n                    flag_33800 = ((volatile __local\n                                   int8_t *) local_mem_33713)[sext_i32_i64(wave_sizze_33701) -\n                                                              (int64_t) 1];\n                    if (local_tid_33699 == 0) {\n                        if (!(flag_33800 == (int8_t) 2)) {\n                            int64_t x_33803 = (int64_t) 0;\n                            int64_t x_33804 = (int64_t) 0;\n                            int64_t x_33805 = (int64_t) 0;\n                            int64_t x_33806 = (int64_t) 0;\n                            int64_t x_33807;\n                            int64_t x_33808;\n                            int64_t x_33809;\n                            int64_t x_33810;\n                            int8_t flag1_33815;\n                            \n                            flag1_33815 = (int8_t) 0;\n                            \n                            int8_t flag2_33816;\n                            int8_t used1_33817;\n                            \n                            used1_33817 = (int8_t) 0;\n                            \n                            int8_t used2_33818;\n                            \n                            for (int32_t i_33819 = 0; i_33819 <\n                                 wave_sizze_33701; i_33819++) {\n                                flag2_33816 = ((__local\n                                                int8_t *) local_mem_33713)[sext_i32_i64(i_33819)];\n                                used2_33818 = lshr8(flag2_33816, (int8_t) 2);\n                                flag2_33816 = flag2_33816 & (int8_t) 3;\n             ",
            "                   x_33807 = ((__local\n                                            int64_t *) local_mem_33713)[squot64(warp_byte_offset_33708,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33819)];\n                                x_33808 = ((__local\n                                            int64_t *) local_mem_33713)[squot64(warp_byte_offset_33709,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33819)];\n                                x_33809 = ((__local\n                                            int64_t *) local_mem_33713)[squot64(warp_byte_offset_33710,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33819)];\n                                x_33810 = ((__local\n                                            int64_t *) local_mem_33713)[squot64(warp_byte_offset_33711,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33819)];\n                                if (!(flag2_33816 == (int8_t) 1)) {\n                                    flag1_33815 = flag2_33816;\n                                    used1_33817 = used2_33818;\n                                    x_33803 = x_33807;\n                                    x_33804 = x_33808;\n                                    x_33805 = x_33809;\n                                    x_33806 = x_33810;\n                                } else {\n                                    used1_33817 += used2_33818;\n                                    \n                                    int64_t defunc_1_op_res_33811;\n  ",
            "                                  \n                                    defunc_1_op_res_33811 = add64(x_33803,\n                                                                  x_33807);\n                                    \n                                    int64_t defunc_1_op_res_33812 =\n                                            add64(x_33804, x_33808);\n                                    int64_t defunc_1_op_res_33813 =\n                                            add64(x_33805, x_33809);\n                                    int64_t defunc_1_op_res_33814 =\n                                            add64(x_33806, x_33810);\n                                    \n                                    x_33803 = defunc_1_op_res_33811;\n                                    x_33804 = defunc_1_op_res_33812;\n                                    x_33805 = defunc_1_op_res_33813;\n                                    x_33806 = defunc_1_op_res_33814;\n                                }\n                            }\n                            flag_33800 = flag1_33815;\n                            used_33801 = used1_33817;\n                            aggr_33796 = x_33803;\n                            aggr_33797 = x_33804;\n                            aggr_33798 = x_33805;\n                            aggr_33799 = x_33806;\n                        } else {\n                            aggr_33796 = ((__local\n                                           int64_t *) local_mem_33713)[squot64(warp_byte_offset_33708,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33701) -\n                                                                        (int64_t) 1)];\n                            aggr_33797 = ((__local\n                                           int64_t *) local_mem_33713)[squot64(warp_byte_offset_33709,\n                                                      ",
            "                         (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33701) -\n                                                                        (int64_t) 1)];\n                            aggr_33798 = ((__local\n                                           int64_t *) local_mem_33713)[squot64(warp_byte_offset_33710,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33701) -\n                                                                        (int64_t) 1)];\n                            aggr_33799 = ((__local\n                                           int64_t *) local_mem_33713)[squot64(warp_byte_offset_33711,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33701) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33800 == (int8_t) 2) {\n                            readOffset_33794 = wave_sizze_33701 * -1;\n                        } else {\n                            readOffset_33794 -= zext_i8_i32(used_33801);\n                        }\n                        ((__local int32_t *) local_mem_33713)[(int64_t) 0] =\n                            readOffset_33794;\n                        \n                        int64_t x_33820;\n                        \n                        x_33820 = aggr_33796;\n                        \n                        int64_t x_33821;\n                        \n                        x_33821 = aggr_33797;\n                        \n                        int64_t x_33822;\n                        \n                        x_33822 = aggr_33798;\n                        \n                        int64_t x_33823;\n    ",
            "                    \n                        x_33823 = aggr_33799;\n                        \n                        int64_t x_33824;\n                        \n                        x_33824 = prefix_33789;\n                        \n                        int64_t x_33825;\n                        \n                        x_33825 = prefix_33790;\n                        \n                        int64_t x_33826;\n                        \n                        x_33826 = prefix_33791;\n                        \n                        int64_t x_33827;\n                        \n                        x_33827 = prefix_33792;\n                        \n                        int64_t defunc_1_op_res_33828;\n                        \n                        defunc_1_op_res_33828 = add64(x_33820, x_33824);\n                        \n                        int64_t defunc_1_op_res_33829 = add64(x_33821, x_33825);\n                        int64_t defunc_1_op_res_33830 = add64(x_33822, x_33826);\n                        int64_t defunc_1_op_res_33831 = add64(x_33823, x_33827);\n                        \n                        prefix_33789 = defunc_1_op_res_33828;\n                        prefix_33790 = defunc_1_op_res_33829;\n                        prefix_33791 = defunc_1_op_res_33830;\n                        prefix_33792 = defunc_1_op_res_33831;\n                    }\n                    mem_fence_local();\n                    readOffset_33794 = ((__local\n                                         int32_t *) local_mem_33713)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33699 == 0) {\n                int64_t x_33832 = prefix_33789;\n                int64_t x_33833 = prefix_33790;\n                int64_t x_33834 = prefix_33791;\n                int64_t x_33835 = prefix_33792;\n                int64_t x_33836 = acc_33770;\n                int64_t x_33837 = acc_33771;\n                int64_t x_33838 = acc_33772;\n                int64_t x_33839 = acc_33773;\n                int64",
            "_t defunc_1_op_res_33840 = add64(x_33832, x_33836);\n                int64_t defunc_1_op_res_33841 = add64(x_33833, x_33837);\n                int64_t defunc_1_op_res_33842 = add64(x_33834, x_33838);\n                int64_t defunc_1_op_res_33843 = add64(x_33835, x_33839);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_33684)[dynamic_id_33730] =\n                    defunc_1_op_res_33840;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33688)[dynamic_id_33730] =\n                    defunc_1_op_res_33841;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33692)[dynamic_id_33730] =\n                    defunc_1_op_res_33842;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33696)[dynamic_id_33730] =\n                    defunc_1_op_res_33843;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33680)[dynamic_id_33730] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(warp_byte_offset_33708,\n                                                      (int64_t) 8)] =\n                    prefix_33789;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(warp_byte_offset_33709,\n                                                      (int64_t) 8)] =\n                    prefix_33790;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(warp_byte_offset_33710,\n                                                      (int64_t) 8)] =\n                    prefix_33791;\n                ((__local\n                  int64_t *) local_mem_33713)[squot64(warp_byte_offset_33711,\n                                                      (int64_t) 8)] =\n                    prefix_33792;\n                acc_33770 = (int64_t) 0;\n                acc_33771 = (int64_t) 0;\n                ac",
            "c_33772 = (int64_t) 0;\n                acc_33773 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33730 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33789 = ((__local\n                             int64_t *) local_mem_33713)[squot64(warp_byte_offset_33708,\n                                                                 (int64_t) 8)];\n            prefix_33790 = ((__local\n                             int64_t *) local_mem_33713)[squot64(warp_byte_offset_33709,\n                                                                 (int64_t) 8)];\n            prefix_33791 = ((__local\n                             int64_t *) local_mem_33713)[squot64(warp_byte_offset_33710,\n                                                                 (int64_t) 8)];\n            prefix_33792 = ((__local\n                             int64_t *) local_mem_33713)[squot64(warp_byte_offset_33711,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_33844;\n        int64_t x_33848;\n        int64_t x_33856;\n        \n        x_33856 = prefix_33789;\n        \n        int64_t x_33860;\n        \n        x_33860 = acc_33770;\n        \n        int64_t x_33845;\n        int64_t x_33849;\n        int64_t x_33857;\n        \n        x_33857 = prefix_33790;\n        \n        int64_t x_33861;\n        \n        x_33861 = acc_33771;\n        \n        int64_t x_33846;\n        int64_t x_33850;\n        int64_t x_33858;\n        \n        x_33858 = prefix_33791;\n        \n        int64_t x_33862;\n        \n        x_33862 = acc_33772;\n        \n        int64_t x_33847;\n        int64_t x_33851;\n        int64_t x_33859;\n        \n        x_33859 = prefix_33792;\n        \n        int64_t x_33863;\n        \n        x_33863 = acc_33773;\n        \n        int64_t defunc_1_op_res_33864;\n        \n        defunc_1_op_res_33864 = add64(x_33856, x_33860);\n        \n    ",
            "    int64_t defunc_1_op_res_33865 = add64(x_33857, x_33861);\n        int64_t defunc_1_op_res_33866 = add64(x_33858, x_33862);\n        int64_t defunc_1_op_res_33867 = add64(x_33859, x_33863);\n        \n        x_33844 = defunc_1_op_res_33864;\n        x_33845 = defunc_1_op_res_33865;\n        x_33846 = defunc_1_op_res_33866;\n        x_33847 = defunc_1_op_res_33867;\n        for (int64_t i_33868 = 0; i_33868 < (int64_t) 9; i_33868++) {\n            x_33848 = private_mem_33732[i_33868];\n            x_33849 = private_mem_33734[i_33868];\n            x_33850 = private_mem_33736[i_33868];\n            x_33851 = private_mem_33738[i_33868];\n            \n            int64_t defunc_1_op_res_33852;\n            \n            defunc_1_op_res_33852 = add64(x_33844, x_33848);\n            \n            int64_t defunc_1_op_res_33853 = add64(x_33845, x_33849);\n            int64_t defunc_1_op_res_33854 = add64(x_33846, x_33850);\n            int64_t defunc_1_op_res_33855 = add64(x_33847, x_33851);\n            \n            private_mem_33732[i_33868] = defunc_1_op_res_33852;\n            private_mem_33734[i_33868] = defunc_1_op_res_33853;\n            private_mem_33736[i_33868] = defunc_1_op_res_33854;\n            private_mem_33738[i_33868] = defunc_1_op_res_33855;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33869 = 0; i_33869 < (int64_t) 9; i_33869++) {\n            int64_t sharedIdx_33870 = sext_i32_i64(local_tid_33699 * 9) +\n                    i_33869;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33870] =\n                private_mem_33732[i_33869];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33871 = 0; i_33871 < (int64_t) 9; i_33871++) {\n            int32_t sharedIdx_33872 = local_tid_33699 +\n                    sext_i64_i32(segscan_group_sizze_30796 * i_33871);\n            \n            private_mem_33732[i_33871] = ((__local\n                                           int64_t",
            " *) local_mem_33713)[sext_i32_i64(sharedIdx_33872)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33873 = 0; i_33873 < (int64_t) 9; i_33873++) {\n            int64_t sharedIdx_33874 = sext_i32_i64(local_tid_33699 * 9) +\n                    i_33873;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33874] =\n                private_mem_33734[i_33873];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33875 = 0; i_33875 < (int64_t) 9; i_33875++) {\n            int32_t sharedIdx_33876 = local_tid_33699 +\n                    sext_i64_i32(segscan_group_sizze_30796 * i_33875);\n            \n            private_mem_33734[i_33875] = ((__local\n                                           int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33876)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33877 = 0; i_33877 < (int64_t) 9; i_33877++) {\n            int64_t sharedIdx_33878 = sext_i32_i64(local_tid_33699 * 9) +\n                    i_33877;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33878] =\n                private_mem_33736[i_33877];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33879 = 0; i_33879 < (int64_t) 9; i_33879++) {\n            int32_t sharedIdx_33880 = local_tid_33699 +\n                    sext_i64_i32(segscan_group_sizze_30796 * i_33879);\n            \n            private_mem_33736[i_33879] = ((__local\n                                           int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33880)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33881 = 0; i_33881 < (int64_t) 9; i_33881++) {\n            int64_t sharedIdx_33882 = sext_i32_i64(local_tid_33699 * 9) +\n                    i_33881;\n            \n            ((__local int64_t *) local_mem_33713)[sharedIdx_33882] =\n                private_mem_33738[i_33881];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33883 = 0; ",
            "i_33883 < (int64_t) 9; i_33883++) {\n            int32_t sharedIdx_33884 = local_tid_33699 +\n                    sext_i64_i32(segscan_group_sizze_30796 * i_33883);\n            \n            private_mem_33738[i_33883] = ((__local\n                                           int64_t *) local_mem_33713)[sext_i32_i64(sharedIdx_33884)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_33885 = 0; i_33885 < (int64_t) 9; i_33885++) {\n            int64_t gtid_30800 = blockOff_33731 + segscan_group_sizze_30796 *\n                    i_33885 + sext_i32_i64(local_tid_33699);\n            \n            if (slt64(gtid_30800, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32139)[gtid_30800] =\n                    private_mem_33732[i_33885];\n            }\n        }\n        for (int64_t i_33886 = 0; i_33886 < (int64_t) 9; i_33886++) {\n            int64_t gtid_30800 = blockOff_33731 + segscan_group_sizze_30796 *\n                    i_33886 + sext_i32_i64(local_tid_33699);\n            \n            if (slt64(gtid_30800, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32141)[gtid_30800] =\n                    private_mem_33734[i_33886];\n            }\n        }\n        for (int64_t i_33887 = 0; i_33887 < (int64_t) 9; i_33887++) {\n            int64_t gtid_30800 = blockOff_33731 + segscan_group_sizze_30796 *\n                    i_33887 + sext_i32_i64(local_tid_33699);\n            \n            if (slt64(gtid_30800, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32143)[gtid_30800] =\n                    private_mem_33736[i_33887];\n            }\n        }\n        for (int64_t i_33888 = 0; i_33888 < (int64_t) 9; i_33888++) {\n            int64_t gtid_30800 = blockOff_33731 + segscan_group_sizze_30796 *\n                    i_33888 + sext_i32_i64(local_tid_33699);\n            \n            if (slt64(gtid_30800, defunc_2_reduce_res_29171)) {\n            ",
            "    ((__global int64_t *) mem_32145)[gtid_30800] =\n                    private_mem_33738[i_33888];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33730 == sdiv_up64(defunc_2_reduce_res_29171,\n                                          segscan_group_sizze_30796 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_33678)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30796\n}\n__kernel void test_clusterWithzisegscan_30867(__global int *global_failure,\n                                              uint local_mem_33930_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29171,\n                                              __global unsigned char *mem_32176,\n                                              __global unsigned char *mem_32179,\n                                              __global unsigned char *mem_32181,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_33907,\n                                              __global\n                                              unsigned char *status_flags_mem_33909,\n                                              __global\n                                              unsigned char *aggregates_mem_33911,\n                                              __global\n                                              unsigned char *incprefixes_mem_33913,\n                                              __global\n                                              unsigned char *aggregates_mem_33915,\n                                              __global\n                                              unsigned char *incprefixes_mem_33917)\n{\n    #define segscan_group_sizze_30862 (test_clusterWithzis",
            "egscan_group_sizze_30861)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_33930_backing_0 =\n                  &shared_mem[local_mem_33930_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_33919;\n    int32_t local_tid_33920;\n    int64_t group_sizze_33923;\n    int32_t wave_sizze_33922;\n    int32_t group_tid_33921;\n    \n    global_tid_33919 = get_global_id(0);\n    local_tid_33920 = get_local_id(0);\n    group_sizze_33923 = get_local_size(0);\n    wave_sizze_33922 = LOCKSTEP_WIDTH;\n    group_tid_33921 = get_group_id(0);\n    \n    int32_t phys_tid_30867;\n    \n    phys_tid_30867 = global_tid_33919;\n    \n    int64_t byte_offsets_33924;\n    \n    byte_offsets_33924 = (int64_t) 0;\n    \n    int64_t byte_offsets_33925;\n    \n    byte_offsets_33925 = segscan_group_sizze_30862;\n    \n    int64_t byte_offsets_33926;\n    \n    byte_offsets_33926 = sdiv_up64(segscan_group_sizze_30862, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30862 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_33927;\n    \n    warp_byte_offset_33927 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_33928;\n    \n    warp_byte_offset_33928 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_33929;\n    \n    warp_byte_offset_33929 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_33930;\n    \n    local_mem_33930 = (__local char *) local_mem_33930_backing_0;\n    \n    int64_t trans_arr_len_33931;\n    \n    trans_arr_len_33931 = (int64_t) 9 * segscan_group_sizze_30862;\n    \n    int32_t dynamic_id_33941;\n    \n    if (local_tid_33920 == 0) {\n        dynamic_id_33941 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_33907)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_33930)[(int64_t) 0] = dynamic_id_33",
            "941;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_33941 = ((__local int32_t *) local_mem_33930)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_33942;\n    \n    blockOff_33942 = sext_i32_i64(dynamic_id_33941) * (int64_t) 9 *\n        segscan_group_sizze_30862;\n    \n    bool private_mem_33943[9];\n    int64_t private_mem_33945[9];\n    \n    // Load and map\n    {\n        for (int64_t i_33947 = 0; i_33947 < (int64_t) 9; i_33947++) {\n            int64_t gtid_30866 = blockOff_33942 +\n                    sext_i32_i64(local_tid_33920) + i_33947 *\n                    segscan_group_sizze_30862;\n            \n            if (slt64(gtid_30866, defunc_2_reduce_res_29171)) {\n                bool x_29423 = ((__global bool *) mem_32176)[gtid_30866];\n                \n                private_mem_33943[i_33947] = x_29423;\n                private_mem_33945[i_33947] = (int64_t) 1;\n            } else {\n                private_mem_33943[i_33947] = 0;\n                private_mem_33945[i_33947] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33948 = 0; i_33948 < (int64_t) 9; i_33948++) {\n            int64_t sharedIdx_33949 = sext_i32_i64(local_tid_33920) + i_33948 *\n                    segscan_group_sizze_30862;\n            \n            ((__local bool *) local_mem_33930)[sharedIdx_33949] =\n                private_mem_33943[i_33948];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33950 = 0; i_33950 < 9; i_33950++) {\n            int32_t sharedIdx_33951 = local_tid_33920 * 9 + i_33950;\n            \n            private_mem_33943[sext_i32_i64(i_33950)] = ((__local\n                                                         bool *) local_mem_33930)[sext_i32_i64(sharedIdx_33951)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_33952 = 0; i_33952 < (int64_t) 9; i_33952++) {\n            int64_t sharedIdx_33953 = sext_i32_i64(local_t",
            "id_33920) + i_33952 *\n                    segscan_group_sizze_30862;\n            \n            ((__local int64_t *) local_mem_33930)[sharedIdx_33953] =\n                private_mem_33945[i_33952];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_33954 = 0; i_33954 < 9; i_33954++) {\n            int32_t sharedIdx_33955 = local_tid_33920 * 9 + i_33954;\n            \n            private_mem_33945[sext_i32_i64(i_33954)] = ((__local\n                                                         int64_t *) local_mem_33930)[sext_i32_i64(sharedIdx_33955)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_33956 = 0; i_33956 < (int64_t) 8; i_33956++) {\n            bool x_29416;\n            bool x_29418;\n            \n            x_29416 = private_mem_33943[i_33956];\n            x_29418 = private_mem_33943[i_33956 + (int64_t) 1];\n            \n            int64_t x_29417;\n            int64_t x_29419;\n            \n            x_29417 = private_mem_33945[i_33956];\n            x_29419 = private_mem_33945[i_33956 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29420;\n            \n            defunc_1_op_res_29420 = x_29416 || x_29418;\n            \n            int64_t defunc_1_op_res_29421;\n            \n            if (x_29418) {\n                defunc_1_op_res_29421 = x_29419;\n            } else {\n                int64_t defunc_1_op_res_29422 = add64(x_29417, x_29419);\n                \n                defunc_1_op_res_29421 = defunc_1_op_res_29422;\n            }\n            private_mem_33943[i_33956 + (int64_t) 1] = defunc_1_op_res_29420;\n            private_mem_33945[i_33956 + (int64_t) 1] = defunc_1_op_res_29421;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_33930)[byte_offsets_33924 +\n                                           sext_i32_i64(local_tid_33920)] =\n            private_mem_33943[(int64_t) 8];\n        ((__local int64_t *) local_mem_33930)[",
            "squot64(byte_offsets_33925,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33920)] =\n            private_mem_33945[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_33964;\n    int64_t acc_33965;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_33957;\n        int64_t x_33958;\n        bool x_33959;\n        int64_t x_33960;\n        bool x_33966;\n        int64_t x_33967;\n        bool x_33968;\n        int64_t x_33969;\n        bool ltid_in_bounds_33973;\n        \n        ltid_in_bounds_33973 = slt64(sext_i32_i64(local_tid_33920),\n                                     segscan_group_sizze_30862);\n        \n        int32_t skip_threads_33974;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_33973) {\n                x_33959 = ((volatile __local\n                            bool *) local_mem_33930)[byte_offsets_33924 +\n                                                     sext_i32_i64(local_tid_33920)];\n                x_33960 = ((volatile __local\n                            int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_33920)];\n                if ((local_tid_33920 - squot32(local_tid_33920, 32) * 32) ==\n                    0) {\n                    x_33957 = x_33959;\n                    x_33958 = x_33960;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_33974 = 1;\n            while (slt32(skip_threads_33974, 32)) {\n                if (sle32(skip_threads_33974, local_tid_33920 -\n                          squot32(local_tid_33920, 32) * 32) &&\n                    ltid_in_bounds_33973) {\n                    // read operands\n                    {\n                        ",
            "x_33957 = ((volatile __local\n                                    bool *) local_mem_33930)[byte_offsets_33924 +\n                                                             (sext_i32_i64(local_tid_33920) -\n                                                              sext_i32_i64(skip_threads_33974))];\n                        x_33958 = ((volatile __local\n                                    int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_33920) -\n                                                                 sext_i32_i64(skip_threads_33974))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_33961 = x_33957 || x_33959;\n                        int64_t defunc_1_op_res_33962;\n                        \n                        if (x_33959) {\n                            defunc_1_op_res_33962 = x_33960;\n                        } else {\n                            int64_t defunc_1_op_res_33963 = add64(x_33958,\n                                                                  x_33960);\n                            \n                            defunc_1_op_res_33962 = defunc_1_op_res_33963;\n                        }\n                        x_33957 = defunc_1_op_res_33961;\n                        x_33958 = defunc_1_op_res_33962;\n                    }\n                }\n                if (sle32(wave_sizze_33922, skip_threads_33974)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_33974, local_tid_33920 -\n                          squot32(local_tid_33920, 32) * 32) &&\n                    ltid_in_bounds_33973) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_33930)[by",
            "te_offsets_33924 +\n                                                   sext_i32_i64(local_tid_33920)] =\n                            x_33957;\n                        x_33959 = x_33957;\n                        ((volatile __local\n                          int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_33920)] =\n                            x_33958;\n                        x_33960 = x_33958;\n                    }\n                }\n                if (sle32(wave_sizze_33922, skip_threads_33974)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_33974 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_33920 - squot32(local_tid_33920, 32) * 32) == 31 &&\n                ltid_in_bounds_33973) {\n                ((volatile __local bool *) local_mem_33930)[byte_offsets_33924 +\n                                                            sext_i32_i64(squot32(local_tid_33920,\n                                                                                 32))] =\n                    x_33957;\n                ((volatile __local\n                  int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_33920,\n                                                                   32))] =\n                    x_33958;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_33975;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid",
            "_33920, 32) == 0 && ltid_in_bounds_33973) {\n                    x_33968 = ((volatile __local\n                                bool *) local_mem_33930)[byte_offsets_33924 +\n                                                         sext_i32_i64(local_tid_33920)];\n                    x_33969 = ((volatile __local\n                                int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_33920)];\n                    if ((local_tid_33920 - squot32(local_tid_33920, 32) * 32) ==\n                        0) {\n                        x_33966 = x_33968;\n                        x_33967 = x_33969;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_33975 = 1;\n                while (slt32(skip_threads_33975, 32)) {\n                    if (sle32(skip_threads_33975, local_tid_33920 -\n                              squot32(local_tid_33920, 32) * 32) &&\n                        (squot32(local_tid_33920, 32) == 0 &&\n                         ltid_in_bounds_33973)) {\n                        // read operands\n                        {\n                            x_33966 = ((volatile __local\n                                        bool *) local_mem_33930)[byte_offsets_33924 +\n                                                                 (sext_i32_i64(local_tid_33920) -\n                                                                  sext_i32_i64(skip_threads_33975))];\n                            x_33967 = ((volatile __local\n                                        int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_33920) -\n     ",
            "                                                                sext_i32_i64(skip_threads_33975))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_33970 = x_33966 || x_33968;\n                            int64_t defunc_1_op_res_33971;\n                            \n                            if (x_33968) {\n                                defunc_1_op_res_33971 = x_33969;\n                            } else {\n                                int64_t defunc_1_op_res_33972 = add64(x_33967,\n                                                                      x_33969);\n                                \n                                defunc_1_op_res_33971 = defunc_1_op_res_33972;\n                            }\n                            x_33966 = defunc_1_op_res_33970;\n                            x_33967 = defunc_1_op_res_33971;\n                        }\n                    }\n                    if (sle32(wave_sizze_33922, skip_threads_33975)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_33975, local_tid_33920 -\n                              squot32(local_tid_33920, 32) * 32) &&\n                        (squot32(local_tid_33920, 32) == 0 &&\n                         ltid_in_bounds_33973)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_33930)[byte_offsets_33924 +\n                                                       sext_i32_i64(local_tid_33920)] =\n                                x_33966;\n                            x_33968 = x_33966;\n                            ((volatile __local\n                              int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                  (int64_t) 8) +\n                                                ",
            "          sext_i32_i64(local_tid_33920)] =\n                                x_33967;\n                            x_33969 = x_33967;\n                        }\n                    }\n                    if (sle32(wave_sizze_33922, skip_threads_33975)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_33975 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_33920, 32) == 0 || !ltid_in_bounds_33973)) {\n                // read operands\n                {\n                    x_33959 = x_33957;\n                    x_33960 = x_33958;\n                    x_33957 = ((__local\n                                bool *) local_mem_33930)[byte_offsets_33924 +\n                                                         (sext_i32_i64(squot32(local_tid_33920,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_33958 = ((__local\n                                int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_33920,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_33961 = x_33957 || x_33959;\n                    int64_t defunc_1_op_res_33962;\n                    \n                    if (x_33959) {\n                        defunc_1_op_res_33962 = x_33960;\n                    } else {\n                        int64_t defunc_1_op_res_33963 = add64(x_33958, x_33960);\n            ",
            "            \n                        defunc_1_op_res_33962 = defunc_1_op_res_33963;\n                    }\n                    x_33957 = defunc_1_op_res_33961;\n                    x_33958 = defunc_1_op_res_33962;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_33930)[byte_offsets_33924 +\n                                                       sext_i32_i64(local_tid_33920)] =\n                        x_33957;\n                    ((__local\n                      int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33920)] =\n                        x_33958;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_33920, 32) == 0) {\n                ((__local bool *) local_mem_33930)[byte_offsets_33924 +\n                                                   sext_i32_i64(local_tid_33920)] =\n                    x_33959;\n                ((__local\n                  int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_33920)] =\n                    x_33960;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_33920 == 0) {\n            acc_33964 = ((__local bool *) local_mem_33930)[byte_offsets_33924 +\n                                                           (segscan_group_sizze_30862 -\n                                                            (int64_t) 1)];\n            acc_33965 = ((__local\n                          int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                              (int64_t",
            ") 8) +\n                                                      (segscan_group_sizze_30862 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_33964 = ((__local bool *) local_mem_33930)[byte_offsets_33924 +\n                                                           (sext_i32_i64(local_tid_33920) -\n                                                            (int64_t) 1)];\n            acc_33965 = ((__local\n                          int64_t *) local_mem_33930)[squot64(byte_offsets_33925,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_33920) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_33976;\n    \n    prefix_33976 = 0;\n    \n    int64_t prefix_33977;\n    \n    prefix_33977 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_33941 == (int64_t) 0 && local_tid_33920 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_33913)[dynamic_id_33941] = acc_33964;\n            ((volatile __global\n              int64_t *) incprefixes_mem_33917)[dynamic_id_33941] = acc_33965;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_33909)[dynamic_id_33941] = (int8_t) 2;\n            acc_33964 = 0;\n            acc_33965 = (int64_t) 0;\n        }\n        if (!(dynamic_id_33941 == (int64_t) 0) && slt32(local_tid_33920,\n                                                        wave_sizze_33922)) {\n            if (local_tid_33920 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_33911)[dynamic_id_33941] = acc_33964;\n                ((volatile __global\n                  int64_t *) aggregates_mem_33915)[dynamic_id_33941] =\n                    acc_33965;\n                mem_fence_global();\n                ((volatile __glo",
            "bal\n                  int8_t *) status_flags_mem_33909)[dynamic_id_33941] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_33930)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_33909)[dynamic_id_33941 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_33978;\n            \n            status_33978 = ((__local int8_t *) local_mem_33930)[(int64_t) 0];\n            if (status_33978 == (int8_t) 2) {\n                if (local_tid_33920 == 0) {\n                    prefix_33976 = ((volatile __global\n                                     bool *) incprefixes_mem_33913)[dynamic_id_33941 -\n                                                                    (int64_t) 1];\n                    prefix_33977 = ((volatile __global\n                                     int64_t *) incprefixes_mem_33917)[dynamic_id_33941 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_33979 = dynamic_id_33941 -\n                        sext_i32_i64(wave_sizze_33922);\n                \n                while (slt32(wave_sizze_33922 * -1, readOffset_33979)) {\n                    int32_t read_i_33980 = readOffset_33979 + local_tid_33920;\n                    bool aggr_33981 = 0;\n                    int64_t aggr_33982 = (int64_t) 0;\n                    int8_t flag_33983 = (int8_t) 0;\n                    int8_t used_33984 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_33980)) {\n                        flag_33983 = ((volatile __global\n                                       int8_t *) status_flags_mem_33909)[sext_i32_i64(read_i_33980)];\n                        if (flag_33983 == (int8_t) 2) {\n                            aggr_33",
            "981 = ((volatile __global\n                                           bool *) incprefixes_mem_33913)[sext_i32_i64(read_i_33980)];\n                            aggr_33982 = ((volatile __global\n                                           int64_t *) incprefixes_mem_33917)[sext_i32_i64(read_i_33980)];\n                        } else {\n                            if (flag_33983 == (int8_t) 1) {\n                                aggr_33981 = ((volatile __global\n                                               bool *) aggregates_mem_33911)[sext_i32_i64(read_i_33980)];\n                                aggr_33982 = ((volatile __global\n                                               int64_t *) aggregates_mem_33915)[sext_i32_i64(read_i_33980)];\n                                used_33984 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_33930)[warp_byte_offset_33927 +\n                                                       sext_i32_i64(local_tid_33920)] =\n                        aggr_33981;\n                    ((__local\n                      int64_t *) local_mem_33930)[squot64(warp_byte_offset_33928,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_33920)] =\n                        aggr_33982;\n                    \n                    int8_t tmp_33985;\n                    \n                    tmp_33985 = flag_33983 | used_33984 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_33930)[sext_i32_i64(local_tid_33920)] =\n                        tmp_33985;\n                    mem_fence_local();\n                    flag_33983 = ((volatile __local\n                                   int8_t *) local_mem_33930)[sext_i32_i64(wave_sizze_33922) -\n                                                              (int64_t) 1];\n                    if (local_tid_33920 == 0) {\n               ",
            "         if (!(flag_33983 == (int8_t) 2)) {\n                            bool x_33986 = 0;\n                            int64_t x_33987 = (int64_t) 0;\n                            bool x_33988;\n                            int64_t x_33989;\n                            int8_t flag1_33993;\n                            \n                            flag1_33993 = (int8_t) 0;\n                            \n                            int8_t flag2_33994;\n                            int8_t used1_33995;\n                            \n                            used1_33995 = (int8_t) 0;\n                            \n                            int8_t used2_33996;\n                            \n                            for (int32_t i_33997 = 0; i_33997 <\n                                 wave_sizze_33922; i_33997++) {\n                                flag2_33994 = ((__local\n                                                int8_t *) local_mem_33930)[sext_i32_i64(i_33997)];\n                                used2_33996 = lshr8(flag2_33994, (int8_t) 2);\n                                flag2_33994 = flag2_33994 & (int8_t) 3;\n                                x_33988 = ((__local\n                                            bool *) local_mem_33930)[warp_byte_offset_33927 +\n                                                                     sext_i32_i64(i_33997)];\n                                x_33989 = ((__local\n                                            int64_t *) local_mem_33930)[squot64(warp_byte_offset_33928,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_33997)];\n                                if (!(flag2_33994 == (int8_t) 1)) {\n                                    flag1_33993 = flag2_33994;\n                                    used1_33995 = used2_33996;\n                                    x_33986 = x_33988;\n                                    x_33987 = x_339",
            "89;\n                                } else {\n                                    used1_33995 += used2_33996;\n                                    \n                                    bool defunc_1_op_res_33990;\n                                    \n                                    defunc_1_op_res_33990 = x_33986 || x_33988;\n                                    \n                                    int64_t defunc_1_op_res_33991;\n                                    \n                                    if (x_33988) {\n                                        defunc_1_op_res_33991 = x_33989;\n                                    } else {\n                                        int64_t defunc_1_op_res_33992 =\n                                                add64(x_33987, x_33989);\n                                        \n                                        defunc_1_op_res_33991 =\n                                            defunc_1_op_res_33992;\n                                    }\n                                    x_33986 = defunc_1_op_res_33990;\n                                    x_33987 = defunc_1_op_res_33991;\n                                }\n                            }\n                            flag_33983 = flag1_33993;\n                            used_33984 = used1_33995;\n                            aggr_33981 = x_33986;\n                            aggr_33982 = x_33987;\n                        } else {\n                            aggr_33981 = ((__local\n                                           bool *) local_mem_33930)[warp_byte_offset_33927 +\n                                                                    (sext_i32_i64(wave_sizze_33922) -\n                                                                     (int64_t) 1)];\n                            aggr_33982 = ((__local\n                                           int64_t *) local_mem_33930)[squot64(warp_byte_offset_33928,\n                                                                               (i",
            "nt64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_33922) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_33983 == (int8_t) 2) {\n                            readOffset_33979 = wave_sizze_33922 * -1;\n                        } else {\n                            readOffset_33979 -= zext_i8_i32(used_33984);\n                        }\n                        ((__local int32_t *) local_mem_33930)[(int64_t) 0] =\n                            readOffset_33979;\n                        \n                        bool x_33998;\n                        \n                        x_33998 = aggr_33981;\n                        \n                        int64_t x_33999;\n                        \n                        x_33999 = aggr_33982;\n                        \n                        bool x_34000;\n                        \n                        x_34000 = prefix_33976;\n                        \n                        int64_t x_34001;\n                        \n                        x_34001 = prefix_33977;\n                        \n                        bool defunc_1_op_res_34002;\n                        \n                        defunc_1_op_res_34002 = x_33998 || x_34000;\n                        \n                        int64_t defunc_1_op_res_34003;\n                        \n                        if (x_34000) {\n                            defunc_1_op_res_34003 = x_34001;\n                        } else {\n                            int64_t defunc_1_op_res_34004 = add64(x_33999,\n                                                                  x_34001);\n                            \n                            defunc_1_op_res_34003 = defunc_1_op_res_34004;\n                        }\n                        prefix_33976 = defunc_1_op_res_34002;\n                        prefix_33977 = defunc_1_op_res_34003;\n                    }\n       ",
            "             mem_fence_local();\n                    readOffset_33979 = ((__local\n                                         int32_t *) local_mem_33930)[(int64_t) 0];\n                }\n            }\n            if (local_tid_33920 == 0) {\n                bool x_34005 = prefix_33976;\n                int64_t x_34006 = prefix_33977;\n                bool x_34007 = acc_33964;\n                int64_t x_34008 = acc_33965;\n                bool defunc_1_op_res_34009 = x_34005 || x_34007;\n                int64_t defunc_1_op_res_34010;\n                \n                if (x_34007) {\n                    defunc_1_op_res_34010 = x_34008;\n                } else {\n                    int64_t defunc_1_op_res_34011 = add64(x_34006, x_34008);\n                    \n                    defunc_1_op_res_34010 = defunc_1_op_res_34011;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_33913)[dynamic_id_33941] =\n                    defunc_1_op_res_34009;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_33917)[dynamic_id_33941] =\n                    defunc_1_op_res_34010;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_33909)[dynamic_id_33941] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_33930)[warp_byte_offset_33927] =\n                    prefix_33976;\n                ((__local\n                  int64_t *) local_mem_33930)[squot64(warp_byte_offset_33928,\n                                                      (int64_t) 8)] =\n                    prefix_33977;\n                acc_33964 = 0;\n                acc_33965 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_33941 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_33976 = ((__local\n                             bool *) local_mem_33930)[warp_byte_offset_33927];\n            prefix_33977 = ((__local\n                            ",
            " int64_t *) local_mem_33930)[squot64(warp_byte_offset_33928,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_34012;\n        bool x_34014;\n        bool x_34019;\n        \n        x_34019 = prefix_33976;\n        \n        bool x_34021;\n        \n        x_34021 = acc_33964;\n        \n        int64_t x_34013;\n        int64_t x_34015;\n        int64_t x_34020;\n        \n        x_34020 = prefix_33977;\n        \n        int64_t x_34022;\n        \n        x_34022 = acc_33965;\n        \n        bool defunc_1_op_res_34023;\n        \n        defunc_1_op_res_34023 = x_34019 || x_34021;\n        \n        int64_t defunc_1_op_res_34024;\n        \n        if (x_34021) {\n            defunc_1_op_res_34024 = x_34022;\n        } else {\n            int64_t defunc_1_op_res_34025 = add64(x_34020, x_34022);\n            \n            defunc_1_op_res_34024 = defunc_1_op_res_34025;\n        }\n        x_34012 = defunc_1_op_res_34023;\n        x_34013 = defunc_1_op_res_34024;\n        for (int64_t i_34026 = 0; i_34026 < (int64_t) 9; i_34026++) {\n            x_34014 = private_mem_33943[i_34026];\n            x_34015 = private_mem_33945[i_34026];\n            \n            bool defunc_1_op_res_34016;\n            \n            defunc_1_op_res_34016 = x_34012 || x_34014;\n            \n            int64_t defunc_1_op_res_34017;\n            \n            if (x_34014) {\n                defunc_1_op_res_34017 = x_34015;\n            } else {\n                int64_t defunc_1_op_res_34018 = add64(x_34013, x_34015);\n                \n                defunc_1_op_res_34017 = defunc_1_op_res_34018;\n            }\n            private_mem_33943[i_34026] = defunc_1_op_res_34016;\n            private_mem_33945[i_34026] = defunc_1_op_res_34017;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34027 = 0; i_34027 < (int64_t) 9; i_34027++) {\n   ",
            "         int64_t sharedIdx_34028 = sext_i32_i64(local_tid_33920 * 9) +\n                    i_34027;\n            \n            ((__local bool *) local_mem_33930)[sharedIdx_34028] =\n                private_mem_33943[i_34027];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34029 = 0; i_34029 < (int64_t) 9; i_34029++) {\n            int32_t sharedIdx_34030 = local_tid_33920 +\n                    sext_i64_i32(segscan_group_sizze_30862 * i_34029);\n            \n            private_mem_33943[i_34029] = ((__local\n                                           bool *) local_mem_33930)[sext_i32_i64(sharedIdx_34030)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34031 = 0; i_34031 < (int64_t) 9; i_34031++) {\n            int64_t sharedIdx_34032 = sext_i32_i64(local_tid_33920 * 9) +\n                    i_34031;\n            \n            ((__local int64_t *) local_mem_33930)[sharedIdx_34032] =\n                private_mem_33945[i_34031];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34033 = 0; i_34033 < (int64_t) 9; i_34033++) {\n            int32_t sharedIdx_34034 = local_tid_33920 +\n                    sext_i64_i32(segscan_group_sizze_30862 * i_34033);\n            \n            private_mem_33945[i_34033] = ((__local\n                                           int64_t *) local_mem_33930)[sext_i32_i64(sharedIdx_34034)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34035 = 0; i_34035 < (int64_t) 9; i_34035++) {\n            int64_t gtid_30866 = blockOff_33942 + segscan_group_sizze_30862 *\n                    i_34035 + sext_i32_i64(local_tid_33920);\n            \n            if (slt64(gtid_30866, defunc_2_reduce_res_29171)) {\n                ((__global bool *) mem_32179)[gtid_30866] =\n                    private_mem_33943[i_34035];\n            }\n        }\n        for (int64_t i_34036 = 0; i_34036 < (int64_t) 9; i_34036++) {\n            ",
            "int64_t gtid_30866 = blockOff_33942 + segscan_group_sizze_30862 *\n                    i_34036 + sext_i32_i64(local_tid_33920);\n            \n            if (slt64(gtid_30866, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32181)[gtid_30866] =\n                    private_mem_33945[i_34036];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_33941 == sdiv_up64(defunc_2_reduce_res_29171,\n                                          segscan_group_sizze_30862 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_33907)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30862\n}\n__kernel void test_clusterWithzisegscan_30875(__global int *global_failure,\n                                              uint local_mem_34057_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29171,\n                                              __global unsigned char *mem_32176,\n                                              __global unsigned char *mem_32184,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34040,\n                                              __global\n                                              unsigned char *status_flags_mem_34042,\n                                              __global\n                                              unsigned char *aggregates_mem_34044,\n                                              __global\n                                              unsigned char *incprefixes_mem_34046)\n{\n    #define segscan_group_sizze_30870 (test_clusterWithzisegscan_group_sizze_30869)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *lo",
            "cal_mem_34057_backing_0 =\n                  &shared_mem[local_mem_34057_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34048;\n    int32_t local_tid_34049;\n    int64_t group_sizze_34052;\n    int32_t wave_sizze_34051;\n    int32_t group_tid_34050;\n    \n    global_tid_34048 = get_global_id(0);\n    local_tid_34049 = get_local_id(0);\n    group_sizze_34052 = get_local_size(0);\n    wave_sizze_34051 = LOCKSTEP_WIDTH;\n    group_tid_34050 = get_group_id(0);\n    \n    int32_t phys_tid_30875;\n    \n    phys_tid_30875 = global_tid_34048;\n    \n    int64_t byte_offsets_34053;\n    \n    byte_offsets_34053 = (int64_t) 0;\n    \n    int64_t byte_offsets_34054;\n    \n    byte_offsets_34054 = segscan_group_sizze_30870 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34055;\n    \n    warp_byte_offset_34055 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34056;\n    \n    warp_byte_offset_34056 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34057;\n    \n    local_mem_34057 = (__local char *) local_mem_34057_backing_0;\n    \n    int64_t trans_arr_len_34058;\n    \n    trans_arr_len_34058 = (int64_t) 9 * segscan_group_sizze_30870;\n    \n    int32_t dynamic_id_34065;\n    \n    if (local_tid_34049 == 0) {\n        dynamic_id_34065 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34040)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34057)[(int64_t) 0] = dynamic_id_34065;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34065 = ((__local int32_t *) local_mem_34057)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34066;\n    \n    blockOff_34066 = sext_i32_i64(dynamic_id_34065) * (int64_t) 9 *\n        segscan_group_sizze_30870;\n    \n    int64_t private_mem_34067[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34069 = 0; ",
            "i_34069 < (int64_t) 9; i_34069++) {\n            int64_t gtid_30874 = blockOff_34066 +\n                    sext_i32_i64(local_tid_34049) + i_34069 *\n                    segscan_group_sizze_30870;\n            \n            if (slt64(gtid_30874, defunc_2_reduce_res_29171)) {\n                int64_t i_p_o_31873 = add64((int64_t) 1, gtid_30874);\n                int64_t rot_i_31874 = smod64(i_p_o_31873,\n                                             defunc_2_reduce_res_29171);\n                bool x_29430 = ((__global bool *) mem_32176)[rot_i_31874];\n                int64_t defunc_0_f_res_29431 = btoi_bool_i64(x_29430);\n                \n                private_mem_34067[i_34069] = defunc_0_f_res_29431;\n            } else {\n                private_mem_34067[i_34069] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34070 = 0; i_34070 < (int64_t) 9; i_34070++) {\n            int64_t sharedIdx_34071 = sext_i32_i64(local_tid_34049) + i_34070 *\n                    segscan_group_sizze_30870;\n            \n            ((__local int64_t *) local_mem_34057)[sharedIdx_34071] =\n                private_mem_34067[i_34070];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34072 = 0; i_34072 < 9; i_34072++) {\n            int32_t sharedIdx_34073 = local_tid_34049 * 9 + i_34072;\n            \n            private_mem_34067[sext_i32_i64(i_34072)] = ((__local\n                                                         int64_t *) local_mem_34057)[sext_i32_i64(sharedIdx_34073)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34074 = 0; i_34074 < (int64_t) 8; i_34074++) {\n            int64_t x_29427;\n            int64_t x_29428;\n            \n            x_29427 = private_mem_34067[i_34074];\n            x_29428 = private_mem_34067[i_34074 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29429;\n            \n            d",
            "efunc_1_op_res_29429 = add64(x_29427, x_29428);\n            private_mem_34067[i_34074 + (int64_t) 1] = defunc_1_op_res_29429;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34049)] =\n            private_mem_34067[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34078;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34075;\n        int64_t x_34076;\n        int64_t x_34079;\n        int64_t x_34080;\n        bool ltid_in_bounds_34082;\n        \n        ltid_in_bounds_34082 = slt64(sext_i32_i64(local_tid_34049),\n                                     segscan_group_sizze_30870);\n        \n        int32_t skip_threads_34083;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34082) {\n                x_34076 = ((volatile __local\n                            int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34049)];\n                if ((local_tid_34049 - squot32(local_tid_34049, 32) * 32) ==\n                    0) {\n                    x_34075 = x_34076;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34083 = 1;\n            while (slt32(skip_threads_34083, 32)) {\n                if (sle32(skip_threads_34083, local_tid_34049 -\n                          squot32(local_tid_34049, 32) * 32) &&\n                    ltid_in_bounds_34082) {\n                    // read operands\n                    {\n                        x_34075 = ((volatile __local\n                                    int64_t *) local_mem_34057)[squot64(byte_offsets_340",
            "53,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34049) -\n                                                                 sext_i32_i64(skip_threads_34083))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_34077 = add64(x_34075, x_34076);\n                        \n                        x_34075 = defunc_1_op_res_34077;\n                    }\n                }\n                if (sle32(wave_sizze_34051, skip_threads_34083)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34083, local_tid_34049 -\n                          squot32(local_tid_34049, 32) * 32) &&\n                    ltid_in_bounds_34082) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34049)] =\n                            x_34075;\n                        x_34076 = x_34075;\n                    }\n                }\n                if (sle32(wave_sizze_34051, skip_threads_34083)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34083 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34049 - squot32(local_tid_34049, 32) * 32) == 31 &&\n                ltid_in_bounds_34082) {\n                ((volatile __local\n                  int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                      (int64_t) 8) +\n                                    ",
            "          sext_i32_i64(squot32(local_tid_34049,\n                                                                   32))] =\n                    x_34075;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34084;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34049, 32) == 0 && ltid_in_bounds_34082) {\n                    x_34080 = ((volatile __local\n                                int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34049)];\n                    if ((local_tid_34049 - squot32(local_tid_34049, 32) * 32) ==\n                        0) {\n                        x_34079 = x_34080;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34084 = 1;\n                while (slt32(skip_threads_34084, 32)) {\n                    if (sle32(skip_threads_34084, local_tid_34049 -\n                              squot32(local_tid_34049, 32) * 32) &&\n                        (squot32(local_tid_34049, 32) == 0 &&\n                         ltid_in_bounds_34082)) {\n                        // read operands\n                        {\n                            x_34079 = ((volatile __local\n                                        int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_34049) -\n                                                                     sext_i32_i64(skip_threads_34084))];\n                        }\n              ",
            "          // perform operation\n                        {\n                            int64_t defunc_1_op_res_34081 = add64(x_34079,\n                                                                  x_34080);\n                            \n                            x_34079 = defunc_1_op_res_34081;\n                        }\n                    }\n                    if (sle32(wave_sizze_34051, skip_threads_34084)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34084, local_tid_34049 -\n                              squot32(local_tid_34049, 32) * 32) &&\n                        (squot32(local_tid_34049, 32) == 0 &&\n                         ltid_in_bounds_34082)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34049)] =\n                                x_34079;\n                            x_34080 = x_34079;\n                        }\n                    }\n                    if (sle32(wave_sizze_34051, skip_threads_34084)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34084 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34049, 32) == 0 || !ltid_in_bounds_34082)) {\n                // read operands\n                {\n                    x_34076 = x_34075;\n                    x_34075 = ((__local\n                                int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                                    (int64_t) 8) +\n                                   ",
            "                         (sext_i32_i64(squot32(local_tid_34049,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_34077 = add64(x_34075, x_34076);\n                    \n                    x_34075 = defunc_1_op_res_34077;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34049)] =\n                        x_34075;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34049, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34049)] =\n                    x_34076;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34049 == 0) {\n            acc_34078 = ((__local\n                          int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30870 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34078 = ((__local\n                          int64_t *) local_mem_34057)[squot64(byte_offsets_34053,\n                                                              (int64_t) 8) +\n              ",
            "                                        (sext_i32_i64(local_tid_34049) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34085;\n    \n    prefix_34085 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34065 == (int64_t) 0 && local_tid_34049 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34046)[dynamic_id_34065] = acc_34078;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34042)[dynamic_id_34065] = (int8_t) 2;\n            acc_34078 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34065 == (int64_t) 0) && slt32(local_tid_34049,\n                                                        wave_sizze_34051)) {\n            if (local_tid_34049 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34044)[dynamic_id_34065] =\n                    acc_34078;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34042)[dynamic_id_34065] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34057)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_34042)[dynamic_id_34065 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34086;\n            \n            status_34086 = ((__local int8_t *) local_mem_34057)[(int64_t) 0];\n            if (status_34086 == (int8_t) 2) {\n                if (local_tid_34049 == 0) {\n                    prefix_34085 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34046)[dynamic_id_34065 -\n                                                                       (int64_t) 1];\n      ",
            "          }\n            } else {\n                int32_t readOffset_34087 = dynamic_id_34065 -\n                        sext_i32_i64(wave_sizze_34051);\n                \n                while (slt32(wave_sizze_34051 * -1, readOffset_34087)) {\n                    int32_t read_i_34088 = readOffset_34087 + local_tid_34049;\n                    int64_t aggr_34089 = (int64_t) 0;\n                    int8_t flag_34090 = (int8_t) 0;\n                    int8_t used_34091 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34088)) {\n                        flag_34090 = ((volatile __global\n                                       int8_t *) status_flags_mem_34042)[sext_i32_i64(read_i_34088)];\n                        if (flag_34090 == (int8_t) 2) {\n                            aggr_34089 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34046)[sext_i32_i64(read_i_34088)];\n                        } else {\n                            if (flag_34090 == (int8_t) 1) {\n                                aggr_34089 = ((volatile __global\n                                               int64_t *) aggregates_mem_34044)[sext_i32_i64(read_i_34088)];\n                                used_34091 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_34057)[squot64(warp_byte_offset_34055,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34049)] =\n                        aggr_34089;\n                    \n                    int8_t tmp_34092;\n                    \n                    tmp_34092 = flag_34090 | used_34091 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34057)[sext_i32_i64(local_tid_34049)] =\n                        tmp_34092;\n                    mem_fence_local();\n                    flag_3",
            "4090 = ((volatile __local\n                                   int8_t *) local_mem_34057)[sext_i32_i64(wave_sizze_34051) -\n                                                              (int64_t) 1];\n                    if (local_tid_34049 == 0) {\n                        if (!(flag_34090 == (int8_t) 2)) {\n                            int64_t x_34093 = (int64_t) 0;\n                            int64_t x_34094;\n                            int8_t flag1_34096;\n                            \n                            flag1_34096 = (int8_t) 0;\n                            \n                            int8_t flag2_34097;\n                            int8_t used1_34098;\n                            \n                            used1_34098 = (int8_t) 0;\n                            \n                            int8_t used2_34099;\n                            \n                            for (int32_t i_34100 = 0; i_34100 <\n                                 wave_sizze_34051; i_34100++) {\n                                flag2_34097 = ((__local\n                                                int8_t *) local_mem_34057)[sext_i32_i64(i_34100)];\n                                used2_34099 = lshr8(flag2_34097, (int8_t) 2);\n                                flag2_34097 = flag2_34097 & (int8_t) 3;\n                                x_34094 = ((__local\n                                            int64_t *) local_mem_34057)[squot64(warp_byte_offset_34055,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34100)];\n                                if (!(flag2_34097 == (int8_t) 1)) {\n                                    flag1_34096 = flag2_34097;\n                                    used1_34098 = used2_34099;\n                                    x_34093 = x_34094;\n                                } else {\n                                    used1_34098 += used2_34099;\n             ",
            "                       \n                                    int64_t defunc_1_op_res_34095;\n                                    \n                                    defunc_1_op_res_34095 = add64(x_34093,\n                                                                  x_34094);\n                                    x_34093 = defunc_1_op_res_34095;\n                                }\n                            }\n                            flag_34090 = flag1_34096;\n                            used_34091 = used1_34098;\n                            aggr_34089 = x_34093;\n                        } else {\n                            aggr_34089 = ((__local\n                                           int64_t *) local_mem_34057)[squot64(warp_byte_offset_34055,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34051) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34090 == (int8_t) 2) {\n                            readOffset_34087 = wave_sizze_34051 * -1;\n                        } else {\n                            readOffset_34087 -= zext_i8_i32(used_34091);\n                        }\n                        ((__local int32_t *) local_mem_34057)[(int64_t) 0] =\n                            readOffset_34087;\n                        \n                        int64_t x_34101;\n                        \n                        x_34101 = aggr_34089;\n                        \n                        int64_t x_34102;\n                        \n                        x_34102 = prefix_34085;\n                        \n                        int64_t defunc_1_op_res_34103;\n                        \n                        defunc_1_op_res_34103 = add64(x_34101, x_34102);\n                        prefix_34085 = defunc_1_op_res_34103;\n                    }\n            ",
            "        mem_fence_local();\n                    readOffset_34087 = ((__local\n                                         int32_t *) local_mem_34057)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34049 == 0) {\n                int64_t x_34104 = prefix_34085;\n                int64_t x_34105 = acc_34078;\n                int64_t defunc_1_op_res_34106 = add64(x_34104, x_34105);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34046)[dynamic_id_34065] =\n                    defunc_1_op_res_34106;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34042)[dynamic_id_34065] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34057)[squot64(warp_byte_offset_34055,\n                                                      (int64_t) 8)] =\n                    prefix_34085;\n                acc_34078 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34065 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34085 = ((__local\n                             int64_t *) local_mem_34057)[squot64(warp_byte_offset_34055,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34107;\n        int64_t x_34108;\n        int64_t x_34110;\n        \n        x_34110 = prefix_34085;\n        \n        int64_t x_34111;\n        \n        x_34111 = acc_34078;\n        \n        int64_t defunc_1_op_res_34112;\n        \n        defunc_1_op_res_34112 = add64(x_34110, x_34111);\n        x_34107 = defunc_1_op_res_34112;\n        for (int64_t i_34113 = 0; i_34113 < (int64_t) 9; i_34113++) {\n            x_34108 = private_mem_34067[i_34113];\n            \n            int64_t defunc_1_op_res_34109;\n            \n            defunc_1_op_res_34109 = add64(x_34107, x_34108);\n     ",
            "       private_mem_34067[i_34113] = defunc_1_op_res_34109;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34114 = 0; i_34114 < (int64_t) 9; i_34114++) {\n            int64_t sharedIdx_34115 = sext_i32_i64(local_tid_34049 * 9) +\n                    i_34114;\n            \n            ((__local int64_t *) local_mem_34057)[sharedIdx_34115] =\n                private_mem_34067[i_34114];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34116 = 0; i_34116 < (int64_t) 9; i_34116++) {\n            int32_t sharedIdx_34117 = local_tid_34049 +\n                    sext_i64_i32(segscan_group_sizze_30870 * i_34116);\n            \n            private_mem_34067[i_34116] = ((__local\n                                           int64_t *) local_mem_34057)[sext_i32_i64(sharedIdx_34117)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34118 = 0; i_34118 < (int64_t) 9; i_34118++) {\n            int64_t gtid_30874 = blockOff_34066 + segscan_group_sizze_30870 *\n                    i_34118 + sext_i32_i64(local_tid_34049);\n            \n            if (slt64(gtid_30874, defunc_2_reduce_res_29171)) {\n                ((__global int64_t *) mem_32184)[gtid_30874] =\n                    private_mem_34067[i_34118];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34065 == sdiv_up64(defunc_2_reduce_res_29171,\n                                          segscan_group_sizze_30870 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34040)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30870\n}\n__kernel void test_clusterWithzisegscan_30889(__global int *global_failure,\n                                              uint lo",
            "cal_mem_34144_backing_offset_0,\n                                              int64_t num_segments_29432,\n                                              __global unsigned char *mem_32186,\n                                              __global unsigned char *mem_32190,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34127,\n                                              __global\n                                              unsigned char *status_flags_mem_34129,\n                                              __global\n                                              unsigned char *aggregates_mem_34131,\n                                              __global\n                                              unsigned char *incprefixes_mem_34133)\n{\n    #define segscan_group_sizze_30884 (test_clusterWithzisegscan_group_sizze_30883)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34144_backing_0 =\n                  &shared_mem[local_mem_34144_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34135;\n    int32_t local_tid_34136;\n    int64_t group_sizze_34139;\n    int32_t wave_sizze_34138;\n    int32_t group_tid_34137;\n    \n    global_tid_34135 = get_global_id(0);\n    local_tid_34136 = get_local_id(0);\n    group_sizze_34139 = get_local_size(0);\n    wave_sizze_34138 = LOCKSTEP_WIDTH;\n    group_tid_34137 = get_group_id(0);\n    \n    int32_t phys_tid_30889;\n    \n    phys_tid_30889 = global_tid_34135;\n    \n    int64_t byte_offsets_34140;\n    \n    byte_offsets_34140 = (int64_t) 0;\n    \n    int64_t byte_offsets_34141;\n    \n    byte_offsets_34141 = segscan_group_sizze_30884 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34142;\n    \n    warp_byte_offset_34142 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34143;\n    \n    warp_byte_offset_34143 = (int64_t) 288;\n    // Allo",
            "cate reused shared memeory\n    { }\n    \n    __local char *local_mem_34144;\n    \n    local_mem_34144 = (__local char *) local_mem_34144_backing_0;\n    \n    int64_t trans_arr_len_34145;\n    \n    trans_arr_len_34145 = (int64_t) 9 * segscan_group_sizze_30884;\n    \n    int32_t dynamic_id_34152;\n    \n    if (local_tid_34136 == 0) {\n        dynamic_id_34152 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34127)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34144)[(int64_t) 0] = dynamic_id_34152;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34152 = ((__local int32_t *) local_mem_34144)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34153;\n    \n    blockOff_34153 = sext_i32_i64(dynamic_id_34152) * (int64_t) 9 *\n        segscan_group_sizze_30884;\n    \n    int64_t private_mem_34154[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34156 = 0; i_34156 < (int64_t) 9; i_34156++) {\n            int64_t gtid_30888 = blockOff_34153 +\n                    sext_i32_i64(local_tid_34136) + i_34156 *\n                    segscan_group_sizze_30884;\n            \n            if (slt64(gtid_30888, num_segments_29432)) {\n                int64_t x_29449 = ((__global int64_t *) mem_32186)[gtid_30888];\n                \n                private_mem_34154[i_34156] = x_29449;\n            } else {\n                private_mem_34154[i_34156] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34157 = 0; i_34157 < (int64_t) 9; i_34157++) {\n            int64_t sharedIdx_34158 = sext_i32_i64(local_tid_34136) + i_34157 *\n                    segscan_group_sizze_30884;\n            \n            ((__local int64_t *) local_mem_34144)[sharedIdx_34158] =\n                private_mem_34154[i_34157];\n        }\n        barrier(CLK_LOCAL_",
            "MEM_FENCE);\n        for (int32_t i_34159 = 0; i_34159 < 9; i_34159++) {\n            int32_t sharedIdx_34160 = local_tid_34136 * 9 + i_34159;\n            \n            private_mem_34154[sext_i32_i64(i_34159)] = ((__local\n                                                         int64_t *) local_mem_34144)[sext_i32_i64(sharedIdx_34160)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34161 = 0; i_34161 < (int64_t) 8; i_34161++) {\n            int64_t x_29446;\n            int64_t x_29447;\n            \n            x_29446 = private_mem_34154[i_34161];\n            x_29447 = private_mem_34154[i_34161 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29448;\n            \n            defunc_1_op_res_29448 = add64(x_29446, x_29447);\n            private_mem_34154[i_34161 + (int64_t) 1] = defunc_1_op_res_29448;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34136)] =\n            private_mem_34154[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34165;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34162;\n        int64_t x_34163;\n        int64_t x_34166;\n        int64_t x_34167;\n        bool ltid_in_bounds_34169;\n        \n        ltid_in_bounds_34169 = slt64(sext_i32_i64(local_tid_34136),\n                                     segscan_group_sizze_30884);\n        \n        int32_t skip_threads_34170;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34169) {\n                x_34163 = ((volatile __local\n                            int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                (int64_t) 8) +\n                                         ",
            "               sext_i32_i64(local_tid_34136)];\n                if ((local_tid_34136 - squot32(local_tid_34136, 32) * 32) ==\n                    0) {\n                    x_34162 = x_34163;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34170 = 1;\n            while (slt32(skip_threads_34170, 32)) {\n                if (sle32(skip_threads_34170, local_tid_34136 -\n                          squot32(local_tid_34136, 32) * 32) &&\n                    ltid_in_bounds_34169) {\n                    // read operands\n                    {\n                        x_34162 = ((volatile __local\n                                    int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34136) -\n                                                                 sext_i32_i64(skip_threads_34170))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_34164 = add64(x_34162, x_34163);\n                        \n                        x_34162 = defunc_1_op_res_34164;\n                    }\n                }\n                if (sle32(wave_sizze_34138, skip_threads_34170)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34170, local_tid_34136 -\n                          squot32(local_tid_34136, 32) * 32) &&\n                    ltid_in_bounds_34169) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34136)] =\n             ",
            "               x_34162;\n                        x_34163 = x_34162;\n                    }\n                }\n                if (sle32(wave_sizze_34138, skip_threads_34170)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34170 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34136 - squot32(local_tid_34136, 32) * 32) == 31 &&\n                ltid_in_bounds_34169) {\n                ((volatile __local\n                  int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34136,\n                                                                   32))] =\n                    x_34162;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34171;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34136, 32) == 0 && ltid_in_bounds_34169) {\n                    x_34167 = ((volatile __local\n                                int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34136)];\n                    if ((local_tid_34136 - squot32(local_tid_34136, 32) * 32) ==\n                        0) {\n                        x_34166 = x_34167;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34171 = 1;\n                while (slt32(skip_threads_34171, 32)) {\n                    if (sle32(skip_threads_34171,",
            " local_tid_34136 -\n                              squot32(local_tid_34136, 32) * 32) &&\n                        (squot32(local_tid_34136, 32) == 0 &&\n                         ltid_in_bounds_34169)) {\n                        // read operands\n                        {\n                            x_34166 = ((volatile __local\n                                        int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_34136) -\n                                                                     sext_i32_i64(skip_threads_34171))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_34168 = add64(x_34166,\n                                                                  x_34167);\n                            \n                            x_34166 = defunc_1_op_res_34168;\n                        }\n                    }\n                    if (sle32(wave_sizze_34138, skip_threads_34171)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34171, local_tid_34136 -\n                              squot32(local_tid_34136, 32) * 32) &&\n                        (squot32(local_tid_34136, 32) == 0 &&\n                         ltid_in_bounds_34169)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34136)] =\n                                x_34166;\n                            x_34167 = x_34166;\n                        }\n                  ",
            "  }\n                    if (sle32(wave_sizze_34138, skip_threads_34171)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34171 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34136, 32) == 0 || !ltid_in_bounds_34169)) {\n                // read operands\n                {\n                    x_34163 = x_34162;\n                    x_34162 = ((__local\n                                int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34136,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_34164 = add64(x_34162, x_34163);\n                    \n                    x_34162 = defunc_1_op_res_34164;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34136)] =\n                        x_34162;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34136, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64",
            "(local_tid_34136)] =\n                    x_34163;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34136 == 0) {\n            acc_34165 = ((__local\n                          int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30884 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34165 = ((__local\n                          int64_t *) local_mem_34144)[squot64(byte_offsets_34140,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_34136) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34172;\n    \n    prefix_34172 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34152 == (int64_t) 0 && local_tid_34136 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34133)[dynamic_id_34152] = acc_34165;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34129)[dynamic_id_34152] = (int8_t) 2;\n            acc_34165 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34152 == (int64_t) 0) && slt32(local_tid_34136,\n                                                        wave_sizze_34138)) {\n            if (local_tid_34136 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34131)[dynamic_id_34152] =\n                    acc_34165;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34129)[dynamic_id_34152] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34144)[(int64_t) 0] = ((__",
            "global\n                                                                      int8_t *) status_flags_mem_34129)[dynamic_id_34152 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34173;\n            \n            status_34173 = ((__local int8_t *) local_mem_34144)[(int64_t) 0];\n            if (status_34173 == (int8_t) 2) {\n                if (local_tid_34136 == 0) {\n                    prefix_34172 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34133)[dynamic_id_34152 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34174 = dynamic_id_34152 -\n                        sext_i32_i64(wave_sizze_34138);\n                \n                while (slt32(wave_sizze_34138 * -1, readOffset_34174)) {\n                    int32_t read_i_34175 = readOffset_34174 + local_tid_34136;\n                    int64_t aggr_34176 = (int64_t) 0;\n                    int8_t flag_34177 = (int8_t) 0;\n                    int8_t used_34178 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34175)) {\n                        flag_34177 = ((volatile __global\n                                       int8_t *) status_flags_mem_34129)[sext_i32_i64(read_i_34175)];\n                        if (flag_34177 == (int8_t) 2) {\n                            aggr_34176 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34133)[sext_i32_i64(read_i_34175)];\n                        } else {\n                            if (flag_34177 == (int8_t) 1) {\n                                aggr_34176 = ((volatile __global\n                                               int64_t *) aggregates_mem_34131)[sext_i32_i64(read_i_34175)];\n                                used_34178 = (",
            "int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_34144)[squot64(warp_byte_offset_34142,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34136)] =\n                        aggr_34176;\n                    \n                    int8_t tmp_34179;\n                    \n                    tmp_34179 = flag_34177 | used_34178 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34144)[sext_i32_i64(local_tid_34136)] =\n                        tmp_34179;\n                    mem_fence_local();\n                    flag_34177 = ((volatile __local\n                                   int8_t *) local_mem_34144)[sext_i32_i64(wave_sizze_34138) -\n                                                              (int64_t) 1];\n                    if (local_tid_34136 == 0) {\n                        if (!(flag_34177 == (int8_t) 2)) {\n                            int64_t x_34180 = (int64_t) 0;\n                            int64_t x_34181;\n                            int8_t flag1_34183;\n                            \n                            flag1_34183 = (int8_t) 0;\n                            \n                            int8_t flag2_34184;\n                            int8_t used1_34185;\n                            \n                            used1_34185 = (int8_t) 0;\n                            \n                            int8_t used2_34186;\n                            \n                            for (int32_t i_34187 = 0; i_34187 <\n                                 wave_sizze_34138; i_34187++) {\n                                flag2_34184 = ((__local\n                                                int8_t *) local_mem_34144)[sext_i32_i64(i_34187)];\n                                used2_34186 = lshr8(flag2_34184, (int8_t) 2);\n                              ",
            "  flag2_34184 = flag2_34184 & (int8_t) 3;\n                                x_34181 = ((__local\n                                            int64_t *) local_mem_34144)[squot64(warp_byte_offset_34142,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34187)];\n                                if (!(flag2_34184 == (int8_t) 1)) {\n                                    flag1_34183 = flag2_34184;\n                                    used1_34185 = used2_34186;\n                                    x_34180 = x_34181;\n                                } else {\n                                    used1_34185 += used2_34186;\n                                    \n                                    int64_t defunc_1_op_res_34182;\n                                    \n                                    defunc_1_op_res_34182 = add64(x_34180,\n                                                                  x_34181);\n                                    x_34180 = defunc_1_op_res_34182;\n                                }\n                            }\n                            flag_34177 = flag1_34183;\n                            used_34178 = used1_34185;\n                            aggr_34176 = x_34180;\n                        } else {\n                            aggr_34176 = ((__local\n                                           int64_t *) local_mem_34144)[squot64(warp_byte_offset_34142,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34138) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34177 == (int8_t) 2) {\n                            readOffset_34174 = wave_sizze_34138 * -1;\n                        } else {\n                ",
            "            readOffset_34174 -= zext_i8_i32(used_34178);\n                        }\n                        ((__local int32_t *) local_mem_34144)[(int64_t) 0] =\n                            readOffset_34174;\n                        \n                        int64_t x_34188;\n                        \n                        x_34188 = aggr_34176;\n                        \n                        int64_t x_34189;\n                        \n                        x_34189 = prefix_34172;\n                        \n                        int64_t defunc_1_op_res_34190;\n                        \n                        defunc_1_op_res_34190 = add64(x_34188, x_34189);\n                        prefix_34172 = defunc_1_op_res_34190;\n                    }\n                    mem_fence_local();\n                    readOffset_34174 = ((__local\n                                         int32_t *) local_mem_34144)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34136 == 0) {\n                int64_t x_34191 = prefix_34172;\n                int64_t x_34192 = acc_34165;\n                int64_t defunc_1_op_res_34193 = add64(x_34191, x_34192);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34133)[dynamic_id_34152] =\n                    defunc_1_op_res_34193;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34129)[dynamic_id_34152] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34144)[squot64(warp_byte_offset_34142,\n                                                      (int64_t) 8)] =\n                    prefix_34172;\n                acc_34165 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34152 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34172 = ((__local\n                             int64_t *) local_mem_34144)[squot64(warp_byte_offset_34142,\n            ",
            "                                                     (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34194;\n        int64_t x_34195;\n        int64_t x_34197;\n        \n        x_34197 = prefix_34172;\n        \n        int64_t x_34198;\n        \n        x_34198 = acc_34165;\n        \n        int64_t defunc_1_op_res_34199;\n        \n        defunc_1_op_res_34199 = add64(x_34197, x_34198);\n        x_34194 = defunc_1_op_res_34199;\n        for (int64_t i_34200 = 0; i_34200 < (int64_t) 9; i_34200++) {\n            x_34195 = private_mem_34154[i_34200];\n            \n            int64_t defunc_1_op_res_34196;\n            \n            defunc_1_op_res_34196 = add64(x_34194, x_34195);\n            private_mem_34154[i_34200] = defunc_1_op_res_34196;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34201 = 0; i_34201 < (int64_t) 9; i_34201++) {\n            int64_t sharedIdx_34202 = sext_i32_i64(local_tid_34136 * 9) +\n                    i_34201;\n            \n            ((__local int64_t *) local_mem_34144)[sharedIdx_34202] =\n                private_mem_34154[i_34201];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34203 = 0; i_34203 < (int64_t) 9; i_34203++) {\n            int32_t sharedIdx_34204 = local_tid_34136 +\n                    sext_i64_i32(segscan_group_sizze_30884 * i_34203);\n            \n            private_mem_34154[i_34203] = ((__local\n                                           int64_t *) local_mem_34144)[sext_i32_i64(sharedIdx_34204)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34205 = 0; i_34205 < (int64_t) 9; i_34205++) {\n            int64_t gtid_30888 = blockOff_34153 + segscan_group_sizze_30884 *\n                    i_34205 + sext_i32_i64(local_tid_34136);\n            \n            if (slt64(gtid_30888, num_segments_29432))",
            " {\n                ((__global int64_t *) mem_32190)[gtid_30888] =\n                    private_mem_34154[i_34205];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34152 == sdiv_up64(num_segments_29432,\n                                          segscan_group_sizze_30884 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34127)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30884\n}\n__kernel void test_clusterWithzisegscan_30943(__global int *global_failure,\n                                              uint local_mem_34247_backing_offset_0,\n                                              int64_t num_segments_29432,\n                                              __global unsigned char *mem_32202,\n                                              __global unsigned char *mem_32205,\n                                              __global unsigned char *mem_32207,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34224,\n                                              __global\n                                              unsigned char *status_flags_mem_34226,\n                                              __global\n                                              unsigned char *aggregates_mem_34228,\n                                              __global\n                                              unsigned char *incprefixes_mem_34230,\n                                              __global\n                                              unsigned char *aggregates_mem_34232,\n                                              __global\n                                              unsigned char *incprefixes_mem_34234)\n{\n    #define segscan_group_sizze_30938 (test_clusterWithzi",
            "segscan_group_sizze_30937)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34247_backing_0 =\n                  &shared_mem[local_mem_34247_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34236;\n    int32_t local_tid_34237;\n    int64_t group_sizze_34240;\n    int32_t wave_sizze_34239;\n    int32_t group_tid_34238;\n    \n    global_tid_34236 = get_global_id(0);\n    local_tid_34237 = get_local_id(0);\n    group_sizze_34240 = get_local_size(0);\n    wave_sizze_34239 = LOCKSTEP_WIDTH;\n    group_tid_34238 = get_group_id(0);\n    \n    int32_t phys_tid_30943;\n    \n    phys_tid_30943 = global_tid_34236;\n    \n    int64_t byte_offsets_34241;\n    \n    byte_offsets_34241 = (int64_t) 0;\n    \n    int64_t byte_offsets_34242;\n    \n    byte_offsets_34242 = segscan_group_sizze_30938;\n    \n    int64_t byte_offsets_34243;\n    \n    byte_offsets_34243 = sdiv_up64(segscan_group_sizze_30938, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30938 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34244;\n    \n    warp_byte_offset_34244 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34245;\n    \n    warp_byte_offset_34245 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_34246;\n    \n    warp_byte_offset_34246 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34247;\n    \n    local_mem_34247 = (__local char *) local_mem_34247_backing_0;\n    \n    int64_t trans_arr_len_34248;\n    \n    trans_arr_len_34248 = (int64_t) 9 * segscan_group_sizze_30938;\n    \n    int32_t dynamic_id_34258;\n    \n    if (local_tid_34237 == 0) {\n        dynamic_id_34258 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34224)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34247)[(int64_t) 0] = dynamic_id_3",
            "4258;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34258 = ((__local int32_t *) local_mem_34247)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34259;\n    \n    blockOff_34259 = sext_i32_i64(dynamic_id_34258) * (int64_t) 9 *\n        segscan_group_sizze_30938;\n    \n    bool private_mem_34260[9];\n    int64_t private_mem_34262[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34264 = 0; i_34264 < (int64_t) 9; i_34264++) {\n            int64_t gtid_30942 = blockOff_34259 +\n                    sext_i32_i64(local_tid_34237) + i_34264 *\n                    segscan_group_sizze_30938;\n            \n            if (slt64(gtid_30942, num_segments_29432)) {\n                bool x_29484 = ((__global bool *) mem_32202)[gtid_30942];\n                \n                private_mem_34260[i_34264] = x_29484;\n                private_mem_34262[i_34264] = (int64_t) 1;\n            } else {\n                private_mem_34260[i_34264] = 0;\n                private_mem_34262[i_34264] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34265 = 0; i_34265 < (int64_t) 9; i_34265++) {\n            int64_t sharedIdx_34266 = sext_i32_i64(local_tid_34237) + i_34265 *\n                    segscan_group_sizze_30938;\n            \n            ((__local bool *) local_mem_34247)[sharedIdx_34266] =\n                private_mem_34260[i_34265];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34267 = 0; i_34267 < 9; i_34267++) {\n            int32_t sharedIdx_34268 = local_tid_34237 * 9 + i_34267;\n            \n            private_mem_34260[sext_i32_i64(i_34267)] = ((__local\n                                                         bool *) local_mem_34247)[sext_i32_i64(sharedIdx_34268)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34269 = 0; i_34269 < (int64_t) 9; i_34269++) {\n            int64_t sharedIdx_34270 = sext_i32_i64(local_tid_342",
            "37) + i_34269 *\n                    segscan_group_sizze_30938;\n            \n            ((__local int64_t *) local_mem_34247)[sharedIdx_34270] =\n                private_mem_34262[i_34269];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34271 = 0; i_34271 < 9; i_34271++) {\n            int32_t sharedIdx_34272 = local_tid_34237 * 9 + i_34271;\n            \n            private_mem_34262[sext_i32_i64(i_34271)] = ((__local\n                                                         int64_t *) local_mem_34247)[sext_i32_i64(sharedIdx_34272)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34273 = 0; i_34273 < (int64_t) 8; i_34273++) {\n            bool x_29477;\n            bool x_29479;\n            \n            x_29477 = private_mem_34260[i_34273];\n            x_29479 = private_mem_34260[i_34273 + (int64_t) 1];\n            \n            int64_t x_29478;\n            int64_t x_29480;\n            \n            x_29478 = private_mem_34262[i_34273];\n            x_29480 = private_mem_34262[i_34273 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29481;\n            \n            defunc_1_op_res_29481 = x_29477 || x_29479;\n            \n            int64_t defunc_1_op_res_29482;\n            \n            if (x_29479) {\n                defunc_1_op_res_29482 = x_29480;\n            } else {\n                int64_t defunc_1_op_res_29483 = add64(x_29478, x_29480);\n                \n                defunc_1_op_res_29482 = defunc_1_op_res_29483;\n            }\n            private_mem_34260[i_34273 + (int64_t) 1] = defunc_1_op_res_29481;\n            private_mem_34262[i_34273 + (int64_t) 1] = defunc_1_op_res_29482;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_34247)[byte_offsets_34241 +\n                                           sext_i32_i64(local_tid_34237)] =\n            private_mem_34260[(int64_t) 8];\n        ((__local int64_t *) local_mem_34247)[squot6",
            "4(byte_offsets_34242,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34237)] =\n            private_mem_34262[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_34281;\n    int64_t acc_34282;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_34274;\n        int64_t x_34275;\n        bool x_34276;\n        int64_t x_34277;\n        bool x_34283;\n        int64_t x_34284;\n        bool x_34285;\n        int64_t x_34286;\n        bool ltid_in_bounds_34290;\n        \n        ltid_in_bounds_34290 = slt64(sext_i32_i64(local_tid_34237),\n                                     segscan_group_sizze_30938);\n        \n        int32_t skip_threads_34291;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34290) {\n                x_34276 = ((volatile __local\n                            bool *) local_mem_34247)[byte_offsets_34241 +\n                                                     sext_i32_i64(local_tid_34237)];\n                x_34277 = ((volatile __local\n                            int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34237)];\n                if ((local_tid_34237 - squot32(local_tid_34237, 32) * 32) ==\n                    0) {\n                    x_34274 = x_34276;\n                    x_34275 = x_34277;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34291 = 1;\n            while (slt32(skip_threads_34291, 32)) {\n                if (sle32(skip_threads_34291, local_tid_34237 -\n                          squot32(local_tid_34237, 32) * 32) &&\n                    ltid_in_bounds_34290) {\n                    // read operands\n                    {\n                        x_3427",
            "4 = ((volatile __local\n                                    bool *) local_mem_34247)[byte_offsets_34241 +\n                                                             (sext_i32_i64(local_tid_34237) -\n                                                              sext_i32_i64(skip_threads_34291))];\n                        x_34275 = ((volatile __local\n                                    int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34237) -\n                                                                 sext_i32_i64(skip_threads_34291))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_34278 = x_34274 || x_34276;\n                        int64_t defunc_1_op_res_34279;\n                        \n                        if (x_34276) {\n                            defunc_1_op_res_34279 = x_34277;\n                        } else {\n                            int64_t defunc_1_op_res_34280 = add64(x_34275,\n                                                                  x_34277);\n                            \n                            defunc_1_op_res_34279 = defunc_1_op_res_34280;\n                        }\n                        x_34274 = defunc_1_op_res_34278;\n                        x_34275 = defunc_1_op_res_34279;\n                    }\n                }\n                if (sle32(wave_sizze_34239, skip_threads_34291)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34291, local_tid_34237 -\n                          squot32(local_tid_34237, 32) * 32) &&\n                    ltid_in_bounds_34290) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_34247)[byte_off",
            "sets_34241 +\n                                                   sext_i32_i64(local_tid_34237)] =\n                            x_34274;\n                        x_34276 = x_34274;\n                        ((volatile __local\n                          int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34237)] =\n                            x_34275;\n                        x_34277 = x_34275;\n                    }\n                }\n                if (sle32(wave_sizze_34239, skip_threads_34291)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34291 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34237 - squot32(local_tid_34237, 32) * 32) == 31 &&\n                ltid_in_bounds_34290) {\n                ((volatile __local bool *) local_mem_34247)[byte_offsets_34241 +\n                                                            sext_i32_i64(squot32(local_tid_34237,\n                                                                                 32))] =\n                    x_34274;\n                ((volatile __local\n                  int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34237,\n                                                                   32))] =\n                    x_34275;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34292;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34237",
            ", 32) == 0 && ltid_in_bounds_34290) {\n                    x_34285 = ((volatile __local\n                                bool *) local_mem_34247)[byte_offsets_34241 +\n                                                         sext_i32_i64(local_tid_34237)];\n                    x_34286 = ((volatile __local\n                                int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34237)];\n                    if ((local_tid_34237 - squot32(local_tid_34237, 32) * 32) ==\n                        0) {\n                        x_34283 = x_34285;\n                        x_34284 = x_34286;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34292 = 1;\n                while (slt32(skip_threads_34292, 32)) {\n                    if (sle32(skip_threads_34292, local_tid_34237 -\n                              squot32(local_tid_34237, 32) * 32) &&\n                        (squot32(local_tid_34237, 32) == 0 &&\n                         ltid_in_bounds_34290)) {\n                        // read operands\n                        {\n                            x_34283 = ((volatile __local\n                                        bool *) local_mem_34247)[byte_offsets_34241 +\n                                                                 (sext_i32_i64(local_tid_34237) -\n                                                                  sext_i32_i64(skip_threads_34292))];\n                            x_34284 = ((volatile __local\n                                        int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_34237) -\n           ",
            "                                                          sext_i32_i64(skip_threads_34292))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_34287 = x_34283 || x_34285;\n                            int64_t defunc_1_op_res_34288;\n                            \n                            if (x_34285) {\n                                defunc_1_op_res_34288 = x_34286;\n                            } else {\n                                int64_t defunc_1_op_res_34289 = add64(x_34284,\n                                                                      x_34286);\n                                \n                                defunc_1_op_res_34288 = defunc_1_op_res_34289;\n                            }\n                            x_34283 = defunc_1_op_res_34287;\n                            x_34284 = defunc_1_op_res_34288;\n                        }\n                    }\n                    if (sle32(wave_sizze_34239, skip_threads_34292)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34292, local_tid_34237 -\n                              squot32(local_tid_34237, 32) * 32) &&\n                        (squot32(local_tid_34237, 32) == 0 &&\n                         ltid_in_bounds_34290)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_34247)[byte_offsets_34241 +\n                                                       sext_i32_i64(local_tid_34237)] =\n                                x_34283;\n                            x_34285 = x_34283;\n                            ((volatile __local\n                              int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                  (int64_t) 8) +\n                                                      ",
            "    sext_i32_i64(local_tid_34237)] =\n                                x_34284;\n                            x_34286 = x_34284;\n                        }\n                    }\n                    if (sle32(wave_sizze_34239, skip_threads_34292)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34292 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34237, 32) == 0 || !ltid_in_bounds_34290)) {\n                // read operands\n                {\n                    x_34276 = x_34274;\n                    x_34277 = x_34275;\n                    x_34274 = ((__local\n                                bool *) local_mem_34247)[byte_offsets_34241 +\n                                                         (sext_i32_i64(squot32(local_tid_34237,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_34275 = ((__local\n                                int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34237,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_34278 = x_34274 || x_34276;\n                    int64_t defunc_1_op_res_34279;\n                    \n                    if (x_34276) {\n                        defunc_1_op_res_34279 = x_34277;\n                    } else {\n                        int64_t defunc_1_op_res_34280 = add64(x_34275, x_34277);\n                  ",
            "      \n                        defunc_1_op_res_34279 = defunc_1_op_res_34280;\n                    }\n                    x_34274 = defunc_1_op_res_34278;\n                    x_34275 = defunc_1_op_res_34279;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_34247)[byte_offsets_34241 +\n                                                       sext_i32_i64(local_tid_34237)] =\n                        x_34274;\n                    ((__local\n                      int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34237)] =\n                        x_34275;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34237, 32) == 0) {\n                ((__local bool *) local_mem_34247)[byte_offsets_34241 +\n                                                   sext_i32_i64(local_tid_34237)] =\n                    x_34276;\n                ((__local\n                  int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34237)] =\n                    x_34277;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34237 == 0) {\n            acc_34281 = ((__local bool *) local_mem_34247)[byte_offsets_34241 +\n                                                           (segscan_group_sizze_30938 -\n                                                            (int64_t) 1)];\n            acc_34282 = ((__local\n                          int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                              (int64_t) 8) +",
            "\n                                                      (segscan_group_sizze_30938 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34281 = ((__local bool *) local_mem_34247)[byte_offsets_34241 +\n                                                           (sext_i32_i64(local_tid_34237) -\n                                                            (int64_t) 1)];\n            acc_34282 = ((__local\n                          int64_t *) local_mem_34247)[squot64(byte_offsets_34242,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_34237) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_34293;\n    \n    prefix_34293 = 0;\n    \n    int64_t prefix_34294;\n    \n    prefix_34294 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34258 == (int64_t) 0 && local_tid_34237 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_34230)[dynamic_id_34258] = acc_34281;\n            ((volatile __global\n              int64_t *) incprefixes_mem_34234)[dynamic_id_34258] = acc_34282;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34226)[dynamic_id_34258] = (int8_t) 2;\n            acc_34281 = 0;\n            acc_34282 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34258 == (int64_t) 0) && slt32(local_tid_34237,\n                                                        wave_sizze_34239)) {\n            if (local_tid_34237 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_34228)[dynamic_id_34258] = acc_34281;\n                ((volatile __global\n                  int64_t *) aggregates_mem_34232)[dynamic_id_34258] =\n                    acc_34282;\n                mem_fence_global();\n                ((volatile __global\n  ",
            "                int8_t *) status_flags_mem_34226)[dynamic_id_34258] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34247)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_34226)[dynamic_id_34258 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34295;\n            \n            status_34295 = ((__local int8_t *) local_mem_34247)[(int64_t) 0];\n            if (status_34295 == (int8_t) 2) {\n                if (local_tid_34237 == 0) {\n                    prefix_34293 = ((volatile __global\n                                     bool *) incprefixes_mem_34230)[dynamic_id_34258 -\n                                                                    (int64_t) 1];\n                    prefix_34294 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34234)[dynamic_id_34258 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34296 = dynamic_id_34258 -\n                        sext_i32_i64(wave_sizze_34239);\n                \n                while (slt32(wave_sizze_34239 * -1, readOffset_34296)) {\n                    int32_t read_i_34297 = readOffset_34296 + local_tid_34237;\n                    bool aggr_34298 = 0;\n                    int64_t aggr_34299 = (int64_t) 0;\n                    int8_t flag_34300 = (int8_t) 0;\n                    int8_t used_34301 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34297)) {\n                        flag_34300 = ((volatile __global\n                                       int8_t *) status_flags_mem_34226)[sext_i32_i64(read_i_34297)];\n                        if (flag_34300 == (int8_t) 2) {\n                            aggr_34298 = ",
            "((volatile __global\n                                           bool *) incprefixes_mem_34230)[sext_i32_i64(read_i_34297)];\n                            aggr_34299 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34234)[sext_i32_i64(read_i_34297)];\n                        } else {\n                            if (flag_34300 == (int8_t) 1) {\n                                aggr_34298 = ((volatile __global\n                                               bool *) aggregates_mem_34228)[sext_i32_i64(read_i_34297)];\n                                aggr_34299 = ((volatile __global\n                                               int64_t *) aggregates_mem_34232)[sext_i32_i64(read_i_34297)];\n                                used_34301 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_34247)[warp_byte_offset_34244 +\n                                                       sext_i32_i64(local_tid_34237)] =\n                        aggr_34298;\n                    ((__local\n                      int64_t *) local_mem_34247)[squot64(warp_byte_offset_34245,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34237)] =\n                        aggr_34299;\n                    \n                    int8_t tmp_34302;\n                    \n                    tmp_34302 = flag_34300 | used_34301 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34247)[sext_i32_i64(local_tid_34237)] =\n                        tmp_34302;\n                    mem_fence_local();\n                    flag_34300 = ((volatile __local\n                                   int8_t *) local_mem_34247)[sext_i32_i64(wave_sizze_34239) -\n                                                              (int64_t) 1];\n                    if (local_tid_34237 == 0) {\n                     ",
            "   if (!(flag_34300 == (int8_t) 2)) {\n                            bool x_34303 = 0;\n                            int64_t x_34304 = (int64_t) 0;\n                            bool x_34305;\n                            int64_t x_34306;\n                            int8_t flag1_34310;\n                            \n                            flag1_34310 = (int8_t) 0;\n                            \n                            int8_t flag2_34311;\n                            int8_t used1_34312;\n                            \n                            used1_34312 = (int8_t) 0;\n                            \n                            int8_t used2_34313;\n                            \n                            for (int32_t i_34314 = 0; i_34314 <\n                                 wave_sizze_34239; i_34314++) {\n                                flag2_34311 = ((__local\n                                                int8_t *) local_mem_34247)[sext_i32_i64(i_34314)];\n                                used2_34313 = lshr8(flag2_34311, (int8_t) 2);\n                                flag2_34311 = flag2_34311 & (int8_t) 3;\n                                x_34305 = ((__local\n                                            bool *) local_mem_34247)[warp_byte_offset_34244 +\n                                                                     sext_i32_i64(i_34314)];\n                                x_34306 = ((__local\n                                            int64_t *) local_mem_34247)[squot64(warp_byte_offset_34245,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34314)];\n                                if (!(flag2_34311 == (int8_t) 1)) {\n                                    flag1_34310 = flag2_34311;\n                                    used1_34312 = used2_34313;\n                                    x_34303 = x_34305;\n                                    x_34304 = x_34306;\n  ",
            "                              } else {\n                                    used1_34312 += used2_34313;\n                                    \n                                    bool defunc_1_op_res_34307;\n                                    \n                                    defunc_1_op_res_34307 = x_34303 || x_34305;\n                                    \n                                    int64_t defunc_1_op_res_34308;\n                                    \n                                    if (x_34305) {\n                                        defunc_1_op_res_34308 = x_34306;\n                                    } else {\n                                        int64_t defunc_1_op_res_34309 =\n                                                add64(x_34304, x_34306);\n                                        \n                                        defunc_1_op_res_34308 =\n                                            defunc_1_op_res_34309;\n                                    }\n                                    x_34303 = defunc_1_op_res_34307;\n                                    x_34304 = defunc_1_op_res_34308;\n                                }\n                            }\n                            flag_34300 = flag1_34310;\n                            used_34301 = used1_34312;\n                            aggr_34298 = x_34303;\n                            aggr_34299 = x_34304;\n                        } else {\n                            aggr_34298 = ((__local\n                                           bool *) local_mem_34247)[warp_byte_offset_34244 +\n                                                                    (sext_i32_i64(wave_sizze_34239) -\n                                                                     (int64_t) 1)];\n                            aggr_34299 = ((__local\n                                           int64_t *) local_mem_34247)[squot64(warp_byte_offset_34245,\n                                                                               (int64_t",
            ") 8) +\n                                                                       (sext_i32_i64(wave_sizze_34239) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34300 == (int8_t) 2) {\n                            readOffset_34296 = wave_sizze_34239 * -1;\n                        } else {\n                            readOffset_34296 -= zext_i8_i32(used_34301);\n                        }\n                        ((__local int32_t *) local_mem_34247)[(int64_t) 0] =\n                            readOffset_34296;\n                        \n                        bool x_34315;\n                        \n                        x_34315 = aggr_34298;\n                        \n                        int64_t x_34316;\n                        \n                        x_34316 = aggr_34299;\n                        \n                        bool x_34317;\n                        \n                        x_34317 = prefix_34293;\n                        \n                        int64_t x_34318;\n                        \n                        x_34318 = prefix_34294;\n                        \n                        bool defunc_1_op_res_34319;\n                        \n                        defunc_1_op_res_34319 = x_34315 || x_34317;\n                        \n                        int64_t defunc_1_op_res_34320;\n                        \n                        if (x_34317) {\n                            defunc_1_op_res_34320 = x_34318;\n                        } else {\n                            int64_t defunc_1_op_res_34321 = add64(x_34316,\n                                                                  x_34318);\n                            \n                            defunc_1_op_res_34320 = defunc_1_op_res_34321;\n                        }\n                        prefix_34293 = defunc_1_op_res_34319;\n                        prefix_34294 = defunc_1_op_res_34320;\n                    }\n             ",
            "       mem_fence_local();\n                    readOffset_34296 = ((__local\n                                         int32_t *) local_mem_34247)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34237 == 0) {\n                bool x_34322 = prefix_34293;\n                int64_t x_34323 = prefix_34294;\n                bool x_34324 = acc_34281;\n                int64_t x_34325 = acc_34282;\n                bool defunc_1_op_res_34326 = x_34322 || x_34324;\n                int64_t defunc_1_op_res_34327;\n                \n                if (x_34324) {\n                    defunc_1_op_res_34327 = x_34325;\n                } else {\n                    int64_t defunc_1_op_res_34328 = add64(x_34323, x_34325);\n                    \n                    defunc_1_op_res_34327 = defunc_1_op_res_34328;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_34230)[dynamic_id_34258] =\n                    defunc_1_op_res_34326;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_34234)[dynamic_id_34258] =\n                    defunc_1_op_res_34327;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34226)[dynamic_id_34258] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_34247)[warp_byte_offset_34244] =\n                    prefix_34293;\n                ((__local\n                  int64_t *) local_mem_34247)[squot64(warp_byte_offset_34245,\n                                                      (int64_t) 8)] =\n                    prefix_34294;\n                acc_34281 = 0;\n                acc_34282 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34258 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34293 = ((__local\n                             bool *) local_mem_34247)[warp_byte_offset_34244];\n            prefix_34294 = ((__local\n                             int64",
            "_t *) local_mem_34247)[squot64(warp_byte_offset_34245,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_34329;\n        bool x_34331;\n        bool x_34336;\n        \n        x_34336 = prefix_34293;\n        \n        bool x_34338;\n        \n        x_34338 = acc_34281;\n        \n        int64_t x_34330;\n        int64_t x_34332;\n        int64_t x_34337;\n        \n        x_34337 = prefix_34294;\n        \n        int64_t x_34339;\n        \n        x_34339 = acc_34282;\n        \n        bool defunc_1_op_res_34340;\n        \n        defunc_1_op_res_34340 = x_34336 || x_34338;\n        \n        int64_t defunc_1_op_res_34341;\n        \n        if (x_34338) {\n            defunc_1_op_res_34341 = x_34339;\n        } else {\n            int64_t defunc_1_op_res_34342 = add64(x_34337, x_34339);\n            \n            defunc_1_op_res_34341 = defunc_1_op_res_34342;\n        }\n        x_34329 = defunc_1_op_res_34340;\n        x_34330 = defunc_1_op_res_34341;\n        for (int64_t i_34343 = 0; i_34343 < (int64_t) 9; i_34343++) {\n            x_34331 = private_mem_34260[i_34343];\n            x_34332 = private_mem_34262[i_34343];\n            \n            bool defunc_1_op_res_34333;\n            \n            defunc_1_op_res_34333 = x_34329 || x_34331;\n            \n            int64_t defunc_1_op_res_34334;\n            \n            if (x_34331) {\n                defunc_1_op_res_34334 = x_34332;\n            } else {\n                int64_t defunc_1_op_res_34335 = add64(x_34330, x_34332);\n                \n                defunc_1_op_res_34334 = defunc_1_op_res_34335;\n            }\n            private_mem_34260[i_34343] = defunc_1_op_res_34333;\n            private_mem_34262[i_34343] = defunc_1_op_res_34334;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34344 = 0; i_34344 < (int64_t) 9; i_34344++) {\n         ",
            "   int64_t sharedIdx_34345 = sext_i32_i64(local_tid_34237 * 9) +\n                    i_34344;\n            \n            ((__local bool *) local_mem_34247)[sharedIdx_34345] =\n                private_mem_34260[i_34344];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34346 = 0; i_34346 < (int64_t) 9; i_34346++) {\n            int32_t sharedIdx_34347 = local_tid_34237 +\n                    sext_i64_i32(segscan_group_sizze_30938 * i_34346);\n            \n            private_mem_34260[i_34346] = ((__local\n                                           bool *) local_mem_34247)[sext_i32_i64(sharedIdx_34347)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34348 = 0; i_34348 < (int64_t) 9; i_34348++) {\n            int64_t sharedIdx_34349 = sext_i32_i64(local_tid_34237 * 9) +\n                    i_34348;\n            \n            ((__local int64_t *) local_mem_34247)[sharedIdx_34349] =\n                private_mem_34262[i_34348];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34350 = 0; i_34350 < (int64_t) 9; i_34350++) {\n            int32_t sharedIdx_34351 = local_tid_34237 +\n                    sext_i64_i32(segscan_group_sizze_30938 * i_34350);\n            \n            private_mem_34262[i_34350] = ((__local\n                                           int64_t *) local_mem_34247)[sext_i32_i64(sharedIdx_34351)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34352 = 0; i_34352 < (int64_t) 9; i_34352++) {\n            int64_t gtid_30942 = blockOff_34259 + segscan_group_sizze_30938 *\n                    i_34352 + sext_i32_i64(local_tid_34237);\n            \n            if (slt64(gtid_30942, num_segments_29432)) {\n                ((__global bool *) mem_32205)[gtid_30942] =\n                    private_mem_34260[i_34352];\n            }\n        }\n        for (int64_t i_34353 = 0; i_34353 < (int64_t) 9; i_34353++) {\n            int64_t gtid_",
            "30942 = blockOff_34259 + segscan_group_sizze_30938 *\n                    i_34353 + sext_i32_i64(local_tid_34237);\n            \n            if (slt64(gtid_30942, num_segments_29432)) {\n                ((__global int64_t *) mem_32207)[gtid_30942] =\n                    private_mem_34262[i_34353];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34258 == sdiv_up64(num_segments_29432,\n                                          segscan_group_sizze_30938 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34224)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30938\n}\n__kernel void test_clusterWithzisegscan_30951(__global int *global_failure,\n                                              uint local_mem_34374_backing_offset_0,\n                                              int64_t num_segments_29432,\n                                              __global unsigned char *mem_32202,\n                                              __global unsigned char *mem_32210,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34357,\n                                              __global\n                                              unsigned char *status_flags_mem_34359,\n                                              __global\n                                              unsigned char *aggregates_mem_34361,\n                                              __global\n                                              unsigned char *incprefixes_mem_34363)\n{\n    #define segscan_group_sizze_30946 (test_clusterWithzisegscan_group_sizze_30945)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34374_backing_0 =\n        ",
            "          &shared_mem[local_mem_34374_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34365;\n    int32_t local_tid_34366;\n    int64_t group_sizze_34369;\n    int32_t wave_sizze_34368;\n    int32_t group_tid_34367;\n    \n    global_tid_34365 = get_global_id(0);\n    local_tid_34366 = get_local_id(0);\n    group_sizze_34369 = get_local_size(0);\n    wave_sizze_34368 = LOCKSTEP_WIDTH;\n    group_tid_34367 = get_group_id(0);\n    \n    int32_t phys_tid_30951;\n    \n    phys_tid_30951 = global_tid_34365;\n    \n    int64_t byte_offsets_34370;\n    \n    byte_offsets_34370 = (int64_t) 0;\n    \n    int64_t byte_offsets_34371;\n    \n    byte_offsets_34371 = segscan_group_sizze_30946 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34372;\n    \n    warp_byte_offset_34372 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34373;\n    \n    warp_byte_offset_34373 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34374;\n    \n    local_mem_34374 = (__local char *) local_mem_34374_backing_0;\n    \n    int64_t trans_arr_len_34375;\n    \n    trans_arr_len_34375 = (int64_t) 9 * segscan_group_sizze_30946;\n    \n    int32_t dynamic_id_34382;\n    \n    if (local_tid_34366 == 0) {\n        dynamic_id_34382 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34357)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34374)[(int64_t) 0] = dynamic_id_34382;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34382 = ((__local int32_t *) local_mem_34374)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34383;\n    \n    blockOff_34383 = sext_i32_i64(dynamic_id_34382) * (int64_t) 9 *\n        segscan_group_sizze_30946;\n    \n    int64_t private_mem_34384[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34386 = 0; i_34386 < (int64_t) 9; i_34386++) ",
            "{\n            int64_t gtid_30950 = blockOff_34383 +\n                    sext_i32_i64(local_tid_34366) + i_34386 *\n                    segscan_group_sizze_30946;\n            \n            if (slt64(gtid_30950, num_segments_29432)) {\n                int64_t i_p_o_31879 = add64((int64_t) 1, gtid_30950);\n                int64_t rot_i_31880 = smod64(i_p_o_31879, num_segments_29432);\n                bool x_29491 = ((__global bool *) mem_32202)[rot_i_31880];\n                int64_t defunc_0_f_res_29492 = btoi_bool_i64(x_29491);\n                \n                private_mem_34384[i_34386] = defunc_0_f_res_29492;\n            } else {\n                private_mem_34384[i_34386] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34387 = 0; i_34387 < (int64_t) 9; i_34387++) {\n            int64_t sharedIdx_34388 = sext_i32_i64(local_tid_34366) + i_34387 *\n                    segscan_group_sizze_30946;\n            \n            ((__local int64_t *) local_mem_34374)[sharedIdx_34388] =\n                private_mem_34384[i_34387];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34389 = 0; i_34389 < 9; i_34389++) {\n            int32_t sharedIdx_34390 = local_tid_34366 * 9 + i_34389;\n            \n            private_mem_34384[sext_i32_i64(i_34389)] = ((__local\n                                                         int64_t *) local_mem_34374)[sext_i32_i64(sharedIdx_34390)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34391 = 0; i_34391 < (int64_t) 8; i_34391++) {\n            int64_t x_29488;\n            int64_t x_29489;\n            \n            x_29488 = private_mem_34384[i_34391];\n            x_29489 = private_mem_34384[i_34391 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29490;\n            \n            defunc_1_op_res_29490 = add64(x_29488, x_29489);\n            private_mem_34384[i_34391 + (int6",
            "4_t) 1] = defunc_1_op_res_29490;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34366)] =\n            private_mem_34384[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34395;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34392;\n        int64_t x_34393;\n        int64_t x_34396;\n        int64_t x_34397;\n        bool ltid_in_bounds_34399;\n        \n        ltid_in_bounds_34399 = slt64(sext_i32_i64(local_tid_34366),\n                                     segscan_group_sizze_30946);\n        \n        int32_t skip_threads_34400;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34399) {\n                x_34393 = ((volatile __local\n                            int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34366)];\n                if ((local_tid_34366 - squot32(local_tid_34366, 32) * 32) ==\n                    0) {\n                    x_34392 = x_34393;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34400 = 1;\n            while (slt32(skip_threads_34400, 32)) {\n                if (sle32(skip_threads_34400, local_tid_34366 -\n                          squot32(local_tid_34366, 32) * 32) &&\n                    ltid_in_bounds_34399) {\n                    // read operands\n                    {\n                        x_34392 = ((volatile __local\n                                    int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                        (int64_t) 8) +\n  ",
            "                                                              (sext_i32_i64(local_tid_34366) -\n                                                                 sext_i32_i64(skip_threads_34400))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_34394 = add64(x_34392, x_34393);\n                        \n                        x_34392 = defunc_1_op_res_34394;\n                    }\n                }\n                if (sle32(wave_sizze_34368, skip_threads_34400)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34400, local_tid_34366 -\n                          squot32(local_tid_34366, 32) * 32) &&\n                    ltid_in_bounds_34399) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34366)] =\n                            x_34392;\n                        x_34393 = x_34392;\n                    }\n                }\n                if (sle32(wave_sizze_34368, skip_threads_34400)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34400 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34366 - squot32(local_tid_34366, 32) * 32) == 31 &&\n                ltid_in_bounds_34399) {\n                ((volatile __local\n                  int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34366,\n                                             ",
            "                      32))] =\n                    x_34392;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34401;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34366, 32) == 0 && ltid_in_bounds_34399) {\n                    x_34397 = ((volatile __local\n                                int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34366)];\n                    if ((local_tid_34366 - squot32(local_tid_34366, 32) * 32) ==\n                        0) {\n                        x_34396 = x_34397;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34401 = 1;\n                while (slt32(skip_threads_34401, 32)) {\n                    if (sle32(skip_threads_34401, local_tid_34366 -\n                              squot32(local_tid_34366, 32) * 32) &&\n                        (squot32(local_tid_34366, 32) == 0 &&\n                         ltid_in_bounds_34399)) {\n                        // read operands\n                        {\n                            x_34396 = ((volatile __local\n                                        int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_34366) -\n                                                                     sext_i32_i64(skip_threads_34401))];\n                        }\n                        // perform operation\n                        {\n                            int64_t ",
            "defunc_1_op_res_34398 = add64(x_34396,\n                                                                  x_34397);\n                            \n                            x_34396 = defunc_1_op_res_34398;\n                        }\n                    }\n                    if (sle32(wave_sizze_34368, skip_threads_34401)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34401, local_tid_34366 -\n                              squot32(local_tid_34366, 32) * 32) &&\n                        (squot32(local_tid_34366, 32) == 0 &&\n                         ltid_in_bounds_34399)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34366)] =\n                                x_34396;\n                            x_34397 = x_34396;\n                        }\n                    }\n                    if (sle32(wave_sizze_34368, skip_threads_34401)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34401 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34366, 32) == 0 || !ltid_in_bounds_34399)) {\n                // read operands\n                {\n                    x_34393 = x_34392;\n                    x_34392 = ((__local\n                                int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34366,\n                             ",
            "                                                     32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_34394 = add64(x_34392, x_34393);\n                    \n                    x_34392 = defunc_1_op_res_34394;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34366)] =\n                        x_34392;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34366, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34366)] =\n                    x_34393;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34366 == 0) {\n            acc_34395 = ((__local\n                          int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30946 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34395 = ((__local\n                          int64_t *) local_mem_34374)[squot64(byte_offsets_34370,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_34366) -\n                    ",
            "                                   (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34402;\n    \n    prefix_34402 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34382 == (int64_t) 0 && local_tid_34366 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34363)[dynamic_id_34382] = acc_34395;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34359)[dynamic_id_34382] = (int8_t) 2;\n            acc_34395 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34382 == (int64_t) 0) && slt32(local_tid_34366,\n                                                        wave_sizze_34368)) {\n            if (local_tid_34366 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34361)[dynamic_id_34382] =\n                    acc_34395;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34359)[dynamic_id_34382] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34374)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_34359)[dynamic_id_34382 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34403;\n            \n            status_34403 = ((__local int8_t *) local_mem_34374)[(int64_t) 0];\n            if (status_34403 == (int8_t) 2) {\n                if (local_tid_34366 == 0) {\n                    prefix_34402 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34363)[dynamic_id_34382 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34404 = dynamic_id_34382 ",
            "-\n                        sext_i32_i64(wave_sizze_34368);\n                \n                while (slt32(wave_sizze_34368 * -1, readOffset_34404)) {\n                    int32_t read_i_34405 = readOffset_34404 + local_tid_34366;\n                    int64_t aggr_34406 = (int64_t) 0;\n                    int8_t flag_34407 = (int8_t) 0;\n                    int8_t used_34408 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34405)) {\n                        flag_34407 = ((volatile __global\n                                       int8_t *) status_flags_mem_34359)[sext_i32_i64(read_i_34405)];\n                        if (flag_34407 == (int8_t) 2) {\n                            aggr_34406 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34363)[sext_i32_i64(read_i_34405)];\n                        } else {\n                            if (flag_34407 == (int8_t) 1) {\n                                aggr_34406 = ((volatile __global\n                                               int64_t *) aggregates_mem_34361)[sext_i32_i64(read_i_34405)];\n                                used_34408 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_34374)[squot64(warp_byte_offset_34372,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34366)] =\n                        aggr_34406;\n                    \n                    int8_t tmp_34409;\n                    \n                    tmp_34409 = flag_34407 | used_34408 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34374)[sext_i32_i64(local_tid_34366)] =\n                        tmp_34409;\n                    mem_fence_local();\n                    flag_34407 = ((volatile __local\n                                   int8_t *) local_mem_34374)[sext_",
            "i32_i64(wave_sizze_34368) -\n                                                              (int64_t) 1];\n                    if (local_tid_34366 == 0) {\n                        if (!(flag_34407 == (int8_t) 2)) {\n                            int64_t x_34410 = (int64_t) 0;\n                            int64_t x_34411;\n                            int8_t flag1_34413;\n                            \n                            flag1_34413 = (int8_t) 0;\n                            \n                            int8_t flag2_34414;\n                            int8_t used1_34415;\n                            \n                            used1_34415 = (int8_t) 0;\n                            \n                            int8_t used2_34416;\n                            \n                            for (int32_t i_34417 = 0; i_34417 <\n                                 wave_sizze_34368; i_34417++) {\n                                flag2_34414 = ((__local\n                                                int8_t *) local_mem_34374)[sext_i32_i64(i_34417)];\n                                used2_34416 = lshr8(flag2_34414, (int8_t) 2);\n                                flag2_34414 = flag2_34414 & (int8_t) 3;\n                                x_34411 = ((__local\n                                            int64_t *) local_mem_34374)[squot64(warp_byte_offset_34372,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34417)];\n                                if (!(flag2_34414 == (int8_t) 1)) {\n                                    flag1_34413 = flag2_34414;\n                                    used1_34415 = used2_34416;\n                                    x_34410 = x_34411;\n                                } else {\n                                    used1_34415 += used2_34416;\n                                    \n                                    int64_t defunc_1_op_res_34412;\n  ",
            "                                  \n                                    defunc_1_op_res_34412 = add64(x_34410,\n                                                                  x_34411);\n                                    x_34410 = defunc_1_op_res_34412;\n                                }\n                            }\n                            flag_34407 = flag1_34413;\n                            used_34408 = used1_34415;\n                            aggr_34406 = x_34410;\n                        } else {\n                            aggr_34406 = ((__local\n                                           int64_t *) local_mem_34374)[squot64(warp_byte_offset_34372,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34368) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34407 == (int8_t) 2) {\n                            readOffset_34404 = wave_sizze_34368 * -1;\n                        } else {\n                            readOffset_34404 -= zext_i8_i32(used_34408);\n                        }\n                        ((__local int32_t *) local_mem_34374)[(int64_t) 0] =\n                            readOffset_34404;\n                        \n                        int64_t x_34418;\n                        \n                        x_34418 = aggr_34406;\n                        \n                        int64_t x_34419;\n                        \n                        x_34419 = prefix_34402;\n                        \n                        int64_t defunc_1_op_res_34420;\n                        \n                        defunc_1_op_res_34420 = add64(x_34418, x_34419);\n                        prefix_34402 = defunc_1_op_res_34420;\n                    }\n                    mem_fence_local();\n                    readOffset_34404 = ((__local\n                 ",
            "                        int32_t *) local_mem_34374)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34366 == 0) {\n                int64_t x_34421 = prefix_34402;\n                int64_t x_34422 = acc_34395;\n                int64_t defunc_1_op_res_34423 = add64(x_34421, x_34422);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34363)[dynamic_id_34382] =\n                    defunc_1_op_res_34423;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34359)[dynamic_id_34382] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34374)[squot64(warp_byte_offset_34372,\n                                                      (int64_t) 8)] =\n                    prefix_34402;\n                acc_34395 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34382 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34402 = ((__local\n                             int64_t *) local_mem_34374)[squot64(warp_byte_offset_34372,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34424;\n        int64_t x_34425;\n        int64_t x_34427;\n        \n        x_34427 = prefix_34402;\n        \n        int64_t x_34428;\n        \n        x_34428 = acc_34395;\n        \n        int64_t defunc_1_op_res_34429;\n        \n        defunc_1_op_res_34429 = add64(x_34427, x_34428);\n        x_34424 = defunc_1_op_res_34429;\n        for (int64_t i_34430 = 0; i_34430 < (int64_t) 9; i_34430++) {\n            x_34425 = private_mem_34384[i_34430];\n            \n            int64_t defunc_1_op_res_34426;\n            \n            defunc_1_op_res_34426 = add64(x_34424, x_34425);\n            private_mem_34384[i_34430] = defunc_1_op_res_34426;\n        }\n    }\n    // Transpose s",
            "can output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34431 = 0; i_34431 < (int64_t) 9; i_34431++) {\n            int64_t sharedIdx_34432 = sext_i32_i64(local_tid_34366 * 9) +\n                    i_34431;\n            \n            ((__local int64_t *) local_mem_34374)[sharedIdx_34432] =\n                private_mem_34384[i_34431];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34433 = 0; i_34433 < (int64_t) 9; i_34433++) {\n            int32_t sharedIdx_34434 = local_tid_34366 +\n                    sext_i64_i32(segscan_group_sizze_30946 * i_34433);\n            \n            private_mem_34384[i_34433] = ((__local\n                                           int64_t *) local_mem_34374)[sext_i32_i64(sharedIdx_34434)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34435 = 0; i_34435 < (int64_t) 9; i_34435++) {\n            int64_t gtid_30950 = blockOff_34383 + segscan_group_sizze_30946 *\n                    i_34435 + sext_i32_i64(local_tid_34366);\n            \n            if (slt64(gtid_30950, num_segments_29432)) {\n                ((__global int64_t *) mem_32210)[gtid_30950] =\n                    private_mem_34384[i_34435];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34382 == sdiv_up64(num_segments_29432,\n                                          segscan_group_sizze_30946 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34357)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30946\n}\n__kernel void test_clusterWithzisegscan_30965(__global int *global_failure,\n                                              uint local_mem_34461_backing_offset_0,\n                                              int64_t num_segments_29493,\n ",
            "                                             __global unsigned char *mem_32212,\n                                              __global unsigned char *mem_32216,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34444,\n                                              __global\n                                              unsigned char *status_flags_mem_34446,\n                                              __global\n                                              unsigned char *aggregates_mem_34448,\n                                              __global\n                                              unsigned char *incprefixes_mem_34450)\n{\n    #define segscan_group_sizze_30960 (test_clusterWithzisegscan_group_sizze_30959)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34461_backing_0 =\n                  &shared_mem[local_mem_34461_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_34452;\n    int32_t local_tid_34453;\n    int64_t group_sizze_34456;\n    int32_t wave_sizze_34455;\n    int32_t group_tid_34454;\n    \n    global_tid_34452 = get_global_id(0);\n    local_tid_34453 = get_local_id(0);\n    group_sizze_34456 = get_local_size(0);\n    wave_sizze_34455 = LOCKSTEP_WIDTH;\n    group_tid_34454 = get_group_id(0);\n    \n    int32_t phys_tid_30965;\n    \n    phys_tid_30965 = global_tid_34452;\n    \n    int64_t byte_offsets_34457;\n    \n    byte_offsets_34457 = (int64_t) 0;\n    \n    int64_t byte_offsets_34458;\n    \n    byte_offsets_34458 = segscan_group_sizze_30960 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34459;\n    \n    warp_byte_offset_34459 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34460;\n    \n    warp_byte_offset_34460 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34461;\n    \n    local_mem_34461 = (__lo",
            "cal char *) local_mem_34461_backing_0;\n    \n    int64_t trans_arr_len_34462;\n    \n    trans_arr_len_34462 = (int64_t) 9 * segscan_group_sizze_30960;\n    \n    int32_t dynamic_id_34469;\n    \n    if (local_tid_34453 == 0) {\n        dynamic_id_34469 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34444)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34461)[(int64_t) 0] = dynamic_id_34469;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34469 = ((__local int32_t *) local_mem_34461)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34470;\n    \n    blockOff_34470 = sext_i32_i64(dynamic_id_34469) * (int64_t) 9 *\n        segscan_group_sizze_30960;\n    \n    int64_t private_mem_34471[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34473 = 0; i_34473 < (int64_t) 9; i_34473++) {\n            int64_t gtid_30964 = blockOff_34470 +\n                    sext_i32_i64(local_tid_34453) + i_34473 *\n                    segscan_group_sizze_30960;\n            \n            if (slt64(gtid_30964, num_segments_29493)) {\n                int64_t x_29514 = ((__global int64_t *) mem_32212)[gtid_30964];\n                \n                private_mem_34471[i_34473] = x_29514;\n            } else {\n                private_mem_34471[i_34473] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34474 = 0; i_34474 < (int64_t) 9; i_34474++) {\n            int64_t sharedIdx_34475 = sext_i32_i64(local_tid_34453) + i_34474 *\n                    segscan_group_sizze_30960;\n            \n            ((__local int64_t *) local_mem_34461)[sharedIdx_34475] =\n                private_mem_34471[i_34474];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34476 = 0; i_34476 < 9; i_34476++) {\n            int32_t sharedIdx_34477",
            " = local_tid_34453 * 9 + i_34476;\n            \n            private_mem_34471[sext_i32_i64(i_34476)] = ((__local\n                                                         int64_t *) local_mem_34461)[sext_i32_i64(sharedIdx_34477)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34478 = 0; i_34478 < (int64_t) 8; i_34478++) {\n            int64_t x_29511;\n            int64_t x_29512;\n            \n            x_29511 = private_mem_34471[i_34478];\n            x_29512 = private_mem_34471[i_34478 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29513;\n            \n            defunc_1_op_res_29513 = add64(x_29511, x_29512);\n            private_mem_34471[i_34478 + (int64_t) 1] = defunc_1_op_res_29513;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34453)] =\n            private_mem_34471[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34482;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34479;\n        int64_t x_34480;\n        int64_t x_34483;\n        int64_t x_34484;\n        bool ltid_in_bounds_34486;\n        \n        ltid_in_bounds_34486 = slt64(sext_i32_i64(local_tid_34453),\n                                     segscan_group_sizze_30960);\n        \n        int32_t skip_threads_34487;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34486) {\n                x_34480 = ((volatile __local\n                            int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34453)];\n                if ((local_tid_34453 - squot32(local_tid_344",
            "53, 32) * 32) ==\n                    0) {\n                    x_34479 = x_34480;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34487 = 1;\n            while (slt32(skip_threads_34487, 32)) {\n                if (sle32(skip_threads_34487, local_tid_34453 -\n                          squot32(local_tid_34453, 32) * 32) &&\n                    ltid_in_bounds_34486) {\n                    // read operands\n                    {\n                        x_34479 = ((volatile __local\n                                    int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34453) -\n                                                                 sext_i32_i64(skip_threads_34487))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_34481 = add64(x_34479, x_34480);\n                        \n                        x_34479 = defunc_1_op_res_34481;\n                    }\n                }\n                if (sle32(wave_sizze_34455, skip_threads_34487)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34487, local_tid_34453 -\n                          squot32(local_tid_34453, 32) * 32) &&\n                    ltid_in_bounds_34486) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34453)] =\n                            x_34479;\n                        x_34480 = x_34479;\n                    }\n                }\n",
            "                if (sle32(wave_sizze_34455, skip_threads_34487)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34487 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34453 - squot32(local_tid_34453, 32) * 32) == 31 &&\n                ltid_in_bounds_34486) {\n                ((volatile __local\n                  int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34453,\n                                                                   32))] =\n                    x_34479;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34488;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34453, 32) == 0 && ltid_in_bounds_34486) {\n                    x_34484 = ((volatile __local\n                                int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34453)];\n                    if ((local_tid_34453 - squot32(local_tid_34453, 32) * 32) ==\n                        0) {\n                        x_34483 = x_34484;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34488 = 1;\n                while (slt32(skip_threads_34488, 32)) {\n                    if (sle32(skip_threads_34488, local_tid_34453 -\n                              squot32(local_tid_34453, 32) * 32) &&\n                    ",
            "    (squot32(local_tid_34453, 32) == 0 &&\n                         ltid_in_bounds_34486)) {\n                        // read operands\n                        {\n                            x_34483 = ((volatile __local\n                                        int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_34453) -\n                                                                     sext_i32_i64(skip_threads_34488))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_34485 = add64(x_34483,\n                                                                  x_34484);\n                            \n                            x_34483 = defunc_1_op_res_34485;\n                        }\n                    }\n                    if (sle32(wave_sizze_34455, skip_threads_34488)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34488, local_tid_34453 -\n                              squot32(local_tid_34453, 32) * 32) &&\n                        (squot32(local_tid_34453, 32) == 0 &&\n                         ltid_in_bounds_34486)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34453)] =\n                                x_34483;\n                            x_34484 = x_34483;\n                        }\n                    }\n                    if (sle32(wave_sizze_34455, skip_threads_34488)) {\n                        barrier(",
            "CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34488 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34453, 32) == 0 || !ltid_in_bounds_34486)) {\n                // read operands\n                {\n                    x_34480 = x_34479;\n                    x_34479 = ((__local\n                                int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34453,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_34481 = add64(x_34479, x_34480);\n                    \n                    x_34479 = defunc_1_op_res_34481;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34453)] =\n                        x_34479;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34453, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34453)] =\n                    x_34480;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FEN",
            "CE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34453 == 0) {\n            acc_34482 = ((__local\n                          int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30960 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34482 = ((__local\n                          int64_t *) local_mem_34461)[squot64(byte_offsets_34457,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_34453) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34489;\n    \n    prefix_34489 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34469 == (int64_t) 0 && local_tid_34453 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34450)[dynamic_id_34469] = acc_34482;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34446)[dynamic_id_34469] = (int8_t) 2;\n            acc_34482 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34469 == (int64_t) 0) && slt32(local_tid_34453,\n                                                        wave_sizze_34455)) {\n            if (local_tid_34453 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34448)[dynamic_id_34469] =\n                    acc_34482;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34446)[dynamic_id_34469] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34461)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_344",
            "46)[dynamic_id_34469 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34490;\n            \n            status_34490 = ((__local int8_t *) local_mem_34461)[(int64_t) 0];\n            if (status_34490 == (int8_t) 2) {\n                if (local_tid_34453 == 0) {\n                    prefix_34489 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34450)[dynamic_id_34469 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34491 = dynamic_id_34469 -\n                        sext_i32_i64(wave_sizze_34455);\n                \n                while (slt32(wave_sizze_34455 * -1, readOffset_34491)) {\n                    int32_t read_i_34492 = readOffset_34491 + local_tid_34453;\n                    int64_t aggr_34493 = (int64_t) 0;\n                    int8_t flag_34494 = (int8_t) 0;\n                    int8_t used_34495 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34492)) {\n                        flag_34494 = ((volatile __global\n                                       int8_t *) status_flags_mem_34446)[sext_i32_i64(read_i_34492)];\n                        if (flag_34494 == (int8_t) 2) {\n                            aggr_34493 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34450)[sext_i32_i64(read_i_34492)];\n                        } else {\n                            if (flag_34494 == (int8_t) 1) {\n                                aggr_34493 = ((volatile __global\n                                               int64_t *) aggregates_mem_34448)[sext_i32_i64(read_i_34492)];\n                                used_34495 = (int8_t) 1;\n                            }\n                        }\n                    }\n                  ",
            "  ((__local\n                      int64_t *) local_mem_34461)[squot64(warp_byte_offset_34459,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34453)] =\n                        aggr_34493;\n                    \n                    int8_t tmp_34496;\n                    \n                    tmp_34496 = flag_34494 | used_34495 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34461)[sext_i32_i64(local_tid_34453)] =\n                        tmp_34496;\n                    mem_fence_local();\n                    flag_34494 = ((volatile __local\n                                   int8_t *) local_mem_34461)[sext_i32_i64(wave_sizze_34455) -\n                                                              (int64_t) 1];\n                    if (local_tid_34453 == 0) {\n                        if (!(flag_34494 == (int8_t) 2)) {\n                            int64_t x_34497 = (int64_t) 0;\n                            int64_t x_34498;\n                            int8_t flag1_34500;\n                            \n                            flag1_34500 = (int8_t) 0;\n                            \n                            int8_t flag2_34501;\n                            int8_t used1_34502;\n                            \n                            used1_34502 = (int8_t) 0;\n                            \n                            int8_t used2_34503;\n                            \n                            for (int32_t i_34504 = 0; i_34504 <\n                                 wave_sizze_34455; i_34504++) {\n                                flag2_34501 = ((__local\n                                                int8_t *) local_mem_34461)[sext_i32_i64(i_34504)];\n                                used2_34503 = lshr8(flag2_34501, (int8_t) 2);\n                                flag2_34501 = flag2_34501 & (int8_t) 3;\n                                x_34498 = ((__local\n             ",
            "                               int64_t *) local_mem_34461)[squot64(warp_byte_offset_34459,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34504)];\n                                if (!(flag2_34501 == (int8_t) 1)) {\n                                    flag1_34500 = flag2_34501;\n                                    used1_34502 = used2_34503;\n                                    x_34497 = x_34498;\n                                } else {\n                                    used1_34502 += used2_34503;\n                                    \n                                    int64_t defunc_1_op_res_34499;\n                                    \n                                    defunc_1_op_res_34499 = add64(x_34497,\n                                                                  x_34498);\n                                    x_34497 = defunc_1_op_res_34499;\n                                }\n                            }\n                            flag_34494 = flag1_34500;\n                            used_34495 = used1_34502;\n                            aggr_34493 = x_34497;\n                        } else {\n                            aggr_34493 = ((__local\n                                           int64_t *) local_mem_34461)[squot64(warp_byte_offset_34459,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34455) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34494 == (int8_t) 2) {\n                            readOffset_34491 = wave_sizze_34455 * -1;\n                        } else {\n                            readOffset_34491 -= zext_i8_i32(used_34495);\n                        }\n                        ",
            "((__local int32_t *) local_mem_34461)[(int64_t) 0] =\n                            readOffset_34491;\n                        \n                        int64_t x_34505;\n                        \n                        x_34505 = aggr_34493;\n                        \n                        int64_t x_34506;\n                        \n                        x_34506 = prefix_34489;\n                        \n                        int64_t defunc_1_op_res_34507;\n                        \n                        defunc_1_op_res_34507 = add64(x_34505, x_34506);\n                        prefix_34489 = defunc_1_op_res_34507;\n                    }\n                    mem_fence_local();\n                    readOffset_34491 = ((__local\n                                         int32_t *) local_mem_34461)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34453 == 0) {\n                int64_t x_34508 = prefix_34489;\n                int64_t x_34509 = acc_34482;\n                int64_t defunc_1_op_res_34510 = add64(x_34508, x_34509);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34450)[dynamic_id_34469] =\n                    defunc_1_op_res_34510;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34446)[dynamic_id_34469] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34461)[squot64(warp_byte_offset_34459,\n                                                      (int64_t) 8)] =\n                    prefix_34489;\n                acc_34482 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34469 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34489 = ((__local\n                             int64_t *) local_mem_34461)[squot64(warp_byte_offset_34459,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE",
            ");\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34511;\n        int64_t x_34512;\n        int64_t x_34514;\n        \n        x_34514 = prefix_34489;\n        \n        int64_t x_34515;\n        \n        x_34515 = acc_34482;\n        \n        int64_t defunc_1_op_res_34516;\n        \n        defunc_1_op_res_34516 = add64(x_34514, x_34515);\n        x_34511 = defunc_1_op_res_34516;\n        for (int64_t i_34517 = 0; i_34517 < (int64_t) 9; i_34517++) {\n            x_34512 = private_mem_34471[i_34517];\n            \n            int64_t defunc_1_op_res_34513;\n            \n            defunc_1_op_res_34513 = add64(x_34511, x_34512);\n            private_mem_34471[i_34517] = defunc_1_op_res_34513;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34518 = 0; i_34518 < (int64_t) 9; i_34518++) {\n            int64_t sharedIdx_34519 = sext_i32_i64(local_tid_34453 * 9) +\n                    i_34518;\n            \n            ((__local int64_t *) local_mem_34461)[sharedIdx_34519] =\n                private_mem_34471[i_34518];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34520 = 0; i_34520 < (int64_t) 9; i_34520++) {\n            int32_t sharedIdx_34521 = local_tid_34453 +\n                    sext_i64_i32(segscan_group_sizze_30960 * i_34520);\n            \n            private_mem_34471[i_34520] = ((__local\n                                           int64_t *) local_mem_34461)[sext_i32_i64(sharedIdx_34521)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34522 = 0; i_34522 < (int64_t) 9; i_34522++) {\n            int64_t gtid_30964 = blockOff_34470 + segscan_group_sizze_30960 *\n                    i_34522 + sext_i32_i64(local_tid_34453);\n            \n            if (slt64(gtid_30964, num_segments_29493)) {\n                ((__global int64_t *) mem_32216)[gtid_30964] =\n                    private_mem_34471[i_3",
            "4522];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34469 == sdiv_up64(num_segments_29493,\n                                          segscan_group_sizze_30960 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34444)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30960\n}\n__kernel void test_clusterWithzisegscan_31019(__global int *global_failure,\n                                              uint local_mem_34676_backing_offset_0,\n                                              int64_t numVert_28890,\n                                              int64_t i32_res_29575, __global\n                                              unsigned char *clusterWith_res_mem_32275,\n                                              __global unsigned char *mem_32278,\n                                              __global unsigned char *mem_32280,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34659,\n                                              __global\n                                              unsigned char *status_flags_mem_34661,\n                                              __global\n                                              unsigned char *aggregates_mem_34663,\n                                              __global\n                                              unsigned char *incprefixes_mem_34665)\n{\n    #define segscan_group_sizze_31014 (test_clusterWithzisegscan_group_sizze_31013)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34676_backing_0 =\n                  &shared_mem[local_mem_34676_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t gl",
            "obal_tid_34667;\n    int32_t local_tid_34668;\n    int64_t group_sizze_34671;\n    int32_t wave_sizze_34670;\n    int32_t group_tid_34669;\n    \n    global_tid_34667 = get_global_id(0);\n    local_tid_34668 = get_local_id(0);\n    group_sizze_34671 = get_local_size(0);\n    wave_sizze_34670 = LOCKSTEP_WIDTH;\n    group_tid_34669 = get_group_id(0);\n    \n    int32_t phys_tid_31019;\n    \n    phys_tid_31019 = global_tid_34667;\n    \n    int64_t byte_offsets_34672;\n    \n    byte_offsets_34672 = (int64_t) 0;\n    \n    int64_t byte_offsets_34673;\n    \n    byte_offsets_34673 = segscan_group_sizze_31014 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34674;\n    \n    warp_byte_offset_34674 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34675;\n    \n    warp_byte_offset_34675 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34676;\n    \n    local_mem_34676 = (__local char *) local_mem_34676_backing_0;\n    \n    int64_t trans_arr_len_34677;\n    \n    trans_arr_len_34677 = (int64_t) 9 * segscan_group_sizze_31014;\n    \n    int32_t dynamic_id_34684;\n    \n    if (local_tid_34668 == 0) {\n        dynamic_id_34684 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34659)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34676)[(int64_t) 0] = dynamic_id_34684;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34684 = ((__local int32_t *) local_mem_34676)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34685;\n    \n    blockOff_34685 = sext_i32_i64(dynamic_id_34684) * (int64_t) 9 *\n        segscan_group_sizze_31014;\n    \n    int64_t private_mem_34686[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34688 = 0; i_34688 < (int64_t) 9; i_34688++) {\n            int64_t gtid_31018 = blockOff_34685 +\n                    sext_i32_i64(local_tid_34668) + i_34688 *\n             ",
            "       segscan_group_sizze_31014;\n            \n            if (slt64(gtid_31018, numVert_28890)) {\n                int64_t x_29581 = ((__global\n                                    int64_t *) clusterWith_res_mem_32275)[gtid_31018];\n                bool defunc_0_p_res_29582 = slt64(i32_res_29575, x_29581);\n                bool cond_neg_29583 = !defunc_0_p_res_29582;\n                int64_t defunc_1_lifted_lambda_res_29584 =\n                        btoi_bool_i64(cond_neg_29583);\n                bool is_i_29585 = defunc_1_lifted_lambda_res_29584 ==\n                     (int64_t) 0;\n                bool cond_neg_29586 = !is_i_29585;\n                int64_t part_res_29587 = btoi_bool_i64(cond_neg_29586);\n                int64_t part_res_29588 = btoi_bool_i64(is_i_29585);\n                \n                ((__global int64_t *) mem_32280)[gtid_31018] = part_res_29587;\n                private_mem_34686[i_34688] = part_res_29588;\n            } else {\n                private_mem_34686[i_34688] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34689 = 0; i_34689 < (int64_t) 9; i_34689++) {\n            int64_t sharedIdx_34690 = sext_i32_i64(local_tid_34668) + i_34689 *\n                    segscan_group_sizze_31014;\n            \n            ((__local int64_t *) local_mem_34676)[sharedIdx_34690] =\n                private_mem_34686[i_34689];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34691 = 0; i_34691 < 9; i_34691++) {\n            int32_t sharedIdx_34692 = local_tid_34668 * 9 + i_34691;\n            \n            private_mem_34686[sext_i32_i64(i_34691)] = ((__local\n                                                         int64_t *) local_mem_34676)[sext_i32_i64(sharedIdx_34692)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34693 = 0; i_34693 < (int64_t) 8; i_34693++) {\n            int64_t x_29578;\n        ",
            "    int64_t y_29579;\n            \n            x_29578 = private_mem_34686[i_34693];\n            y_29579 = private_mem_34686[i_34693 + (int64_t) 1];\n            \n            int64_t zz_29580;\n            \n            zz_29580 = x_29578 + y_29579;\n            private_mem_34686[i_34693 + (int64_t) 1] = zz_29580;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34668)] =\n            private_mem_34686[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34697;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34694;\n        int64_t y_34695;\n        int64_t x_34698;\n        int64_t y_34699;\n        bool ltid_in_bounds_34701;\n        \n        ltid_in_bounds_34701 = slt64(sext_i32_i64(local_tid_34668),\n                                     segscan_group_sizze_31014);\n        \n        int32_t skip_threads_34702;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34701) {\n                y_34695 = ((volatile __local\n                            int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34668)];\n                if ((local_tid_34668 - squot32(local_tid_34668, 32) * 32) ==\n                    0) {\n                    x_34694 = y_34695;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34702 = 1;\n            while (slt32(skip_threads_34702, 32)) {\n                if (sle32(skip_threads_34702, local_tid_34668 -\n                          squot32(local_tid_34668, 32) * 32) &&\n                    ltid_in_bounds_34701) {\n               ",
            "     // read operands\n                    {\n                        x_34694 = ((volatile __local\n                                    int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34668) -\n                                                                 sext_i32_i64(skip_threads_34702))];\n                    }\n                    // perform operation\n                    {\n                        int64_t zz_34696 = x_34694 + y_34695;\n                        \n                        x_34694 = zz_34696;\n                    }\n                }\n                if (sle32(wave_sizze_34670, skip_threads_34702)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34702, local_tid_34668 -\n                          squot32(local_tid_34668, 32) * 32) &&\n                    ltid_in_bounds_34701) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34668)] =\n                            x_34694;\n                        y_34695 = x_34694;\n                    }\n                }\n                if (sle32(wave_sizze_34670, skip_threads_34702)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34702 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34668 - squot32(local_tid_34668, 32) * 32) == 31 &&\n                ltid_in_bounds_34701) {\n                ((volatile __local\n                  int64_t ",
            "*) local_mem_34676)[squot64(byte_offsets_34672,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34668,\n                                                                   32))] =\n                    x_34694;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34703;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34668, 32) == 0 && ltid_in_bounds_34701) {\n                    y_34699 = ((volatile __local\n                                int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34668)];\n                    if ((local_tid_34668 - squot32(local_tid_34668, 32) * 32) ==\n                        0) {\n                        x_34698 = y_34699;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34703 = 1;\n                while (slt32(skip_threads_34703, 32)) {\n                    if (sle32(skip_threads_34703, local_tid_34668 -\n                              squot32(local_tid_34668, 32) * 32) &&\n                        (squot32(local_tid_34668, 32) == 0 &&\n                         ltid_in_bounds_34701)) {\n                        // read operands\n                        {\n                            x_34698 = ((volatile __local\n                                        int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_3",
            "4668) -\n                                                                     sext_i32_i64(skip_threads_34703))];\n                        }\n                        // perform operation\n                        {\n                            int64_t zz_34700 = x_34698 + y_34699;\n                            \n                            x_34698 = zz_34700;\n                        }\n                    }\n                    if (sle32(wave_sizze_34670, skip_threads_34703)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34703, local_tid_34668 -\n                              squot32(local_tid_34668, 32) * 32) &&\n                        (squot32(local_tid_34668, 32) == 0 &&\n                         ltid_in_bounds_34701)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34668)] =\n                                x_34698;\n                            y_34699 = x_34698;\n                        }\n                    }\n                    if (sle32(wave_sizze_34670, skip_threads_34703)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34703 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34668, 32) == 0 || !ltid_in_bounds_34701)) {\n                // read operands\n                {\n                    y_34695 = x_34694;\n                    x_34694 = ((__local\n                                int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                               ",
            "     (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34668,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t zz_34696 = x_34694 + y_34695;\n                    \n                    x_34694 = zz_34696;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34668)] =\n                        x_34694;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34668, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34668)] =\n                    y_34695;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34668 == 0) {\n            acc_34697 = ((__local\n                          int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31014 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_34697 = ((__local\n                          int64_t *) local_mem_34676)[squot64(byte_offsets_34672,\n                                                              (int64",
            "_t) 8) +\n                                                      (sext_i32_i64(local_tid_34668) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34704;\n    \n    prefix_34704 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34684 == (int64_t) 0 && local_tid_34668 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34665)[dynamic_id_34684] = acc_34697;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34661)[dynamic_id_34684] = (int8_t) 2;\n            acc_34697 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34684 == (int64_t) 0) && slt32(local_tid_34668,\n                                                        wave_sizze_34670)) {\n            if (local_tid_34668 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34663)[dynamic_id_34684] =\n                    acc_34697;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34661)[dynamic_id_34684] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34676)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_34661)[dynamic_id_34684 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34705;\n            \n            status_34705 = ((__local int8_t *) local_mem_34676)[(int64_t) 0];\n            if (status_34705 == (int8_t) 2) {\n                if (local_tid_34668 == 0) {\n                    prefix_34704 = ((volatile __global\n                                     int64_t *) incprefixes_mem_34665)[dynamic_id_34684 -\n                                                                    ",
            "   (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34706 = dynamic_id_34684 -\n                        sext_i32_i64(wave_sizze_34670);\n                \n                while (slt32(wave_sizze_34670 * -1, readOffset_34706)) {\n                    int32_t read_i_34707 = readOffset_34706 + local_tid_34668;\n                    int64_t aggr_34708 = (int64_t) 0;\n                    int8_t flag_34709 = (int8_t) 0;\n                    int8_t used_34710 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34707)) {\n                        flag_34709 = ((volatile __global\n                                       int8_t *) status_flags_mem_34661)[sext_i32_i64(read_i_34707)];\n                        if (flag_34709 == (int8_t) 2) {\n                            aggr_34708 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34665)[sext_i32_i64(read_i_34707)];\n                        } else {\n                            if (flag_34709 == (int8_t) 1) {\n                                aggr_34708 = ((volatile __global\n                                               int64_t *) aggregates_mem_34663)[sext_i32_i64(read_i_34707)];\n                                used_34710 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_34676)[squot64(warp_byte_offset_34674,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34668)] =\n                        aggr_34708;\n                    \n                    int8_t tmp_34711;\n                    \n                    tmp_34711 = flag_34709 | used_34710 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_34676)[sext_i32_i64(local_tid_34668)] =\n                        tmp_34711;\n                    mem_fence_local();\n   ",
            "                 flag_34709 = ((volatile __local\n                                   int8_t *) local_mem_34676)[sext_i32_i64(wave_sizze_34670) -\n                                                              (int64_t) 1];\n                    if (local_tid_34668 == 0) {\n                        if (!(flag_34709 == (int8_t) 2)) {\n                            int64_t x_34712 = (int64_t) 0;\n                            int64_t y_34713;\n                            int8_t flag1_34715;\n                            \n                            flag1_34715 = (int8_t) 0;\n                            \n                            int8_t flag2_34716;\n                            int8_t used1_34717;\n                            \n                            used1_34717 = (int8_t) 0;\n                            \n                            int8_t used2_34718;\n                            \n                            for (int32_t i_34719 = 0; i_34719 <\n                                 wave_sizze_34670; i_34719++) {\n                                flag2_34716 = ((__local\n                                                int8_t *) local_mem_34676)[sext_i32_i64(i_34719)];\n                                used2_34718 = lshr8(flag2_34716, (int8_t) 2);\n                                flag2_34716 = flag2_34716 & (int8_t) 3;\n                                y_34713 = ((__local\n                                            int64_t *) local_mem_34676)[squot64(warp_byte_offset_34674,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34719)];\n                                if (!(flag2_34716 == (int8_t) 1)) {\n                                    flag1_34715 = flag2_34716;\n                                    used1_34717 = used2_34718;\n                                    x_34712 = y_34713;\n                                } else {\n                                    used1_34717 += use",
            "d2_34718;\n                                    \n                                    int64_t zz_34714;\n                                    \n                                    zz_34714 = x_34712 + y_34713;\n                                    x_34712 = zz_34714;\n                                }\n                            }\n                            flag_34709 = flag1_34715;\n                            used_34710 = used1_34717;\n                            aggr_34708 = x_34712;\n                        } else {\n                            aggr_34708 = ((__local\n                                           int64_t *) local_mem_34676)[squot64(warp_byte_offset_34674,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34670) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34709 == (int8_t) 2) {\n                            readOffset_34706 = wave_sizze_34670 * -1;\n                        } else {\n                            readOffset_34706 -= zext_i8_i32(used_34710);\n                        }\n                        ((__local int32_t *) local_mem_34676)[(int64_t) 0] =\n                            readOffset_34706;\n                        \n                        int64_t x_34720;\n                        \n                        x_34720 = aggr_34708;\n                        \n                        int64_t y_34721;\n                        \n                        y_34721 = prefix_34704;\n                        \n                        int64_t zz_34722;\n                        \n                        zz_34722 = x_34720 + y_34721;\n                        prefix_34704 = zz_34722;\n                    }\n                    mem_fence_local();\n                    readOffset_34706 = ((__local\n                                         int32_t *) local",
            "_mem_34676)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34668 == 0) {\n                int64_t x_34723 = prefix_34704;\n                int64_t y_34724 = acc_34697;\n                int64_t zz_34725 = x_34723 + y_34724;\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34665)[dynamic_id_34684] =\n                    zz_34725;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34661)[dynamic_id_34684] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34676)[squot64(warp_byte_offset_34674,\n                                                      (int64_t) 8)] =\n                    prefix_34704;\n                acc_34697 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34684 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34704 = ((__local\n                             int64_t *) local_mem_34676)[squot64(warp_byte_offset_34674,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34726;\n        int64_t y_34727;\n        int64_t x_34729;\n        \n        x_34729 = prefix_34704;\n        \n        int64_t y_34730;\n        \n        y_34730 = acc_34697;\n        \n        int64_t zz_34731;\n        \n        zz_34731 = x_34729 + y_34730;\n        x_34726 = zz_34731;\n        for (int64_t i_34732 = 0; i_34732 < (int64_t) 9; i_34732++) {\n            y_34727 = private_mem_34686[i_34732];\n            \n            int64_t zz_34728;\n            \n            zz_34728 = x_34726 + y_34727;\n            private_mem_34686[i_34732] = zz_34728;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34733 = 0; i_34733 < (int64_t) 9; i_34733++) {\n            int64_t sharedIdx_34734 =",
            " sext_i32_i64(local_tid_34668 * 9) +\n                    i_34733;\n            \n            ((__local int64_t *) local_mem_34676)[sharedIdx_34734] =\n                private_mem_34686[i_34733];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34735 = 0; i_34735 < (int64_t) 9; i_34735++) {\n            int32_t sharedIdx_34736 = local_tid_34668 +\n                    sext_i64_i32(segscan_group_sizze_31014 * i_34735);\n            \n            private_mem_34686[i_34735] = ((__local\n                                           int64_t *) local_mem_34676)[sext_i32_i64(sharedIdx_34736)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34737 = 0; i_34737 < (int64_t) 9; i_34737++) {\n            int64_t gtid_31018 = blockOff_34685 + segscan_group_sizze_31014 *\n                    i_34737 + sext_i32_i64(local_tid_34668);\n            \n            if (slt64(gtid_31018, numVert_28890)) {\n                ((__global int64_t *) mem_32278)[gtid_31018] =\n                    private_mem_34686[i_34737];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34684 == sdiv_up64(numVert_28890,\n                                          segscan_group_sizze_31014 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34659)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31014\n}\n__kernel void test_clusterWithzisegscan_31033(__global int *global_failure,\n                                              int failure_is_an_option, __global\n                                              int64_t *global_failure_args,\n                                              uint local_mem_34764_backing_offset_0,\n                                              int64_t numVert_28890,\n                     ",
            "                         int64_t partition_sizze_29591,\n                                              __global\n                                              unsigned char *clusterWith_res_mem_32275,\n                                              __global unsigned char *mem_32282,\n                                              __global unsigned char *mem_32290,\n                                              __global unsigned char *mem_32292,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_34747,\n                                              __global\n                                              unsigned char *status_flags_mem_34749,\n                                              __global\n                                              unsigned char *aggregates_mem_34751,\n                                              __global\n                                              unsigned char *incprefixes_mem_34753)\n{\n    #define segscan_group_sizze_31028 (test_clusterWithzisegscan_group_sizze_31027)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_34764_backing_0 =\n                  &shared_mem[local_mem_34764_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_34755;\n    int32_t local_tid_34756;\n    int64_t group_sizze_34759;\n    int32_t wave_sizze_34758;\n    int32_t group_tid_34757;\n    \n    global_tid_34755 = get_global_id(0);\n    local_tid_34756 = get_local_id(0);\n    group_sizze_34759 = get_local_size(0);\n    wave_sizze_34758 = LOCKSTEP_WIDTH;\n    group_tid_34757 = get_group_id(0);\n    \n    int32_t phys_tid_31033;\n    \n    phys_tid_31033 = global_tid_34755;\n    \n    int64_t b",
            "yte_offsets_34760;\n    \n    byte_offsets_34760 = (int64_t) 0;\n    \n    int64_t byte_offsets_34761;\n    \n    byte_offsets_34761 = segscan_group_sizze_31028 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_34762;\n    \n    warp_byte_offset_34762 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_34763;\n    \n    warp_byte_offset_34763 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_34764;\n    \n    local_mem_34764 = (__local char *) local_mem_34764_backing_0;\n    \n    int64_t trans_arr_len_34765;\n    \n    trans_arr_len_34765 = (int64_t) 9 * segscan_group_sizze_31028;\n    \n    int32_t dynamic_id_34772;\n    \n    if (local_tid_34756 == 0) {\n        dynamic_id_34772 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_34747)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_34764)[(int64_t) 0] = dynamic_id_34772;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_34772 = ((__local int32_t *) local_mem_34764)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_34773;\n    \n    blockOff_34773 = sext_i32_i64(dynamic_id_34772) * (int64_t) 9 *\n        segscan_group_sizze_31028;\n    \n    int64_t private_mem_34774[9];\n    \n    // Load and map\n    {\n        for (int64_t i_34776 = 0; i_34776 < (int64_t) 9; i_34776++) {\n            int64_t gtid_31032 = blockOff_34773 +\n                    sext_i32_i64(local_tid_34756) + i_34776 *\n                    segscan_group_sizze_31028;\n            \n            if (slt64(gtid_31032, partition_sizze_29591)) {\n                int32_t x_29625 = ((__global int32_t *) mem_32282)[gtid_31032];\n                int64_t v_29626 = sext_i32_i64(x_29625);\n                bool x_29627 = sle64((int64_t) 0, v_29626);\n                bool y_29628 = slt64(v_29626, numVert_28890);\n                bool bounds_check_29629 = x_29627 && y_29628;\n        ",
            "        bool index_certs_29630;\n                \n                if (!bounds_check_29629) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 23) ==\n                            -1) {\n                            global_failure_args[0] = v_29626;\n                            global_failure_args[1] = numVert_28890;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t defunc_0_f_res_29631 = ((__global\n                                                 int64_t *) clusterWith_res_mem_32275)[v_29626];\n                \n                ((__global int64_t *) mem_32292)[gtid_31032] =\n                    defunc_0_f_res_29631;\n                private_mem_34774[i_34776] = defunc_0_f_res_29631;\n            } else {\n                private_mem_34774[i_34776] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34777 = 0; i_34777 < (int64_t) 9; i_34777++) {\n            int64_t sharedIdx_34778 = sext_i32_i64(local_tid_34756) + i_34777 *\n                    segscan_group_sizze_31028;\n            \n            ((__local int64_t *) local_mem_34764)[sharedIdx_34778] =\n                private_mem_34774[i_34777];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_34779 = 0; i_34779 < 9; i_34779++) {\n            int32_t sharedIdx_34780 = local_tid_34756 * 9 + i_34779;\n            \n            private_mem_34774[sext_i32_i64(i_34779)] = ((__local\n                                                         int64_t *) local_mem_34764)[sext_i32_i64(sharedIdx_34780)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_34781 = 0; i_34781 < (int64_t) 8; i_34781++) {\n            int64_t x_29622;\n            int64_t x_29623;\n            ",
            "\n            x_29622 = private_mem_34774[i_34781];\n            x_29623 = private_mem_34774[i_34781 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29624;\n            \n            defunc_1_op_res_29624 = add64(x_29622, x_29623);\n            private_mem_34774[i_34781 + (int64_t) 1] = defunc_1_op_res_29624;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34756)] =\n            private_mem_34774[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_34785;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_34782;\n        int64_t x_34783;\n        int64_t x_34786;\n        int64_t x_34787;\n        bool ltid_in_bounds_34789;\n        \n        ltid_in_bounds_34789 = slt64(sext_i32_i64(local_tid_34756),\n                                     segscan_group_sizze_31028);\n        \n        int32_t skip_threads_34790;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_34789) {\n                x_34783 = ((volatile __local\n                            int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_34756)];\n                if ((local_tid_34756 - squot32(local_tid_34756, 32) * 32) ==\n                    0) {\n                    x_34782 = x_34783;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_34790 = 1;\n            while (slt32(skip_threads_34790, 32)) {\n                if (sle32(skip_threads_34790, local_tid_34756 -\n                          squot32(local_tid_34756, 32) * 32) &&\n                    ltid_in_bounds_34789) {\n   ",
            "                 // read operands\n                    {\n                        x_34782 = ((volatile __local\n                                    int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_34756) -\n                                                                 sext_i32_i64(skip_threads_34790))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_34784 = add64(x_34782, x_34783);\n                        \n                        x_34782 = defunc_1_op_res_34784;\n                    }\n                }\n                if (sle32(wave_sizze_34758, skip_threads_34790)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_34790, local_tid_34756 -\n                          squot32(local_tid_34756, 32) * 32) &&\n                    ltid_in_bounds_34789) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_34756)] =\n                            x_34782;\n                        x_34783 = x_34782;\n                    }\n                }\n                if (sle32(wave_sizze_34758, skip_threads_34790)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_34790 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_34756 - squot32(local_tid_34756, 32) * 32) == 31 &&\n                ltid_in_bounds_34789) {\n                (",
            "(volatile __local\n                  int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_34756,\n                                                                   32))] =\n                    x_34782;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_34791;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_34756, 32) == 0 && ltid_in_bounds_34789) {\n                    x_34787 = ((volatile __local\n                                int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_34756)];\n                    if ((local_tid_34756 - squot32(local_tid_34756, 32) * 32) ==\n                        0) {\n                        x_34786 = x_34787;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_34791 = 1;\n                while (slt32(skip_threads_34791, 32)) {\n                    if (sle32(skip_threads_34791, local_tid_34756 -\n                              squot32(local_tid_34756, 32) * 32) &&\n                        (squot32(local_tid_34756, 32) == 0 &&\n                         ltid_in_bounds_34789)) {\n                        // read operands\n                        {\n                            x_34786 = ((volatile __local\n                                        int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                            (int64_t) 8) +\n                                                 ",
            "                   (sext_i32_i64(local_tid_34756) -\n                                                                     sext_i32_i64(skip_threads_34791))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_34788 = add64(x_34786,\n                                                                  x_34787);\n                            \n                            x_34786 = defunc_1_op_res_34788;\n                        }\n                    }\n                    if (sle32(wave_sizze_34758, skip_threads_34791)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_34791, local_tid_34756 -\n                              squot32(local_tid_34756, 32) * 32) &&\n                        (squot32(local_tid_34756, 32) == 0 &&\n                         ltid_in_bounds_34789)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_34756)] =\n                                x_34786;\n                            x_34787 = x_34786;\n                        }\n                    }\n                    if (sle32(wave_sizze_34758, skip_threads_34791)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_34791 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_34756, 32) == 0 || !ltid_in_bounds_34789)) {\n                // read operands\n                {\n                    x_34783 = x_34782;\n                    x_34782 = ((__local\n         ",
            "                       int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_34756,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_34784 = add64(x_34782, x_34783);\n                    \n                    x_34782 = defunc_1_op_res_34784;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34756)] =\n                        x_34782;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_34756, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_34756)] =\n                    x_34783;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_34756 == 0) {\n            acc_34785 = ((__local\n                          int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31028 -\n                                                       (int64_t) 1)];\n        } else {\n          ",
            "  acc_34785 = ((__local\n                          int64_t *) local_mem_34764)[squot64(byte_offsets_34760,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_34756) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_34792;\n    \n    prefix_34792 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_34772 == (int64_t) 0 && local_tid_34756 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_34753)[dynamic_id_34772] = acc_34785;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_34749)[dynamic_id_34772] = (int8_t) 2;\n            acc_34785 = (int64_t) 0;\n        }\n        if (!(dynamic_id_34772 == (int64_t) 0) && slt32(local_tid_34756,\n                                                        wave_sizze_34758)) {\n            if (local_tid_34756 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_34751)[dynamic_id_34772] =\n                    acc_34785;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34749)[dynamic_id_34772] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_34764)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_34749)[dynamic_id_34772 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_34793;\n            \n            status_34793 = ((__local int8_t *) local_mem_34764)[(int64_t) 0];\n            if (status_34793 == (int8_t) 2) {\n                if (local_tid_34756 == 0) {\n                    prefix_34792 = ((vo",
            "latile __global\n                                     int64_t *) incprefixes_mem_34753)[dynamic_id_34772 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_34794 = dynamic_id_34772 -\n                        sext_i32_i64(wave_sizze_34758);\n                \n                while (slt32(wave_sizze_34758 * -1, readOffset_34794)) {\n                    int32_t read_i_34795 = readOffset_34794 + local_tid_34756;\n                    int64_t aggr_34796 = (int64_t) 0;\n                    int8_t flag_34797 = (int8_t) 0;\n                    int8_t used_34798 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_34795)) {\n                        flag_34797 = ((volatile __global\n                                       int8_t *) status_flags_mem_34749)[sext_i32_i64(read_i_34795)];\n                        if (flag_34797 == (int8_t) 2) {\n                            aggr_34796 = ((volatile __global\n                                           int64_t *) incprefixes_mem_34753)[sext_i32_i64(read_i_34795)];\n                        } else {\n                            if (flag_34797 == (int8_t) 1) {\n                                aggr_34796 = ((volatile __global\n                                               int64_t *) aggregates_mem_34751)[sext_i32_i64(read_i_34795)];\n                                used_34798 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_34764)[squot64(warp_byte_offset_34762,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_34756)] =\n                        aggr_34796;\n                    \n                    int8_t tmp_34799;\n                    \n                    tmp_34799 = flag_34797 | used_34798 << (int8_t) 2;\n               ",
            "     ((__local\n                      int8_t *) local_mem_34764)[sext_i32_i64(local_tid_34756)] =\n                        tmp_34799;\n                    mem_fence_local();\n                    flag_34797 = ((volatile __local\n                                   int8_t *) local_mem_34764)[sext_i32_i64(wave_sizze_34758) -\n                                                              (int64_t) 1];\n                    if (local_tid_34756 == 0) {\n                        if (!(flag_34797 == (int8_t) 2)) {\n                            int64_t x_34800 = (int64_t) 0;\n                            int64_t x_34801;\n                            int8_t flag1_34803;\n                            \n                            flag1_34803 = (int8_t) 0;\n                            \n                            int8_t flag2_34804;\n                            int8_t used1_34805;\n                            \n                            used1_34805 = (int8_t) 0;\n                            \n                            int8_t used2_34806;\n                            \n                            for (int32_t i_34807 = 0; i_34807 <\n                                 wave_sizze_34758; i_34807++) {\n                                flag2_34804 = ((__local\n                                                int8_t *) local_mem_34764)[sext_i32_i64(i_34807)];\n                                used2_34806 = lshr8(flag2_34804, (int8_t) 2);\n                                flag2_34804 = flag2_34804 & (int8_t) 3;\n                                x_34801 = ((__local\n                                            int64_t *) local_mem_34764)[squot64(warp_byte_offset_34762,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_34807)];\n                                if (!(flag2_34804 == (int8_t) 1)) {\n                                    flag1_34803 = flag2_34804;\n                                    use",
            "d1_34805 = used2_34806;\n                                    x_34800 = x_34801;\n                                } else {\n                                    used1_34805 += used2_34806;\n                                    \n                                    int64_t defunc_1_op_res_34802;\n                                    \n                                    defunc_1_op_res_34802 = add64(x_34800,\n                                                                  x_34801);\n                                    x_34800 = defunc_1_op_res_34802;\n                                }\n                            }\n                            flag_34797 = flag1_34803;\n                            used_34798 = used1_34805;\n                            aggr_34796 = x_34800;\n                        } else {\n                            aggr_34796 = ((__local\n                                           int64_t *) local_mem_34764)[squot64(warp_byte_offset_34762,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_34758) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_34797 == (int8_t) 2) {\n                            readOffset_34794 = wave_sizze_34758 * -1;\n                        } else {\n                            readOffset_34794 -= zext_i8_i32(used_34798);\n                        }\n                        ((__local int32_t *) local_mem_34764)[(int64_t) 0] =\n                            readOffset_34794;\n                        \n                        int64_t x_34808;\n                        \n                        x_34808 = aggr_34796;\n                        \n                        int64_t x_34809;\n                        \n                        x_34809 = prefix_34792;\n                        \n                        int64_t defunc_1_op_res_3481",
            "0;\n                        \n                        defunc_1_op_res_34810 = add64(x_34808, x_34809);\n                        prefix_34792 = defunc_1_op_res_34810;\n                    }\n                    mem_fence_local();\n                    readOffset_34794 = ((__local\n                                         int32_t *) local_mem_34764)[(int64_t) 0];\n                }\n            }\n            if (local_tid_34756 == 0) {\n                int64_t x_34811 = prefix_34792;\n                int64_t x_34812 = acc_34785;\n                int64_t defunc_1_op_res_34813 = add64(x_34811, x_34812);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_34753)[dynamic_id_34772] =\n                    defunc_1_op_res_34813;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_34749)[dynamic_id_34772] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_34764)[squot64(warp_byte_offset_34762,\n                                                      (int64_t) 8)] =\n                    prefix_34792;\n                acc_34785 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_34772 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_34792 = ((__local\n                             int64_t *) local_mem_34764)[squot64(warp_byte_offset_34762,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_34814;\n        int64_t x_34815;\n        int64_t x_34817;\n        \n        x_34817 = prefix_34792;\n        \n        int64_t x_34818;\n        \n        x_34818 = acc_34785;\n        \n        int64_t defunc_1_op_res_34819;\n        \n        defunc_1_op_res_34819 = add64(x_34817, x_34818);\n        x_34814 = defunc_1_op_res_34819;\n        for (int64_t i_34820 = 0; i_34820 < (int64_t) 9; i",
            "_34820++) {\n            x_34815 = private_mem_34774[i_34820];\n            \n            int64_t defunc_1_op_res_34816;\n            \n            defunc_1_op_res_34816 = add64(x_34814, x_34815);\n            private_mem_34774[i_34820] = defunc_1_op_res_34816;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34821 = 0; i_34821 < (int64_t) 9; i_34821++) {\n            int64_t sharedIdx_34822 = sext_i32_i64(local_tid_34756 * 9) +\n                    i_34821;\n            \n            ((__local int64_t *) local_mem_34764)[sharedIdx_34822] =\n                private_mem_34774[i_34821];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_34823 = 0; i_34823 < (int64_t) 9; i_34823++) {\n            int32_t sharedIdx_34824 = local_tid_34756 +\n                    sext_i64_i32(segscan_group_sizze_31028 * i_34823);\n            \n            private_mem_34774[i_34823] = ((__local\n                                           int64_t *) local_mem_34764)[sext_i32_i64(sharedIdx_34824)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_34825 = 0; i_34825 < (int64_t) 9; i_34825++) {\n            int64_t gtid_31032 = blockOff_34773 + segscan_group_sizze_31028 *\n                    i_34825 + sext_i32_i64(local_tid_34756);\n            \n            if (slt64(gtid_31032, partition_sizze_29591)) {\n                ((__global int64_t *) mem_32290)[gtid_31032] =\n                    private_mem_34774[i_34825];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_34772 == sdiv_up64(partition_sizze_29591,\n                                          segscan_group_sizze_31028 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_34747)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  ",
            "error_0:\n    return;\n    #undef segscan_group_sizze_31028\n}\n__kernel void test_clusterWithzisegscan_31066(__global int *global_failure,\n                                              uint local_mem_35023_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29634,\n                                              __global unsigned char *mem_32297,\n                                              __global unsigned char *mem_32301,\n                                              __global unsigned char *mem_32303,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_35000,\n                                              __global\n                                              unsigned char *status_flags_mem_35002,\n                                              __global\n                                              unsigned char *aggregates_mem_35004,\n                                              __global\n                                              unsigned char *incprefixes_mem_35006,\n                                              __global\n                                              unsigned char *aggregates_mem_35008,\n                                              __global\n                                              unsigned char *incprefixes_mem_35010)\n{\n    #define segscan_group_sizze_31061 (test_clusterWithzisegscan_group_sizze_31060)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_35023_backing_0 =\n                  &shared_mem[local_mem_35023_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_35012;\n    int32_t local_tid_35013;\n    int64_t group_sizze_35016;\n    int32_t wave_sizze_35015;\n    int32_t group_tid_35014;\n    \n    global_tid_35012 = get_global_id(0);\n    local_tid_35013 = get_local_id(0);\n    group_sizze_35016 ",
            "= get_local_size(0);\n    wave_sizze_35015 = LOCKSTEP_WIDTH;\n    group_tid_35014 = get_group_id(0);\n    \n    int32_t phys_tid_31066;\n    \n    phys_tid_31066 = global_tid_35012;\n    \n    int64_t byte_offsets_35017;\n    \n    byte_offsets_35017 = (int64_t) 0;\n    \n    int64_t byte_offsets_35018;\n    \n    byte_offsets_35018 = segscan_group_sizze_31061;\n    \n    int64_t byte_offsets_35019;\n    \n    byte_offsets_35019 = sdiv_up64(segscan_group_sizze_31061, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31061 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_35020;\n    \n    warp_byte_offset_35020 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_35021;\n    \n    warp_byte_offset_35021 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_35022;\n    \n    warp_byte_offset_35022 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_35023;\n    \n    local_mem_35023 = (__local char *) local_mem_35023_backing_0;\n    \n    int64_t trans_arr_len_35024;\n    \n    trans_arr_len_35024 = (int64_t) 9 * segscan_group_sizze_31061;\n    \n    int32_t dynamic_id_35034;\n    \n    if (local_tid_35013 == 0) {\n        dynamic_id_35034 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_35000)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_35023)[(int64_t) 0] = dynamic_id_35034;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_35034 = ((__local int32_t *) local_mem_35023)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_35035;\n    \n    blockOff_35035 = sext_i32_i64(dynamic_id_35034) * (int64_t) 9 *\n        segscan_group_sizze_31061;\n    \n    bool private_mem_35036[9];\n    int64_t private_mem_35038[9];\n    \n    // Load and map\n    {\n        for (int64_t i_35040 = 0; i_35040 < (int64_t) 9; i_35040++) {\n            int64_t gtid_31065 = blockOff_35035 +\n                    sext_i32_",
            "i64(local_tid_35013) + i_35040 *\n                    segscan_group_sizze_31061;\n            \n            if (slt64(gtid_31065, defunc_2_reduce_res_29634)) {\n                int64_t x_29660 = ((__global int64_t *) mem_32297)[gtid_31065];\n                bool defunc_0_f_res_29661 = slt64((int64_t) 0, x_29660);\n                \n                private_mem_35036[i_35040] = defunc_0_f_res_29661;\n                private_mem_35038[i_35040] = x_29660;\n            } else {\n                private_mem_35036[i_35040] = 0;\n                private_mem_35038[i_35040] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35041 = 0; i_35041 < (int64_t) 9; i_35041++) {\n            int64_t sharedIdx_35042 = sext_i32_i64(local_tid_35013) + i_35041 *\n                    segscan_group_sizze_31061;\n            \n            ((__local bool *) local_mem_35023)[sharedIdx_35042] =\n                private_mem_35036[i_35041];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_35043 = 0; i_35043 < 9; i_35043++) {\n            int32_t sharedIdx_35044 = local_tid_35013 * 9 + i_35043;\n            \n            private_mem_35036[sext_i32_i64(i_35043)] = ((__local\n                                                         bool *) local_mem_35023)[sext_i32_i64(sharedIdx_35044)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35045 = 0; i_35045 < (int64_t) 9; i_35045++) {\n            int64_t sharedIdx_35046 = sext_i32_i64(local_tid_35013) + i_35045 *\n                    segscan_group_sizze_31061;\n            \n            ((__local int64_t *) local_mem_35023)[sharedIdx_35046] =\n                private_mem_35038[i_35045];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_35047 = 0; i_35047 < 9; i_35047++) {\n            int32_t sharedIdx_35048 = local_tid_35013 * 9 + i_35047;\n            \n            private_mem_35038[sext_i32_i64(i_35047)] = ((__local\n       ",
            "                                                  int64_t *) local_mem_35023)[sext_i32_i64(sharedIdx_35048)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_35049 = 0; i_35049 < (int64_t) 8; i_35049++) {\n            bool x_29653;\n            bool x_29655;\n            \n            x_29653 = private_mem_35036[i_35049];\n            x_29655 = private_mem_35036[i_35049 + (int64_t) 1];\n            \n            int64_t x_29654;\n            int64_t x_29656;\n            \n            x_29654 = private_mem_35038[i_35049];\n            x_29656 = private_mem_35038[i_35049 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29657;\n            \n            defunc_1_op_res_29657 = x_29653 || x_29655;\n            \n            int64_t defunc_1_op_res_29658;\n            \n            if (x_29655) {\n                defunc_1_op_res_29658 = x_29656;\n            } else {\n                int64_t defunc_1_op_res_29659 = add64(x_29654, x_29656);\n                \n                defunc_1_op_res_29658 = defunc_1_op_res_29659;\n            }\n            private_mem_35036[i_35049 + (int64_t) 1] = defunc_1_op_res_29657;\n            private_mem_35038[i_35049 + (int64_t) 1] = defunc_1_op_res_29658;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_35023)[byte_offsets_35017 +\n                                           sext_i32_i64(local_tid_35013)] =\n            private_mem_35036[(int64_t) 8];\n        ((__local int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35013)] =\n            private_mem_35038[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_35057;\n    int64_t acc_35058;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_35050;\n        int64_t x_35051;\n        bool x_35052;\n        int64_t x_35053;\n   ",
            "     bool x_35059;\n        int64_t x_35060;\n        bool x_35061;\n        int64_t x_35062;\n        bool ltid_in_bounds_35066;\n        \n        ltid_in_bounds_35066 = slt64(sext_i32_i64(local_tid_35013),\n                                     segscan_group_sizze_31061);\n        \n        int32_t skip_threads_35067;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_35066) {\n                x_35052 = ((volatile __local\n                            bool *) local_mem_35023)[byte_offsets_35017 +\n                                                     sext_i32_i64(local_tid_35013)];\n                x_35053 = ((volatile __local\n                            int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_35013)];\n                if ((local_tid_35013 - squot32(local_tid_35013, 32) * 32) ==\n                    0) {\n                    x_35050 = x_35052;\n                    x_35051 = x_35053;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_35067 = 1;\n            while (slt32(skip_threads_35067, 32)) {\n                if (sle32(skip_threads_35067, local_tid_35013 -\n                          squot32(local_tid_35013, 32) * 32) &&\n                    ltid_in_bounds_35066) {\n                    // read operands\n                    {\n                        x_35050 = ((volatile __local\n                                    bool *) local_mem_35023)[byte_offsets_35017 +\n                                                             (sext_i32_i64(local_tid_35013) -\n                                                              sext_i32_i64(skip_threads_35067))];\n                        x_35051 = ((volatile __local\n                                    int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n         ",
            "                                                               (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_35013) -\n                                                                 sext_i32_i64(skip_threads_35067))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_35054 = x_35050 || x_35052;\n                        int64_t defunc_1_op_res_35055;\n                        \n                        if (x_35052) {\n                            defunc_1_op_res_35055 = x_35053;\n                        } else {\n                            int64_t defunc_1_op_res_35056 = add64(x_35051,\n                                                                  x_35053);\n                            \n                            defunc_1_op_res_35055 = defunc_1_op_res_35056;\n                        }\n                        x_35050 = defunc_1_op_res_35054;\n                        x_35051 = defunc_1_op_res_35055;\n                    }\n                }\n                if (sle32(wave_sizze_35015, skip_threads_35067)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_35067, local_tid_35013 -\n                          squot32(local_tid_35013, 32) * 32) &&\n                    ltid_in_bounds_35066) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_35023)[byte_offsets_35017 +\n                                                   sext_i32_i64(local_tid_35013)] =\n                            x_35050;\n                        x_35052 = x_35050;\n                        ((volatile __local\n                          int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local",
            "_tid_35013)] =\n                            x_35051;\n                        x_35053 = x_35051;\n                    }\n                }\n                if (sle32(wave_sizze_35015, skip_threads_35067)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_35067 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_35013 - squot32(local_tid_35013, 32) * 32) == 31 &&\n                ltid_in_bounds_35066) {\n                ((volatile __local bool *) local_mem_35023)[byte_offsets_35017 +\n                                                            sext_i32_i64(squot32(local_tid_35013,\n                                                                                 32))] =\n                    x_35050;\n                ((volatile __local\n                  int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_35013,\n                                                                   32))] =\n                    x_35051;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_35068;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_35013, 32) == 0 && ltid_in_bounds_35066) {\n                    x_35061 = ((volatile __local\n                                bool *) local_mem_35023)[byte_offsets_35017 +\n                                                         sext_i32_i64(local_tid_35013)];\n                    x_35062 = ((volatile __local\n                                int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                            ",
            "        (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_35013)];\n                    if ((local_tid_35013 - squot32(local_tid_35013, 32) * 32) ==\n                        0) {\n                        x_35059 = x_35061;\n                        x_35060 = x_35062;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_35068 = 1;\n                while (slt32(skip_threads_35068, 32)) {\n                    if (sle32(skip_threads_35068, local_tid_35013 -\n                              squot32(local_tid_35013, 32) * 32) &&\n                        (squot32(local_tid_35013, 32) == 0 &&\n                         ltid_in_bounds_35066)) {\n                        // read operands\n                        {\n                            x_35059 = ((volatile __local\n                                        bool *) local_mem_35023)[byte_offsets_35017 +\n                                                                 (sext_i32_i64(local_tid_35013) -\n                                                                  sext_i32_i64(skip_threads_35068))];\n                            x_35060 = ((volatile __local\n                                        int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_35013) -\n                                                                     sext_i32_i64(skip_threads_35068))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_35063 = x_35059 || x_35061;\n                            int64_t defunc_1_op_res_35064;\n                            \n                            if (x_35061) {\n                                defunc_1_op_res_3506",
            "4 = x_35062;\n                            } else {\n                                int64_t defunc_1_op_res_35065 = add64(x_35060,\n                                                                      x_35062);\n                                \n                                defunc_1_op_res_35064 = defunc_1_op_res_35065;\n                            }\n                            x_35059 = defunc_1_op_res_35063;\n                            x_35060 = defunc_1_op_res_35064;\n                        }\n                    }\n                    if (sle32(wave_sizze_35015, skip_threads_35068)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_35068, local_tid_35013 -\n                              squot32(local_tid_35013, 32) * 32) &&\n                        (squot32(local_tid_35013, 32) == 0 &&\n                         ltid_in_bounds_35066)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_35023)[byte_offsets_35017 +\n                                                       sext_i32_i64(local_tid_35013)] =\n                                x_35059;\n                            x_35061 = x_35059;\n                            ((volatile __local\n                              int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_35013)] =\n                                x_35060;\n                            x_35062 = x_35060;\n                        }\n                    }\n                    if (sle32(wave_sizze_35015, skip_threads_35068)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_35068 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n      ",
            "  // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_35013, 32) == 0 || !ltid_in_bounds_35066)) {\n                // read operands\n                {\n                    x_35052 = x_35050;\n                    x_35053 = x_35051;\n                    x_35050 = ((__local\n                                bool *) local_mem_35023)[byte_offsets_35017 +\n                                                         (sext_i32_i64(squot32(local_tid_35013,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_35051 = ((__local\n                                int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_35013,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_35054 = x_35050 || x_35052;\n                    int64_t defunc_1_op_res_35055;\n                    \n                    if (x_35052) {\n                        defunc_1_op_res_35055 = x_35053;\n                    } else {\n                        int64_t defunc_1_op_res_35056 = add64(x_35051, x_35053);\n                        \n                        defunc_1_op_res_35055 = defunc_1_op_res_35056;\n                    }\n                    x_35050 = defunc_1_op_res_35054;\n                    x_35051 = defunc_1_op_res_35055;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_35023)[byte_offsets_35017 +\n                                                       sext_i32_i64(local_tid_35013)] =\n       ",
            "                 x_35050;\n                    ((__local\n                      int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_35013)] =\n                        x_35051;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_35013, 32) == 0) {\n                ((__local bool *) local_mem_35023)[byte_offsets_35017 +\n                                                   sext_i32_i64(local_tid_35013)] =\n                    x_35052;\n                ((__local\n                  int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35013)] =\n                    x_35053;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_35013 == 0) {\n            acc_35057 = ((__local bool *) local_mem_35023)[byte_offsets_35017 +\n                                                           (segscan_group_sizze_31061 -\n                                                            (int64_t) 1)];\n            acc_35058 = ((__local\n                          int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31061 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_35057 = ((__local bool *) local_mem_35023)[byte_offsets_35017 +\n                                                           (sext_i32_i64(local_tid_35013) -\n                                                            (int64_t) 1)];\n            acc_35058 = ((__local",
            "\n                          int64_t *) local_mem_35023)[squot64(byte_offsets_35018,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_35013) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_35069;\n    \n    prefix_35069 = 0;\n    \n    int64_t prefix_35070;\n    \n    prefix_35070 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_35034 == (int64_t) 0 && local_tid_35013 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_35006)[dynamic_id_35034] = acc_35057;\n            ((volatile __global\n              int64_t *) incprefixes_mem_35010)[dynamic_id_35034] = acc_35058;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_35002)[dynamic_id_35034] = (int8_t) 2;\n            acc_35057 = 0;\n            acc_35058 = (int64_t) 0;\n        }\n        if (!(dynamic_id_35034 == (int64_t) 0) && slt32(local_tid_35013,\n                                                        wave_sizze_35015)) {\n            if (local_tid_35013 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_35004)[dynamic_id_35034] = acc_35057;\n                ((volatile __global\n                  int64_t *) aggregates_mem_35008)[dynamic_id_35034] =\n                    acc_35058;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35002)[dynamic_id_35034] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_35023)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_35002)[dynamic_id_35034 -\n                                                                                                        (int64_t) 1];\n            }\n            mem",
            "_fence_local();\n            \n            int8_t status_35071;\n            \n            status_35071 = ((__local int8_t *) local_mem_35023)[(int64_t) 0];\n            if (status_35071 == (int8_t) 2) {\n                if (local_tid_35013 == 0) {\n                    prefix_35069 = ((volatile __global\n                                     bool *) incprefixes_mem_35006)[dynamic_id_35034 -\n                                                                    (int64_t) 1];\n                    prefix_35070 = ((volatile __global\n                                     int64_t *) incprefixes_mem_35010)[dynamic_id_35034 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_35072 = dynamic_id_35034 -\n                        sext_i32_i64(wave_sizze_35015);\n                \n                while (slt32(wave_sizze_35015 * -1, readOffset_35072)) {\n                    int32_t read_i_35073 = readOffset_35072 + local_tid_35013;\n                    bool aggr_35074 = 0;\n                    int64_t aggr_35075 = (int64_t) 0;\n                    int8_t flag_35076 = (int8_t) 0;\n                    int8_t used_35077 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_35073)) {\n                        flag_35076 = ((volatile __global\n                                       int8_t *) status_flags_mem_35002)[sext_i32_i64(read_i_35073)];\n                        if (flag_35076 == (int8_t) 2) {\n                            aggr_35074 = ((volatile __global\n                                           bool *) incprefixes_mem_35006)[sext_i32_i64(read_i_35073)];\n                            aggr_35075 = ((volatile __global\n                                           int64_t *) incprefixes_mem_35010)[sext_i32_i64(read_i_35073)];\n                        } else {\n                            if (flag_35076 == (int8_t) 1) {\n                                aggr_35074 = ((volatile __global\n   ",
            "                                            bool *) aggregates_mem_35004)[sext_i32_i64(read_i_35073)];\n                                aggr_35075 = ((volatile __global\n                                               int64_t *) aggregates_mem_35008)[sext_i32_i64(read_i_35073)];\n                                used_35077 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_35023)[warp_byte_offset_35020 +\n                                                       sext_i32_i64(local_tid_35013)] =\n                        aggr_35074;\n                    ((__local\n                      int64_t *) local_mem_35023)[squot64(warp_byte_offset_35021,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_35013)] =\n                        aggr_35075;\n                    \n                    int8_t tmp_35078;\n                    \n                    tmp_35078 = flag_35076 | used_35077 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_35023)[sext_i32_i64(local_tid_35013)] =\n                        tmp_35078;\n                    mem_fence_local();\n                    flag_35076 = ((volatile __local\n                                   int8_t *) local_mem_35023)[sext_i32_i64(wave_sizze_35015) -\n                                                              (int64_t) 1];\n                    if (local_tid_35013 == 0) {\n                        if (!(flag_35076 == (int8_t) 2)) {\n                            bool x_35079 = 0;\n                            int64_t x_35080 = (int64_t) 0;\n                            bool x_35081;\n                            int64_t x_35082;\n                            int8_t flag1_35086;\n                            \n                            flag1_35086 = (int8_t) 0;\n                            \n                            int8_t flag2_35087;\n             ",
            "               int8_t used1_35088;\n                            \n                            used1_35088 = (int8_t) 0;\n                            \n                            int8_t used2_35089;\n                            \n                            for (int32_t i_35090 = 0; i_35090 <\n                                 wave_sizze_35015; i_35090++) {\n                                flag2_35087 = ((__local\n                                                int8_t *) local_mem_35023)[sext_i32_i64(i_35090)];\n                                used2_35089 = lshr8(flag2_35087, (int8_t) 2);\n                                flag2_35087 = flag2_35087 & (int8_t) 3;\n                                x_35081 = ((__local\n                                            bool *) local_mem_35023)[warp_byte_offset_35020 +\n                                                                     sext_i32_i64(i_35090)];\n                                x_35082 = ((__local\n                                            int64_t *) local_mem_35023)[squot64(warp_byte_offset_35021,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_35090)];\n                                if (!(flag2_35087 == (int8_t) 1)) {\n                                    flag1_35086 = flag2_35087;\n                                    used1_35088 = used2_35089;\n                                    x_35079 = x_35081;\n                                    x_35080 = x_35082;\n                                } else {\n                                    used1_35088 += used2_35089;\n                                    \n                                    bool defunc_1_op_res_35083;\n                                    \n                                    defunc_1_op_res_35083 = x_35079 || x_35081;\n                                    \n                                    int64_t defunc_1_op_res_35084;\n                          ",
            "          \n                                    if (x_35081) {\n                                        defunc_1_op_res_35084 = x_35082;\n                                    } else {\n                                        int64_t defunc_1_op_res_35085 =\n                                                add64(x_35080, x_35082);\n                                        \n                                        defunc_1_op_res_35084 =\n                                            defunc_1_op_res_35085;\n                                    }\n                                    x_35079 = defunc_1_op_res_35083;\n                                    x_35080 = defunc_1_op_res_35084;\n                                }\n                            }\n                            flag_35076 = flag1_35086;\n                            used_35077 = used1_35088;\n                            aggr_35074 = x_35079;\n                            aggr_35075 = x_35080;\n                        } else {\n                            aggr_35074 = ((__local\n                                           bool *) local_mem_35023)[warp_byte_offset_35020 +\n                                                                    (sext_i32_i64(wave_sizze_35015) -\n                                                                     (int64_t) 1)];\n                            aggr_35075 = ((__local\n                                           int64_t *) local_mem_35023)[squot64(warp_byte_offset_35021,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_35015) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_35076 == (int8_t) 2) {\n                            readOffset_35072 = wave_sizze_35015 * -1;\n                        } else {\n                            readOffset_35072 -= zext_i8_i32(used_35",
            "077);\n                        }\n                        ((__local int32_t *) local_mem_35023)[(int64_t) 0] =\n                            readOffset_35072;\n                        \n                        bool x_35091;\n                        \n                        x_35091 = aggr_35074;\n                        \n                        int64_t x_35092;\n                        \n                        x_35092 = aggr_35075;\n                        \n                        bool x_35093;\n                        \n                        x_35093 = prefix_35069;\n                        \n                        int64_t x_35094;\n                        \n                        x_35094 = prefix_35070;\n                        \n                        bool defunc_1_op_res_35095;\n                        \n                        defunc_1_op_res_35095 = x_35091 || x_35093;\n                        \n                        int64_t defunc_1_op_res_35096;\n                        \n                        if (x_35093) {\n                            defunc_1_op_res_35096 = x_35094;\n                        } else {\n                            int64_t defunc_1_op_res_35097 = add64(x_35092,\n                                                                  x_35094);\n                            \n                            defunc_1_op_res_35096 = defunc_1_op_res_35097;\n                        }\n                        prefix_35069 = defunc_1_op_res_35095;\n                        prefix_35070 = defunc_1_op_res_35096;\n                    }\n                    mem_fence_local();\n                    readOffset_35072 = ((__local\n                                         int32_t *) local_mem_35023)[(int64_t) 0];\n                }\n            }\n            if (local_tid_35013 == 0) {\n                bool x_35098 = prefix_35069;\n                int64_t x_35099 = prefix_35070;\n                bool x_35100 = acc_35057;\n                int64_t x_35101 = acc_35058;\n                bool defunc_1_op_res_3510",
            "2 = x_35098 || x_35100;\n                int64_t defunc_1_op_res_35103;\n                \n                if (x_35100) {\n                    defunc_1_op_res_35103 = x_35101;\n                } else {\n                    int64_t defunc_1_op_res_35104 = add64(x_35099, x_35101);\n                    \n                    defunc_1_op_res_35103 = defunc_1_op_res_35104;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_35006)[dynamic_id_35034] =\n                    defunc_1_op_res_35102;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_35010)[dynamic_id_35034] =\n                    defunc_1_op_res_35103;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35002)[dynamic_id_35034] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_35023)[warp_byte_offset_35020] =\n                    prefix_35069;\n                ((__local\n                  int64_t *) local_mem_35023)[squot64(warp_byte_offset_35021,\n                                                      (int64_t) 8)] =\n                    prefix_35070;\n                acc_35057 = 0;\n                acc_35058 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_35034 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_35069 = ((__local\n                             bool *) local_mem_35023)[warp_byte_offset_35020];\n            prefix_35070 = ((__local\n                             int64_t *) local_mem_35023)[squot64(warp_byte_offset_35021,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_35105;\n        bool x_35107;\n        bool x_35112;\n        \n        x_35112 = prefix_35069;\n        \n        bool x_35114;\n        \n        x_35114 = acc_35057;\n        \n        int64_t x_35106;\n        int64_t ",
            "x_35108;\n        int64_t x_35113;\n        \n        x_35113 = prefix_35070;\n        \n        int64_t x_35115;\n        \n        x_35115 = acc_35058;\n        \n        bool defunc_1_op_res_35116;\n        \n        defunc_1_op_res_35116 = x_35112 || x_35114;\n        \n        int64_t defunc_1_op_res_35117;\n        \n        if (x_35114) {\n            defunc_1_op_res_35117 = x_35115;\n        } else {\n            int64_t defunc_1_op_res_35118 = add64(x_35113, x_35115);\n            \n            defunc_1_op_res_35117 = defunc_1_op_res_35118;\n        }\n        x_35105 = defunc_1_op_res_35116;\n        x_35106 = defunc_1_op_res_35117;\n        for (int64_t i_35119 = 0; i_35119 < (int64_t) 9; i_35119++) {\n            x_35107 = private_mem_35036[i_35119];\n            x_35108 = private_mem_35038[i_35119];\n            \n            bool defunc_1_op_res_35109;\n            \n            defunc_1_op_res_35109 = x_35105 || x_35107;\n            \n            int64_t defunc_1_op_res_35110;\n            \n            if (x_35107) {\n                defunc_1_op_res_35110 = x_35108;\n            } else {\n                int64_t defunc_1_op_res_35111 = add64(x_35106, x_35108);\n                \n                defunc_1_op_res_35110 = defunc_1_op_res_35111;\n            }\n            private_mem_35036[i_35119] = defunc_1_op_res_35109;\n            private_mem_35038[i_35119] = defunc_1_op_res_35110;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35120 = 0; i_35120 < (int64_t) 9; i_35120++) {\n            int64_t sharedIdx_35121 = sext_i32_i64(local_tid_35013 * 9) +\n                    i_35120;\n            \n            ((__local bool *) local_mem_35023)[sharedIdx_35121] =\n                private_mem_35036[i_35120];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35122 = 0; i_35122 < (int64_t) 9; i_35122++) {\n            int32_t sharedIdx_35123 = local_tid_35013 +\n                    sext_i64_i32(segscan_group_sizze_31061 *",
            " i_35122);\n            \n            private_mem_35036[i_35122] = ((__local\n                                           bool *) local_mem_35023)[sext_i32_i64(sharedIdx_35123)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35124 = 0; i_35124 < (int64_t) 9; i_35124++) {\n            int64_t sharedIdx_35125 = sext_i32_i64(local_tid_35013 * 9) +\n                    i_35124;\n            \n            ((__local int64_t *) local_mem_35023)[sharedIdx_35125] =\n                private_mem_35038[i_35124];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35126 = 0; i_35126 < (int64_t) 9; i_35126++) {\n            int32_t sharedIdx_35127 = local_tid_35013 +\n                    sext_i64_i32(segscan_group_sizze_31061 * i_35126);\n            \n            private_mem_35038[i_35126] = ((__local\n                                           int64_t *) local_mem_35023)[sext_i32_i64(sharedIdx_35127)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_35128 = 0; i_35128 < (int64_t) 9; i_35128++) {\n            int64_t gtid_31065 = blockOff_35035 + segscan_group_sizze_31061 *\n                    i_35128 + sext_i32_i64(local_tid_35013);\n            \n            if (slt64(gtid_31065, defunc_2_reduce_res_29634)) {\n                ((__global bool *) mem_32301)[gtid_31065] =\n                    private_mem_35036[i_35128];\n            }\n        }\n        for (int64_t i_35129 = 0; i_35129 < (int64_t) 9; i_35129++) {\n            int64_t gtid_31065 = blockOff_35035 + segscan_group_sizze_31061 *\n                    i_35129 + sext_i32_i64(local_tid_35013);\n            \n            if (slt64(gtid_31065, defunc_2_reduce_res_29634)) {\n                ((__global int64_t *) mem_32303)[gtid_31065] =\n                    private_mem_35038[i_35129];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_35034 == sdiv_up64(defunc_2_r",
            "educe_res_29634,\n                                          segscan_group_sizze_31061 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_35000)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31061\n}\n__kernel void test_clusterWithzisegscan_31092(__global int *global_failure,\n                                              uint local_mem_35155_backing_offset_0,\n                                              int64_t partition_sizze_29591,\n                                              __global unsigned char *mem_32292,\n                                              __global unsigned char *mem_32309,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_35138,\n                                              __global\n                                              unsigned char *status_flags_mem_35140,\n                                              __global\n                                              unsigned char *aggregates_mem_35142,\n                                              __global\n                                              unsigned char *incprefixes_mem_35144)\n{\n    #define segscan_group_sizze_31087 (test_clusterWithzisegscan_group_sizze_31086)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_35155_backing_0 =\n                  &shared_mem[local_mem_35155_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_35146;\n    int32_t local_tid_35147;\n    int64_t group_sizze_35150;\n    int32_t wave_sizze_35149;\n    int32_t group_tid_35148;\n    \n    global_tid_35146 = get_global_id(0);\n    local_tid_35147 = get_local_id(0);\n    group_sizze_35150 = get_local_size(0);\n    wave_sizze_35149 = LOCKSTEP_WIDTH",
            ";\n    group_tid_35148 = get_group_id(0);\n    \n    int32_t phys_tid_31092;\n    \n    phys_tid_31092 = global_tid_35146;\n    \n    int64_t byte_offsets_35151;\n    \n    byte_offsets_35151 = (int64_t) 0;\n    \n    int64_t byte_offsets_35152;\n    \n    byte_offsets_35152 = segscan_group_sizze_31087 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_35153;\n    \n    warp_byte_offset_35153 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_35154;\n    \n    warp_byte_offset_35154 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_35155;\n    \n    local_mem_35155 = (__local char *) local_mem_35155_backing_0;\n    \n    int64_t trans_arr_len_35156;\n    \n    trans_arr_len_35156 = (int64_t) 9 * segscan_group_sizze_31087;\n    \n    int32_t dynamic_id_35163;\n    \n    if (local_tid_35147 == 0) {\n        dynamic_id_35163 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_35138)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_35155)[(int64_t) 0] = dynamic_id_35163;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_35163 = ((__local int32_t *) local_mem_35155)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_35164;\n    \n    blockOff_35164 = sext_i32_i64(dynamic_id_35163) * (int64_t) 9 *\n        segscan_group_sizze_31087;\n    \n    int64_t private_mem_35165[9];\n    \n    // Load and map\n    {\n        for (int64_t i_35167 = 0; i_35167 < (int64_t) 9; i_35167++) {\n            int64_t gtid_31091 = blockOff_35164 +\n                    sext_i32_i64(local_tid_35147) + i_35167 *\n                    segscan_group_sizze_31087;\n            \n            if (slt64(gtid_31091, partition_sizze_29591)) {\n                int64_t x_29676 = ((__global int64_t *) mem_32292)[gtid_31091];\n                \n                private_mem_35165[i_35167] = x_29676;\n            } else {\n                priva",
            "te_mem_35165[i_35167] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35168 = 0; i_35168 < (int64_t) 9; i_35168++) {\n            int64_t sharedIdx_35169 = sext_i32_i64(local_tid_35147) + i_35168 *\n                    segscan_group_sizze_31087;\n            \n            ((__local int64_t *) local_mem_35155)[sharedIdx_35169] =\n                private_mem_35165[i_35168];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_35170 = 0; i_35170 < 9; i_35170++) {\n            int32_t sharedIdx_35171 = local_tid_35147 * 9 + i_35170;\n            \n            private_mem_35165[sext_i32_i64(i_35170)] = ((__local\n                                                         int64_t *) local_mem_35155)[sext_i32_i64(sharedIdx_35171)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_35172 = 0; i_35172 < (int64_t) 8; i_35172++) {\n            int64_t x_29673;\n            int64_t x_29674;\n            \n            x_29673 = private_mem_35165[i_35172];\n            x_29674 = private_mem_35165[i_35172 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_29675;\n            \n            defunc_1_op_res_29675 = add64(x_29673, x_29674);\n            private_mem_35165[i_35172 + (int64_t) 1] = defunc_1_op_res_29675;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35147)] =\n            private_mem_35165[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_35176;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_35173;\n        int64_t x_35174;\n        int64_t x_35177;\n        int64_t x_35178;\n        bool ltid_in_bounds_35180;\n        \n        ltid_in_bounds_3518",
            "0 = slt64(sext_i32_i64(local_tid_35147),\n                                     segscan_group_sizze_31087);\n        \n        int32_t skip_threads_35181;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_35180) {\n                x_35174 = ((volatile __local\n                            int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_35147)];\n                if ((local_tid_35147 - squot32(local_tid_35147, 32) * 32) ==\n                    0) {\n                    x_35173 = x_35174;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_35181 = 1;\n            while (slt32(skip_threads_35181, 32)) {\n                if (sle32(skip_threads_35181, local_tid_35147 -\n                          squot32(local_tid_35147, 32) * 32) &&\n                    ltid_in_bounds_35180) {\n                    // read operands\n                    {\n                        x_35173 = ((volatile __local\n                                    int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_35147) -\n                                                                 sext_i32_i64(skip_threads_35181))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_35175 = add64(x_35173, x_35174);\n                        \n                        x_35173 = defunc_1_op_res_35175;\n                    }\n                }\n                if (sle32(wave_sizze_35149, skip_threads_35181)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_th",
            "reads_35181, local_tid_35147 -\n                          squot32(local_tid_35147, 32) * 32) &&\n                    ltid_in_bounds_35180) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_35147)] =\n                            x_35173;\n                        x_35174 = x_35173;\n                    }\n                }\n                if (sle32(wave_sizze_35149, skip_threads_35181)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_35181 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_35147 - squot32(local_tid_35147, 32) * 32) == 31 &&\n                ltid_in_bounds_35180) {\n                ((volatile __local\n                  int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_35147,\n                                                                   32))] =\n                    x_35173;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_35182;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_35147, 32) == 0 && ltid_in_bounds_35180) {\n                    x_35178 = ((volatile __local\n                                int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                    (int64_t) 8) +\n                   ",
            "                                         sext_i32_i64(local_tid_35147)];\n                    if ((local_tid_35147 - squot32(local_tid_35147, 32) * 32) ==\n                        0) {\n                        x_35177 = x_35178;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_35182 = 1;\n                while (slt32(skip_threads_35182, 32)) {\n                    if (sle32(skip_threads_35182, local_tid_35147 -\n                              squot32(local_tid_35147, 32) * 32) &&\n                        (squot32(local_tid_35147, 32) == 0 &&\n                         ltid_in_bounds_35180)) {\n                        // read operands\n                        {\n                            x_35177 = ((volatile __local\n                                        int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_35147) -\n                                                                     sext_i32_i64(skip_threads_35182))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_35179 = add64(x_35177,\n                                                                  x_35178);\n                            \n                            x_35177 = defunc_1_op_res_35179;\n                        }\n                    }\n                    if (sle32(wave_sizze_35149, skip_threads_35182)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_35182, local_tid_35147 -\n                              squot32(local_tid_35147, 32) * 32) &&\n                        (squot32(local_tid_35147, 32) == 0 &&\n                         ltid_in_bounds_35180)) {\n    ",
            "                    // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_35147)] =\n                                x_35177;\n                            x_35178 = x_35177;\n                        }\n                    }\n                    if (sle32(wave_sizze_35149, skip_threads_35182)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_35182 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_35147, 32) == 0 || !ltid_in_bounds_35180)) {\n                // read operands\n                {\n                    x_35174 = x_35173;\n                    x_35173 = ((__local\n                                int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_35147,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_35175 = add64(x_35173, x_35174);\n                    \n                    x_35173 = defunc_1_op_res_35175;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                          (int64_t) 8) +\n                                     ",
            "             sext_i32_i64(local_tid_35147)] =\n                        x_35173;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_35147, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35147)] =\n                    x_35174;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_35147 == 0) {\n            acc_35176 = ((__local\n                          int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31087 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_35176 = ((__local\n                          int64_t *) local_mem_35155)[squot64(byte_offsets_35151,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_35147) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_35183;\n    \n    prefix_35183 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_35163 == (int64_t) 0 && local_tid_35147 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_35144)[dynamic_id_35163] = acc_35176;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_35140)[dynamic_id_35163] = (int8_t) 2;\n            acc_35176 = (int64_t) 0;\n        }\n        if (!(dynamic_id_35163 == (int64_t) 0) && slt32(local_tid_35147,\n    ",
            "                                                    wave_sizze_35149)) {\n            if (local_tid_35147 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_35142)[dynamic_id_35163] =\n                    acc_35176;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35140)[dynamic_id_35163] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_35155)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_35140)[dynamic_id_35163 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_35184;\n            \n            status_35184 = ((__local int8_t *) local_mem_35155)[(int64_t) 0];\n            if (status_35184 == (int8_t) 2) {\n                if (local_tid_35147 == 0) {\n                    prefix_35183 = ((volatile __global\n                                     int64_t *) incprefixes_mem_35144)[dynamic_id_35163 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_35185 = dynamic_id_35163 -\n                        sext_i32_i64(wave_sizze_35149);\n                \n                while (slt32(wave_sizze_35149 * -1, readOffset_35185)) {\n                    int32_t read_i_35186 = readOffset_35185 + local_tid_35147;\n                    int64_t aggr_35187 = (int64_t) 0;\n                    int8_t flag_35188 = (int8_t) 0;\n                    int8_t used_35189 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_35186)) {\n                        flag_35188 = ((volatile __global\n                                       int8_t *) status_flags_mem_35140)[sext_i32_i64(read_i_35186)];\n                        if (flag_3518",
            "8 == (int8_t) 2) {\n                            aggr_35187 = ((volatile __global\n                                           int64_t *) incprefixes_mem_35144)[sext_i32_i64(read_i_35186)];\n                        } else {\n                            if (flag_35188 == (int8_t) 1) {\n                                aggr_35187 = ((volatile __global\n                                               int64_t *) aggregates_mem_35142)[sext_i32_i64(read_i_35186)];\n                                used_35189 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_35155)[squot64(warp_byte_offset_35153,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_35147)] =\n                        aggr_35187;\n                    \n                    int8_t tmp_35190;\n                    \n                    tmp_35190 = flag_35188 | used_35189 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_35155)[sext_i32_i64(local_tid_35147)] =\n                        tmp_35190;\n                    mem_fence_local();\n                    flag_35188 = ((volatile __local\n                                   int8_t *) local_mem_35155)[sext_i32_i64(wave_sizze_35149) -\n                                                              (int64_t) 1];\n                    if (local_tid_35147 == 0) {\n                        if (!(flag_35188 == (int8_t) 2)) {\n                            int64_t x_35191 = (int64_t) 0;\n                            int64_t x_35192;\n                            int8_t flag1_35194;\n                            \n                            flag1_35194 = (int8_t) 0;\n                            \n                            int8_t flag2_35195;\n                            int8_t used1_35196;\n                            \n                            used1_35196 = (int8_t) 0",
            ";\n                            \n                            int8_t used2_35197;\n                            \n                            for (int32_t i_35198 = 0; i_35198 <\n                                 wave_sizze_35149; i_35198++) {\n                                flag2_35195 = ((__local\n                                                int8_t *) local_mem_35155)[sext_i32_i64(i_35198)];\n                                used2_35197 = lshr8(flag2_35195, (int8_t) 2);\n                                flag2_35195 = flag2_35195 & (int8_t) 3;\n                                x_35192 = ((__local\n                                            int64_t *) local_mem_35155)[squot64(warp_byte_offset_35153,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_35198)];\n                                if (!(flag2_35195 == (int8_t) 1)) {\n                                    flag1_35194 = flag2_35195;\n                                    used1_35196 = used2_35197;\n                                    x_35191 = x_35192;\n                                } else {\n                                    used1_35196 += used2_35197;\n                                    \n                                    int64_t defunc_1_op_res_35193;\n                                    \n                                    defunc_1_op_res_35193 = add64(x_35191,\n                                                                  x_35192);\n                                    x_35191 = defunc_1_op_res_35193;\n                                }\n                            }\n                            flag_35188 = flag1_35194;\n                            used_35189 = used1_35196;\n                            aggr_35187 = x_35191;\n                        } else {\n                            aggr_35187 = ((__local\n                                           int64_t *) local_mem_35155)[squot64(warp_byte_of",
            "fset_35153,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_35149) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_35188 == (int8_t) 2) {\n                            readOffset_35185 = wave_sizze_35149 * -1;\n                        } else {\n                            readOffset_35185 -= zext_i8_i32(used_35189);\n                        }\n                        ((__local int32_t *) local_mem_35155)[(int64_t) 0] =\n                            readOffset_35185;\n                        \n                        int64_t x_35199;\n                        \n                        x_35199 = aggr_35187;\n                        \n                        int64_t x_35200;\n                        \n                        x_35200 = prefix_35183;\n                        \n                        int64_t defunc_1_op_res_35201;\n                        \n                        defunc_1_op_res_35201 = add64(x_35199, x_35200);\n                        prefix_35183 = defunc_1_op_res_35201;\n                    }\n                    mem_fence_local();\n                    readOffset_35185 = ((__local\n                                         int32_t *) local_mem_35155)[(int64_t) 0];\n                }\n            }\n            if (local_tid_35147 == 0) {\n                int64_t x_35202 = prefix_35183;\n                int64_t x_35203 = acc_35176;\n                int64_t defunc_1_op_res_35204 = add64(x_35202, x_35203);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_35144)[dynamic_id_35163] =\n                    defunc_1_op_res_35204;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35140)[dynamic_id_35163] =\n                    (int8_t) 2;\n    ",
            "            ((__local\n                  int64_t *) local_mem_35155)[squot64(warp_byte_offset_35153,\n                                                      (int64_t) 8)] =\n                    prefix_35183;\n                acc_35176 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_35163 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_35183 = ((__local\n                             int64_t *) local_mem_35155)[squot64(warp_byte_offset_35153,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_35205;\n        int64_t x_35206;\n        int64_t x_35208;\n        \n        x_35208 = prefix_35183;\n        \n        int64_t x_35209;\n        \n        x_35209 = acc_35176;\n        \n        int64_t defunc_1_op_res_35210;\n        \n        defunc_1_op_res_35210 = add64(x_35208, x_35209);\n        x_35205 = defunc_1_op_res_35210;\n        for (int64_t i_35211 = 0; i_35211 < (int64_t) 9; i_35211++) {\n            x_35206 = private_mem_35165[i_35211];\n            \n            int64_t defunc_1_op_res_35207;\n            \n            defunc_1_op_res_35207 = add64(x_35205, x_35206);\n            private_mem_35165[i_35211] = defunc_1_op_res_35207;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35212 = 0; i_35212 < (int64_t) 9; i_35212++) {\n            int64_t sharedIdx_35213 = sext_i32_i64(local_tid_35147 * 9) +\n                    i_35212;\n            \n            ((__local int64_t *) local_mem_35155)[sharedIdx_35213] =\n                private_mem_35165[i_35212];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35214 = 0; i_35214 < (int64_t) 9; i_35214++) {\n            int32_t sharedIdx_35215 = local_tid_35147 +\n                    sext_i64_i32(segscan_group_sizze_31087 * i_35214);\n            \n            private_mem_35165[i_35214] =",
            " ((__local\n                                           int64_t *) local_mem_35155)[sext_i32_i64(sharedIdx_35215)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_35216 = 0; i_35216 < (int64_t) 9; i_35216++) {\n            int64_t gtid_31091 = blockOff_35164 + segscan_group_sizze_31087 *\n                    i_35216 + sext_i32_i64(local_tid_35147);\n            \n            if (slt64(gtid_31091, partition_sizze_29591)) {\n                ((__global int64_t *) mem_32309)[gtid_31091] =\n                    private_mem_35165[i_35216];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_35163 == sdiv_up64(partition_sizze_29591,\n                                          segscan_group_sizze_31087 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_35138)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31087\n}\n__kernel void test_clusterWithzisegscan_31100(__global int *global_failure,\n                                              uint local_mem_35248_backing_offset_0,\n                                              int64_t defunc_2_reduce_res_29634,\n                                              __global unsigned char *mem_32306,\n                                              __global unsigned char *mem_32314,\n                                              __global unsigned char *mem_32316,\n                                              __global\n                                              unsigned char *test_clusterWithziid_counter_mem_35225,\n                                              __global\n                                              unsigned char *status_flags_mem_35227,\n                                              __global\n                                              ",
            "unsigned char *aggregates_mem_35229,\n                                              __global\n                                              unsigned char *incprefixes_mem_35231,\n                                              __global\n                                              unsigned char *aggregates_mem_35233,\n                                              __global\n                                              unsigned char *incprefixes_mem_35235)\n{\n    #define segscan_group_sizze_31095 (test_clusterWithzisegscan_group_sizze_31094)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_35248_backing_0 =\n                  &shared_mem[local_mem_35248_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_35237;\n    int32_t local_tid_35238;\n    int64_t group_sizze_35241;\n    int32_t wave_sizze_35240;\n    int32_t group_tid_35239;\n    \n    global_tid_35237 = get_global_id(0);\n    local_tid_35238 = get_local_id(0);\n    group_sizze_35241 = get_local_size(0);\n    wave_sizze_35240 = LOCKSTEP_WIDTH;\n    group_tid_35239 = get_group_id(0);\n    \n    int32_t phys_tid_31100;\n    \n    phys_tid_31100 = global_tid_35237;\n    \n    int64_t byte_offsets_35242;\n    \n    byte_offsets_35242 = (int64_t) 0;\n    \n    int64_t byte_offsets_35243;\n    \n    byte_offsets_35243 = segscan_group_sizze_31095;\n    \n    int64_t byte_offsets_35244;\n    \n    byte_offsets_35244 = sdiv_up64(segscan_group_sizze_31095, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_31095 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_35245;\n    \n    warp_byte_offset_35245 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_35246;\n    \n    warp_byte_offset_35246 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_35247;\n    \n    warp_byte_offset_35247 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_35248;\n    \n    local_mem_35248 = (__local char *) local_mem_35",
            "248_backing_0;\n    \n    int64_t trans_arr_len_35249;\n    \n    trans_arr_len_35249 = (int64_t) 9 * segscan_group_sizze_31095;\n    \n    int32_t dynamic_id_35259;\n    \n    if (local_tid_35238 == 0) {\n        dynamic_id_35259 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_clusterWithziid_counter_mem_35225)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_35248)[(int64_t) 0] = dynamic_id_35259;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_35259 = ((__local int32_t *) local_mem_35248)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_35260;\n    \n    blockOff_35260 = sext_i32_i64(dynamic_id_35259) * (int64_t) 9 *\n        segscan_group_sizze_31095;\n    \n    bool private_mem_35261[9];\n    int64_t private_mem_35263[9];\n    \n    // Load and map\n    {\n        for (int64_t i_35265 = 0; i_35265 < (int64_t) 9; i_35265++) {\n            int64_t gtid_31099 = blockOff_35260 +\n                    sext_i32_i64(local_tid_35238) + i_35265 *\n                    segscan_group_sizze_31095;\n            \n            if (slt64(gtid_31099, defunc_2_reduce_res_29634)) {\n                bool x_29700 = ((__global bool *) mem_32306)[gtid_31099];\n                \n                private_mem_35261[i_35265] = x_29700;\n                private_mem_35263[i_35265] = (int64_t) 1;\n            } else {\n                private_mem_35261[i_35265] = 0;\n                private_mem_35263[i_35265] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35266 = 0; i_35266 < (int64_t) 9; i_35266++) {\n            int64_t sharedIdx_35267 = sext_i32_i64(local_tid_35238) + i_35266 *\n                    segscan_group_sizze_31095;\n            \n            ((__local bool *) local_mem_35248)[sharedIdx_35267] =\n                private_mem_35261[i_35266];\n        }\n        barrier(CLK_LO",
            "CAL_MEM_FENCE);\n        for (int32_t i_35268 = 0; i_35268 < 9; i_35268++) {\n            int32_t sharedIdx_35269 = local_tid_35238 * 9 + i_35268;\n            \n            private_mem_35261[sext_i32_i64(i_35268)] = ((__local\n                                                         bool *) local_mem_35248)[sext_i32_i64(sharedIdx_35269)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35270 = 0; i_35270 < (int64_t) 9; i_35270++) {\n            int64_t sharedIdx_35271 = sext_i32_i64(local_tid_35238) + i_35270 *\n                    segscan_group_sizze_31095;\n            \n            ((__local int64_t *) local_mem_35248)[sharedIdx_35271] =\n                private_mem_35263[i_35270];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_35272 = 0; i_35272 < 9; i_35272++) {\n            int32_t sharedIdx_35273 = local_tid_35238 * 9 + i_35272;\n            \n            private_mem_35263[sext_i32_i64(i_35272)] = ((__local\n                                                         int64_t *) local_mem_35248)[sext_i32_i64(sharedIdx_35273)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_35274 = 0; i_35274 < (int64_t) 8; i_35274++) {\n            bool x_29693;\n            bool x_29695;\n            \n            x_29693 = private_mem_35261[i_35274];\n            x_29695 = private_mem_35261[i_35274 + (int64_t) 1];\n            \n            int64_t x_29694;\n            int64_t x_29696;\n            \n            x_29694 = private_mem_35263[i_35274];\n            x_29696 = private_mem_35263[i_35274 + (int64_t) 1];\n            \n            bool defunc_1_op_res_29697;\n            \n            defunc_1_op_res_29697 = x_29693 || x_29695;\n            \n            int64_t defunc_1_op_res_29698;\n            \n            if (x_29695) {\n                defunc_1_op_res_29698 = x_29696;\n            } else {\n                int64_t defunc_1_op_res_29699 = add64(x_29694, x_29696);\n                \n            ",
            "    defunc_1_op_res_29698 = defunc_1_op_res_29699;\n            }\n            private_mem_35261[i_35274 + (int64_t) 1] = defunc_1_op_res_29697;\n            private_mem_35263[i_35274 + (int64_t) 1] = defunc_1_op_res_29698;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_35248)[byte_offsets_35242 +\n                                           sext_i32_i64(local_tid_35238)] =\n            private_mem_35261[(int64_t) 8];\n        ((__local int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35238)] =\n            private_mem_35263[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_35282;\n    int64_t acc_35283;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_35275;\n        int64_t x_35276;\n        bool x_35277;\n        int64_t x_35278;\n        bool x_35284;\n        int64_t x_35285;\n        bool x_35286;\n        int64_t x_35287;\n        bool ltid_in_bounds_35291;\n        \n        ltid_in_bounds_35291 = slt64(sext_i32_i64(local_tid_35238),\n                                     segscan_group_sizze_31095);\n        \n        int32_t skip_threads_35292;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_35291) {\n                x_35277 = ((volatile __local\n                            bool *) local_mem_35248)[byte_offsets_35242 +\n                                                     sext_i32_i64(local_tid_35238)];\n                x_35278 = ((volatile __local\n                            int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_35238)];\n                if ((local_tid_35238 - squot32(local_tid_35238, 32) * 32) ==\n                    0) {\n                ",
            "    x_35275 = x_35277;\n                    x_35276 = x_35278;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_35292 = 1;\n            while (slt32(skip_threads_35292, 32)) {\n                if (sle32(skip_threads_35292, local_tid_35238 -\n                          squot32(local_tid_35238, 32) * 32) &&\n                    ltid_in_bounds_35291) {\n                    // read operands\n                    {\n                        x_35275 = ((volatile __local\n                                    bool *) local_mem_35248)[byte_offsets_35242 +\n                                                             (sext_i32_i64(local_tid_35238) -\n                                                              sext_i32_i64(skip_threads_35292))];\n                        x_35276 = ((volatile __local\n                                    int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_35238) -\n                                                                 sext_i32_i64(skip_threads_35292))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_35279 = x_35275 || x_35277;\n                        int64_t defunc_1_op_res_35280;\n                        \n                        if (x_35277) {\n                            defunc_1_op_res_35280 = x_35278;\n                        } else {\n                            int64_t defunc_1_op_res_35281 = add64(x_35276,\n                                                                  x_35278);\n                            \n                            defunc_1_op_res_35280 = defunc_1_op_res_35281;\n                        }\n                        x_35275 = defunc_1_op_res_35279;\n                        x_35276 = defunc_1_op",
            "_res_35280;\n                    }\n                }\n                if (sle32(wave_sizze_35240, skip_threads_35292)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_35292, local_tid_35238 -\n                          squot32(local_tid_35238, 32) * 32) &&\n                    ltid_in_bounds_35291) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_35248)[byte_offsets_35242 +\n                                                   sext_i32_i64(local_tid_35238)] =\n                            x_35275;\n                        x_35277 = x_35275;\n                        ((volatile __local\n                          int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_35238)] =\n                            x_35276;\n                        x_35278 = x_35276;\n                    }\n                }\n                if (sle32(wave_sizze_35240, skip_threads_35292)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_35292 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_35238 - squot32(local_tid_35238, 32) * 32) == 31 &&\n                ltid_in_bounds_35291) {\n                ((volatile __local bool *) local_mem_35248)[byte_offsets_35242 +\n                                                            sext_i32_i64(squot32(local_tid_35238,\n                                                                                 32))] =\n                    x_35275;\n                ((volatile __local\n                  int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                      ",
            "(int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_35238,\n                                                                   32))] =\n                    x_35276;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_35293;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_35238, 32) == 0 && ltid_in_bounds_35291) {\n                    x_35286 = ((volatile __local\n                                bool *) local_mem_35248)[byte_offsets_35242 +\n                                                         sext_i32_i64(local_tid_35238)];\n                    x_35287 = ((volatile __local\n                                int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_35238)];\n                    if ((local_tid_35238 - squot32(local_tid_35238, 32) * 32) ==\n                        0) {\n                        x_35284 = x_35286;\n                        x_35285 = x_35287;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_35293 = 1;\n                while (slt32(skip_threads_35293, 32)) {\n                    if (sle32(skip_threads_35293, local_tid_35238 -\n                              squot32(local_tid_35238, 32) * 32) &&\n                        (squot32(local_tid_35238, 32) == 0 &&\n                         ltid_in_bounds_35291)) {\n                        // read operands\n                        {\n                            x_35284 = ((volatile __local\n                                        bool *) local_mem_35248)[byte_offsets_35242 +\n                                     ",
            "                            (sext_i32_i64(local_tid_35238) -\n                                                                  sext_i32_i64(skip_threads_35293))];\n                            x_35285 = ((volatile __local\n                                        int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_35238) -\n                                                                     sext_i32_i64(skip_threads_35293))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_35288 = x_35284 || x_35286;\n                            int64_t defunc_1_op_res_35289;\n                            \n                            if (x_35286) {\n                                defunc_1_op_res_35289 = x_35287;\n                            } else {\n                                int64_t defunc_1_op_res_35290 = add64(x_35285,\n                                                                      x_35287);\n                                \n                                defunc_1_op_res_35289 = defunc_1_op_res_35290;\n                            }\n                            x_35284 = defunc_1_op_res_35288;\n                            x_35285 = defunc_1_op_res_35289;\n                        }\n                    }\n                    if (sle32(wave_sizze_35240, skip_threads_35293)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_35293, local_tid_35238 -\n                              squot32(local_tid_35238, 32) * 32) &&\n                        (squot32(local_tid_35238, 32) == 0 &&\n                         ltid_in_bounds_35291)) {\n                        // write result\n                        {\n                            ((volatile __local\n ",
            "                             bool *) local_mem_35248)[byte_offsets_35242 +\n                                                       sext_i32_i64(local_tid_35238)] =\n                                x_35284;\n                            x_35286 = x_35284;\n                            ((volatile __local\n                              int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_35238)] =\n                                x_35285;\n                            x_35287 = x_35285;\n                        }\n                    }\n                    if (sle32(wave_sizze_35240, skip_threads_35293)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_35293 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_35238, 32) == 0 || !ltid_in_bounds_35291)) {\n                // read operands\n                {\n                    x_35277 = x_35275;\n                    x_35278 = x_35276;\n                    x_35275 = ((__local\n                                bool *) local_mem_35248)[byte_offsets_35242 +\n                                                         (sext_i32_i64(squot32(local_tid_35238,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_35276 = ((__local\n                                int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_35238,\n                                                                                ",
            "  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_35279 = x_35275 || x_35277;\n                    int64_t defunc_1_op_res_35280;\n                    \n                    if (x_35277) {\n                        defunc_1_op_res_35280 = x_35278;\n                    } else {\n                        int64_t defunc_1_op_res_35281 = add64(x_35276, x_35278);\n                        \n                        defunc_1_op_res_35280 = defunc_1_op_res_35281;\n                    }\n                    x_35275 = defunc_1_op_res_35279;\n                    x_35276 = defunc_1_op_res_35280;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_35248)[byte_offsets_35242 +\n                                                       sext_i32_i64(local_tid_35238)] =\n                        x_35275;\n                    ((__local\n                      int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_35238)] =\n                        x_35276;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_35238, 32) == 0) {\n                ((__local bool *) local_mem_35248)[byte_offsets_35242 +\n                                                   sext_i32_i64(local_tid_35238)] =\n                    x_35277;\n                ((__local\n                  int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_35238)] =\n                    x_35278;\n            }\n        }\n        barrier(CLK_LOCAL_ME",
            "M_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_35238 == 0) {\n            acc_35282 = ((__local bool *) local_mem_35248)[byte_offsets_35242 +\n                                                           (segscan_group_sizze_31095 -\n                                                            (int64_t) 1)];\n            acc_35283 = ((__local\n                          int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_31095 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_35282 = ((__local bool *) local_mem_35248)[byte_offsets_35242 +\n                                                           (sext_i32_i64(local_tid_35238) -\n                                                            (int64_t) 1)];\n            acc_35283 = ((__local\n                          int64_t *) local_mem_35248)[squot64(byte_offsets_35243,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_35238) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_35294;\n    \n    prefix_35294 = 0;\n    \n    int64_t prefix_35295;\n    \n    prefix_35295 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_35259 == (int64_t) 0 && local_tid_35238 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_35231)[dynamic_id_35259] = acc_35282;\n            ((volatile __global\n              int64_t *) incprefixes_mem_35235)[dynamic_id_35259] = acc_35283;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_35227)[dynamic_id_35259] = (int8_t) 2;\n            acc_35282 = 0;\n            acc_35283 = (int64_t) 0;\n        ",
            "}\n        if (!(dynamic_id_35259 == (int64_t) 0) && slt32(local_tid_35238,\n                                                        wave_sizze_35240)) {\n            if (local_tid_35238 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_35229)[dynamic_id_35259] = acc_35282;\n                ((volatile __global\n                  int64_t *) aggregates_mem_35233)[dynamic_id_35259] =\n                    acc_35283;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35227)[dynamic_id_35259] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_35248)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_35227)[dynamic_id_35259 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_35296;\n            \n            status_35296 = ((__local int8_t *) local_mem_35248)[(int64_t) 0];\n            if (status_35296 == (int8_t) 2) {\n                if (local_tid_35238 == 0) {\n                    prefix_35294 = ((volatile __global\n                                     bool *) incprefixes_mem_35231)[dynamic_id_35259 -\n                                                                    (int64_t) 1];\n                    prefix_35295 = ((volatile __global\n                                     int64_t *) incprefixes_mem_35235)[dynamic_id_35259 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_35297 = dynamic_id_35259 -\n                        sext_i32_i64(wave_sizze_35240);\n                \n                while (slt32(wave_sizze_35240 * -1, readOffset_35297)) {\n                    int32_t read_i_35298 = readOffset_35297 + local_tid_35238;\n       ",
            "             bool aggr_35299 = 0;\n                    int64_t aggr_35300 = (int64_t) 0;\n                    int8_t flag_35301 = (int8_t) 0;\n                    int8_t used_35302 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_35298)) {\n                        flag_35301 = ((volatile __global\n                                       int8_t *) status_flags_mem_35227)[sext_i32_i64(read_i_35298)];\n                        if (flag_35301 == (int8_t) 2) {\n                            aggr_35299 = ((volatile __global\n                                           bool *) incprefixes_mem_35231)[sext_i32_i64(read_i_35298)];\n                            aggr_35300 = ((volatile __global\n                                           int64_t *) incprefixes_mem_35235)[sext_i32_i64(read_i_35298)];\n                        } else {\n                            if (flag_35301 == (int8_t) 1) {\n                                aggr_35299 = ((volatile __global\n                                               bool *) aggregates_mem_35229)[sext_i32_i64(read_i_35298)];\n                                aggr_35300 = ((volatile __global\n                                               int64_t *) aggregates_mem_35233)[sext_i32_i64(read_i_35298)];\n                                used_35302 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_35248)[warp_byte_offset_35245 +\n                                                       sext_i32_i64(local_tid_35238)] =\n                        aggr_35299;\n                    ((__local\n                      int64_t *) local_mem_35248)[squot64(warp_byte_offset_35246,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_35238)] =\n                        aggr_35300;\n                    \n                    int8_t tmp_35303;\n                    \n                    tmp_35303 ",
            "= flag_35301 | used_35302 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_35248)[sext_i32_i64(local_tid_35238)] =\n                        tmp_35303;\n                    mem_fence_local();\n                    flag_35301 = ((volatile __local\n                                   int8_t *) local_mem_35248)[sext_i32_i64(wave_sizze_35240) -\n                                                              (int64_t) 1];\n                    if (local_tid_35238 == 0) {\n                        if (!(flag_35301 == (int8_t) 2)) {\n                            bool x_35304 = 0;\n                            int64_t x_35305 = (int64_t) 0;\n                            bool x_35306;\n                            int64_t x_35307;\n                            int8_t flag1_35311;\n                            \n                            flag1_35311 = (int8_t) 0;\n                            \n                            int8_t flag2_35312;\n                            int8_t used1_35313;\n                            \n                            used1_35313 = (int8_t) 0;\n                            \n                            int8_t used2_35314;\n                            \n                            for (int32_t i_35315 = 0; i_35315 <\n                                 wave_sizze_35240; i_35315++) {\n                                flag2_35312 = ((__local\n                                                int8_t *) local_mem_35248)[sext_i32_i64(i_35315)];\n                                used2_35314 = lshr8(flag2_35312, (int8_t) 2);\n                                flag2_35312 = flag2_35312 & (int8_t) 3;\n                                x_35306 = ((__local\n                                            bool *) local_mem_35248)[warp_byte_offset_35245 +\n                                                                     sext_i32_i64(i_35315)];\n                                x_35307 = ((__local\n                                            int64_t *) local_mem_35248)[squot64(wa",
            "rp_byte_offset_35246,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_35315)];\n                                if (!(flag2_35312 == (int8_t) 1)) {\n                                    flag1_35311 = flag2_35312;\n                                    used1_35313 = used2_35314;\n                                    x_35304 = x_35306;\n                                    x_35305 = x_35307;\n                                } else {\n                                    used1_35313 += used2_35314;\n                                    \n                                    bool defunc_1_op_res_35308;\n                                    \n                                    defunc_1_op_res_35308 = x_35304 || x_35306;\n                                    \n                                    int64_t defunc_1_op_res_35309;\n                                    \n                                    if (x_35306) {\n                                        defunc_1_op_res_35309 = x_35307;\n                                    } else {\n                                        int64_t defunc_1_op_res_35310 =\n                                                add64(x_35305, x_35307);\n                                        \n                                        defunc_1_op_res_35309 =\n                                            defunc_1_op_res_35310;\n                                    }\n                                    x_35304 = defunc_1_op_res_35308;\n                                    x_35305 = defunc_1_op_res_35309;\n                                }\n                            }\n                            flag_35301 = flag1_35311;\n                            used_35302 = used1_35313;\n                            aggr_35299 = x_35304;\n                            aggr_35300 = x_35305;\n                        } else {\n                            aggr_35299 = ((__local\n ",
            "                                          bool *) local_mem_35248)[warp_byte_offset_35245 +\n                                                                    (sext_i32_i64(wave_sizze_35240) -\n                                                                     (int64_t) 1)];\n                            aggr_35300 = ((__local\n                                           int64_t *) local_mem_35248)[squot64(warp_byte_offset_35246,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_35240) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_35301 == (int8_t) 2) {\n                            readOffset_35297 = wave_sizze_35240 * -1;\n                        } else {\n                            readOffset_35297 -= zext_i8_i32(used_35302);\n                        }\n                        ((__local int32_t *) local_mem_35248)[(int64_t) 0] =\n                            readOffset_35297;\n                        \n                        bool x_35316;\n                        \n                        x_35316 = aggr_35299;\n                        \n                        int64_t x_35317;\n                        \n                        x_35317 = aggr_35300;\n                        \n                        bool x_35318;\n                        \n                        x_35318 = prefix_35294;\n                        \n                        int64_t x_35319;\n                        \n                        x_35319 = prefix_35295;\n                        \n                        bool defunc_1_op_res_35320;\n                        \n                        defunc_1_op_res_35320 = x_35316 || x_35318;\n                        \n                        int64_t defunc_1_op_res_35321;\n                        \n                        if (x_35318) {\n               ",
            "             defunc_1_op_res_35321 = x_35319;\n                        } else {\n                            int64_t defunc_1_op_res_35322 = add64(x_35317,\n                                                                  x_35319);\n                            \n                            defunc_1_op_res_35321 = defunc_1_op_res_35322;\n                        }\n                        prefix_35294 = defunc_1_op_res_35320;\n                        prefix_35295 = defunc_1_op_res_35321;\n                    }\n                    mem_fence_local();\n                    readOffset_35297 = ((__local\n                                         int32_t *) local_mem_35248)[(int64_t) 0];\n                }\n            }\n            if (local_tid_35238 == 0) {\n                bool x_35323 = prefix_35294;\n                int64_t x_35324 = prefix_35295;\n                bool x_35325 = acc_35282;\n                int64_t x_35326 = acc_35283;\n                bool defunc_1_op_res_35327 = x_35323 || x_35325;\n                int64_t defunc_1_op_res_35328;\n                \n                if (x_35325) {\n                    defunc_1_op_res_35328 = x_35326;\n                } else {\n                    int64_t defunc_1_op_res_35329 = add64(x_35324, x_35326);\n                    \n                    defunc_1_op_res_35328 = defunc_1_op_res_35329;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_35231)[dynamic_id_35259] =\n                    defunc_1_op_res_35327;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_35235)[dynamic_id_35259] =\n                    defunc_1_op_res_35328;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_35227)[dynamic_id_35259] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_35248)[warp_byte_offset_35245] =\n                    prefix_35294;\n                ((__local\n                  int64_t *) local_mem",
            "_35248)[squot64(warp_byte_offset_35246,\n                                                      (int64_t) 8)] =\n                    prefix_35295;\n                acc_35282 = 0;\n                acc_35283 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_35259 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_35294 = ((__local\n                             bool *) local_mem_35248)[warp_byte_offset_35245];\n            prefix_35295 = ((__local\n                             int64_t *) local_mem_35248)[squot64(warp_byte_offset_35246,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_35330;\n        bool x_35332;\n        bool x_35337;\n        \n        x_35337 = prefix_35294;\n        \n        bool x_35339;\n        \n        x_35339 = acc_35282;\n        \n        int64_t x_35331;\n        int64_t x_35333;\n        int64_t x_35338;\n        \n        x_35338 = prefix_35295;\n        \n        int64_t x_35340;\n        \n        x_35340 = acc_35283;\n        \n        bool defunc_1_op_res_35341;\n        \n        defunc_1_op_res_35341 = x_35337 || x_35339;\n        \n        int64_t defunc_1_op_res_35342;\n        \n        if (x_35339) {\n            defunc_1_op_res_35342 = x_35340;\n        } else {\n            int64_t defunc_1_op_res_35343 = add64(x_35338, x_35340);\n            \n            defunc_1_op_res_35342 = defunc_1_op_res_35343;\n        }\n        x_35330 = defunc_1_op_res_35341;\n        x_35331 = defunc_1_op_res_35342;\n        for (int64_t i_35344 = 0; i_35344 < (int64_t) 9; i_35344++) {\n            x_35332 = private_mem_35261[i_35344];\n            x_35333 = private_mem_35263[i_35344];\n            \n            bool defunc_1_op_res_35334;\n            \n            defunc_1_op_res_35334 = x_35330 || x_35332;\n            \n            int64_t defunc_1_op_res_35335;\n            \n            if (x_35332) {\n              ",
            "  defunc_1_op_res_35335 = x_35333;\n            } else {\n                int64_t defunc_1_op_res_35336 = add64(x_35331, x_35333);\n                \n                defunc_1_op_res_35335 = defunc_1_op_res_35336;\n            }\n            private_mem_35261[i_35344] = defunc_1_op_res_35334;\n            private_mem_35263[i_35344] = defunc_1_op_res_35335;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35345 = 0; i_35345 < (int64_t) 9; i_35345++) {\n            int64_t sharedIdx_35346 = sext_i32_i64(local_tid_35238 * 9) +\n                    i_35345;\n            \n            ((__local bool *) local_mem_35248)[sharedIdx_35346] =\n                private_mem_35261[i_35345];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35347 = 0; i_35347 < (int64_t) 9; i_35347++) {\n            int32_t sharedIdx_35348 = local_tid_35238 +\n                    sext_i64_i32(segscan_group_sizze_31095 * i_35347);\n            \n            private_mem_35261[i_35347] = ((__local\n                                           bool *) local_mem_35248)[sext_i32_i64(sharedIdx_35348)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35349 = 0; i_35349 < (int64_t) 9; i_35349++) {\n            int64_t sharedIdx_35350 = sext_i32_i64(local_tid_35238 * 9) +\n                    i_35349;\n            \n            ((__local int64_t *) local_mem_35248)[sharedIdx_35350] =\n                private_mem_35263[i_35349];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_35351 = 0; i_35351 < (int64_t) 9; i_35351++) {\n            int32_t sharedIdx_35352 = local_tid_35238 +\n                    sext_i64_i32(segscan_group_sizze_31095 * i_35351);\n            \n            private_mem_35263[i_35351] = ((__local\n                                           int64_t *) local_mem_35248)[sext_i32_i64(sharedIdx_35352)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global ",
            "memory\n    {\n        for (int64_t i_35353 = 0; i_35353 < (int64_t) 9; i_35353++) {\n            int64_t gtid_31099 = blockOff_35260 + segscan_group_sizze_31095 *\n                    i_35353 + sext_i32_i64(local_tid_35238);\n            \n            if (slt64(gtid_31099, defunc_2_reduce_res_29634)) {\n                ((__global bool *) mem_32314)[gtid_31099] =\n                    private_mem_35261[i_35353];\n            }\n        }\n        for (int64_t i_35354 = 0; i_35354 < (int64_t) 9; i_35354++) {\n            int64_t gtid_31099 = blockOff_35260 + segscan_group_sizze_31095 *\n                    i_35354 + sext_i32_i64(local_tid_35238);\n            \n            if (slt64(gtid_31099, defunc_2_reduce_res_29634)) {\n                ((__global int64_t *) mem_32316)[gtid_31099] =\n                    private_mem_35263[i_35354];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_35259 == sdiv_up64(defunc_2_reduce_res_29634,\n                                          segscan_group_sizze_31095 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_clusterWithziid_counter_mem_35225)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_31095\n}\n__kernel void test_elimDupesWithzicopy_32774(int64_t num_segments_28854,\n                                             __global unsigned char *mem_31966,\n                                             __global unsigned char *mem_31968)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_32774;\n    int32_t copy_ltid_32775;\n    int32_t copy_gid_32776;\n    \n    copy_gtid_32774 = get_global_id(0);\n    copy_ltid_32775 = get_local_id(0);\n    copy_gid_32776 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_32774), num_segments_28854)) {\n        ((__global int64_t *) mem_31968)[sext_i32_i64(copy_gtid_3",
            "2774)] =\n            ((__global\n              int64_t *) mem_31966)[smod64(sext_i32_i64(copy_gtid_32774) +\n                                           (int64_t) -1, num_segments_28854)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_elimDupesWithzisegmap_30389(__global int *global_failure,\n                                               int64_t implz2081U_28821,\n                                               __global\n                                               unsigned char *arr_mem_31946,\n                                               __global\n                                               unsigned char *mem_31949)\n{\n    #define segmap_group_sizze_30397 (test_elimDupesWithzisegmap_group_sizze_30391)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32444;\n    int32_t local_tid_32445;\n    int64_t group_sizze_32448;\n    int32_t wave_sizze_32447;\n    int32_t group_tid_32446;\n    \n    global_tid_32444 = get_global_id(0);\n    local_tid_32445 = get_local_id(0);\n    group_sizze_32448 = get_local_size(0);\n    wave_sizze_32447 = LOCKSTEP_WIDTH;\n    group_tid_32446 = get_group_id(0);\n    \n    int32_t phys_tid_30389;\n    \n    phys_tid_30389 = global_tid_32444;\n    \n    int64_t gtid_30388;\n    \n    gtid_30388 = sext_i32_i64(group_tid_32446) * segmap_group_sizze_30397 +\n        sext_i32_i64(local_tid_32445);\n    if (slt64(gtid_30388, implz2081U_28821)) {\n        int32_t x_30400 = ((__global int32_t *) arr_mem_31946)[gtid_30388];\n        int64_t defunc_0_f_res_30401 = sext_i32_i64(x_30400);\n        \n        ((__global int64_t *) mem_31949)[gtid_30388] = defunc_0_f_res_30401;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30397\n}\n__kernel void test_elimDupesWithzisegmap_30403(__global int *global_failure,\n                                               int64_t implz2081U_28821,\n                                               __global",
            "\n                                               unsigned char *mem_31949,\n                                               __global\n                                               unsigned char *mem_31952)\n{\n    #define segmap_group_sizze_30413 (test_elimDupesWithzisegmap_group_sizze_30405)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32449;\n    int32_t local_tid_32450;\n    int64_t group_sizze_32453;\n    int32_t wave_sizze_32452;\n    int32_t group_tid_32451;\n    \n    global_tid_32449 = get_global_id(0);\n    local_tid_32450 = get_local_id(0);\n    group_sizze_32453 = get_local_size(0);\n    wave_sizze_32452 = LOCKSTEP_WIDTH;\n    group_tid_32451 = get_group_id(0);\n    \n    int32_t phys_tid_30403;\n    \n    phys_tid_30403 = global_tid_32449;\n    \n    int64_t gtid_30402;\n    \n    gtid_30402 = sext_i32_i64(group_tid_32451) * segmap_group_sizze_30413 +\n        sext_i32_i64(local_tid_32450);\n    if (slt64(gtid_30402, implz2081U_28821)) {\n        int64_t x_30416 = ((__global int64_t *) mem_31949)[gtid_30402];\n        int64_t i_p_o_31847 = add64((int64_t) -1, gtid_30402);\n        int64_t rot_i_31848 = smod64(i_p_o_31847, implz2081U_28821);\n        int64_t x_30417 = ((__global int64_t *) mem_31949)[rot_i_31848];\n        bool defunc_1_f_res_30418 = x_30416 == x_30417;\n        bool defunc_1_f_res_30419 = !defunc_1_f_res_30418;\n        \n        ((__global bool *) mem_31952)[gtid_30402] = defunc_1_f_res_30419;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30413\n}\n__kernel void test_elimDupesWithzisegmap_30437(__global int *global_failure,\n                                               int64_t implz2081U_28821,\n                                               int64_t num_segments_28854,\n                                               __global\n                                               unsigned char *mem_31952,\n                               ",
            "                __global\n                                               unsigned char *mem_31957,\n                                               __global\n                                               unsigned char *mem_31960,\n                                               __global\n                                               unsigned char *mem_31962)\n{\n    #define segmap_group_sizze_30440 (test_elimDupesWithzisegmap_group_sizze_30439)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32687;\n    int32_t local_tid_32688;\n    int64_t group_sizze_32691;\n    int32_t wave_sizze_32690;\n    int32_t group_tid_32689;\n    \n    global_tid_32687 = get_global_id(0);\n    local_tid_32688 = get_local_id(0);\n    group_sizze_32691 = get_local_size(0);\n    wave_sizze_32690 = LOCKSTEP_WIDTH;\n    group_tid_32689 = get_group_id(0);\n    \n    int32_t phys_tid_30437;\n    \n    phys_tid_30437 = global_tid_32687;\n    \n    int64_t write_i_30436;\n    \n    write_i_30436 = sext_i32_i64(group_tid_32689) * segmap_group_sizze_30440 +\n        sext_i32_i64(local_tid_32688);\n    if (slt64(write_i_30436, implz2081U_28821)) {\n        int64_t i_p_o_31851 = add64((int64_t) 1, write_i_30436);\n        int64_t rot_i_31852 = smod64(i_p_o_31851, implz2081U_28821);\n        bool x_28867 = ((__global bool *) mem_31952)[rot_i_31852];\n        int64_t write_value_28868 = ((__global\n                                      int64_t *) mem_31957)[write_i_30436];\n        int64_t defunc_1_f_res_28869;\n        \n        if (x_28867) {\n            int64_t x_28866 = ((__global int64_t *) mem_31960)[write_i_30436];\n            int64_t defunc_1_f_res_t_res_28870 = sub64(x_28866, (int64_t) 1);\n            \n            defunc_1_f_res_28869 = defunc_1_f_res_t_res_28870;\n        } else {\n            defunc_1_f_res_28869 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_28869) &&\n           ",
            " slt64(defunc_1_f_res_28869, num_segments_28854)) {\n            ((__global int64_t *) mem_31962)[defunc_1_f_res_28869] =\n                write_value_28868;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30440\n}\n__kernel void test_elimDupesWithzisegmap_30451(__global int *global_failure,\n                                               int failure_is_an_option,\n                                               __global\n                                               int64_t *global_failure_args,\n                                               int64_t implz2081U_28821,\n                                               int64_t num_segments_28854,\n                                               __global\n                                               unsigned char *arr_mem_31946,\n                                               __global\n                                               unsigned char *mem_31968,\n                                               __global\n                                               unsigned char *mem_31971)\n{\n    #define segmap_group_sizze_30463 (test_elimDupesWithzisegmap_group_sizze_30453)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32779;\n    int32_t local_tid_32780;\n    int64_t group_sizze_32783;\n    int32_t wave_sizze_32782;\n    int32_t group_tid_32781;\n    \n    global_tid_32779 = get_global_id(0);\n    local_tid_32780 = get_local_id(0);\n    group_sizze_32783 = get_local_size(0);\n    wave_sizze_32782 = LOCKSTEP_WIDTH;\n    group_tid_32781 = get_group_id(0);\n    \n    int32_t phys_tid_30451;\n    \n    phys_tid_30451 = global_tid_32779;\n    \n    int64_t gtid_30450;\n    \n    gtid_30450 = sext_i32_i64(group_tid_32781) * segmap_group_sizze_30463 +\n        sext_i32_i64(local_tid_32780);\n    if (slt64(gtid_30450, num_segments_28854)) {\n        int64_t x_30466 = ((__global int64_t *) mem_31968)[gtid_30450];\n ",
            "       bool x_30467 = sle64((int64_t) 0, x_30466);\n        bool y_30468 = slt64(x_30466, implz2081U_28821);\n        bool bounds_check_30469 = x_30467 && y_30468;\n        bool index_certs_30470;\n        \n        if (!bounds_check_30469) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 27) == -1) {\n                    global_failure_args[0] = x_30466;\n                    global_failure_args[1] = implz2081U_28821;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t defunc_0_f_res_30471 = ((__global\n                                         int32_t *) arr_mem_31946)[x_30466];\n        \n        ((__global int32_t *) mem_31971)[gtid_30450] = defunc_0_f_res_30471;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30463\n}\n__kernel void test_elimDupesWithzisegscan_30427(__global int *global_failure,\n                                                uint local_mem_32489_backing_offset_0,\n                                                int64_t implz2081U_28821,\n                                                __global\n                                                unsigned char *mem_31952,\n                                                __global\n                                                unsigned char *mem_31955,\n                                                __global\n                                                unsigned char *mem_31957,\n                                                __global\n                                                unsigned char *test_elimDupesWithziid_counter_mem_32457,\n                                                __global\n                                                unsigned char *status_flags_mem_32459,\n                                                __global\n                                                unsigned char *aggregates_mem_32461,\n                                                __global\n                                 ",
            "               unsigned char *incprefixes_mem_32463,\n                                                __global\n                                                unsigned char *aggregates_mem_32465,\n                                                __global\n                                                unsigned char *incprefixes_mem_32467)\n{\n    #define segscan_group_sizze_30422 (test_elimDupesWithzisegscan_group_sizze_30421)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32489_backing_0 =\n                  &shared_mem[local_mem_32489_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32478;\n    int32_t local_tid_32479;\n    int64_t group_sizze_32482;\n    int32_t wave_sizze_32481;\n    int32_t group_tid_32480;\n    \n    global_tid_32478 = get_global_id(0);\n    local_tid_32479 = get_local_id(0);\n    group_sizze_32482 = get_local_size(0);\n    wave_sizze_32481 = LOCKSTEP_WIDTH;\n    group_tid_32480 = get_group_id(0);\n    \n    int32_t phys_tid_30427;\n    \n    phys_tid_30427 = global_tid_32478;\n    \n    int64_t byte_offsets_32483;\n    \n    byte_offsets_32483 = (int64_t) 0;\n    \n    int64_t byte_offsets_32484;\n    \n    byte_offsets_32484 = segscan_group_sizze_30422;\n    \n    int64_t byte_offsets_32485;\n    \n    byte_offsets_32485 = sdiv_up64(segscan_group_sizze_30422, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30422 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32486;\n    \n    warp_byte_offset_32486 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32487;\n    \n    warp_byte_offset_32487 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_32488;\n    \n    warp_byte_offset_32488 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32489;\n    \n    local_mem_32489 = (__local char *) local_mem_32489_backing_0;\n    \n    int64_t trans_arr_len_32490;\n    \n    trans_arr_len_32490 = (int64_t) 9 * segscan_group_s",
            "izze_30422;\n    \n    int32_t dynamic_id_32500;\n    \n    if (local_tid_32479 == 0) {\n        dynamic_id_32500 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_elimDupesWithziid_counter_mem_32457)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32489)[(int64_t) 0] = dynamic_id_32500;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32500 = ((__local int32_t *) local_mem_32489)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32501;\n    \n    blockOff_32501 = sext_i32_i64(dynamic_id_32500) * (int64_t) 9 *\n        segscan_group_sizze_30422;\n    \n    bool private_mem_32502[9];\n    int64_t private_mem_32504[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32506 = 0; i_32506 < (int64_t) 9; i_32506++) {\n            int64_t gtid_30426 = blockOff_32501 +\n                    sext_i32_i64(local_tid_32479) + i_32506 *\n                    segscan_group_sizze_30422;\n            \n            if (slt64(gtid_30426, implz2081U_28821)) {\n                bool x_28845 = ((__global bool *) mem_31952)[gtid_30426];\n                \n                private_mem_32502[i_32506] = x_28845;\n                private_mem_32504[i_32506] = (int64_t) 1;\n            } else {\n                private_mem_32502[i_32506] = 0;\n                private_mem_32504[i_32506] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32507 = 0; i_32507 < (int64_t) 9; i_32507++) {\n            int64_t sharedIdx_32508 = sext_i32_i64(local_tid_32479) + i_32507 *\n                    segscan_group_sizze_30422;\n            \n            ((__local bool *) local_mem_32489)[sharedIdx_32508] =\n                private_mem_32502[i_32507];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32509 = 0; i_32509 < 9; i_32509++) {\n            int32_t sharedIdx_32510 = local_",
            "tid_32479 * 9 + i_32509;\n            \n            private_mem_32502[sext_i32_i64(i_32509)] = ((__local\n                                                         bool *) local_mem_32489)[sext_i32_i64(sharedIdx_32510)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32511 = 0; i_32511 < (int64_t) 9; i_32511++) {\n            int64_t sharedIdx_32512 = sext_i32_i64(local_tid_32479) + i_32511 *\n                    segscan_group_sizze_30422;\n            \n            ((__local int64_t *) local_mem_32489)[sharedIdx_32512] =\n                private_mem_32504[i_32511];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32513 = 0; i_32513 < 9; i_32513++) {\n            int32_t sharedIdx_32514 = local_tid_32479 * 9 + i_32513;\n            \n            private_mem_32504[sext_i32_i64(i_32513)] = ((__local\n                                                         int64_t *) local_mem_32489)[sext_i32_i64(sharedIdx_32514)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32515 = 0; i_32515 < (int64_t) 8; i_32515++) {\n            bool x_28838;\n            bool x_28840;\n            \n            x_28838 = private_mem_32502[i_32515];\n            x_28840 = private_mem_32502[i_32515 + (int64_t) 1];\n            \n            int64_t x_28839;\n            int64_t x_28841;\n            \n            x_28839 = private_mem_32504[i_32515];\n            x_28841 = private_mem_32504[i_32515 + (int64_t) 1];\n            \n            bool defunc_1_op_res_28842;\n            \n            defunc_1_op_res_28842 = x_28838 || x_28840;\n            \n            int64_t defunc_1_op_res_28843;\n            \n            if (x_28840) {\n                defunc_1_op_res_28843 = x_28841;\n            } else {\n                int64_t defunc_1_op_res_28844 = add64(x_28839, x_28841);\n                \n                defunc_1_op_res_28843 = defunc_1_op_res_28844;\n            }\n            private_mem_32502[i_32515 + (int64_t) 1] = ",
            "defunc_1_op_res_28842;\n            private_mem_32504[i_32515 + (int64_t) 1] = defunc_1_op_res_28843;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_32489)[byte_offsets_32483 +\n                                           sext_i32_i64(local_tid_32479)] =\n            private_mem_32502[(int64_t) 8];\n        ((__local int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32479)] =\n            private_mem_32504[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_32523;\n    int64_t acc_32524;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_32516;\n        int64_t x_32517;\n        bool x_32518;\n        int64_t x_32519;\n        bool x_32525;\n        int64_t x_32526;\n        bool x_32527;\n        int64_t x_32528;\n        bool ltid_in_bounds_32532;\n        \n        ltid_in_bounds_32532 = slt64(sext_i32_i64(local_tid_32479),\n                                     segscan_group_sizze_30422);\n        \n        int32_t skip_threads_32533;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32532) {\n                x_32518 = ((volatile __local\n                            bool *) local_mem_32489)[byte_offsets_32483 +\n                                                     sext_i32_i64(local_tid_32479)];\n                x_32519 = ((volatile __local\n                            int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32479)];\n                if ((local_tid_32479 - squot32(local_tid_32479, 32) * 32) ==\n                    0) {\n                    x_32516 = x_32518;\n                    x_32517 = x_32519;\n                }\n            }\n        }\n        // in-bl",
            "ock scan (hopefully no barriers needed)\n        {\n            skip_threads_32533 = 1;\n            while (slt32(skip_threads_32533, 32)) {\n                if (sle32(skip_threads_32533, local_tid_32479 -\n                          squot32(local_tid_32479, 32) * 32) &&\n                    ltid_in_bounds_32532) {\n                    // read operands\n                    {\n                        x_32516 = ((volatile __local\n                                    bool *) local_mem_32489)[byte_offsets_32483 +\n                                                             (sext_i32_i64(local_tid_32479) -\n                                                              sext_i32_i64(skip_threads_32533))];\n                        x_32517 = ((volatile __local\n                                    int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32479) -\n                                                                 sext_i32_i64(skip_threads_32533))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_32520 = x_32516 || x_32518;\n                        int64_t defunc_1_op_res_32521;\n                        \n                        if (x_32518) {\n                            defunc_1_op_res_32521 = x_32519;\n                        } else {\n                            int64_t defunc_1_op_res_32522 = add64(x_32517,\n                                                                  x_32519);\n                            \n                            defunc_1_op_res_32521 = defunc_1_op_res_32522;\n                        }\n                        x_32516 = defunc_1_op_res_32520;\n                        x_32517 = defunc_1_op_res_32521;\n                    }\n                }\n                if (sle32(wave_sizze_32481, skip_threads_32533)) {\n ",
            "                   barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32533, local_tid_32479 -\n                          squot32(local_tid_32479, 32) * 32) &&\n                    ltid_in_bounds_32532) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_32489)[byte_offsets_32483 +\n                                                   sext_i32_i64(local_tid_32479)] =\n                            x_32516;\n                        x_32518 = x_32516;\n                        ((volatile __local\n                          int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32479)] =\n                            x_32517;\n                        x_32519 = x_32517;\n                    }\n                }\n                if (sle32(wave_sizze_32481, skip_threads_32533)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32533 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32479 - squot32(local_tid_32479, 32) * 32) == 31 &&\n                ltid_in_bounds_32532) {\n                ((volatile __local bool *) local_mem_32489)[byte_offsets_32483 +\n                                                            sext_i32_i64(squot32(local_tid_32479,\n                                                                                 32))] =\n                    x_32516;\n                ((volatile __local\n                  int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32479,\n                     ",
            "                                              32))] =\n                    x_32517;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32534;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32479, 32) == 0 && ltid_in_bounds_32532) {\n                    x_32527 = ((volatile __local\n                                bool *) local_mem_32489)[byte_offsets_32483 +\n                                                         sext_i32_i64(local_tid_32479)];\n                    x_32528 = ((volatile __local\n                                int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32479)];\n                    if ((local_tid_32479 - squot32(local_tid_32479, 32) * 32) ==\n                        0) {\n                        x_32525 = x_32527;\n                        x_32526 = x_32528;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32534 = 1;\n                while (slt32(skip_threads_32534, 32)) {\n                    if (sle32(skip_threads_32534, local_tid_32479 -\n                              squot32(local_tid_32479, 32) * 32) &&\n                        (squot32(local_tid_32479, 32) == 0 &&\n                         ltid_in_bounds_32532)) {\n                        // read operands\n                        {\n                            x_32525 = ((volatile __local\n                                        bool *) local_mem_32489)[byte_offsets_32483 +\n                                                                 (sext_i32_i64(local_tid_32479) -\n                                                           ",
            "       sext_i32_i64(skip_threads_32534))];\n                            x_32526 = ((volatile __local\n                                        int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32479) -\n                                                                     sext_i32_i64(skip_threads_32534))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_32529 = x_32525 || x_32527;\n                            int64_t defunc_1_op_res_32530;\n                            \n                            if (x_32527) {\n                                defunc_1_op_res_32530 = x_32528;\n                            } else {\n                                int64_t defunc_1_op_res_32531 = add64(x_32526,\n                                                                      x_32528);\n                                \n                                defunc_1_op_res_32530 = defunc_1_op_res_32531;\n                            }\n                            x_32525 = defunc_1_op_res_32529;\n                            x_32526 = defunc_1_op_res_32530;\n                        }\n                    }\n                    if (sle32(wave_sizze_32481, skip_threads_32534)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32534, local_tid_32479 -\n                              squot32(local_tid_32479, 32) * 32) &&\n                        (squot32(local_tid_32479, 32) == 0 &&\n                         ltid_in_bounds_32532)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_32489)[byte_offsets_32483 +\n                                             ",
            "          sext_i32_i64(local_tid_32479)] =\n                                x_32525;\n                            x_32527 = x_32525;\n                            ((volatile __local\n                              int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32479)] =\n                                x_32526;\n                            x_32528 = x_32526;\n                        }\n                    }\n                    if (sle32(wave_sizze_32481, skip_threads_32534)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32534 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32479, 32) == 0 || !ltid_in_bounds_32532)) {\n                // read operands\n                {\n                    x_32518 = x_32516;\n                    x_32519 = x_32517;\n                    x_32516 = ((__local\n                                bool *) local_mem_32489)[byte_offsets_32483 +\n                                                         (sext_i32_i64(squot32(local_tid_32479,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_32517 = ((__local\n                                int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32479,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                /",
            "/ perform operation\n                {\n                    bool defunc_1_op_res_32520 = x_32516 || x_32518;\n                    int64_t defunc_1_op_res_32521;\n                    \n                    if (x_32518) {\n                        defunc_1_op_res_32521 = x_32519;\n                    } else {\n                        int64_t defunc_1_op_res_32522 = add64(x_32517, x_32519);\n                        \n                        defunc_1_op_res_32521 = defunc_1_op_res_32522;\n                    }\n                    x_32516 = defunc_1_op_res_32520;\n                    x_32517 = defunc_1_op_res_32521;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_32489)[byte_offsets_32483 +\n                                                       sext_i32_i64(local_tid_32479)] =\n                        x_32516;\n                    ((__local\n                      int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32479)] =\n                        x_32517;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32479, 32) == 0) {\n                ((__local bool *) local_mem_32489)[byte_offsets_32483 +\n                                                   sext_i32_i64(local_tid_32479)] =\n                    x_32518;\n                ((__local\n                  int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32479)] =\n                    x_32519;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32479 == 0) {\n            acc_32523 = ((__local bo",
            "ol *) local_mem_32489)[byte_offsets_32483 +\n                                                           (segscan_group_sizze_30422 -\n                                                            (int64_t) 1)];\n            acc_32524 = ((__local\n                          int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30422 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32523 = ((__local bool *) local_mem_32489)[byte_offsets_32483 +\n                                                           (sext_i32_i64(local_tid_32479) -\n                                                            (int64_t) 1)];\n            acc_32524 = ((__local\n                          int64_t *) local_mem_32489)[squot64(byte_offsets_32484,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32479) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_32535;\n    \n    prefix_32535 = 0;\n    \n    int64_t prefix_32536;\n    \n    prefix_32536 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32500 == (int64_t) 0 && local_tid_32479 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_32463)[dynamic_id_32500] = acc_32523;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32467)[dynamic_id_32500] = acc_32524;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32459)[dynamic_id_32500] = (int8_t) 2;\n            acc_32523 = 0;\n            acc_32524 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32500 == (int64_t) 0) && slt32(local_tid_32479,\n                                             ",
            "           wave_sizze_32481)) {\n            if (local_tid_32479 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_32461)[dynamic_id_32500] = acc_32523;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32465)[dynamic_id_32500] =\n                    acc_32524;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32459)[dynamic_id_32500] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32489)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32459)[dynamic_id_32500 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32537;\n            \n            status_32537 = ((__local int8_t *) local_mem_32489)[(int64_t) 0];\n            if (status_32537 == (int8_t) 2) {\n                if (local_tid_32479 == 0) {\n                    prefix_32535 = ((volatile __global\n                                     bool *) incprefixes_mem_32463)[dynamic_id_32500 -\n                                                                    (int64_t) 1];\n                    prefix_32536 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32467)[dynamic_id_32500 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32538 = dynamic_id_32500 -\n                        sext_i32_i64(wave_sizze_32481);\n                \n                while (slt32(wave_sizze_32481 * -1, readOffset_32538)) {\n                    int32_t read_i_32539 = readOffset_32538 + local_tid_32479;\n                    bool aggr_32540 = 0;\n                    int64_t aggr_32541 = (int64_t) 0;\n                    int8_t flag_",
            "32542 = (int8_t) 0;\n                    int8_t used_32543 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32539)) {\n                        flag_32542 = ((volatile __global\n                                       int8_t *) status_flags_mem_32459)[sext_i32_i64(read_i_32539)];\n                        if (flag_32542 == (int8_t) 2) {\n                            aggr_32540 = ((volatile __global\n                                           bool *) incprefixes_mem_32463)[sext_i32_i64(read_i_32539)];\n                            aggr_32541 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32467)[sext_i32_i64(read_i_32539)];\n                        } else {\n                            if (flag_32542 == (int8_t) 1) {\n                                aggr_32540 = ((volatile __global\n                                               bool *) aggregates_mem_32461)[sext_i32_i64(read_i_32539)];\n                                aggr_32541 = ((volatile __global\n                                               int64_t *) aggregates_mem_32465)[sext_i32_i64(read_i_32539)];\n                                used_32543 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_32489)[warp_byte_offset_32486 +\n                                                       sext_i32_i64(local_tid_32479)] =\n                        aggr_32540;\n                    ((__local\n                      int64_t *) local_mem_32489)[squot64(warp_byte_offset_32487,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32479)] =\n                        aggr_32541;\n                    \n                    int8_t tmp_32544;\n                    \n                    tmp_32544 = flag_32542 | used_32543 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32489)[",
            "sext_i32_i64(local_tid_32479)] =\n                        tmp_32544;\n                    mem_fence_local();\n                    flag_32542 = ((volatile __local\n                                   int8_t *) local_mem_32489)[sext_i32_i64(wave_sizze_32481) -\n                                                              (int64_t) 1];\n                    if (local_tid_32479 == 0) {\n                        if (!(flag_32542 == (int8_t) 2)) {\n                            bool x_32545 = 0;\n                            int64_t x_32546 = (int64_t) 0;\n                            bool x_32547;\n                            int64_t x_32548;\n                            int8_t flag1_32552;\n                            \n                            flag1_32552 = (int8_t) 0;\n                            \n                            int8_t flag2_32553;\n                            int8_t used1_32554;\n                            \n                            used1_32554 = (int8_t) 0;\n                            \n                            int8_t used2_32555;\n                            \n                            for (int32_t i_32556 = 0; i_32556 <\n                                 wave_sizze_32481; i_32556++) {\n                                flag2_32553 = ((__local\n                                                int8_t *) local_mem_32489)[sext_i32_i64(i_32556)];\n                                used2_32555 = lshr8(flag2_32553, (int8_t) 2);\n                                flag2_32553 = flag2_32553 & (int8_t) 3;\n                                x_32547 = ((__local\n                                            bool *) local_mem_32489)[warp_byte_offset_32486 +\n                                                                     sext_i32_i64(i_32556)];\n                                x_32548 = ((__local\n                                            int64_t *) local_mem_32489)[squot64(warp_byte_offset_32487,\n                                                                                (int64_t) 8) +\n   ",
            "                                                                     sext_i32_i64(i_32556)];\n                                if (!(flag2_32553 == (int8_t) 1)) {\n                                    flag1_32552 = flag2_32553;\n                                    used1_32554 = used2_32555;\n                                    x_32545 = x_32547;\n                                    x_32546 = x_32548;\n                                } else {\n                                    used1_32554 += used2_32555;\n                                    \n                                    bool defunc_1_op_res_32549;\n                                    \n                                    defunc_1_op_res_32549 = x_32545 || x_32547;\n                                    \n                                    int64_t defunc_1_op_res_32550;\n                                    \n                                    if (x_32547) {\n                                        defunc_1_op_res_32550 = x_32548;\n                                    } else {\n                                        int64_t defunc_1_op_res_32551 =\n                                                add64(x_32546, x_32548);\n                                        \n                                        defunc_1_op_res_32550 =\n                                            defunc_1_op_res_32551;\n                                    }\n                                    x_32545 = defunc_1_op_res_32549;\n                                    x_32546 = defunc_1_op_res_32550;\n                                }\n                            }\n                            flag_32542 = flag1_32552;\n                            used_32543 = used1_32554;\n                            aggr_32540 = x_32545;\n                            aggr_32541 = x_32546;\n                        } else {\n                            aggr_32540 = ((__local\n                                           bool *) local_mem_32489)[warp_byte_offset_32486 +\n                            ",
            "                                        (sext_i32_i64(wave_sizze_32481) -\n                                                                     (int64_t) 1)];\n                            aggr_32541 = ((__local\n                                           int64_t *) local_mem_32489)[squot64(warp_byte_offset_32487,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32481) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32542 == (int8_t) 2) {\n                            readOffset_32538 = wave_sizze_32481 * -1;\n                        } else {\n                            readOffset_32538 -= zext_i8_i32(used_32543);\n                        }\n                        ((__local int32_t *) local_mem_32489)[(int64_t) 0] =\n                            readOffset_32538;\n                        \n                        bool x_32557;\n                        \n                        x_32557 = aggr_32540;\n                        \n                        int64_t x_32558;\n                        \n                        x_32558 = aggr_32541;\n                        \n                        bool x_32559;\n                        \n                        x_32559 = prefix_32535;\n                        \n                        int64_t x_32560;\n                        \n                        x_32560 = prefix_32536;\n                        \n                        bool defunc_1_op_res_32561;\n                        \n                        defunc_1_op_res_32561 = x_32557 || x_32559;\n                        \n                        int64_t defunc_1_op_res_32562;\n                        \n                        if (x_32559) {\n                            defunc_1_op_res_32562 = x_32560;\n                        } else {\n                            int64_t defun",
            "c_1_op_res_32563 = add64(x_32558,\n                                                                  x_32560);\n                            \n                            defunc_1_op_res_32562 = defunc_1_op_res_32563;\n                        }\n                        prefix_32535 = defunc_1_op_res_32561;\n                        prefix_32536 = defunc_1_op_res_32562;\n                    }\n                    mem_fence_local();\n                    readOffset_32538 = ((__local\n                                         int32_t *) local_mem_32489)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32479 == 0) {\n                bool x_32564 = prefix_32535;\n                int64_t x_32565 = prefix_32536;\n                bool x_32566 = acc_32523;\n                int64_t x_32567 = acc_32524;\n                bool defunc_1_op_res_32568 = x_32564 || x_32566;\n                int64_t defunc_1_op_res_32569;\n                \n                if (x_32566) {\n                    defunc_1_op_res_32569 = x_32567;\n                } else {\n                    int64_t defunc_1_op_res_32570 = add64(x_32565, x_32567);\n                    \n                    defunc_1_op_res_32569 = defunc_1_op_res_32570;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_32463)[dynamic_id_32500] =\n                    defunc_1_op_res_32568;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32467)[dynamic_id_32500] =\n                    defunc_1_op_res_32569;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32459)[dynamic_id_32500] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_32489)[warp_byte_offset_32486] =\n                    prefix_32535;\n                ((__local\n                  int64_t *) local_mem_32489)[squot64(warp_byte_offset_32487,\n                                                      (int64_t) 8)] =\n          ",
            "          prefix_32536;\n                acc_32523 = 0;\n                acc_32524 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32500 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32535 = ((__local\n                             bool *) local_mem_32489)[warp_byte_offset_32486];\n            prefix_32536 = ((__local\n                             int64_t *) local_mem_32489)[squot64(warp_byte_offset_32487,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_32571;\n        bool x_32573;\n        bool x_32578;\n        \n        x_32578 = prefix_32535;\n        \n        bool x_32580;\n        \n        x_32580 = acc_32523;\n        \n        int64_t x_32572;\n        int64_t x_32574;\n        int64_t x_32579;\n        \n        x_32579 = prefix_32536;\n        \n        int64_t x_32581;\n        \n        x_32581 = acc_32524;\n        \n        bool defunc_1_op_res_32582;\n        \n        defunc_1_op_res_32582 = x_32578 || x_32580;\n        \n        int64_t defunc_1_op_res_32583;\n        \n        if (x_32580) {\n            defunc_1_op_res_32583 = x_32581;\n        } else {\n            int64_t defunc_1_op_res_32584 = add64(x_32579, x_32581);\n            \n            defunc_1_op_res_32583 = defunc_1_op_res_32584;\n        }\n        x_32571 = defunc_1_op_res_32582;\n        x_32572 = defunc_1_op_res_32583;\n        for (int64_t i_32585 = 0; i_32585 < (int64_t) 9; i_32585++) {\n            x_32573 = private_mem_32502[i_32585];\n            x_32574 = private_mem_32504[i_32585];\n            \n            bool defunc_1_op_res_32575;\n            \n            defunc_1_op_res_32575 = x_32571 || x_32573;\n            \n            int64_t defunc_1_op_res_32576;\n            \n            if (x_32573) {\n                defunc_1_op_res_32576 = x_32574;\n            } else {\n                int64_t defunc_1_op_res_32577 = add64(x_32572, x",
            "_32574);\n                \n                defunc_1_op_res_32576 = defunc_1_op_res_32577;\n            }\n            private_mem_32502[i_32585] = defunc_1_op_res_32575;\n            private_mem_32504[i_32585] = defunc_1_op_res_32576;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32586 = 0; i_32586 < (int64_t) 9; i_32586++) {\n            int64_t sharedIdx_32587 = sext_i32_i64(local_tid_32479 * 9) +\n                    i_32586;\n            \n            ((__local bool *) local_mem_32489)[sharedIdx_32587] =\n                private_mem_32502[i_32586];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32588 = 0; i_32588 < (int64_t) 9; i_32588++) {\n            int32_t sharedIdx_32589 = local_tid_32479 +\n                    sext_i64_i32(segscan_group_sizze_30422 * i_32588);\n            \n            private_mem_32502[i_32588] = ((__local\n                                           bool *) local_mem_32489)[sext_i32_i64(sharedIdx_32589)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32590 = 0; i_32590 < (int64_t) 9; i_32590++) {\n            int64_t sharedIdx_32591 = sext_i32_i64(local_tid_32479 * 9) +\n                    i_32590;\n            \n            ((__local int64_t *) local_mem_32489)[sharedIdx_32591] =\n                private_mem_32504[i_32590];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32592 = 0; i_32592 < (int64_t) 9; i_32592++) {\n            int32_t sharedIdx_32593 = local_tid_32479 +\n                    sext_i64_i32(segscan_group_sizze_30422 * i_32592);\n            \n            private_mem_32504[i_32592] = ((__local\n                                           int64_t *) local_mem_32489)[sext_i32_i64(sharedIdx_32593)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32594 = 0; i_32594 < (int64_t) 9; i_32594++) {\n            int64_t gtid_30426 = bloc",
            "kOff_32501 + segscan_group_sizze_30422 *\n                    i_32594 + sext_i32_i64(local_tid_32479);\n            \n            if (slt64(gtid_30426, implz2081U_28821)) {\n                ((__global bool *) mem_31955)[gtid_30426] =\n                    private_mem_32502[i_32594];\n            }\n        }\n        for (int64_t i_32595 = 0; i_32595 < (int64_t) 9; i_32595++) {\n            int64_t gtid_30426 = blockOff_32501 + segscan_group_sizze_30422 *\n                    i_32595 + sext_i32_i64(local_tid_32479);\n            \n            if (slt64(gtid_30426, implz2081U_28821)) {\n                ((__global int64_t *) mem_31957)[gtid_30426] =\n                    private_mem_32504[i_32595];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32500 == sdiv_up64(implz2081U_28821,\n                                          segscan_group_sizze_30422 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_elimDupesWithziid_counter_mem_32457)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30422\n}\n__kernel void test_elimDupesWithzisegscan_30435(__global int *global_failure,\n                                                uint local_mem_32616_backing_offset_0,\n                                                int64_t implz2081U_28821,\n                                                __global\n                                                unsigned char *mem_31952,\n                                                __global\n                                                unsigned char *mem_31960,\n                                                __global\n                                                unsigned char *test_elimDupesWithziid_counter_mem_32599,\n                                                __global\n                                                unsigned char *status_flags_mem_32601,\n    ",
            "                                            __global\n                                                unsigned char *aggregates_mem_32603,\n                                                __global\n                                                unsigned char *incprefixes_mem_32605)\n{\n    #define segscan_group_sizze_30430 (test_elimDupesWithzisegscan_group_sizze_30429)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32616_backing_0 =\n                  &shared_mem[local_mem_32616_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32607;\n    int32_t local_tid_32608;\n    int64_t group_sizze_32611;\n    int32_t wave_sizze_32610;\n    int32_t group_tid_32609;\n    \n    global_tid_32607 = get_global_id(0);\n    local_tid_32608 = get_local_id(0);\n    group_sizze_32611 = get_local_size(0);\n    wave_sizze_32610 = LOCKSTEP_WIDTH;\n    group_tid_32609 = get_group_id(0);\n    \n    int32_t phys_tid_30435;\n    \n    phys_tid_30435 = global_tid_32607;\n    \n    int64_t byte_offsets_32612;\n    \n    byte_offsets_32612 = (int64_t) 0;\n    \n    int64_t byte_offsets_32613;\n    \n    byte_offsets_32613 = segscan_group_sizze_30430 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32614;\n    \n    warp_byte_offset_32614 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32615;\n    \n    warp_byte_offset_32615 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32616;\n    \n    local_mem_32616 = (__local char *) local_mem_32616_backing_0;\n    \n    int64_t trans_arr_len_32617;\n    \n    trans_arr_len_32617 = (int64_t) 9 * segscan_group_sizze_30430;\n    \n    int32_t dynamic_id_32624;\n    \n    if (local_tid_32608 == 0) {\n        dynamic_id_32624 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_elimDupesWithziid_counter_mem_32599)[(int64_t) 0],\n                                             ",
            "    (int) 1);\n        ((__local int32_t *) local_mem_32616)[(int64_t) 0] = dynamic_id_32624;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32624 = ((__local int32_t *) local_mem_32616)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32625;\n    \n    blockOff_32625 = sext_i32_i64(dynamic_id_32624) * (int64_t) 9 *\n        segscan_group_sizze_30430;\n    \n    int64_t private_mem_32626[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32628 = 0; i_32628 < (int64_t) 9; i_32628++) {\n            int64_t gtid_30434 = blockOff_32625 +\n                    sext_i32_i64(local_tid_32608) + i_32628 *\n                    segscan_group_sizze_30430;\n            \n            if (slt64(gtid_30434, implz2081U_28821)) {\n                int64_t i_p_o_31849 = add64((int64_t) 1, gtid_30434);\n                int64_t rot_i_31850 = smod64(i_p_o_31849, implz2081U_28821);\n                bool x_28852 = ((__global bool *) mem_31952)[rot_i_31850];\n                int64_t defunc_0_f_res_28853 = btoi_bool_i64(x_28852);\n                \n                private_mem_32626[i_32628] = defunc_0_f_res_28853;\n            } else {\n                private_mem_32626[i_32628] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32629 = 0; i_32629 < (int64_t) 9; i_32629++) {\n            int64_t sharedIdx_32630 = sext_i32_i64(local_tid_32608) + i_32629 *\n                    segscan_group_sizze_30430;\n            \n            ((__local int64_t *) local_mem_32616)[sharedIdx_32630] =\n                private_mem_32626[i_32629];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32631 = 0; i_32631 < 9; i_32631++) {\n            int32_t sharedIdx_32632 = local_tid_32608 * 9 + i_32631;\n            \n            private_mem_32626[sext_i32_i64(i_32631)] = ((__local\n                                                         int64_t *) local_mem_32616)[sext_i32_i64(sharedIdx_32632",
            ")];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32633 = 0; i_32633 < (int64_t) 8; i_32633++) {\n            int64_t x_28849;\n            int64_t x_28850;\n            \n            x_28849 = private_mem_32626[i_32633];\n            x_28850 = private_mem_32626[i_32633 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28851;\n            \n            defunc_1_op_res_28851 = add64(x_28849, x_28850);\n            private_mem_32626[i_32633 + (int64_t) 1] = defunc_1_op_res_28851;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32608)] =\n            private_mem_32626[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32637;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32634;\n        int64_t x_32635;\n        int64_t x_32638;\n        int64_t x_32639;\n        bool ltid_in_bounds_32641;\n        \n        ltid_in_bounds_32641 = slt64(sext_i32_i64(local_tid_32608),\n                                     segscan_group_sizze_30430);\n        \n        int32_t skip_threads_32642;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32641) {\n                x_32635 = ((volatile __local\n                            int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32608)];\n                if ((local_tid_32608 - squot32(local_tid_32608, 32) * 32) ==\n                    0) {\n                    x_32634 = x_32635;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32642 = 1;\n",
            "            while (slt32(skip_threads_32642, 32)) {\n                if (sle32(skip_threads_32642, local_tid_32608 -\n                          squot32(local_tid_32608, 32) * 32) &&\n                    ltid_in_bounds_32641) {\n                    // read operands\n                    {\n                        x_32634 = ((volatile __local\n                                    int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32608) -\n                                                                 sext_i32_i64(skip_threads_32642))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32636 = add64(x_32634, x_32635);\n                        \n                        x_32634 = defunc_1_op_res_32636;\n                    }\n                }\n                if (sle32(wave_sizze_32610, skip_threads_32642)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32642, local_tid_32608 -\n                          squot32(local_tid_32608, 32) * 32) &&\n                    ltid_in_bounds_32641) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32608)] =\n                            x_32634;\n                        x_32635 = x_32634;\n                    }\n                }\n                if (sle32(wave_sizze_32610, skip_threads_32642)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32642 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL",
            "_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32608 - squot32(local_tid_32608, 32) * 32) == 31 &&\n                ltid_in_bounds_32641) {\n                ((volatile __local\n                  int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32608,\n                                                                   32))] =\n                    x_32634;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32643;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32608, 32) == 0 && ltid_in_bounds_32641) {\n                    x_32639 = ((volatile __local\n                                int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32608)];\n                    if ((local_tid_32608 - squot32(local_tid_32608, 32) * 32) ==\n                        0) {\n                        x_32638 = x_32639;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32643 = 1;\n                while (slt32(skip_threads_32643, 32)) {\n                    if (sle32(skip_threads_32643, local_tid_32608 -\n                              squot32(local_tid_32608, 32) * 32) &&\n                        (squot32(local_tid_32608, 32) == 0 &&\n                         ltid_in_bounds_32641)) {\n                        // read operands\n                        {\n                            x_32638 = ((volatile __local\n         ",
            "                               int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32608) -\n                                                                     sext_i32_i64(skip_threads_32643))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32640 = add64(x_32638,\n                                                                  x_32639);\n                            \n                            x_32638 = defunc_1_op_res_32640;\n                        }\n                    }\n                    if (sle32(wave_sizze_32610, skip_threads_32643)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32643, local_tid_32608 -\n                              squot32(local_tid_32608, 32) * 32) &&\n                        (squot32(local_tid_32608, 32) == 0 &&\n                         ltid_in_bounds_32641)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32608)] =\n                                x_32638;\n                            x_32639 = x_32638;\n                        }\n                    }\n                    if (sle32(wave_sizze_32610, skip_threads_32643)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32643 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n   ",
            "     {\n            if (!(squot32(local_tid_32608, 32) == 0 || !ltid_in_bounds_32641)) {\n                // read operands\n                {\n                    x_32635 = x_32634;\n                    x_32634 = ((__local\n                                int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32608,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32636 = add64(x_32634, x_32635);\n                    \n                    x_32634 = defunc_1_op_res_32636;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32608)] =\n                        x_32634;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32608, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32608)] =\n                    x_32635;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32608 == 0) {\n            acc_32637 = ((__local\n                          int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                              ",
            "                                (int64_t) 8) +\n                                                      (segscan_group_sizze_30430 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32637 = ((__local\n                          int64_t *) local_mem_32616)[squot64(byte_offsets_32612,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32608) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32644;\n    \n    prefix_32644 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32624 == (int64_t) 0 && local_tid_32608 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32605)[dynamic_id_32624] = acc_32637;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32601)[dynamic_id_32624] = (int8_t) 2;\n            acc_32637 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32624 == (int64_t) 0) && slt32(local_tid_32608,\n                                                        wave_sizze_32610)) {\n            if (local_tid_32608 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32603)[dynamic_id_32624] =\n                    acc_32637;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32601)[dynamic_id_32624] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32616)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32601)[dynamic_id_32624 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_",
            "32645;\n            \n            status_32645 = ((__local int8_t *) local_mem_32616)[(int64_t) 0];\n            if (status_32645 == (int8_t) 2) {\n                if (local_tid_32608 == 0) {\n                    prefix_32644 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32605)[dynamic_id_32624 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32646 = dynamic_id_32624 -\n                        sext_i32_i64(wave_sizze_32610);\n                \n                while (slt32(wave_sizze_32610 * -1, readOffset_32646)) {\n                    int32_t read_i_32647 = readOffset_32646 + local_tid_32608;\n                    int64_t aggr_32648 = (int64_t) 0;\n                    int8_t flag_32649 = (int8_t) 0;\n                    int8_t used_32650 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32647)) {\n                        flag_32649 = ((volatile __global\n                                       int8_t *) status_flags_mem_32601)[sext_i32_i64(read_i_32647)];\n                        if (flag_32649 == (int8_t) 2) {\n                            aggr_32648 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32605)[sext_i32_i64(read_i_32647)];\n                        } else {\n                            if (flag_32649 == (int8_t) 1) {\n                                aggr_32648 = ((volatile __global\n                                               int64_t *) aggregates_mem_32603)[sext_i32_i64(read_i_32647)];\n                                used_32650 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32616)[squot64(warp_byte_offset_32614,\n                                                          (int64_t) 8) +\n                                                  sext_i32",
            "_i64(local_tid_32608)] =\n                        aggr_32648;\n                    \n                    int8_t tmp_32651;\n                    \n                    tmp_32651 = flag_32649 | used_32650 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32616)[sext_i32_i64(local_tid_32608)] =\n                        tmp_32651;\n                    mem_fence_local();\n                    flag_32649 = ((volatile __local\n                                   int8_t *) local_mem_32616)[sext_i32_i64(wave_sizze_32610) -\n                                                              (int64_t) 1];\n                    if (local_tid_32608 == 0) {\n                        if (!(flag_32649 == (int8_t) 2)) {\n                            int64_t x_32652 = (int64_t) 0;\n                            int64_t x_32653;\n                            int8_t flag1_32655;\n                            \n                            flag1_32655 = (int8_t) 0;\n                            \n                            int8_t flag2_32656;\n                            int8_t used1_32657;\n                            \n                            used1_32657 = (int8_t) 0;\n                            \n                            int8_t used2_32658;\n                            \n                            for (int32_t i_32659 = 0; i_32659 <\n                                 wave_sizze_32610; i_32659++) {\n                                flag2_32656 = ((__local\n                                                int8_t *) local_mem_32616)[sext_i32_i64(i_32659)];\n                                used2_32658 = lshr8(flag2_32656, (int8_t) 2);\n                                flag2_32656 = flag2_32656 & (int8_t) 3;\n                                x_32653 = ((__local\n                                            int64_t *) local_mem_32616)[squot64(warp_byte_offset_32614,\n                                                                                (int64_t) 8) +\n                                       ",
            "                                 sext_i32_i64(i_32659)];\n                                if (!(flag2_32656 == (int8_t) 1)) {\n                                    flag1_32655 = flag2_32656;\n                                    used1_32657 = used2_32658;\n                                    x_32652 = x_32653;\n                                } else {\n                                    used1_32657 += used2_32658;\n                                    \n                                    int64_t defunc_1_op_res_32654;\n                                    \n                                    defunc_1_op_res_32654 = add64(x_32652,\n                                                                  x_32653);\n                                    x_32652 = defunc_1_op_res_32654;\n                                }\n                            }\n                            flag_32649 = flag1_32655;\n                            used_32650 = used1_32657;\n                            aggr_32648 = x_32652;\n                        } else {\n                            aggr_32648 = ((__local\n                                           int64_t *) local_mem_32616)[squot64(warp_byte_offset_32614,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32610) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32649 == (int8_t) 2) {\n                            readOffset_32646 = wave_sizze_32610 * -1;\n                        } else {\n                            readOffset_32646 -= zext_i8_i32(used_32650);\n                        }\n                        ((__local int32_t *) local_mem_32616)[(int64_t) 0] =\n                            readOffset_32646;\n                        \n                        int64_t x_32660;\n                        \n                        x_32660 = a",
            "ggr_32648;\n                        \n                        int64_t x_32661;\n                        \n                        x_32661 = prefix_32644;\n                        \n                        int64_t defunc_1_op_res_32662;\n                        \n                        defunc_1_op_res_32662 = add64(x_32660, x_32661);\n                        prefix_32644 = defunc_1_op_res_32662;\n                    }\n                    mem_fence_local();\n                    readOffset_32646 = ((__local\n                                         int32_t *) local_mem_32616)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32608 == 0) {\n                int64_t x_32663 = prefix_32644;\n                int64_t x_32664 = acc_32637;\n                int64_t defunc_1_op_res_32665 = add64(x_32663, x_32664);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32605)[dynamic_id_32624] =\n                    defunc_1_op_res_32665;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32601)[dynamic_id_32624] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32616)[squot64(warp_byte_offset_32614,\n                                                      (int64_t) 8)] =\n                    prefix_32644;\n                acc_32637 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32624 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32644 = ((__local\n                             int64_t *) local_mem_32616)[squot64(warp_byte_offset_32614,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32666;\n        int64_t x_32667;\n        int64_t x_32669;\n        \n        x_32669 = prefix_32644;\n        \n        int64_t x_32670;\n        \n        x_32670",
            " = acc_32637;\n        \n        int64_t defunc_1_op_res_32671;\n        \n        defunc_1_op_res_32671 = add64(x_32669, x_32670);\n        x_32666 = defunc_1_op_res_32671;\n        for (int64_t i_32672 = 0; i_32672 < (int64_t) 9; i_32672++) {\n            x_32667 = private_mem_32626[i_32672];\n            \n            int64_t defunc_1_op_res_32668;\n            \n            defunc_1_op_res_32668 = add64(x_32666, x_32667);\n            private_mem_32626[i_32672] = defunc_1_op_res_32668;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32673 = 0; i_32673 < (int64_t) 9; i_32673++) {\n            int64_t sharedIdx_32674 = sext_i32_i64(local_tid_32608 * 9) +\n                    i_32673;\n            \n            ((__local int64_t *) local_mem_32616)[sharedIdx_32674] =\n                private_mem_32626[i_32673];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32675 = 0; i_32675 < (int64_t) 9; i_32675++) {\n            int32_t sharedIdx_32676 = local_tid_32608 +\n                    sext_i64_i32(segscan_group_sizze_30430 * i_32675);\n            \n            private_mem_32626[i_32675] = ((__local\n                                           int64_t *) local_mem_32616)[sext_i32_i64(sharedIdx_32676)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32677 = 0; i_32677 < (int64_t) 9; i_32677++) {\n            int64_t gtid_30434 = blockOff_32625 + segscan_group_sizze_30430 *\n                    i_32677 + sext_i32_i64(local_tid_32608);\n            \n            if (slt64(gtid_30434, implz2081U_28821)) {\n                ((__global int64_t *) mem_31960)[gtid_30434] =\n                    private_mem_32626[i_32677];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32624 == sdiv_up64(implz2081U_28821,\n                                          segscan_group_sizze_30430 *\n",
            "                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_elimDupesWithziid_counter_mem_32599)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30430\n}\n__kernel void test_elimDupesWithzisegscan_30449(__global int *global_failure,\n                                                uint local_mem_32712_backing_offset_0,\n                                                int64_t num_segments_28854,\n                                                __global\n                                                unsigned char *mem_31962,\n                                                __global\n                                                unsigned char *mem_31966,\n                                                __global\n                                                unsigned char *test_elimDupesWithziid_counter_mem_32695,\n                                                __global\n                                                unsigned char *status_flags_mem_32697,\n                                                __global\n                                                unsigned char *aggregates_mem_32699,\n                                                __global\n                                                unsigned char *incprefixes_mem_32701)\n{\n    #define segscan_group_sizze_30444 (test_elimDupesWithzisegscan_group_sizze_30443)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32712_backing_0 =\n                  &shared_mem[local_mem_32712_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32703;\n    int32_t local_tid_32704;\n    int64_t group_sizze_32707;\n    int32_t wave_sizze_32706;\n    int32_t group_tid_32705;\n    \n    global_tid_32703 = get_global_id(0);\n    local_tid_32704 = get_local_id(0);\n    group_sizze_32707 = get_local_size(0);",
            "\n    wave_sizze_32706 = LOCKSTEP_WIDTH;\n    group_tid_32705 = get_group_id(0);\n    \n    int32_t phys_tid_30449;\n    \n    phys_tid_30449 = global_tid_32703;\n    \n    int64_t byte_offsets_32708;\n    \n    byte_offsets_32708 = (int64_t) 0;\n    \n    int64_t byte_offsets_32709;\n    \n    byte_offsets_32709 = segscan_group_sizze_30444 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32710;\n    \n    warp_byte_offset_32710 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32711;\n    \n    warp_byte_offset_32711 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32712;\n    \n    local_mem_32712 = (__local char *) local_mem_32712_backing_0;\n    \n    int64_t trans_arr_len_32713;\n    \n    trans_arr_len_32713 = (int64_t) 9 * segscan_group_sizze_30444;\n    \n    int32_t dynamic_id_32720;\n    \n    if (local_tid_32704 == 0) {\n        dynamic_id_32720 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_elimDupesWithziid_counter_mem_32695)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32712)[(int64_t) 0] = dynamic_id_32720;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32720 = ((__local int32_t *) local_mem_32712)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32721;\n    \n    blockOff_32721 = sext_i32_i64(dynamic_id_32720) * (int64_t) 9 *\n        segscan_group_sizze_30444;\n    \n    int64_t private_mem_32722[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32724 = 0; i_32724 < (int64_t) 9; i_32724++) {\n            int64_t gtid_30448 = blockOff_32721 +\n                    sext_i32_i64(local_tid_32704) + i_32724 *\n                    segscan_group_sizze_30444;\n            \n            if (slt64(gtid_30448, num_segments_28854)) {\n                int64_t x_28875 = ((__global int64_t *) mem_31962)[gtid_30448];\n                \n                private_mem_32722[i_32724] = x_28875;\n     ",
            "       } else {\n                private_mem_32722[i_32724] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32725 = 0; i_32725 < (int64_t) 9; i_32725++) {\n            int64_t sharedIdx_32726 = sext_i32_i64(local_tid_32704) + i_32725 *\n                    segscan_group_sizze_30444;\n            \n            ((__local int64_t *) local_mem_32712)[sharedIdx_32726] =\n                private_mem_32722[i_32725];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32727 = 0; i_32727 < 9; i_32727++) {\n            int32_t sharedIdx_32728 = local_tid_32704 * 9 + i_32727;\n            \n            private_mem_32722[sext_i32_i64(i_32727)] = ((__local\n                                                         int64_t *) local_mem_32712)[sext_i32_i64(sharedIdx_32728)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32729 = 0; i_32729 < (int64_t) 8; i_32729++) {\n            int64_t x_28872;\n            int64_t x_28873;\n            \n            x_28872 = private_mem_32722[i_32729];\n            x_28873 = private_mem_32722[i_32729 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28874;\n            \n            defunc_1_op_res_28874 = add64(x_28872, x_28873);\n            private_mem_32722[i_32729 + (int64_t) 1] = defunc_1_op_res_28874;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32704)] =\n            private_mem_32722[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32733;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32730;\n        int64_t x_32731;\n        int64_t x_32734;\n        int64_t x_32735;\n        bool ltid_in_bounds_32737;",
            "\n        \n        ltid_in_bounds_32737 = slt64(sext_i32_i64(local_tid_32704),\n                                     segscan_group_sizze_30444);\n        \n        int32_t skip_threads_32738;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32737) {\n                x_32731 = ((volatile __local\n                            int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32704)];\n                if ((local_tid_32704 - squot32(local_tid_32704, 32) * 32) ==\n                    0) {\n                    x_32730 = x_32731;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32738 = 1;\n            while (slt32(skip_threads_32738, 32)) {\n                if (sle32(skip_threads_32738, local_tid_32704 -\n                          squot32(local_tid_32704, 32) * 32) &&\n                    ltid_in_bounds_32737) {\n                    // read operands\n                    {\n                        x_32730 = ((volatile __local\n                                    int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32704) -\n                                                                 sext_i32_i64(skip_threads_32738))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32732 = add64(x_32730, x_32731);\n                        \n                        x_32730 = defunc_1_op_res_32732;\n                    }\n                }\n                if (sle32(wave_sizze_32706, skip_threads_32738)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n              ",
            "  }\n                if (sle32(skip_threads_32738, local_tid_32704 -\n                          squot32(local_tid_32704, 32) * 32) &&\n                    ltid_in_bounds_32737) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32704)] =\n                            x_32730;\n                        x_32731 = x_32730;\n                    }\n                }\n                if (sle32(wave_sizze_32706, skip_threads_32738)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32738 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32704 - squot32(local_tid_32704, 32) * 32) == 31 &&\n                ltid_in_bounds_32737) {\n                ((volatile __local\n                  int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32704,\n                                                                   32))] =\n                    x_32730;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32739;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32704, 32) == 0 && ltid_in_bounds_32737) {\n                    x_32735 = ((volatile __local\n                                int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                 ",
            "   (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32704)];\n                    if ((local_tid_32704 - squot32(local_tid_32704, 32) * 32) ==\n                        0) {\n                        x_32734 = x_32735;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32739 = 1;\n                while (slt32(skip_threads_32739, 32)) {\n                    if (sle32(skip_threads_32739, local_tid_32704 -\n                              squot32(local_tid_32704, 32) * 32) &&\n                        (squot32(local_tid_32704, 32) == 0 &&\n                         ltid_in_bounds_32737)) {\n                        // read operands\n                        {\n                            x_32734 = ((volatile __local\n                                        int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32704) -\n                                                                     sext_i32_i64(skip_threads_32739))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32736 = add64(x_32734,\n                                                                  x_32735);\n                            \n                            x_32734 = defunc_1_op_res_32736;\n                        }\n                    }\n                    if (sle32(wave_sizze_32706, skip_threads_32739)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32739, local_tid_32704 -\n                              squot32(local_tid_32704, 32) * 32) &&\n                        (squot32(local_tid_32704, 32) == 0 &&\n                 ",
            "        ltid_in_bounds_32737)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32704)] =\n                                x_32734;\n                            x_32735 = x_32734;\n                        }\n                    }\n                    if (sle32(wave_sizze_32706, skip_threads_32739)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32739 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32704, 32) == 0 || !ltid_in_bounds_32737)) {\n                // read operands\n                {\n                    x_32731 = x_32730;\n                    x_32730 = ((__local\n                                int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32704,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32732 = add64(x_32730, x_32731);\n                    \n                    x_32730 = defunc_1_op_res_32732;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                          (int64_t) 8) +\n",
            "                                                  sext_i32_i64(local_tid_32704)] =\n                        x_32730;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32704, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32704)] =\n                    x_32731;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32704 == 0) {\n            acc_32733 = ((__local\n                          int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30444 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32733 = ((__local\n                          int64_t *) local_mem_32712)[squot64(byte_offsets_32708,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32704) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32740;\n    \n    prefix_32740 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32720 == (int64_t) 0 && local_tid_32704 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32701)[dynamic_id_32720] = acc_32733;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32697)[dynamic_id_32720] = (int8_t) 2;\n            acc_32733 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32720 == (int64",
            "_t) 0) && slt32(local_tid_32704,\n                                                        wave_sizze_32706)) {\n            if (local_tid_32704 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32699)[dynamic_id_32720] =\n                    acc_32733;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32697)[dynamic_id_32720] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32712)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32697)[dynamic_id_32720 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32741;\n            \n            status_32741 = ((__local int8_t *) local_mem_32712)[(int64_t) 0];\n            if (status_32741 == (int8_t) 2) {\n                if (local_tid_32704 == 0) {\n                    prefix_32740 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32701)[dynamic_id_32720 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32742 = dynamic_id_32720 -\n                        sext_i32_i64(wave_sizze_32706);\n                \n                while (slt32(wave_sizze_32706 * -1, readOffset_32742)) {\n                    int32_t read_i_32743 = readOffset_32742 + local_tid_32704;\n                    int64_t aggr_32744 = (int64_t) 0;\n                    int8_t flag_32745 = (int8_t) 0;\n                    int8_t used_32746 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32743)) {\n                        flag_32745 = ((volatile __global\n                                       int8_t *) status_flags_mem_32697)[sext_i32_i64(read_i_32743)];\n",
            "                        if (flag_32745 == (int8_t) 2) {\n                            aggr_32744 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32701)[sext_i32_i64(read_i_32743)];\n                        } else {\n                            if (flag_32745 == (int8_t) 1) {\n                                aggr_32744 = ((volatile __global\n                                               int64_t *) aggregates_mem_32699)[sext_i32_i64(read_i_32743)];\n                                used_32746 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32712)[squot64(warp_byte_offset_32710,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32704)] =\n                        aggr_32744;\n                    \n                    int8_t tmp_32747;\n                    \n                    tmp_32747 = flag_32745 | used_32746 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32712)[sext_i32_i64(local_tid_32704)] =\n                        tmp_32747;\n                    mem_fence_local();\n                    flag_32745 = ((volatile __local\n                                   int8_t *) local_mem_32712)[sext_i32_i64(wave_sizze_32706) -\n                                                              (int64_t) 1];\n                    if (local_tid_32704 == 0) {\n                        if (!(flag_32745 == (int8_t) 2)) {\n                            int64_t x_32748 = (int64_t) 0;\n                            int64_t x_32749;\n                            int8_t flag1_32751;\n                            \n                            flag1_32751 = (int8_t) 0;\n                            \n                            int8_t flag2_32752;\n                            int8_t used1_32753;\n                            \n               ",
            "             used1_32753 = (int8_t) 0;\n                            \n                            int8_t used2_32754;\n                            \n                            for (int32_t i_32755 = 0; i_32755 <\n                                 wave_sizze_32706; i_32755++) {\n                                flag2_32752 = ((__local\n                                                int8_t *) local_mem_32712)[sext_i32_i64(i_32755)];\n                                used2_32754 = lshr8(flag2_32752, (int8_t) 2);\n                                flag2_32752 = flag2_32752 & (int8_t) 3;\n                                x_32749 = ((__local\n                                            int64_t *) local_mem_32712)[squot64(warp_byte_offset_32710,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32755)];\n                                if (!(flag2_32752 == (int8_t) 1)) {\n                                    flag1_32751 = flag2_32752;\n                                    used1_32753 = used2_32754;\n                                    x_32748 = x_32749;\n                                } else {\n                                    used1_32753 += used2_32754;\n                                    \n                                    int64_t defunc_1_op_res_32750;\n                                    \n                                    defunc_1_op_res_32750 = add64(x_32748,\n                                                                  x_32749);\n                                    x_32748 = defunc_1_op_res_32750;\n                                }\n                            }\n                            flag_32745 = flag1_32751;\n                            used_32746 = used1_32753;\n                            aggr_32744 = x_32748;\n                        } else {\n                            aggr_32744 = ((__local\n                                           int64_t *) ",
            "local_mem_32712)[squot64(warp_byte_offset_32710,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32706) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32745 == (int8_t) 2) {\n                            readOffset_32742 = wave_sizze_32706 * -1;\n                        } else {\n                            readOffset_32742 -= zext_i8_i32(used_32746);\n                        }\n                        ((__local int32_t *) local_mem_32712)[(int64_t) 0] =\n                            readOffset_32742;\n                        \n                        int64_t x_32756;\n                        \n                        x_32756 = aggr_32744;\n                        \n                        int64_t x_32757;\n                        \n                        x_32757 = prefix_32740;\n                        \n                        int64_t defunc_1_op_res_32758;\n                        \n                        defunc_1_op_res_32758 = add64(x_32756, x_32757);\n                        prefix_32740 = defunc_1_op_res_32758;\n                    }\n                    mem_fence_local();\n                    readOffset_32742 = ((__local\n                                         int32_t *) local_mem_32712)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32704 == 0) {\n                int64_t x_32759 = prefix_32740;\n                int64_t x_32760 = acc_32733;\n                int64_t defunc_1_op_res_32761 = add64(x_32759, x_32760);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32701)[dynamic_id_32720] =\n                    defunc_1_op_res_32761;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32697)[dynamic_id_32720] =",
            "\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32712)[squot64(warp_byte_offset_32710,\n                                                      (int64_t) 8)] =\n                    prefix_32740;\n                acc_32733 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32720 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32740 = ((__local\n                             int64_t *) local_mem_32712)[squot64(warp_byte_offset_32710,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32762;\n        int64_t x_32763;\n        int64_t x_32765;\n        \n        x_32765 = prefix_32740;\n        \n        int64_t x_32766;\n        \n        x_32766 = acc_32733;\n        \n        int64_t defunc_1_op_res_32767;\n        \n        defunc_1_op_res_32767 = add64(x_32765, x_32766);\n        x_32762 = defunc_1_op_res_32767;\n        for (int64_t i_32768 = 0; i_32768 < (int64_t) 9; i_32768++) {\n            x_32763 = private_mem_32722[i_32768];\n            \n            int64_t defunc_1_op_res_32764;\n            \n            defunc_1_op_res_32764 = add64(x_32762, x_32763);\n            private_mem_32722[i_32768] = defunc_1_op_res_32764;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32769 = 0; i_32769 < (int64_t) 9; i_32769++) {\n            int64_t sharedIdx_32770 = sext_i32_i64(local_tid_32704 * 9) +\n                    i_32769;\n            \n            ((__local int64_t *) local_mem_32712)[sharedIdx_32770] =\n                private_mem_32722[i_32769];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32771 = 0; i_32771 < (int64_t) 9; i_32771++) {\n            int32_t sharedIdx_32772 = local_tid_32704 +\n                    sext_i64_i32(segscan_group_sizze_30444 * i_32771);\n            \n   ",
            "         private_mem_32722[i_32771] = ((__local\n                                           int64_t *) local_mem_32712)[sext_i32_i64(sharedIdx_32772)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32773 = 0; i_32773 < (int64_t) 9; i_32773++) {\n            int64_t gtid_30448 = blockOff_32721 + segscan_group_sizze_30444 *\n                    i_32773 + sext_i32_i64(local_tid_32704);\n            \n            if (slt64(gtid_30448, num_segments_28854)) {\n                ((__global int64_t *) mem_31966)[gtid_30448] =\n                    private_mem_32722[i_32773];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32720 == sdiv_up64(num_segments_28854,\n                                          segscan_group_sizze_30444 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_elimDupesWithziid_counter_mem_32695)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30444\n}\n__kernel void test_mkSegsFromSort_segIndzicopy_32773(int64_t num_segments_28706,\n                                                     __global\n                                                     unsigned char *mem_31967,\n                                                     __global\n                                                     unsigned char *mem_31969)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_32773;\n    int32_t copy_ltid_32774;\n    int32_t copy_gid_32775;\n    \n    copy_gtid_32773 = get_global_id(0);\n    copy_ltid_32774 = get_local_id(0);\n    copy_gid_32775 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_32773), num_segments_28706)) {\n        ((__global int64_t *) mem_31969)[sext_i32_i64(copy_gtid_32773)] =\n            ((__global\n              int64_t",
            " *) mem_31967)[smod64(sext_i32_i64(copy_gtid_32773) +\n                                           (int64_t) -1, num_segments_28706)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_mkSegsFromSort_segIndzisegmap_30253(__global\n                                                       int *global_failure,\n                                                       int64_t implz2081U_28671,\n                                                       __global\n                                                       unsigned char *keys_mem_31946,\n                                                       __global\n                                                       unsigned char *mem_31950)\n{\n    #define segmap_group_sizze_30261 (test_mkSegsFromSort_segIndzisegmap_group_sizze_30255)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32443;\n    int32_t local_tid_32444;\n    int64_t group_sizze_32447;\n    int32_t wave_sizze_32446;\n    int32_t group_tid_32445;\n    \n    global_tid_32443 = get_global_id(0);\n    local_tid_32444 = get_local_id(0);\n    group_sizze_32447 = get_local_size(0);\n    wave_sizze_32446 = LOCKSTEP_WIDTH;\n    group_tid_32445 = get_group_id(0);\n    \n    int32_t phys_tid_30253;\n    \n    phys_tid_30253 = global_tid_32443;\n    \n    int64_t gtid_30252;\n    \n    gtid_30252 = sext_i32_i64(group_tid_32445) * segmap_group_sizze_30261 +\n        sext_i32_i64(local_tid_32444);\n    if (slt64(gtid_30252, implz2081U_28671)) {\n        int32_t x_30264 = ((__global int32_t *) keys_mem_31946)[gtid_30252];\n        int64_t defunc_0_f_res_30265 = sext_i32_i64(x_30264);\n        \n        ((__global int64_t *) mem_31950)[gtid_30252] = defunc_0_f_res_30265;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30261\n}\n__kernel void test_mkSegsFromSort_segIndzisegmap_30267(__global\n                                                       int *global_failure,\n     ",
            "                                                  int64_t implz2081U_28671,\n                                                       __global\n                                                       unsigned char *mem_31950,\n                                                       __global\n                                                       unsigned char *mem_31953)\n{\n    #define segmap_group_sizze_30277 (test_mkSegsFromSort_segIndzisegmap_group_sizze_30269)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32448;\n    int32_t local_tid_32449;\n    int64_t group_sizze_32452;\n    int32_t wave_sizze_32451;\n    int32_t group_tid_32450;\n    \n    global_tid_32448 = get_global_id(0);\n    local_tid_32449 = get_local_id(0);\n    group_sizze_32452 = get_local_size(0);\n    wave_sizze_32451 = LOCKSTEP_WIDTH;\n    group_tid_32450 = get_group_id(0);\n    \n    int32_t phys_tid_30267;\n    \n    phys_tid_30267 = global_tid_32448;\n    \n    int64_t gtid_30266;\n    \n    gtid_30266 = sext_i32_i64(group_tid_32450) * segmap_group_sizze_30277 +\n        sext_i32_i64(local_tid_32449);\n    if (slt64(gtid_30266, implz2081U_28671)) {\n        int64_t x_30280 = ((__global int64_t *) mem_31950)[gtid_30266];\n        int64_t i_p_o_31847 = add64((int64_t) -1, gtid_30266);\n        int64_t rot_i_31848 = smod64(i_p_o_31847, implz2081U_28671);\n        int64_t x_30281 = ((__global int64_t *) mem_31950)[rot_i_31848];\n        bool defunc_1_f_res_30282 = x_30280 == x_30281;\n        bool defunc_1_f_res_30283 = !defunc_1_f_res_30282;\n        \n        ((__global bool *) mem_31953)[gtid_30266] = defunc_1_f_res_30283;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30277\n}\n__kernel void test_mkSegsFromSort_segIndzisegmap_30301(__global\n                                                       int *global_failure,\n                                                       int64_t implz2081U_",
            "28671,\n                                                       int64_t num_segments_28706,\n                                                       __global\n                                                       unsigned char *mem_31953,\n                                                       __global\n                                                       unsigned char *mem_31958,\n                                                       __global\n                                                       unsigned char *mem_31961,\n                                                       __global\n                                                       unsigned char *mem_31963)\n{\n    #define segmap_group_sizze_30304 (test_mkSegsFromSort_segIndzisegmap_group_sizze_30303)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32686;\n    int32_t local_tid_32687;\n    int64_t group_sizze_32690;\n    int32_t wave_sizze_32689;\n    int32_t group_tid_32688;\n    \n    global_tid_32686 = get_global_id(0);\n    local_tid_32687 = get_local_id(0);\n    group_sizze_32690 = get_local_size(0);\n    wave_sizze_32689 = LOCKSTEP_WIDTH;\n    group_tid_32688 = get_group_id(0);\n    \n    int32_t phys_tid_30301;\n    \n    phys_tid_30301 = global_tid_32686;\n    \n    int64_t write_i_30300;\n    \n    write_i_30300 = sext_i32_i64(group_tid_32688) * segmap_group_sizze_30304 +\n        sext_i32_i64(local_tid_32687);\n    if (slt64(write_i_30300, implz2081U_28671)) {\n        int64_t i_p_o_31851 = add64((int64_t) 1, write_i_30300);\n        int64_t rot_i_31852 = smod64(i_p_o_31851, implz2081U_28671);\n        bool x_28719 = ((__global bool *) mem_31953)[rot_i_31852];\n        int64_t write_value_28720 = ((__global\n                                      int64_t *) mem_31958)[write_i_30300];\n        int64_t defunc_1_f_res_28721;\n        \n        if (x_28719) {\n            int64_t x_28718 = ((__global int64_t *) me",
            "m_31961)[write_i_30300];\n            int64_t defunc_1_f_res_t_res_28722 = sub64(x_28718, (int64_t) 1);\n            \n            defunc_1_f_res_28721 = defunc_1_f_res_t_res_28722;\n        } else {\n            defunc_1_f_res_28721 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_28721) &&\n            slt64(defunc_1_f_res_28721, num_segments_28706)) {\n            ((__global int64_t *) mem_31963)[defunc_1_f_res_28721] =\n                write_value_28720;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30304\n}\n__kernel void test_mkSegsFromSort_segIndzisegmap_30315(__global\n                                                       int *global_failure,\n                                                       int failure_is_an_option,\n                                                       __global\n                                                       int64_t *global_failure_args,\n                                                       int64_t implz2081U_28671,\n                                                       int64_t numKey_28672,\n                                                       int64_t num_segments_28706,\n                                                       __global\n                                                       unsigned char *keys_mem_31946,\n                                                       __global\n                                                       unsigned char *mem_31969,\n                                                       __global\n                                                       unsigned char *mem_31971)\n{\n    #define segmap_group_sizze_30318 (test_mkSegsFromSort_segIndzisegmap_group_sizze_30317)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32778;\n    int32_t local_tid_32779;\n    int64_t group_sizze_32782;\n    int32_t wave_sizze_32781;\n    int32_t group_tid_32",
            "780;\n    \n    global_tid_32778 = get_global_id(0);\n    local_tid_32779 = get_local_id(0);\n    group_sizze_32782 = get_local_size(0);\n    wave_sizze_32781 = LOCKSTEP_WIDTH;\n    group_tid_32780 = get_group_id(0);\n    \n    int32_t phys_tid_30315;\n    \n    phys_tid_30315 = global_tid_32778;\n    \n    int64_t write_i_30314;\n    \n    write_i_30314 = sext_i32_i64(group_tid_32780) * segmap_group_sizze_30318 +\n        sext_i32_i64(local_tid_32779);\n    if (slt64(write_i_30314, num_segments_28706)) {\n        int64_t x_28738 = ((__global int64_t *) mem_31969)[write_i_30314];\n        bool x_28740 = sle64((int64_t) 0, x_28738);\n        bool y_28741 = slt64(x_28738, implz2081U_28671);\n        bool bounds_check_28742 = x_28740 && y_28741;\n        bool index_certs_28743;\n        \n        if (!bounds_check_28742) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 28) == -1) {\n                    global_failure_args[0] = x_28738;\n                    global_failure_args[1] = implz2081U_28671;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t i32_arg_28744 = ((__global int32_t *) keys_mem_31946)[x_28738];\n        int64_t i32_res_28745 = sext_i32_i64(i32_arg_28744);\n        \n        if (sle64((int64_t) 0, i32_res_28745) && slt64(i32_res_28745,\n                                                       numKey_28672)) {\n            ((__global int64_t *) mem_31971)[i32_res_28745] = x_28738;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30318\n}\n__kernel void test_mkSegsFromSort_segIndzisegscan_30291(__global\n                                                        int *global_failure,\n                                                        uint local_mem_32488_backing_offset_0,\n                                                        int64_t implz2081U_28671,\n                                                        __global\n                                                       ",
            " unsigned char *mem_31953,\n                                                        __global\n                                                        unsigned char *mem_31956,\n                                                        __global\n                                                        unsigned char *mem_31958,\n                                                        __global\n                                                        unsigned char *test_mkSegsFromSort_segIndziid_counter_mem_32456,\n                                                        __global\n                                                        unsigned char *status_flags_mem_32458,\n                                                        __global\n                                                        unsigned char *aggregates_mem_32460,\n                                                        __global\n                                                        unsigned char *incprefixes_mem_32462,\n                                                        __global\n                                                        unsigned char *aggregates_mem_32464,\n                                                        __global\n                                                        unsigned char *incprefixes_mem_32466)\n{\n    #define segscan_group_sizze_30286 (test_mkSegsFromSort_segIndzisegscan_group_sizze_30285)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32488_backing_0 =\n                  &shared_mem[local_mem_32488_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32477;\n    int32_t local_tid_32478;\n    int64_t group_sizze_32481;\n    int32_t wave_sizze_32480;\n    int32_t group_tid_32479;\n    \n    global_tid_32477 = get_global_id(0);\n    local_tid_32478 = get_local_id(0);\n    group_sizze_32481 = get_local_size(0);\n    wave_sizze_32480 = LOCKSTEP_WIDTH;\n    group_tid_32479 = ge",
            "t_group_id(0);\n    \n    int32_t phys_tid_30291;\n    \n    phys_tid_30291 = global_tid_32477;\n    \n    int64_t byte_offsets_32482;\n    \n    byte_offsets_32482 = (int64_t) 0;\n    \n    int64_t byte_offsets_32483;\n    \n    byte_offsets_32483 = segscan_group_sizze_30286;\n    \n    int64_t byte_offsets_32484;\n    \n    byte_offsets_32484 = sdiv_up64(segscan_group_sizze_30286, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30286 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32485;\n    \n    warp_byte_offset_32485 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32486;\n    \n    warp_byte_offset_32486 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_32487;\n    \n    warp_byte_offset_32487 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32488;\n    \n    local_mem_32488 = (__local char *) local_mem_32488_backing_0;\n    \n    int64_t trans_arr_len_32489;\n    \n    trans_arr_len_32489 = (int64_t) 9 * segscan_group_sizze_30286;\n    \n    int32_t dynamic_id_32499;\n    \n    if (local_tid_32478 == 0) {\n        dynamic_id_32499 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segIndziid_counter_mem_32456)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32488)[(int64_t) 0] = dynamic_id_32499;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32499 = ((__local int32_t *) local_mem_32488)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32500;\n    \n    blockOff_32500 = sext_i32_i64(dynamic_id_32499) * (int64_t) 9 *\n        segscan_group_sizze_30286;\n    \n    bool private_mem_32501[9];\n    int64_t private_mem_32503[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32505 = 0; i_32505 < (int64_t) 9; i_32505++) {\n            int64_t gtid_30290 = blockOff_32500 +\n                    sext_i32_i64(local_tid_32478) + i_32505 *\n                    segscan_group_sizze_3",
            "0286;\n            \n            if (slt64(gtid_30290, implz2081U_28671)) {\n                bool x_28697 = ((__global bool *) mem_31953)[gtid_30290];\n                \n                private_mem_32501[i_32505] = x_28697;\n                private_mem_32503[i_32505] = (int64_t) 1;\n            } else {\n                private_mem_32501[i_32505] = 0;\n                private_mem_32503[i_32505] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32506 = 0; i_32506 < (int64_t) 9; i_32506++) {\n            int64_t sharedIdx_32507 = sext_i32_i64(local_tid_32478) + i_32506 *\n                    segscan_group_sizze_30286;\n            \n            ((__local bool *) local_mem_32488)[sharedIdx_32507] =\n                private_mem_32501[i_32506];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32508 = 0; i_32508 < 9; i_32508++) {\n            int32_t sharedIdx_32509 = local_tid_32478 * 9 + i_32508;\n            \n            private_mem_32501[sext_i32_i64(i_32508)] = ((__local\n                                                         bool *) local_mem_32488)[sext_i32_i64(sharedIdx_32509)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32510 = 0; i_32510 < (int64_t) 9; i_32510++) {\n            int64_t sharedIdx_32511 = sext_i32_i64(local_tid_32478) + i_32510 *\n                    segscan_group_sizze_30286;\n            \n            ((__local int64_t *) local_mem_32488)[sharedIdx_32511] =\n                private_mem_32503[i_32510];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32512 = 0; i_32512 < 9; i_32512++) {\n            int32_t sharedIdx_32513 = local_tid_32478 * 9 + i_32512;\n            \n            private_mem_32503[sext_i32_i64(i_32512)] = ((__local\n                                                         int64_t *) local_mem_32488)[sext_i32_i64(sharedIdx_32513)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // ",
            "Per thread scan\n    {\n        for (int64_t i_32514 = 0; i_32514 < (int64_t) 8; i_32514++) {\n            bool x_28690;\n            bool x_28692;\n            \n            x_28690 = private_mem_32501[i_32514];\n            x_28692 = private_mem_32501[i_32514 + (int64_t) 1];\n            \n            int64_t x_28691;\n            int64_t x_28693;\n            \n            x_28691 = private_mem_32503[i_32514];\n            x_28693 = private_mem_32503[i_32514 + (int64_t) 1];\n            \n            bool defunc_1_op_res_28694;\n            \n            defunc_1_op_res_28694 = x_28690 || x_28692;\n            \n            int64_t defunc_1_op_res_28695;\n            \n            if (x_28692) {\n                defunc_1_op_res_28695 = x_28693;\n            } else {\n                int64_t defunc_1_op_res_28696 = add64(x_28691, x_28693);\n                \n                defunc_1_op_res_28695 = defunc_1_op_res_28696;\n            }\n            private_mem_32501[i_32514 + (int64_t) 1] = defunc_1_op_res_28694;\n            private_mem_32503[i_32514 + (int64_t) 1] = defunc_1_op_res_28695;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                           sext_i32_i64(local_tid_32478)] =\n            private_mem_32501[(int64_t) 8];\n        ((__local int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32478)] =\n            private_mem_32503[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_32522;\n    int64_t acc_32523;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_32515;\n        int64_t x_32516;\n        bool x_32517;\n        int64_t x_32518;\n        bool x_32524;\n        int64_t x_32525;\n        bool x_32526;\n        int64_t x_32527;\n        bool ltid_in_bounds_32531;\n        \n        ltid_in_bounds_32531 = slt64",
            "(sext_i32_i64(local_tid_32478),\n                                     segscan_group_sizze_30286);\n        \n        int32_t skip_threads_32532;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32531) {\n                x_32517 = ((volatile __local\n                            bool *) local_mem_32488)[byte_offsets_32482 +\n                                                     sext_i32_i64(local_tid_32478)];\n                x_32518 = ((volatile __local\n                            int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32478)];\n                if ((local_tid_32478 - squot32(local_tid_32478, 32) * 32) ==\n                    0) {\n                    x_32515 = x_32517;\n                    x_32516 = x_32518;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32532 = 1;\n            while (slt32(skip_threads_32532, 32)) {\n                if (sle32(skip_threads_32532, local_tid_32478 -\n                          squot32(local_tid_32478, 32) * 32) &&\n                    ltid_in_bounds_32531) {\n                    // read operands\n                    {\n                        x_32515 = ((volatile __local\n                                    bool *) local_mem_32488)[byte_offsets_32482 +\n                                                             (sext_i32_i64(local_tid_32478) -\n                                                              sext_i32_i64(skip_threads_32532))];\n                        x_32516 = ((volatile __local\n                                    int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32478",
            ") -\n                                                                 sext_i32_i64(skip_threads_32532))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_32519 = x_32515 || x_32517;\n                        int64_t defunc_1_op_res_32520;\n                        \n                        if (x_32517) {\n                            defunc_1_op_res_32520 = x_32518;\n                        } else {\n                            int64_t defunc_1_op_res_32521 = add64(x_32516,\n                                                                  x_32518);\n                            \n                            defunc_1_op_res_32520 = defunc_1_op_res_32521;\n                        }\n                        x_32515 = defunc_1_op_res_32519;\n                        x_32516 = defunc_1_op_res_32520;\n                    }\n                }\n                if (sle32(wave_sizze_32480, skip_threads_32532)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32532, local_tid_32478 -\n                          squot32(local_tid_32478, 32) * 32) &&\n                    ltid_in_bounds_32531) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_32488)[byte_offsets_32482 +\n                                                   sext_i32_i64(local_tid_32478)] =\n                            x_32515;\n                        x_32517 = x_32515;\n                        ((volatile __local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32478)] =\n                            x_32516;\n                        x_32518 = x_32516;\n                    }\n                }\n                if (sle32(wave_sizze",
            "_32480, skip_threads_32532)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32532 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32478 - squot32(local_tid_32478, 32) * 32) == 31 &&\n                ltid_in_bounds_32531) {\n                ((volatile __local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                            sext_i32_i64(squot32(local_tid_32478,\n                                                                                 32))] =\n                    x_32515;\n                ((volatile __local\n                  int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32478,\n                                                                   32))] =\n                    x_32516;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32533;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32478, 32) == 0 && ltid_in_bounds_32531) {\n                    x_32526 = ((volatile __local\n                                bool *) local_mem_32488)[byte_offsets_32482 +\n                                                         sext_i32_i64(local_tid_32478)];\n                    x_32527 = ((volatile __local\n                                int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32478)];\n                    if ((local_tid_32478 - squot32(local",
            "_tid_32478, 32) * 32) ==\n                        0) {\n                        x_32524 = x_32526;\n                        x_32525 = x_32527;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32533 = 1;\n                while (slt32(skip_threads_32533, 32)) {\n                    if (sle32(skip_threads_32533, local_tid_32478 -\n                              squot32(local_tid_32478, 32) * 32) &&\n                        (squot32(local_tid_32478, 32) == 0 &&\n                         ltid_in_bounds_32531)) {\n                        // read operands\n                        {\n                            x_32524 = ((volatile __local\n                                        bool *) local_mem_32488)[byte_offsets_32482 +\n                                                                 (sext_i32_i64(local_tid_32478) -\n                                                                  sext_i32_i64(skip_threads_32533))];\n                            x_32525 = ((volatile __local\n                                        int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32478) -\n                                                                     sext_i32_i64(skip_threads_32533))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_32528 = x_32524 || x_32526;\n                            int64_t defunc_1_op_res_32529;\n                            \n                            if (x_32526) {\n                                defunc_1_op_res_32529 = x_32527;\n                            } else {\n                                int64_t defunc_1_op_res_32530 = add64(x_32525,\n                                          ",
            "                            x_32527);\n                                \n                                defunc_1_op_res_32529 = defunc_1_op_res_32530;\n                            }\n                            x_32524 = defunc_1_op_res_32528;\n                            x_32525 = defunc_1_op_res_32529;\n                        }\n                    }\n                    if (sle32(wave_sizze_32480, skip_threads_32533)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32533, local_tid_32478 -\n                              squot32(local_tid_32478, 32) * 32) &&\n                        (squot32(local_tid_32478, 32) == 0 &&\n                         ltid_in_bounds_32531)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_32488)[byte_offsets_32482 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                                x_32524;\n                            x_32526 = x_32524;\n                            ((volatile __local\n                              int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32478)] =\n                                x_32525;\n                            x_32527 = x_32525;\n                        }\n                    }\n                    if (sle32(wave_sizze_32480, skip_threads_32533)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32533 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32478, 32) == 0 || !ltid_in_bounds_32531)) {\n                // read operands\n",
            "                {\n                    x_32517 = x_32515;\n                    x_32518 = x_32516;\n                    x_32515 = ((__local\n                                bool *) local_mem_32488)[byte_offsets_32482 +\n                                                         (sext_i32_i64(squot32(local_tid_32478,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_32516 = ((__local\n                                int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32478,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_32519 = x_32515 || x_32517;\n                    int64_t defunc_1_op_res_32520;\n                    \n                    if (x_32517) {\n                        defunc_1_op_res_32520 = x_32518;\n                    } else {\n                        int64_t defunc_1_op_res_32521 = add64(x_32516, x_32518);\n                        \n                        defunc_1_op_res_32520 = defunc_1_op_res_32521;\n                    }\n                    x_32515 = defunc_1_op_res_32519;\n                    x_32516 = defunc_1_op_res_32520;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                        x_32515;\n                    ((__local\n                      int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                     ",
            "                     (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32478)] =\n                        x_32516;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32478, 32) == 0) {\n                ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                   sext_i32_i64(local_tid_32478)] =\n                    x_32517;\n                ((__local\n                  int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32478)] =\n                    x_32518;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32478 == 0) {\n            acc_32522 = ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                           (segscan_group_sizze_30286 -\n                                                            (int64_t) 1)];\n            acc_32523 = ((__local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30286 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32522 = ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                           (sext_i32_i64(local_tid_32478) -\n                                                            (int64_t) 1)];\n            acc_32523 = ((__local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n           ",
            "                                           (sext_i32_i64(local_tid_32478) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_32534;\n    \n    prefix_32534 = 0;\n    \n    int64_t prefix_32535;\n    \n    prefix_32535 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32499 == (int64_t) 0 && local_tid_32478 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_32462)[dynamic_id_32499] = acc_32522;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32466)[dynamic_id_32499] = acc_32523;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32458)[dynamic_id_32499] = (int8_t) 2;\n            acc_32522 = 0;\n            acc_32523 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32499 == (int64_t) 0) && slt32(local_tid_32478,\n                                                        wave_sizze_32480)) {\n            if (local_tid_32478 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_32460)[dynamic_id_32499] = acc_32522;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32464)[dynamic_id_32499] =\n                    acc_32523;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32458)[dynamic_id_32499] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32488)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32458)[dynamic_id_32499 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32536;\n            \n            status_32536 = ((__local int8_t *) local_mem_32488)[(int64_t) 0];\n            if (st",
            "atus_32536 == (int8_t) 2) {\n                if (local_tid_32478 == 0) {\n                    prefix_32534 = ((volatile __global\n                                     bool *) incprefixes_mem_32462)[dynamic_id_32499 -\n                                                                    (int64_t) 1];\n                    prefix_32535 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32466)[dynamic_id_32499 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32537 = dynamic_id_32499 -\n                        sext_i32_i64(wave_sizze_32480);\n                \n                while (slt32(wave_sizze_32480 * -1, readOffset_32537)) {\n                    int32_t read_i_32538 = readOffset_32537 + local_tid_32478;\n                    bool aggr_32539 = 0;\n                    int64_t aggr_32540 = (int64_t) 0;\n                    int8_t flag_32541 = (int8_t) 0;\n                    int8_t used_32542 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32538)) {\n                        flag_32541 = ((volatile __global\n                                       int8_t *) status_flags_mem_32458)[sext_i32_i64(read_i_32538)];\n                        if (flag_32541 == (int8_t) 2) {\n                            aggr_32539 = ((volatile __global\n                                           bool *) incprefixes_mem_32462)[sext_i32_i64(read_i_32538)];\n                            aggr_32540 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32466)[sext_i32_i64(read_i_32538)];\n                        } else {\n                            if (flag_32541 == (int8_t) 1) {\n                                aggr_32539 = ((volatile __global\n                                               bool *) aggregates_mem_32460)[sext_i32_i64(read_i_32538)];\n                                aggr_32540 = ((volatile __global\n   ",
            "                                            int64_t *) aggregates_mem_32464)[sext_i32_i64(read_i_32538)];\n                                used_32542 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_32488)[warp_byte_offset_32485 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                        aggr_32539;\n                    ((__local\n                      int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32478)] =\n                        aggr_32540;\n                    \n                    int8_t tmp_32543;\n                    \n                    tmp_32543 = flag_32541 | used_32542 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32488)[sext_i32_i64(local_tid_32478)] =\n                        tmp_32543;\n                    mem_fence_local();\n                    flag_32541 = ((volatile __local\n                                   int8_t *) local_mem_32488)[sext_i32_i64(wave_sizze_32480) -\n                                                              (int64_t) 1];\n                    if (local_tid_32478 == 0) {\n                        if (!(flag_32541 == (int8_t) 2)) {\n                            bool x_32544 = 0;\n                            int64_t x_32545 = (int64_t) 0;\n                            bool x_32546;\n                            int64_t x_32547;\n                            int8_t flag1_32551;\n                            \n                            flag1_32551 = (int8_t) 0;\n                            \n                            int8_t flag2_32552;\n                            int8_t used1_32553;\n                            \n                            used1_32553 = (int8_t) 0;\n                            \n                        ",
            "    int8_t used2_32554;\n                            \n                            for (int32_t i_32555 = 0; i_32555 <\n                                 wave_sizze_32480; i_32555++) {\n                                flag2_32552 = ((__local\n                                                int8_t *) local_mem_32488)[sext_i32_i64(i_32555)];\n                                used2_32554 = lshr8(flag2_32552, (int8_t) 2);\n                                flag2_32552 = flag2_32552 & (int8_t) 3;\n                                x_32546 = ((__local\n                                            bool *) local_mem_32488)[warp_byte_offset_32485 +\n                                                                     sext_i32_i64(i_32555)];\n                                x_32547 = ((__local\n                                            int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32555)];\n                                if (!(flag2_32552 == (int8_t) 1)) {\n                                    flag1_32551 = flag2_32552;\n                                    used1_32553 = used2_32554;\n                                    x_32544 = x_32546;\n                                    x_32545 = x_32547;\n                                } else {\n                                    used1_32553 += used2_32554;\n                                    \n                                    bool defunc_1_op_res_32548;\n                                    \n                                    defunc_1_op_res_32548 = x_32544 || x_32546;\n                                    \n                                    int64_t defunc_1_op_res_32549;\n                                    \n                                    if (x_32546) {\n                                        defunc_1_op_res_32549 = x_32547;\n                                    ",
            "} else {\n                                        int64_t defunc_1_op_res_32550 =\n                                                add64(x_32545, x_32547);\n                                        \n                                        defunc_1_op_res_32549 =\n                                            defunc_1_op_res_32550;\n                                    }\n                                    x_32544 = defunc_1_op_res_32548;\n                                    x_32545 = defunc_1_op_res_32549;\n                                }\n                            }\n                            flag_32541 = flag1_32551;\n                            used_32542 = used1_32553;\n                            aggr_32539 = x_32544;\n                            aggr_32540 = x_32545;\n                        } else {\n                            aggr_32539 = ((__local\n                                           bool *) local_mem_32488)[warp_byte_offset_32485 +\n                                                                    (sext_i32_i64(wave_sizze_32480) -\n                                                                     (int64_t) 1)];\n                            aggr_32540 = ((__local\n                                           int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32480) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32541 == (int8_t) 2) {\n                            readOffset_32537 = wave_sizze_32480 * -1;\n                        } else {\n                            readOffset_32537 -= zext_i8_i32(used_32542);\n                        }\n                        ((__local int32_t *) local_mem_32488)[(int64_t) 0] =\n                            readOffset_32537;\n                ",
            "        \n                        bool x_32556;\n                        \n                        x_32556 = aggr_32539;\n                        \n                        int64_t x_32557;\n                        \n                        x_32557 = aggr_32540;\n                        \n                        bool x_32558;\n                        \n                        x_32558 = prefix_32534;\n                        \n                        int64_t x_32559;\n                        \n                        x_32559 = prefix_32535;\n                        \n                        bool defunc_1_op_res_32560;\n                        \n                        defunc_1_op_res_32560 = x_32556 || x_32558;\n                        \n                        int64_t defunc_1_op_res_32561;\n                        \n                        if (x_32558) {\n                            defunc_1_op_res_32561 = x_32559;\n                        } else {\n                            int64_t defunc_1_op_res_32562 = add64(x_32557,\n                                                                  x_32559);\n                            \n                            defunc_1_op_res_32561 = defunc_1_op_res_32562;\n                        }\n                        prefix_32534 = defunc_1_op_res_32560;\n                        prefix_32535 = defunc_1_op_res_32561;\n                    }\n                    mem_fence_local();\n                    readOffset_32537 = ((__local\n                                         int32_t *) local_mem_32488)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32478 == 0) {\n                bool x_32563 = prefix_32534;\n                int64_t x_32564 = prefix_32535;\n                bool x_32565 = acc_32522;\n                int64_t x_32566 = acc_32523;\n                bool defunc_1_op_res_32567 = x_32563 || x_32565;\n                int64_t defunc_1_op_res_32568;\n                \n                if (x_32565) {\n                    defunc_1_op_res_32568 = x_32566;",
            "\n                } else {\n                    int64_t defunc_1_op_res_32569 = add64(x_32564, x_32566);\n                    \n                    defunc_1_op_res_32568 = defunc_1_op_res_32569;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_32462)[dynamic_id_32499] =\n                    defunc_1_op_res_32567;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32466)[dynamic_id_32499] =\n                    defunc_1_op_res_32568;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32458)[dynamic_id_32499] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_32488)[warp_byte_offset_32485] =\n                    prefix_32534;\n                ((__local\n                  int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                      (int64_t) 8)] =\n                    prefix_32535;\n                acc_32522 = 0;\n                acc_32523 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32499 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32534 = ((__local\n                             bool *) local_mem_32488)[warp_byte_offset_32485];\n            prefix_32535 = ((__local\n                             int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_32570;\n        bool x_32572;\n        bool x_32577;\n        \n        x_32577 = prefix_32534;\n        \n        bool x_32579;\n        \n        x_32579 = acc_32522;\n        \n        int64_t x_32571;\n        int64_t x_32573;\n        int64_t x_32578;\n        \n        x_32578 = prefix_32535;\n        \n        int64_t x_32580;\n        \n        x_32580 = acc_32523;\n        \n        bool de",
            "func_1_op_res_32581;\n        \n        defunc_1_op_res_32581 = x_32577 || x_32579;\n        \n        int64_t defunc_1_op_res_32582;\n        \n        if (x_32579) {\n            defunc_1_op_res_32582 = x_32580;\n        } else {\n            int64_t defunc_1_op_res_32583 = add64(x_32578, x_32580);\n            \n            defunc_1_op_res_32582 = defunc_1_op_res_32583;\n        }\n        x_32570 = defunc_1_op_res_32581;\n        x_32571 = defunc_1_op_res_32582;\n        for (int64_t i_32584 = 0; i_32584 < (int64_t) 9; i_32584++) {\n            x_32572 = private_mem_32501[i_32584];\n            x_32573 = private_mem_32503[i_32584];\n            \n            bool defunc_1_op_res_32574;\n            \n            defunc_1_op_res_32574 = x_32570 || x_32572;\n            \n            int64_t defunc_1_op_res_32575;\n            \n            if (x_32572) {\n                defunc_1_op_res_32575 = x_32573;\n            } else {\n                int64_t defunc_1_op_res_32576 = add64(x_32571, x_32573);\n                \n                defunc_1_op_res_32575 = defunc_1_op_res_32576;\n            }\n            private_mem_32501[i_32584] = defunc_1_op_res_32574;\n            private_mem_32503[i_32584] = defunc_1_op_res_32575;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32585 = 0; i_32585 < (int64_t) 9; i_32585++) {\n            int64_t sharedIdx_32586 = sext_i32_i64(local_tid_32478 * 9) +\n                    i_32585;\n            \n            ((__local bool *) local_mem_32488)[sharedIdx_32586] =\n                private_mem_32501[i_32585];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32587 = 0; i_32587 < (int64_t) 9; i_32587++) {\n            int32_t sharedIdx_32588 = local_tid_32478 +\n                    sext_i64_i32(segscan_group_sizze_30286 * i_32587);\n            \n            private_mem_32501[i_32587] = ((__local\n                                           bool *) local_mem_32488)[sext_i32_i64(sharedIdx_32588",
            ")];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32589 = 0; i_32589 < (int64_t) 9; i_32589++) {\n            int64_t sharedIdx_32590 = sext_i32_i64(local_tid_32478 * 9) +\n                    i_32589;\n            \n            ((__local int64_t *) local_mem_32488)[sharedIdx_32590] =\n                private_mem_32503[i_32589];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32591 = 0; i_32591 < (int64_t) 9; i_32591++) {\n            int32_t sharedIdx_32592 = local_tid_32478 +\n                    sext_i64_i32(segscan_group_sizze_30286 * i_32591);\n            \n            private_mem_32503[i_32591] = ((__local\n                                           int64_t *) local_mem_32488)[sext_i32_i64(sharedIdx_32592)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32593 = 0; i_32593 < (int64_t) 9; i_32593++) {\n            int64_t gtid_30290 = blockOff_32500 + segscan_group_sizze_30286 *\n                    i_32593 + sext_i32_i64(local_tid_32478);\n            \n            if (slt64(gtid_30290, implz2081U_28671)) {\n                ((__global bool *) mem_31956)[gtid_30290] =\n                    private_mem_32501[i_32593];\n            }\n        }\n        for (int64_t i_32594 = 0; i_32594 < (int64_t) 9; i_32594++) {\n            int64_t gtid_30290 = blockOff_32500 + segscan_group_sizze_30286 *\n                    i_32594 + sext_i32_i64(local_tid_32478);\n            \n            if (slt64(gtid_30290, implz2081U_28671)) {\n                ((__global int64_t *) mem_31958)[gtid_30290] =\n                    private_mem_32503[i_32594];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32499 == sdiv_up64(implz2081U_28671,\n                                          segscan_group_sizze_30286 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              in",
            "t32_t *) test_mkSegsFromSort_segIndziid_counter_mem_32456)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30286\n}\n__kernel void test_mkSegsFromSort_segIndzisegscan_30299(__global\n                                                        int *global_failure,\n                                                        uint local_mem_32615_backing_offset_0,\n                                                        int64_t implz2081U_28671,\n                                                        __global\n                                                        unsigned char *mem_31953,\n                                                        __global\n                                                        unsigned char *mem_31961,\n                                                        __global\n                                                        unsigned char *test_mkSegsFromSort_segIndziid_counter_mem_32598,\n                                                        __global\n                                                        unsigned char *status_flags_mem_32600,\n                                                        __global\n                                                        unsigned char *aggregates_mem_32602,\n                                                        __global\n                                                        unsigned char *incprefixes_mem_32604)\n{\n    #define segscan_group_sizze_30294 (test_mkSegsFromSort_segIndzisegscan_group_sizze_30293)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32615_backing_0 =\n                  &shared_mem[local_mem_32615_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32606;\n    int32_t local_tid_32607;\n    int64_t group_sizze_32610;\n    int32_t wave_sizze_32609;\n    int32_t group_tid_32608;\n    \n    global_tid_32606 = get_global_i",
            "d(0);\n    local_tid_32607 = get_local_id(0);\n    group_sizze_32610 = get_local_size(0);\n    wave_sizze_32609 = LOCKSTEP_WIDTH;\n    group_tid_32608 = get_group_id(0);\n    \n    int32_t phys_tid_30299;\n    \n    phys_tid_30299 = global_tid_32606;\n    \n    int64_t byte_offsets_32611;\n    \n    byte_offsets_32611 = (int64_t) 0;\n    \n    int64_t byte_offsets_32612;\n    \n    byte_offsets_32612 = segscan_group_sizze_30294 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32613;\n    \n    warp_byte_offset_32613 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32614;\n    \n    warp_byte_offset_32614 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32615;\n    \n    local_mem_32615 = (__local char *) local_mem_32615_backing_0;\n    \n    int64_t trans_arr_len_32616;\n    \n    trans_arr_len_32616 = (int64_t) 9 * segscan_group_sizze_30294;\n    \n    int32_t dynamic_id_32623;\n    \n    if (local_tid_32607 == 0) {\n        dynamic_id_32623 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segIndziid_counter_mem_32598)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32615)[(int64_t) 0] = dynamic_id_32623;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32623 = ((__local int32_t *) local_mem_32615)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32624;\n    \n    blockOff_32624 = sext_i32_i64(dynamic_id_32623) * (int64_t) 9 *\n        segscan_group_sizze_30294;\n    \n    int64_t private_mem_32625[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32627 = 0; i_32627 < (int64_t) 9; i_32627++) {\n            int64_t gtid_30298 = blockOff_32624 +\n                    sext_i32_i64(local_tid_32607) + i_32627 *\n                    segscan_group_sizze_30294;\n            \n            if (slt64(gtid_30298, implz2081U_28671)) {\n                int64_t i_p_o_31849 = add64((int64_t) 1, gtid_3",
            "0298);\n                int64_t rot_i_31850 = smod64(i_p_o_31849, implz2081U_28671);\n                bool x_28704 = ((__global bool *) mem_31953)[rot_i_31850];\n                int64_t defunc_0_f_res_28705 = btoi_bool_i64(x_28704);\n                \n                private_mem_32625[i_32627] = defunc_0_f_res_28705;\n            } else {\n                private_mem_32625[i_32627] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32628 = 0; i_32628 < (int64_t) 9; i_32628++) {\n            int64_t sharedIdx_32629 = sext_i32_i64(local_tid_32607) + i_32628 *\n                    segscan_group_sizze_30294;\n            \n            ((__local int64_t *) local_mem_32615)[sharedIdx_32629] =\n                private_mem_32625[i_32628];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32630 = 0; i_32630 < 9; i_32630++) {\n            int32_t sharedIdx_32631 = local_tid_32607 * 9 + i_32630;\n            \n            private_mem_32625[sext_i32_i64(i_32630)] = ((__local\n                                                         int64_t *) local_mem_32615)[sext_i32_i64(sharedIdx_32631)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32632 = 0; i_32632 < (int64_t) 8; i_32632++) {\n            int64_t x_28701;\n            int64_t x_28702;\n            \n            x_28701 = private_mem_32625[i_32632];\n            x_28702 = private_mem_32625[i_32632 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28703;\n            \n            defunc_1_op_res_28703 = add64(x_28701, x_28702);\n            private_mem_32625[i_32632 + (int64_t) 1] = defunc_1_op_res_28703;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64",
            "(local_tid_32607)] =\n            private_mem_32625[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32636;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32633;\n        int64_t x_32634;\n        int64_t x_32637;\n        int64_t x_32638;\n        bool ltid_in_bounds_32640;\n        \n        ltid_in_bounds_32640 = slt64(sext_i32_i64(local_tid_32607),\n                                     segscan_group_sizze_30294);\n        \n        int32_t skip_threads_32641;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32640) {\n                x_32634 = ((volatile __local\n                            int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32607)];\n                if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) ==\n                    0) {\n                    x_32633 = x_32634;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32641 = 1;\n            while (slt32(skip_threads_32641, 32)) {\n                if (sle32(skip_threads_32641, local_tid_32607 -\n                          squot32(local_tid_32607, 32) * 32) &&\n                    ltid_in_bounds_32640) {\n                    // read operands\n                    {\n                        x_32633 = ((volatile __local\n                                    int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32607) -\n                                                                 sext_i32_i64(skip_threads_32641))];\n                    }\n                    // perform operation\n                    {\n               ",
            "         int64_t defunc_1_op_res_32635 = add64(x_32633, x_32634);\n                        \n                        x_32633 = defunc_1_op_res_32635;\n                    }\n                }\n                if (sle32(wave_sizze_32609, skip_threads_32641)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32641, local_tid_32607 -\n                          squot32(local_tid_32607, 32) * 32) &&\n                    ltid_in_bounds_32640) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32607)] =\n                            x_32633;\n                        x_32634 = x_32633;\n                    }\n                }\n                if (sle32(wave_sizze_32609, skip_threads_32641)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32641 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) == 31 &&\n                ltid_in_bounds_32640) {\n                ((volatile __local\n                  int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32607,\n                                                                   32))] =\n                    x_32633;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32642;\n            \n            // read in",
            "put for in-block scan\n            {\n                if (squot32(local_tid_32607, 32) == 0 && ltid_in_bounds_32640) {\n                    x_32638 = ((volatile __local\n                                int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32607)];\n                    if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) ==\n                        0) {\n                        x_32637 = x_32638;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32642 = 1;\n                while (slt32(skip_threads_32642, 32)) {\n                    if (sle32(skip_threads_32642, local_tid_32607 -\n                              squot32(local_tid_32607, 32) * 32) &&\n                        (squot32(local_tid_32607, 32) == 0 &&\n                         ltid_in_bounds_32640)) {\n                        // read operands\n                        {\n                            x_32637 = ((volatile __local\n                                        int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32607) -\n                                                                     sext_i32_i64(skip_threads_32642))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32639 = add64(x_32637,\n                                                                  x_32638);\n                            \n                            x_32637 = defunc_1_op_res_32639;\n                        }\n                    }\n                    if (sle32(wave_sizze_32",
            "609, skip_threads_32642)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32642, local_tid_32607 -\n                              squot32(local_tid_32607, 32) * 32) &&\n                        (squot32(local_tid_32607, 32) == 0 &&\n                         ltid_in_bounds_32640)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32607)] =\n                                x_32637;\n                            x_32638 = x_32637;\n                        }\n                    }\n                    if (sle32(wave_sizze_32609, skip_threads_32642)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32642 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32607, 32) == 0 || !ltid_in_bounds_32640)) {\n                // read operands\n                {\n                    x_32634 = x_32633;\n                    x_32633 = ((__local\n                                int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32607,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32635 = add64(x_32633, x_32634);\n          ",
            "          \n                    x_32633 = defunc_1_op_res_32635;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32607)] =\n                        x_32633;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32607, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32607)] =\n                    x_32634;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32607 == 0) {\n            acc_32636 = ((__local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30294 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32636 = ((__local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32607) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32643;\n    \n    prefix_32643 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32623 == (int64_t) 0 && local_tid_32607 == 0) {\n            ((volatile ",
            "__global\n              int64_t *) incprefixes_mem_32604)[dynamic_id_32623] = acc_32636;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32600)[dynamic_id_32623] = (int8_t) 2;\n            acc_32636 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32623 == (int64_t) 0) && slt32(local_tid_32607,\n                                                        wave_sizze_32609)) {\n            if (local_tid_32607 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32602)[dynamic_id_32623] =\n                    acc_32636;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32600)[dynamic_id_32623] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32615)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32600)[dynamic_id_32623 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32644;\n            \n            status_32644 = ((__local int8_t *) local_mem_32615)[(int64_t) 0];\n            if (status_32644 == (int8_t) 2) {\n                if (local_tid_32607 == 0) {\n                    prefix_32643 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32604)[dynamic_id_32623 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32645 = dynamic_id_32623 -\n                        sext_i32_i64(wave_sizze_32609);\n                \n                while (slt32(wave_sizze_32609 * -1, readOffset_32645)) {\n                    int32_t read_i_32646 = readOffset_32645 + local_tid_32607;\n                    int64_t aggr_32647 = (int64_t) 0;\n               ",
            "     int8_t flag_32648 = (int8_t) 0;\n                    int8_t used_32649 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32646)) {\n                        flag_32648 = ((volatile __global\n                                       int8_t *) status_flags_mem_32600)[sext_i32_i64(read_i_32646)];\n                        if (flag_32648 == (int8_t) 2) {\n                            aggr_32647 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32604)[sext_i32_i64(read_i_32646)];\n                        } else {\n                            if (flag_32648 == (int8_t) 1) {\n                                aggr_32647 = ((volatile __global\n                                               int64_t *) aggregates_mem_32602)[sext_i32_i64(read_i_32646)];\n                                used_32649 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32607)] =\n                        aggr_32647;\n                    \n                    int8_t tmp_32650;\n                    \n                    tmp_32650 = flag_32648 | used_32649 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32615)[sext_i32_i64(local_tid_32607)] =\n                        tmp_32650;\n                    mem_fence_local();\n                    flag_32648 = ((volatile __local\n                                   int8_t *) local_mem_32615)[sext_i32_i64(wave_sizze_32609) -\n                                                              (int64_t) 1];\n                    if (local_tid_32607 == 0) {\n                        if (!(flag_32648 == (int8_t) 2)) {\n                            int64_t x_32651 = (int64_t) 0;\n                          ",
            "  int64_t x_32652;\n                            int8_t flag1_32654;\n                            \n                            flag1_32654 = (int8_t) 0;\n                            \n                            int8_t flag2_32655;\n                            int8_t used1_32656;\n                            \n                            used1_32656 = (int8_t) 0;\n                            \n                            int8_t used2_32657;\n                            \n                            for (int32_t i_32658 = 0; i_32658 <\n                                 wave_sizze_32609; i_32658++) {\n                                flag2_32655 = ((__local\n                                                int8_t *) local_mem_32615)[sext_i32_i64(i_32658)];\n                                used2_32657 = lshr8(flag2_32655, (int8_t) 2);\n                                flag2_32655 = flag2_32655 & (int8_t) 3;\n                                x_32652 = ((__local\n                                            int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32658)];\n                                if (!(flag2_32655 == (int8_t) 1)) {\n                                    flag1_32654 = flag2_32655;\n                                    used1_32656 = used2_32657;\n                                    x_32651 = x_32652;\n                                } else {\n                                    used1_32656 += used2_32657;\n                                    \n                                    int64_t defunc_1_op_res_32653;\n                                    \n                                    defunc_1_op_res_32653 = add64(x_32651,\n                                                                  x_32652);\n                                    x_32651 = defunc_1_op_res_32653;\n                                }\n       ",
            "                     }\n                            flag_32648 = flag1_32654;\n                            used_32649 = used1_32656;\n                            aggr_32647 = x_32651;\n                        } else {\n                            aggr_32647 = ((__local\n                                           int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32609) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32648 == (int8_t) 2) {\n                            readOffset_32645 = wave_sizze_32609 * -1;\n                        } else {\n                            readOffset_32645 -= zext_i8_i32(used_32649);\n                        }\n                        ((__local int32_t *) local_mem_32615)[(int64_t) 0] =\n                            readOffset_32645;\n                        \n                        int64_t x_32659;\n                        \n                        x_32659 = aggr_32647;\n                        \n                        int64_t x_32660;\n                        \n                        x_32660 = prefix_32643;\n                        \n                        int64_t defunc_1_op_res_32661;\n                        \n                        defunc_1_op_res_32661 = add64(x_32659, x_32660);\n                        prefix_32643 = defunc_1_op_res_32661;\n                    }\n                    mem_fence_local();\n                    readOffset_32645 = ((__local\n                                         int32_t *) local_mem_32615)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32607 == 0) {\n                int64_t x_32662 = prefix_32643;\n                int64_t x_32663 = acc_32636;\n                int64_t defunc_1_op_res_32664 = add64(x_32662, x_",
            "32663);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32604)[dynamic_id_32623] =\n                    defunc_1_op_res_32664;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32600)[dynamic_id_32623] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                      (int64_t) 8)] =\n                    prefix_32643;\n                acc_32636 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32623 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32643 = ((__local\n                             int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32665;\n        int64_t x_32666;\n        int64_t x_32668;\n        \n        x_32668 = prefix_32643;\n        \n        int64_t x_32669;\n        \n        x_32669 = acc_32636;\n        \n        int64_t defunc_1_op_res_32670;\n        \n        defunc_1_op_res_32670 = add64(x_32668, x_32669);\n        x_32665 = defunc_1_op_res_32670;\n        for (int64_t i_32671 = 0; i_32671 < (int64_t) 9; i_32671++) {\n            x_32666 = private_mem_32625[i_32671];\n            \n            int64_t defunc_1_op_res_32667;\n            \n            defunc_1_op_res_32667 = add64(x_32665, x_32666);\n            private_mem_32625[i_32671] = defunc_1_op_res_32667;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32672 = 0; i_32672 < (int64_t) 9; i_32672++) {\n            int64_t sharedIdx_32673 = sext_i32_i64(local_tid_32607 * 9) +\n                    i_32672;\n            \n            ((__local int64_t *) local_mem_32615)[share",
            "dIdx_32673] =\n                private_mem_32625[i_32672];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32674 = 0; i_32674 < (int64_t) 9; i_32674++) {\n            int32_t sharedIdx_32675 = local_tid_32607 +\n                    sext_i64_i32(segscan_group_sizze_30294 * i_32674);\n            \n            private_mem_32625[i_32674] = ((__local\n                                           int64_t *) local_mem_32615)[sext_i32_i64(sharedIdx_32675)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32676 = 0; i_32676 < (int64_t) 9; i_32676++) {\n            int64_t gtid_30298 = blockOff_32624 + segscan_group_sizze_30294 *\n                    i_32676 + sext_i32_i64(local_tid_32607);\n            \n            if (slt64(gtid_30298, implz2081U_28671)) {\n                ((__global int64_t *) mem_31961)[gtid_30298] =\n                    private_mem_32625[i_32676];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32623 == sdiv_up64(implz2081U_28671,\n                                          segscan_group_sizze_30294 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_mkSegsFromSort_segIndziid_counter_mem_32598)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30294\n}\n__kernel void test_mkSegsFromSort_segIndzisegscan_30313(__global\n                                                        int *global_failure,\n                                                        uint local_mem_32711_backing_offset_0,\n                                                        int64_t num_segments_28706,\n                                                        __global\n                                                        unsigned char *mem_31963,\n                                                        __",
            "global\n                                                        unsigned char *mem_31967,\n                                                        __global\n                                                        unsigned char *test_mkSegsFromSort_segIndziid_counter_mem_32694,\n                                                        __global\n                                                        unsigned char *status_flags_mem_32696,\n                                                        __global\n                                                        unsigned char *aggregates_mem_32698,\n                                                        __global\n                                                        unsigned char *incprefixes_mem_32700)\n{\n    #define segscan_group_sizze_30308 (test_mkSegsFromSort_segIndzisegscan_group_sizze_30307)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32711_backing_0 =\n                  &shared_mem[local_mem_32711_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32702;\n    int32_t local_tid_32703;\n    int64_t group_sizze_32706;\n    int32_t wave_sizze_32705;\n    int32_t group_tid_32704;\n    \n    global_tid_32702 = get_global_id(0);\n    local_tid_32703 = get_local_id(0);\n    group_sizze_32706 = get_local_size(0);\n    wave_sizze_32705 = LOCKSTEP_WIDTH;\n    group_tid_32704 = get_group_id(0);\n    \n    int32_t phys_tid_30313;\n    \n    phys_tid_30313 = global_tid_32702;\n    \n    int64_t byte_offsets_32707;\n    \n    byte_offsets_32707 = (int64_t) 0;\n    \n    int64_t byte_offsets_32708;\n    \n    byte_offsets_32708 = segscan_group_sizze_30308 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32709;\n    \n    warp_byte_offset_32709 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32710;\n    \n    warp_byte_offset_32710 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32711;\n    ",
            "\n    local_mem_32711 = (__local char *) local_mem_32711_backing_0;\n    \n    int64_t trans_arr_len_32712;\n    \n    trans_arr_len_32712 = (int64_t) 9 * segscan_group_sizze_30308;\n    \n    int32_t dynamic_id_32719;\n    \n    if (local_tid_32703 == 0) {\n        dynamic_id_32719 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segIndziid_counter_mem_32694)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32711)[(int64_t) 0] = dynamic_id_32719;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32719 = ((__local int32_t *) local_mem_32711)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32720;\n    \n    blockOff_32720 = sext_i32_i64(dynamic_id_32719) * (int64_t) 9 *\n        segscan_group_sizze_30308;\n    \n    int64_t private_mem_32721[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32723 = 0; i_32723 < (int64_t) 9; i_32723++) {\n            int64_t gtid_30312 = blockOff_32720 +\n                    sext_i32_i64(local_tid_32703) + i_32723 *\n                    segscan_group_sizze_30308;\n            \n            if (slt64(gtid_30312, num_segments_28706)) {\n                int64_t x_28727 = ((__global int64_t *) mem_31963)[gtid_30312];\n                \n                private_mem_32721[i_32723] = x_28727;\n            } else {\n                private_mem_32721[i_32723] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32724 = 0; i_32724 < (int64_t) 9; i_32724++) {\n            int64_t sharedIdx_32725 = sext_i32_i64(local_tid_32703) + i_32724 *\n                    segscan_group_sizze_30308;\n            \n            ((__local int64_t *) local_mem_32711)[sharedIdx_32725] =\n                private_mem_32721[i_32724];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32726 = 0; i_32726 < 9; i_32726++)",
            " {\n            int32_t sharedIdx_32727 = local_tid_32703 * 9 + i_32726;\n            \n            private_mem_32721[sext_i32_i64(i_32726)] = ((__local\n                                                         int64_t *) local_mem_32711)[sext_i32_i64(sharedIdx_32727)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32728 = 0; i_32728 < (int64_t) 8; i_32728++) {\n            int64_t x_28724;\n            int64_t x_28725;\n            \n            x_28724 = private_mem_32721[i_32728];\n            x_28725 = private_mem_32721[i_32728 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28726;\n            \n            defunc_1_op_res_28726 = add64(x_28724, x_28725);\n            private_mem_32721[i_32728 + (int64_t) 1] = defunc_1_op_res_28726;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32703)] =\n            private_mem_32721[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32732;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32729;\n        int64_t x_32730;\n        int64_t x_32733;\n        int64_t x_32734;\n        bool ltid_in_bounds_32736;\n        \n        ltid_in_bounds_32736 = slt64(sext_i32_i64(local_tid_32703),\n                                     segscan_group_sizze_30308);\n        \n        int32_t skip_threads_32737;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32736) {\n                x_32730 = ((volatile __local\n                            int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32703)];\n                if ((l",
            "ocal_tid_32703 - squot32(local_tid_32703, 32) * 32) ==\n                    0) {\n                    x_32729 = x_32730;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32737 = 1;\n            while (slt32(skip_threads_32737, 32)) {\n                if (sle32(skip_threads_32737, local_tid_32703 -\n                          squot32(local_tid_32703, 32) * 32) &&\n                    ltid_in_bounds_32736) {\n                    // read operands\n                    {\n                        x_32729 = ((volatile __local\n                                    int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32703) -\n                                                                 sext_i32_i64(skip_threads_32737))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32731 = add64(x_32729, x_32730);\n                        \n                        x_32729 = defunc_1_op_res_32731;\n                    }\n                }\n                if (sle32(wave_sizze_32705, skip_threads_32737)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32737, local_tid_32703 -\n                          squot32(local_tid_32703, 32) * 32) &&\n                    ltid_in_bounds_32736) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32703)] =\n                            x_32729;\n                        x_32730 = x_32729;\n  ",
            "                  }\n                }\n                if (sle32(wave_sizze_32705, skip_threads_32737)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32737 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32703 - squot32(local_tid_32703, 32) * 32) == 31 &&\n                ltid_in_bounds_32736) {\n                ((volatile __local\n                  int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32703,\n                                                                   32))] =\n                    x_32729;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32738;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32703, 32) == 0 && ltid_in_bounds_32736) {\n                    x_32734 = ((volatile __local\n                                int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32703)];\n                    if ((local_tid_32703 - squot32(local_tid_32703, 32) * 32) ==\n                        0) {\n                        x_32733 = x_32734;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32738 = 1;\n                while (slt32(skip_threads_32738, 32)) {\n                    if (sle32(skip_threads_32738, local_tid_32703 -\n                              squot32(local_tid_32",
            "703, 32) * 32) &&\n                        (squot32(local_tid_32703, 32) == 0 &&\n                         ltid_in_bounds_32736)) {\n                        // read operands\n                        {\n                            x_32733 = ((volatile __local\n                                        int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32703) -\n                                                                     sext_i32_i64(skip_threads_32738))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32735 = add64(x_32733,\n                                                                  x_32734);\n                            \n                            x_32733 = defunc_1_op_res_32735;\n                        }\n                    }\n                    if (sle32(wave_sizze_32705, skip_threads_32738)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32738, local_tid_32703 -\n                              squot32(local_tid_32703, 32) * 32) &&\n                        (squot32(local_tid_32703, 32) == 0 &&\n                         ltid_in_bounds_32736)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32703)] =\n                                x_32733;\n                            x_32734 = x_32733;\n                        }\n                    }\n                    if (sle32(wave_sizze_32705, skip_threads_3273",
            "8)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32738 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32703, 32) == 0 || !ltid_in_bounds_32736)) {\n                // read operands\n                {\n                    x_32730 = x_32729;\n                    x_32729 = ((__local\n                                int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32703,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32731 = add64(x_32729, x_32730);\n                    \n                    x_32729 = defunc_1_op_res_32731;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32703)] =\n                        x_32729;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32703, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32703)] =\n                    x_32730;\n            }\n     ",
            "   }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32703 == 0) {\n            acc_32732 = ((__local\n                          int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30308 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32732 = ((__local\n                          int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32703) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32739;\n    \n    prefix_32739 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32719 == (int64_t) 0 && local_tid_32703 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32700)[dynamic_id_32719] = acc_32732;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32696)[dynamic_id_32719] = (int8_t) 2;\n            acc_32732 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32719 == (int64_t) 0) && slt32(local_tid_32703,\n                                                        wave_sizze_32705)) {\n            if (local_tid_32703 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32698)[dynamic_id_32719] =\n                    acc_32732;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32696)[dynamic_id_32719] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32711)[(int64_t) 0] = ((__global\n                                                              ",
            "        int8_t *) status_flags_mem_32696)[dynamic_id_32719 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32740;\n            \n            status_32740 = ((__local int8_t *) local_mem_32711)[(int64_t) 0];\n            if (status_32740 == (int8_t) 2) {\n                if (local_tid_32703 == 0) {\n                    prefix_32739 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32700)[dynamic_id_32719 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32741 = dynamic_id_32719 -\n                        sext_i32_i64(wave_sizze_32705);\n                \n                while (slt32(wave_sizze_32705 * -1, readOffset_32741)) {\n                    int32_t read_i_32742 = readOffset_32741 + local_tid_32703;\n                    int64_t aggr_32743 = (int64_t) 0;\n                    int8_t flag_32744 = (int8_t) 0;\n                    int8_t used_32745 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32742)) {\n                        flag_32744 = ((volatile __global\n                                       int8_t *) status_flags_mem_32696)[sext_i32_i64(read_i_32742)];\n                        if (flag_32744 == (int8_t) 2) {\n                            aggr_32743 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32700)[sext_i32_i64(read_i_32742)];\n                        } else {\n                            if (flag_32744 == (int8_t) 1) {\n                                aggr_32743 = ((volatile __global\n                                               int64_t *) aggregates_mem_32698)[sext_i32_i64(read_i_32742)];\n                                used_32745 = (int8_t) 1;\n                            }\n                        }\n  ",
            "                  }\n                    ((__local\n                      int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32703)] =\n                        aggr_32743;\n                    \n                    int8_t tmp_32746;\n                    \n                    tmp_32746 = flag_32744 | used_32745 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32711)[sext_i32_i64(local_tid_32703)] =\n                        tmp_32746;\n                    mem_fence_local();\n                    flag_32744 = ((volatile __local\n                                   int8_t *) local_mem_32711)[sext_i32_i64(wave_sizze_32705) -\n                                                              (int64_t) 1];\n                    if (local_tid_32703 == 0) {\n                        if (!(flag_32744 == (int8_t) 2)) {\n                            int64_t x_32747 = (int64_t) 0;\n                            int64_t x_32748;\n                            int8_t flag1_32750;\n                            \n                            flag1_32750 = (int8_t) 0;\n                            \n                            int8_t flag2_32751;\n                            int8_t used1_32752;\n                            \n                            used1_32752 = (int8_t) 0;\n                            \n                            int8_t used2_32753;\n                            \n                            for (int32_t i_32754 = 0; i_32754 <\n                                 wave_sizze_32705; i_32754++) {\n                                flag2_32751 = ((__local\n                                                int8_t *) local_mem_32711)[sext_i32_i64(i_32754)];\n                                used2_32753 = lshr8(flag2_32751, (int8_t) 2);\n                                flag2_32751 = flag2_32751 & (int8_t) 3;\n                           ",
            "     x_32748 = ((__local\n                                            int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32754)];\n                                if (!(flag2_32751 == (int8_t) 1)) {\n                                    flag1_32750 = flag2_32751;\n                                    used1_32752 = used2_32753;\n                                    x_32747 = x_32748;\n                                } else {\n                                    used1_32752 += used2_32753;\n                                    \n                                    int64_t defunc_1_op_res_32749;\n                                    \n                                    defunc_1_op_res_32749 = add64(x_32747,\n                                                                  x_32748);\n                                    x_32747 = defunc_1_op_res_32749;\n                                }\n                            }\n                            flag_32744 = flag1_32750;\n                            used_32745 = used1_32752;\n                            aggr_32743 = x_32747;\n                        } else {\n                            aggr_32743 = ((__local\n                                           int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32705) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32744 == (int8_t) 2) {\n                            readOffset_32741 = wave_sizze_32705 * -1;\n                        } else {\n                            readOffset_32741 -= zext_i8_i32(used_32745);\n            ",
            "            }\n                        ((__local int32_t *) local_mem_32711)[(int64_t) 0] =\n                            readOffset_32741;\n                        \n                        int64_t x_32755;\n                        \n                        x_32755 = aggr_32743;\n                        \n                        int64_t x_32756;\n                        \n                        x_32756 = prefix_32739;\n                        \n                        int64_t defunc_1_op_res_32757;\n                        \n                        defunc_1_op_res_32757 = add64(x_32755, x_32756);\n                        prefix_32739 = defunc_1_op_res_32757;\n                    }\n                    mem_fence_local();\n                    readOffset_32741 = ((__local\n                                         int32_t *) local_mem_32711)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32703 == 0) {\n                int64_t x_32758 = prefix_32739;\n                int64_t x_32759 = acc_32732;\n                int64_t defunc_1_op_res_32760 = add64(x_32758, x_32759);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32700)[dynamic_id_32719] =\n                    defunc_1_op_res_32760;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32696)[dynamic_id_32719] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                      (int64_t) 8)] =\n                    prefix_32739;\n                acc_32732 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32719 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32739 = ((__local\n                             int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                 (int64_t) 8)];\n ",
            "           barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32761;\n        int64_t x_32762;\n        int64_t x_32764;\n        \n        x_32764 = prefix_32739;\n        \n        int64_t x_32765;\n        \n        x_32765 = acc_32732;\n        \n        int64_t defunc_1_op_res_32766;\n        \n        defunc_1_op_res_32766 = add64(x_32764, x_32765);\n        x_32761 = defunc_1_op_res_32766;\n        for (int64_t i_32767 = 0; i_32767 < (int64_t) 9; i_32767++) {\n            x_32762 = private_mem_32721[i_32767];\n            \n            int64_t defunc_1_op_res_32763;\n            \n            defunc_1_op_res_32763 = add64(x_32761, x_32762);\n            private_mem_32721[i_32767] = defunc_1_op_res_32763;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32768 = 0; i_32768 < (int64_t) 9; i_32768++) {\n            int64_t sharedIdx_32769 = sext_i32_i64(local_tid_32703 * 9) +\n                    i_32768;\n            \n            ((__local int64_t *) local_mem_32711)[sharedIdx_32769] =\n                private_mem_32721[i_32768];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32770 = 0; i_32770 < (int64_t) 9; i_32770++) {\n            int32_t sharedIdx_32771 = local_tid_32703 +\n                    sext_i64_i32(segscan_group_sizze_30308 * i_32770);\n            \n            private_mem_32721[i_32770] = ((__local\n                                           int64_t *) local_mem_32711)[sext_i32_i64(sharedIdx_32771)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32772 = 0; i_32772 < (int64_t) 9; i_32772++) {\n            int64_t gtid_30312 = blockOff_32720 + segscan_group_sizze_30308 *\n                    i_32772 + sext_i32_i64(local_tid_32703);\n            \n            if (slt64(gtid_30312, num_segments_28706)) {\n                ((__global int64_t *) mem_31967)[gtid_30312] =\n   ",
            "                 private_mem_32721[i_32772];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32719 == sdiv_up64(num_segments_28706,\n                                          segscan_group_sizze_30308 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_mkSegsFromSort_segIndziid_counter_mem_32694)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30308\n}\n__kernel\nvoid test_mkSegsFromSort_segSizzezicopy_32773(int64_t num_segments_28781,\n                                              __global unsigned char *mem_31967,\n                                              __global unsigned char *mem_31969)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_32773;\n    int32_t copy_ltid_32774;\n    int32_t copy_gid_32775;\n    \n    copy_gtid_32773 = get_global_id(0);\n    copy_ltid_32774 = get_local_id(0);\n    copy_gid_32775 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_32773), num_segments_28781)) {\n        ((__global int64_t *) mem_31969)[sext_i32_i64(copy_gtid_32773)] =\n            ((__global\n              int64_t *) mem_31967)[smod64(sext_i32_i64(copy_gtid_32773) +\n                                           (int64_t) -1, num_segments_28781)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void test_mkSegsFromSort_segSizzezisegmap_30321(__global\n                                                         int *global_failure,\n                                                         int64_t implz2081U_28746,\n                                                         __global\n                                                         unsigned char *keys_mem_31946,\n                                                         __global\n                                                         unsigned char *mem_31950)\n{\n    #define se",
            "gmap_group_sizze_30329 (test_mkSegsFromSort_segSizzezisegmap_group_sizze_30323)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32443;\n    int32_t local_tid_32444;\n    int64_t group_sizze_32447;\n    int32_t wave_sizze_32446;\n    int32_t group_tid_32445;\n    \n    global_tid_32443 = get_global_id(0);\n    local_tid_32444 = get_local_id(0);\n    group_sizze_32447 = get_local_size(0);\n    wave_sizze_32446 = LOCKSTEP_WIDTH;\n    group_tid_32445 = get_group_id(0);\n    \n    int32_t phys_tid_30321;\n    \n    phys_tid_30321 = global_tid_32443;\n    \n    int64_t gtid_30320;\n    \n    gtid_30320 = sext_i32_i64(group_tid_32445) * segmap_group_sizze_30329 +\n        sext_i32_i64(local_tid_32444);\n    if (slt64(gtid_30320, implz2081U_28746)) {\n        int32_t x_30332 = ((__global int32_t *) keys_mem_31946)[gtid_30320];\n        int64_t defunc_0_f_res_30333 = sext_i32_i64(x_30332);\n        \n        ((__global int64_t *) mem_31950)[gtid_30320] = defunc_0_f_res_30333;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30329\n}\n__kernel void test_mkSegsFromSort_segSizzezisegmap_30335(__global\n                                                         int *global_failure,\n                                                         int64_t implz2081U_28746,\n                                                         __global\n                                                         unsigned char *mem_31950,\n                                                         __global\n                                                         unsigned char *mem_31953)\n{\n    #define segmap_group_sizze_30345 (test_mkSegsFromSort_segSizzezisegmap_group_sizze_30337)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32448;\n    int32_t local_tid_32449;\n    int64_t g",
            "roup_sizze_32452;\n    int32_t wave_sizze_32451;\n    int32_t group_tid_32450;\n    \n    global_tid_32448 = get_global_id(0);\n    local_tid_32449 = get_local_id(0);\n    group_sizze_32452 = get_local_size(0);\n    wave_sizze_32451 = LOCKSTEP_WIDTH;\n    group_tid_32450 = get_group_id(0);\n    \n    int32_t phys_tid_30335;\n    \n    phys_tid_30335 = global_tid_32448;\n    \n    int64_t gtid_30334;\n    \n    gtid_30334 = sext_i32_i64(group_tid_32450) * segmap_group_sizze_30345 +\n        sext_i32_i64(local_tid_32449);\n    if (slt64(gtid_30334, implz2081U_28746)) {\n        int64_t x_30348 = ((__global int64_t *) mem_31950)[gtid_30334];\n        int64_t i_p_o_31847 = add64((int64_t) -1, gtid_30334);\n        int64_t rot_i_31848 = smod64(i_p_o_31847, implz2081U_28746);\n        int64_t x_30349 = ((__global int64_t *) mem_31950)[rot_i_31848];\n        bool defunc_1_f_res_30350 = x_30348 == x_30349;\n        bool defunc_1_f_res_30351 = !defunc_1_f_res_30350;\n        \n        ((__global bool *) mem_31953)[gtid_30334] = defunc_1_f_res_30351;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30345\n}\n__kernel void test_mkSegsFromSort_segSizzezisegmap_30369(__global\n                                                         int *global_failure,\n                                                         int64_t implz2081U_28746,\n                                                         int64_t num_segments_28781,\n                                                         __global\n                                                         unsigned char *mem_31953,\n                                                         __global\n                                                         unsigned char *mem_31958,\n                                                         __global\n                                                         unsigned char *mem_31961,\n                                                         __global\n                                                         unsigned char *",
            "mem_31963)\n{\n    #define segmap_group_sizze_30372 (test_mkSegsFromSort_segSizzezisegmap_group_sizze_30371)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32686;\n    int32_t local_tid_32687;\n    int64_t group_sizze_32690;\n    int32_t wave_sizze_32689;\n    int32_t group_tid_32688;\n    \n    global_tid_32686 = get_global_id(0);\n    local_tid_32687 = get_local_id(0);\n    group_sizze_32690 = get_local_size(0);\n    wave_sizze_32689 = LOCKSTEP_WIDTH;\n    group_tid_32688 = get_group_id(0);\n    \n    int32_t phys_tid_30369;\n    \n    phys_tid_30369 = global_tid_32686;\n    \n    int64_t write_i_30368;\n    \n    write_i_30368 = sext_i32_i64(group_tid_32688) * segmap_group_sizze_30372 +\n        sext_i32_i64(local_tid_32687);\n    if (slt64(write_i_30368, implz2081U_28746)) {\n        int64_t i_p_o_31851 = add64((int64_t) 1, write_i_30368);\n        int64_t rot_i_31852 = smod64(i_p_o_31851, implz2081U_28746);\n        bool x_28794 = ((__global bool *) mem_31953)[rot_i_31852];\n        int64_t write_value_28795 = ((__global\n                                      int64_t *) mem_31958)[write_i_30368];\n        int64_t defunc_1_f_res_28796;\n        \n        if (x_28794) {\n            int64_t x_28793 = ((__global int64_t *) mem_31961)[write_i_30368];\n            int64_t defunc_1_f_res_t_res_28797 = sub64(x_28793, (int64_t) 1);\n            \n            defunc_1_f_res_28796 = defunc_1_f_res_t_res_28797;\n        } else {\n            defunc_1_f_res_28796 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_28796) &&\n            slt64(defunc_1_f_res_28796, num_segments_28781)) {\n            ((__global int64_t *) mem_31963)[defunc_1_f_res_28796] =\n                write_value_28795;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30372\n}\n__kernel void test_mkSegsFromSort_segSizzezisegmap_30383(__global\n                               ",
            "                          int *global_failure,\n                                                         int failure_is_an_option,\n                                                         __global\n                                                         int64_t *global_failure_args,\n                                                         int64_t implz2081U_28746,\n                                                         int64_t numKey_28747,\n                                                         int64_t num_segments_28781,\n                                                         __global\n                                                         unsigned char *keys_mem_31946,\n                                                         __global\n                                                         unsigned char *mem_31963,\n                                                         __global\n                                                         unsigned char *mem_31969,\n                                                         __global\n                                                         unsigned char *mem_31971)\n{\n    #define segmap_group_sizze_30386 (test_mkSegsFromSort_segSizzezisegmap_group_sizze_30385)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32778;\n    int32_t local_tid_32779;\n    int64_t group_sizze_32782;\n    int32_t wave_sizze_32781;\n    int32_t group_tid_32780;\n    \n    global_tid_32778 = get_global_id(0);\n    local_tid_32779 = get_local_id(0);\n    group_sizze_32782 = get_local_size(0);\n    wave_sizze_32781 = LOCKSTEP_WIDTH;\n    group_tid_32780 = get_group_id(0);\n    \n    int32_t phys_tid_30383;\n    \n    phys_tid_30383 = global_tid_32778;\n    \n    int64_t write_i_30382;\n    \n    write_i_30382 = sext_i32_i64(group_tid_32780) * segmap_group_sizze_30386 +\n        sext_i32_i64(local_tid_32779);\n    if (slt64(write_i_30382, num_se",
            "gments_28781)) {\n        int64_t x_28813 = ((__global int64_t *) mem_31969)[write_i_30382];\n        int64_t write_value_28814 = ((__global\n                                      int64_t *) mem_31963)[write_i_30382];\n        bool x_28815 = sle64((int64_t) 0, x_28813);\n        bool y_28816 = slt64(x_28813, implz2081U_28746);\n        bool bounds_check_28817 = x_28815 && y_28816;\n        bool index_certs_28818;\n        \n        if (!bounds_check_28817) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 29) == -1) {\n                    global_failure_args[0] = x_28813;\n                    global_failure_args[1] = implz2081U_28746;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int32_t i32_arg_28819 = ((__global int32_t *) keys_mem_31946)[x_28813];\n        int64_t i32_res_28820 = sext_i32_i64(i32_arg_28819);\n        \n        if (sle64((int64_t) 0, i32_res_28820) && slt64(i32_res_28820,\n                                                       numKey_28747)) {\n            ((__global int64_t *) mem_31971)[i32_res_28820] = write_value_28814;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_30386\n}\n__kernel void test_mkSegsFromSort_segSizzezisegscan_30359(__global\n                                                          int *global_failure,\n                                                          uint local_mem_32488_backing_offset_0,\n                                                          int64_t implz2081U_28746,\n                                                          __global\n                                                          unsigned char *mem_31953,\n                                                          __global\n                                                          unsigned char *mem_31956,\n                                                          __global\n                                                          unsigned char *mem_31958,\n    ",
            "                                                      __global\n                                                          unsigned char *test_mkSegsFromSort_segSizzeziid_counter_mem_32456,\n                                                          __global\n                                                          unsigned char *status_flags_mem_32458,\n                                                          __global\n                                                          unsigned char *aggregates_mem_32460,\n                                                          __global\n                                                          unsigned char *incprefixes_mem_32462,\n                                                          __global\n                                                          unsigned char *aggregates_mem_32464,\n                                                          __global\n                                                          unsigned char *incprefixes_mem_32466)\n{\n    #define segscan_group_sizze_30354 (test_mkSegsFromSort_segSizzezisegscan_group_sizze_30353)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32488_backing_0 =\n                  &shared_mem[local_mem_32488_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32477;\n    int32_t local_tid_32478;\n    int64_t group_sizze_32481;\n    int32_t wave_sizze_32480;\n    int32_t group_tid_32479;\n    \n    global_tid_32477 = get_global_id(0);\n    local_tid_32478 = get_local_id(0);\n    group_sizze_32481 = get_local_size(0);\n    wave_sizze_32480 = LOCKSTEP_WIDTH;\n    group_tid_32479 = get_group_id(0);\n    \n    int32_t phys_tid_30359;\n    \n    phys_tid_30359 = global_tid_32477;\n    \n    int64_t byte_offsets_32482;\n    \n    byte_offsets_32482 = (int64_t) 0;\n    \n    int64_t byte_offsets_32483;\n    \n    byte_offsets_32483 = segscan_group_sizze_30354;\n    \n    int64_t byte_offsets_3",
            "2484;\n    \n    byte_offsets_32484 = sdiv_up64(segscan_group_sizze_30354, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_30354 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32485;\n    \n    warp_byte_offset_32485 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32486;\n    \n    warp_byte_offset_32486 = (int64_t) 64;\n    \n    int64_t warp_byte_offset_32487;\n    \n    warp_byte_offset_32487 = (int64_t) 320;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32488;\n    \n    local_mem_32488 = (__local char *) local_mem_32488_backing_0;\n    \n    int64_t trans_arr_len_32489;\n    \n    trans_arr_len_32489 = (int64_t) 9 * segscan_group_sizze_30354;\n    \n    int32_t dynamic_id_32499;\n    \n    if (local_tid_32478 == 0) {\n        dynamic_id_32499 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segSizzeziid_counter_mem_32456)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32488)[(int64_t) 0] = dynamic_id_32499;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32499 = ((__local int32_t *) local_mem_32488)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32500;\n    \n    blockOff_32500 = sext_i32_i64(dynamic_id_32499) * (int64_t) 9 *\n        segscan_group_sizze_30354;\n    \n    bool private_mem_32501[9];\n    int64_t private_mem_32503[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32505 = 0; i_32505 < (int64_t) 9; i_32505++) {\n            int64_t gtid_30358 = blockOff_32500 +\n                    sext_i32_i64(local_tid_32478) + i_32505 *\n                    segscan_group_sizze_30354;\n            \n            if (slt64(gtid_30358, implz2081U_28746)) {\n                bool x_28772 = ((__global bool *) mem_31953)[gtid_30358];\n                \n                private_mem_32501[i_32505] = x_28772;\n                private_mem_32503[i_32505] = (int64_t) 1;\n            } else",
            " {\n                private_mem_32501[i_32505] = 0;\n                private_mem_32503[i_32505] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32506 = 0; i_32506 < (int64_t) 9; i_32506++) {\n            int64_t sharedIdx_32507 = sext_i32_i64(local_tid_32478) + i_32506 *\n                    segscan_group_sizze_30354;\n            \n            ((__local bool *) local_mem_32488)[sharedIdx_32507] =\n                private_mem_32501[i_32506];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32508 = 0; i_32508 < 9; i_32508++) {\n            int32_t sharedIdx_32509 = local_tid_32478 * 9 + i_32508;\n            \n            private_mem_32501[sext_i32_i64(i_32508)] = ((__local\n                                                         bool *) local_mem_32488)[sext_i32_i64(sharedIdx_32509)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32510 = 0; i_32510 < (int64_t) 9; i_32510++) {\n            int64_t sharedIdx_32511 = sext_i32_i64(local_tid_32478) + i_32510 *\n                    segscan_group_sizze_30354;\n            \n            ((__local int64_t *) local_mem_32488)[sharedIdx_32511] =\n                private_mem_32503[i_32510];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32512 = 0; i_32512 < 9; i_32512++) {\n            int32_t sharedIdx_32513 = local_tid_32478 * 9 + i_32512;\n            \n            private_mem_32503[sext_i32_i64(i_32512)] = ((__local\n                                                         int64_t *) local_mem_32488)[sext_i32_i64(sharedIdx_32513)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32514 = 0; i_32514 < (int64_t) 8; i_32514++) {\n            bool x_28765;\n            bool x_28767;\n            \n            x_28765 = private_mem_32501[i_32514];\n            x_28767 = private_mem_32501[i_32514 + (int64_t) 1];\n            \n           ",
            " int64_t x_28766;\n            int64_t x_28768;\n            \n            x_28766 = private_mem_32503[i_32514];\n            x_28768 = private_mem_32503[i_32514 + (int64_t) 1];\n            \n            bool defunc_1_op_res_28769;\n            \n            defunc_1_op_res_28769 = x_28765 || x_28767;\n            \n            int64_t defunc_1_op_res_28770;\n            \n            if (x_28767) {\n                defunc_1_op_res_28770 = x_28768;\n            } else {\n                int64_t defunc_1_op_res_28771 = add64(x_28766, x_28768);\n                \n                defunc_1_op_res_28770 = defunc_1_op_res_28771;\n            }\n            private_mem_32501[i_32514 + (int64_t) 1] = defunc_1_op_res_28769;\n            private_mem_32503[i_32514 + (int64_t) 1] = defunc_1_op_res_28770;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                           sext_i32_i64(local_tid_32478)] =\n            private_mem_32501[(int64_t) 8];\n        ((__local int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32478)] =\n            private_mem_32503[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool acc_32522;\n    int64_t acc_32523;\n    \n    // Scan results (with warp scan)\n    {\n        bool x_32515;\n        int64_t x_32516;\n        bool x_32517;\n        int64_t x_32518;\n        bool x_32524;\n        int64_t x_32525;\n        bool x_32526;\n        int64_t x_32527;\n        bool ltid_in_bounds_32531;\n        \n        ltid_in_bounds_32531 = slt64(sext_i32_i64(local_tid_32478),\n                                     segscan_group_sizze_30354);\n        \n        int32_t skip_threads_32532;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32531) {\n                x_32517 = ((volatile __local\n         ",
            "                   bool *) local_mem_32488)[byte_offsets_32482 +\n                                                     sext_i32_i64(local_tid_32478)];\n                x_32518 = ((volatile __local\n                            int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32478)];\n                if ((local_tid_32478 - squot32(local_tid_32478, 32) * 32) ==\n                    0) {\n                    x_32515 = x_32517;\n                    x_32516 = x_32518;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32532 = 1;\n            while (slt32(skip_threads_32532, 32)) {\n                if (sle32(skip_threads_32532, local_tid_32478 -\n                          squot32(local_tid_32478, 32) * 32) &&\n                    ltid_in_bounds_32531) {\n                    // read operands\n                    {\n                        x_32515 = ((volatile __local\n                                    bool *) local_mem_32488)[byte_offsets_32482 +\n                                                             (sext_i32_i64(local_tid_32478) -\n                                                              sext_i32_i64(skip_threads_32532))];\n                        x_32516 = ((volatile __local\n                                    int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32478) -\n                                                                 sext_i32_i64(skip_threads_32532))];\n                    }\n                    // perform operation\n                    {\n                        bool defunc_1_op_res_32519 = x_32515 || x_32517;\n                        int64_t ",
            "defunc_1_op_res_32520;\n                        \n                        if (x_32517) {\n                            defunc_1_op_res_32520 = x_32518;\n                        } else {\n                            int64_t defunc_1_op_res_32521 = add64(x_32516,\n                                                                  x_32518);\n                            \n                            defunc_1_op_res_32520 = defunc_1_op_res_32521;\n                        }\n                        x_32515 = defunc_1_op_res_32519;\n                        x_32516 = defunc_1_op_res_32520;\n                    }\n                }\n                if (sle32(wave_sizze_32480, skip_threads_32532)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32532, local_tid_32478 -\n                          squot32(local_tid_32478, 32) * 32) &&\n                    ltid_in_bounds_32531) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) local_mem_32488)[byte_offsets_32482 +\n                                                   sext_i32_i64(local_tid_32478)] =\n                            x_32515;\n                        x_32517 = x_32515;\n                        ((volatile __local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32478)] =\n                            x_32516;\n                        x_32518 = x_32516;\n                    }\n                }\n                if (sle32(wave_sizze_32480, skip_threads_32532)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32532 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ",
            "((local_tid_32478 - squot32(local_tid_32478, 32) * 32) == 31 &&\n                ltid_in_bounds_32531) {\n                ((volatile __local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                            sext_i32_i64(squot32(local_tid_32478,\n                                                                                 32))] =\n                    x_32515;\n                ((volatile __local\n                  int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32478,\n                                                                   32))] =\n                    x_32516;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32533;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32478, 32) == 0 && ltid_in_bounds_32531) {\n                    x_32526 = ((volatile __local\n                                bool *) local_mem_32488)[byte_offsets_32482 +\n                                                         sext_i32_i64(local_tid_32478)];\n                    x_32527 = ((volatile __local\n                                int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32478)];\n                    if ((local_tid_32478 - squot32(local_tid_32478, 32) * 32) ==\n                        0) {\n                        x_32524 = x_32526;\n                        x_32525 = x_32527;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_thread",
            "s_32533 = 1;\n                while (slt32(skip_threads_32533, 32)) {\n                    if (sle32(skip_threads_32533, local_tid_32478 -\n                              squot32(local_tid_32478, 32) * 32) &&\n                        (squot32(local_tid_32478, 32) == 0 &&\n                         ltid_in_bounds_32531)) {\n                        // read operands\n                        {\n                            x_32524 = ((volatile __local\n                                        bool *) local_mem_32488)[byte_offsets_32482 +\n                                                                 (sext_i32_i64(local_tid_32478) -\n                                                                  sext_i32_i64(skip_threads_32533))];\n                            x_32525 = ((volatile __local\n                                        int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32478) -\n                                                                     sext_i32_i64(skip_threads_32533))];\n                        }\n                        // perform operation\n                        {\n                            bool defunc_1_op_res_32528 = x_32524 || x_32526;\n                            int64_t defunc_1_op_res_32529;\n                            \n                            if (x_32526) {\n                                defunc_1_op_res_32529 = x_32527;\n                            } else {\n                                int64_t defunc_1_op_res_32530 = add64(x_32525,\n                                                                      x_32527);\n                                \n                                defunc_1_op_res_32529 = defunc_1_op_res_32530;\n                            }\n                            x_32524 = defunc_1_op_res_32528;\n                            x_32525 = defunc_1_op_res_",
            "32529;\n                        }\n                    }\n                    if (sle32(wave_sizze_32480, skip_threads_32533)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32533, local_tid_32478 -\n                              squot32(local_tid_32478, 32) * 32) &&\n                        (squot32(local_tid_32478, 32) == 0 &&\n                         ltid_in_bounds_32531)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) local_mem_32488)[byte_offsets_32482 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                                x_32524;\n                            x_32526 = x_32524;\n                            ((volatile __local\n                              int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32478)] =\n                                x_32525;\n                            x_32527 = x_32525;\n                        }\n                    }\n                    if (sle32(wave_sizze_32480, skip_threads_32533)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32533 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32478, 32) == 0 || !ltid_in_bounds_32531)) {\n                // read operands\n                {\n                    x_32517 = x_32515;\n                    x_32518 = x_32516;\n                    x_32515 = ((__local\n                                bool *) local_mem_32488)[byte_offsets_32482 +\n                                                         (sext_i32_i64(squot32(lo",
            "cal_tid_32478,\n                                                                               32)) -\n                                                          (int64_t) 1)];\n                    x_32516 = ((__local\n                                int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32478,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    bool defunc_1_op_res_32519 = x_32515 || x_32517;\n                    int64_t defunc_1_op_res_32520;\n                    \n                    if (x_32517) {\n                        defunc_1_op_res_32520 = x_32518;\n                    } else {\n                        int64_t defunc_1_op_res_32521 = add64(x_32516, x_32518);\n                        \n                        defunc_1_op_res_32520 = defunc_1_op_res_32521;\n                    }\n                    x_32515 = defunc_1_op_res_32519;\n                    x_32516 = defunc_1_op_res_32520;\n                }\n                // write final result\n                {\n                    ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                        x_32515;\n                    ((__local\n                      int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32478)] =\n                        x_32516;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n   ",
            "         if (squot32(local_tid_32478, 32) == 0) {\n                ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                   sext_i32_i64(local_tid_32478)] =\n                    x_32517;\n                ((__local\n                  int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32478)] =\n                    x_32518;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32478 == 0) {\n            acc_32522 = ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                           (segscan_group_sizze_30354 -\n                                                            (int64_t) 1)];\n            acc_32523 = ((__local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30354 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32522 = ((__local bool *) local_mem_32488)[byte_offsets_32482 +\n                                                           (sext_i32_i64(local_tid_32478) -\n                                                            (int64_t) 1)];\n            acc_32523 = ((__local\n                          int64_t *) local_mem_32488)[squot64(byte_offsets_32483,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32478) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    bool prefix_32534;\n    \n    prefix_32534 = 0;\n    \n    int64_t prefix_32535;\n    \n    ",
            "prefix_32535 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32499 == (int64_t) 0 && local_tid_32478 == 0) {\n            ((volatile __global\n              bool *) incprefixes_mem_32462)[dynamic_id_32499] = acc_32522;\n            ((volatile __global\n              int64_t *) incprefixes_mem_32466)[dynamic_id_32499] = acc_32523;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32458)[dynamic_id_32499] = (int8_t) 2;\n            acc_32522 = 0;\n            acc_32523 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32499 == (int64_t) 0) && slt32(local_tid_32478,\n                                                        wave_sizze_32480)) {\n            if (local_tid_32478 == 0) {\n                ((volatile __global\n                  bool *) aggregates_mem_32460)[dynamic_id_32499] = acc_32522;\n                ((volatile __global\n                  int64_t *) aggregates_mem_32464)[dynamic_id_32499] =\n                    acc_32523;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32458)[dynamic_id_32499] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32488)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32458)[dynamic_id_32499 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32536;\n            \n            status_32536 = ((__local int8_t *) local_mem_32488)[(int64_t) 0];\n            if (status_32536 == (int8_t) 2) {\n                if (local_tid_32478 == 0) {\n                    prefix_32534 = ((volatile __global\n                                     bool *) incprefixes_mem_32462)[dynamic_id_32499 -\n                                                                    (int64_t) 1];",
            "\n                    prefix_32535 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32466)[dynamic_id_32499 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32537 = dynamic_id_32499 -\n                        sext_i32_i64(wave_sizze_32480);\n                \n                while (slt32(wave_sizze_32480 * -1, readOffset_32537)) {\n                    int32_t read_i_32538 = readOffset_32537 + local_tid_32478;\n                    bool aggr_32539 = 0;\n                    int64_t aggr_32540 = (int64_t) 0;\n                    int8_t flag_32541 = (int8_t) 0;\n                    int8_t used_32542 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32538)) {\n                        flag_32541 = ((volatile __global\n                                       int8_t *) status_flags_mem_32458)[sext_i32_i64(read_i_32538)];\n                        if (flag_32541 == (int8_t) 2) {\n                            aggr_32539 = ((volatile __global\n                                           bool *) incprefixes_mem_32462)[sext_i32_i64(read_i_32538)];\n                            aggr_32540 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32466)[sext_i32_i64(read_i_32538)];\n                        } else {\n                            if (flag_32541 == (int8_t) 1) {\n                                aggr_32539 = ((volatile __global\n                                               bool *) aggregates_mem_32460)[sext_i32_i64(read_i_32538)];\n                                aggr_32540 = ((volatile __global\n                                               int64_t *) aggregates_mem_32464)[sext_i32_i64(read_i_32538)];\n                                used_32542 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local bool *) local_mem_32488)",
            "[warp_byte_offset_32485 +\n                                                       sext_i32_i64(local_tid_32478)] =\n                        aggr_32539;\n                    ((__local\n                      int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32478)] =\n                        aggr_32540;\n                    \n                    int8_t tmp_32543;\n                    \n                    tmp_32543 = flag_32541 | used_32542 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32488)[sext_i32_i64(local_tid_32478)] =\n                        tmp_32543;\n                    mem_fence_local();\n                    flag_32541 = ((volatile __local\n                                   int8_t *) local_mem_32488)[sext_i32_i64(wave_sizze_32480) -\n                                                              (int64_t) 1];\n                    if (local_tid_32478 == 0) {\n                        if (!(flag_32541 == (int8_t) 2)) {\n                            bool x_32544 = 0;\n                            int64_t x_32545 = (int64_t) 0;\n                            bool x_32546;\n                            int64_t x_32547;\n                            int8_t flag1_32551;\n                            \n                            flag1_32551 = (int8_t) 0;\n                            \n                            int8_t flag2_32552;\n                            int8_t used1_32553;\n                            \n                            used1_32553 = (int8_t) 0;\n                            \n                            int8_t used2_32554;\n                            \n                            for (int32_t i_32555 = 0; i_32555 <\n                                 wave_sizze_32480; i_32555++) {\n                                flag2_32552 = ((__local\n                                                int8_t *) ",
            "local_mem_32488)[sext_i32_i64(i_32555)];\n                                used2_32554 = lshr8(flag2_32552, (int8_t) 2);\n                                flag2_32552 = flag2_32552 & (int8_t) 3;\n                                x_32546 = ((__local\n                                            bool *) local_mem_32488)[warp_byte_offset_32485 +\n                                                                     sext_i32_i64(i_32555)];\n                                x_32547 = ((__local\n                                            int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32555)];\n                                if (!(flag2_32552 == (int8_t) 1)) {\n                                    flag1_32551 = flag2_32552;\n                                    used1_32553 = used2_32554;\n                                    x_32544 = x_32546;\n                                    x_32545 = x_32547;\n                                } else {\n                                    used1_32553 += used2_32554;\n                                    \n                                    bool defunc_1_op_res_32548;\n                                    \n                                    defunc_1_op_res_32548 = x_32544 || x_32546;\n                                    \n                                    int64_t defunc_1_op_res_32549;\n                                    \n                                    if (x_32546) {\n                                        defunc_1_op_res_32549 = x_32547;\n                                    } else {\n                                        int64_t defunc_1_op_res_32550 =\n                                                add64(x_32545, x_32547);\n                                        \n                                        defunc_1_op_res_32549 =\n                                    ",
            "        defunc_1_op_res_32550;\n                                    }\n                                    x_32544 = defunc_1_op_res_32548;\n                                    x_32545 = defunc_1_op_res_32549;\n                                }\n                            }\n                            flag_32541 = flag1_32551;\n                            used_32542 = used1_32553;\n                            aggr_32539 = x_32544;\n                            aggr_32540 = x_32545;\n                        } else {\n                            aggr_32539 = ((__local\n                                           bool *) local_mem_32488)[warp_byte_offset_32485 +\n                                                                    (sext_i32_i64(wave_sizze_32480) -\n                                                                     (int64_t) 1)];\n                            aggr_32540 = ((__local\n                                           int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32480) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32541 == (int8_t) 2) {\n                            readOffset_32537 = wave_sizze_32480 * -1;\n                        } else {\n                            readOffset_32537 -= zext_i8_i32(used_32542);\n                        }\n                        ((__local int32_t *) local_mem_32488)[(int64_t) 0] =\n                            readOffset_32537;\n                        \n                        bool x_32556;\n                        \n                        x_32556 = aggr_32539;\n                        \n                        int64_t x_32557;\n                        \n                        x_32557 = aggr_32540;\n                        \n               ",
            "         bool x_32558;\n                        \n                        x_32558 = prefix_32534;\n                        \n                        int64_t x_32559;\n                        \n                        x_32559 = prefix_32535;\n                        \n                        bool defunc_1_op_res_32560;\n                        \n                        defunc_1_op_res_32560 = x_32556 || x_32558;\n                        \n                        int64_t defunc_1_op_res_32561;\n                        \n                        if (x_32558) {\n                            defunc_1_op_res_32561 = x_32559;\n                        } else {\n                            int64_t defunc_1_op_res_32562 = add64(x_32557,\n                                                                  x_32559);\n                            \n                            defunc_1_op_res_32561 = defunc_1_op_res_32562;\n                        }\n                        prefix_32534 = defunc_1_op_res_32560;\n                        prefix_32535 = defunc_1_op_res_32561;\n                    }\n                    mem_fence_local();\n                    readOffset_32537 = ((__local\n                                         int32_t *) local_mem_32488)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32478 == 0) {\n                bool x_32563 = prefix_32534;\n                int64_t x_32564 = prefix_32535;\n                bool x_32565 = acc_32522;\n                int64_t x_32566 = acc_32523;\n                bool defunc_1_op_res_32567 = x_32563 || x_32565;\n                int64_t defunc_1_op_res_32568;\n                \n                if (x_32565) {\n                    defunc_1_op_res_32568 = x_32566;\n                } else {\n                    int64_t defunc_1_op_res_32569 = add64(x_32564, x_32566);\n                    \n                    defunc_1_op_res_32568 = defunc_1_op_res_32569;\n                }\n                ((volatile __global\n                  bool *) incprefixes_mem_32462)[d",
            "ynamic_id_32499] =\n                    defunc_1_op_res_32567;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_32466)[dynamic_id_32499] =\n                    defunc_1_op_res_32568;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32458)[dynamic_id_32499] =\n                    (int8_t) 2;\n                ((__local bool *) local_mem_32488)[warp_byte_offset_32485] =\n                    prefix_32534;\n                ((__local\n                  int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                      (int64_t) 8)] =\n                    prefix_32535;\n                acc_32522 = 0;\n                acc_32523 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32499 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32534 = ((__local\n                             bool *) local_mem_32488)[warp_byte_offset_32485];\n            prefix_32535 = ((__local\n                             int64_t *) local_mem_32488)[squot64(warp_byte_offset_32486,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        bool x_32570;\n        bool x_32572;\n        bool x_32577;\n        \n        x_32577 = prefix_32534;\n        \n        bool x_32579;\n        \n        x_32579 = acc_32522;\n        \n        int64_t x_32571;\n        int64_t x_32573;\n        int64_t x_32578;\n        \n        x_32578 = prefix_32535;\n        \n        int64_t x_32580;\n        \n        x_32580 = acc_32523;\n        \n        bool defunc_1_op_res_32581;\n        \n        defunc_1_op_res_32581 = x_32577 || x_32579;\n        \n        int64_t defunc_1_op_res_32582;\n        \n        if (x_32579) {\n            defunc_1_op_res_32582 = x_32580;\n        } else {\n            int64_t defunc_1_op_res_32583 = add64(x_32578, x_32580);\n  ",
            "          \n            defunc_1_op_res_32582 = defunc_1_op_res_32583;\n        }\n        x_32570 = defunc_1_op_res_32581;\n        x_32571 = defunc_1_op_res_32582;\n        for (int64_t i_32584 = 0; i_32584 < (int64_t) 9; i_32584++) {\n            x_32572 = private_mem_32501[i_32584];\n            x_32573 = private_mem_32503[i_32584];\n            \n            bool defunc_1_op_res_32574;\n            \n            defunc_1_op_res_32574 = x_32570 || x_32572;\n            \n            int64_t defunc_1_op_res_32575;\n            \n            if (x_32572) {\n                defunc_1_op_res_32575 = x_32573;\n            } else {\n                int64_t defunc_1_op_res_32576 = add64(x_32571, x_32573);\n                \n                defunc_1_op_res_32575 = defunc_1_op_res_32576;\n            }\n            private_mem_32501[i_32584] = defunc_1_op_res_32574;\n            private_mem_32503[i_32584] = defunc_1_op_res_32575;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32585 = 0; i_32585 < (int64_t) 9; i_32585++) {\n            int64_t sharedIdx_32586 = sext_i32_i64(local_tid_32478 * 9) +\n                    i_32585;\n            \n            ((__local bool *) local_mem_32488)[sharedIdx_32586] =\n                private_mem_32501[i_32585];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32587 = 0; i_32587 < (int64_t) 9; i_32587++) {\n            int32_t sharedIdx_32588 = local_tid_32478 +\n                    sext_i64_i32(segscan_group_sizze_30354 * i_32587);\n            \n            private_mem_32501[i_32587] = ((__local\n                                           bool *) local_mem_32488)[sext_i32_i64(sharedIdx_32588)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32589 = 0; i_32589 < (int64_t) 9; i_32589++) {\n            int64_t sharedIdx_32590 = sext_i32_i64(local_tid_32478 * 9) +\n                    i_32589;\n            \n            ((__local int64_t *) local_mem_32488)[sharedI",
            "dx_32590] =\n                private_mem_32503[i_32589];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32591 = 0; i_32591 < (int64_t) 9; i_32591++) {\n            int32_t sharedIdx_32592 = local_tid_32478 +\n                    sext_i64_i32(segscan_group_sizze_30354 * i_32591);\n            \n            private_mem_32503[i_32591] = ((__local\n                                           int64_t *) local_mem_32488)[sext_i32_i64(sharedIdx_32592)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32593 = 0; i_32593 < (int64_t) 9; i_32593++) {\n            int64_t gtid_30358 = blockOff_32500 + segscan_group_sizze_30354 *\n                    i_32593 + sext_i32_i64(local_tid_32478);\n            \n            if (slt64(gtid_30358, implz2081U_28746)) {\n                ((__global bool *) mem_31956)[gtid_30358] =\n                    private_mem_32501[i_32593];\n            }\n        }\n        for (int64_t i_32594 = 0; i_32594 < (int64_t) 9; i_32594++) {\n            int64_t gtid_30358 = blockOff_32500 + segscan_group_sizze_30354 *\n                    i_32594 + sext_i32_i64(local_tid_32478);\n            \n            if (slt64(gtid_30358, implz2081U_28746)) {\n                ((__global int64_t *) mem_31958)[gtid_30358] =\n                    private_mem_32503[i_32594];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32499 == sdiv_up64(implz2081U_28746,\n                                          segscan_group_sizze_30354 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_mkSegsFromSort_segSizzeziid_counter_mem_32456)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30354\n}\n__kernel void test_mkSegsFromSort_segSizzezisegscan_30367(__global\n                                                  ",
            "        int *global_failure,\n                                                          uint local_mem_32615_backing_offset_0,\n                                                          int64_t implz2081U_28746,\n                                                          __global\n                                                          unsigned char *mem_31953,\n                                                          __global\n                                                          unsigned char *mem_31961,\n                                                          __global\n                                                          unsigned char *test_mkSegsFromSort_segSizzeziid_counter_mem_32598,\n                                                          __global\n                                                          unsigned char *status_flags_mem_32600,\n                                                          __global\n                                                          unsigned char *aggregates_mem_32602,\n                                                          __global\n                                                          unsigned char *incprefixes_mem_32604)\n{\n    #define segscan_group_sizze_30362 (test_mkSegsFromSort_segSizzezisegscan_group_sizze_30361)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32615_backing_0 =\n                  &shared_mem[local_mem_32615_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32606;\n    int32_t local_tid_32607;\n    int64_t group_sizze_32610;\n    int32_t wave_sizze_32609;\n    int32_t group_tid_32608;\n    \n    global_tid_32606 = get_global_id(0);\n    local_tid_32607 = get_local_id(0);\n    group_sizze_32610 = get_local_size(0);\n    wave_sizze_32609 = LOCKSTEP_WIDTH;\n    group_tid_32608 = get_group_id(0);\n    \n    int32_t phys_tid_30367;\n    \n    phys_tid_30367 = global_tid_32606;\n    \n    int64",
            "_t byte_offsets_32611;\n    \n    byte_offsets_32611 = (int64_t) 0;\n    \n    int64_t byte_offsets_32612;\n    \n    byte_offsets_32612 = segscan_group_sizze_30362 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32613;\n    \n    warp_byte_offset_32613 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32614;\n    \n    warp_byte_offset_32614 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32615;\n    \n    local_mem_32615 = (__local char *) local_mem_32615_backing_0;\n    \n    int64_t trans_arr_len_32616;\n    \n    trans_arr_len_32616 = (int64_t) 9 * segscan_group_sizze_30362;\n    \n    int32_t dynamic_id_32623;\n    \n    if (local_tid_32607 == 0) {\n        dynamic_id_32623 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segSizzeziid_counter_mem_32598)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32615)[(int64_t) 0] = dynamic_id_32623;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32623 = ((__local int32_t *) local_mem_32615)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32624;\n    \n    blockOff_32624 = sext_i32_i64(dynamic_id_32623) * (int64_t) 9 *\n        segscan_group_sizze_30362;\n    \n    int64_t private_mem_32625[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32627 = 0; i_32627 < (int64_t) 9; i_32627++) {\n            int64_t gtid_30366 = blockOff_32624 +\n                    sext_i32_i64(local_tid_32607) + i_32627 *\n                    segscan_group_sizze_30362;\n            \n            if (slt64(gtid_30366, implz2081U_28746)) {\n                int64_t i_p_o_31849 = add64((int64_t) 1, gtid_30366);\n                int64_t rot_i_31850 = smod64(i_p_o_31849, implz2081U_28746);\n                bool x_28779 = ((__global bool *) mem_31953)[rot_i_31850];\n                int64_t defunc_0_f_res_28780 = btoi_bool_i64(x_28779);\n                \n        ",
            "        private_mem_32625[i_32627] = defunc_0_f_res_28780;\n            } else {\n                private_mem_32625[i_32627] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32628 = 0; i_32628 < (int64_t) 9; i_32628++) {\n            int64_t sharedIdx_32629 = sext_i32_i64(local_tid_32607) + i_32628 *\n                    segscan_group_sizze_30362;\n            \n            ((__local int64_t *) local_mem_32615)[sharedIdx_32629] =\n                private_mem_32625[i_32628];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32630 = 0; i_32630 < 9; i_32630++) {\n            int32_t sharedIdx_32631 = local_tid_32607 * 9 + i_32630;\n            \n            private_mem_32625[sext_i32_i64(i_32630)] = ((__local\n                                                         int64_t *) local_mem_32615)[sext_i32_i64(sharedIdx_32631)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32632 = 0; i_32632 < (int64_t) 8; i_32632++) {\n            int64_t x_28776;\n            int64_t x_28777;\n            \n            x_28776 = private_mem_32625[i_32632];\n            x_28777 = private_mem_32625[i_32632 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28778;\n            \n            defunc_1_op_res_28778 = add64(x_28776, x_28777);\n            private_mem_32625[i_32632 + (int64_t) 1] = defunc_1_op_res_28778;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32607)] =\n            private_mem_32625[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32636;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32633;\n        int64_t x_32634;\n        int64_t x_32",
            "637;\n        int64_t x_32638;\n        bool ltid_in_bounds_32640;\n        \n        ltid_in_bounds_32640 = slt64(sext_i32_i64(local_tid_32607),\n                                     segscan_group_sizze_30362);\n        \n        int32_t skip_threads_32641;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32640) {\n                x_32634 = ((volatile __local\n                            int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32607)];\n                if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) ==\n                    0) {\n                    x_32633 = x_32634;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_32641 = 1;\n            while (slt32(skip_threads_32641, 32)) {\n                if (sle32(skip_threads_32641, local_tid_32607 -\n                          squot32(local_tid_32607, 32) * 32) &&\n                    ltid_in_bounds_32640) {\n                    // read operands\n                    {\n                        x_32633 = ((volatile __local\n                                    int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32607) -\n                                                                 sext_i32_i64(skip_threads_32641))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32635 = add64(x_32633, x_32634);\n                        \n                        x_32633 = defunc_1_op_res_32635;\n                    }\n                }\n                if (sle32(wave_sizze_32609, skip_threads_32641)) {\n",
            "                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32641, local_tid_32607 -\n                          squot32(local_tid_32607, 32) * 32) &&\n                    ltid_in_bounds_32640) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32607)] =\n                            x_32633;\n                        x_32634 = x_32633;\n                    }\n                }\n                if (sle32(wave_sizze_32609, skip_threads_32641)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32641 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) == 31 &&\n                ltid_in_bounds_32640) {\n                ((volatile __local\n                  int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32607,\n                                                                   32))] =\n                    x_32633;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32642;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32607, 32) == 0 && ltid_in_bounds_32640) {\n                    x_32638 = ((volatile __local\n                                int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n ",
            "                                                                   (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32607)];\n                    if ((local_tid_32607 - squot32(local_tid_32607, 32) * 32) ==\n                        0) {\n                        x_32637 = x_32638;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32642 = 1;\n                while (slt32(skip_threads_32642, 32)) {\n                    if (sle32(skip_threads_32642, local_tid_32607 -\n                              squot32(local_tid_32607, 32) * 32) &&\n                        (squot32(local_tid_32607, 32) == 0 &&\n                         ltid_in_bounds_32640)) {\n                        // read operands\n                        {\n                            x_32637 = ((volatile __local\n                                        int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32607) -\n                                                                     sext_i32_i64(skip_threads_32642))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32639 = add64(x_32637,\n                                                                  x_32638);\n                            \n                            x_32637 = defunc_1_op_res_32639;\n                        }\n                    }\n                    if (sle32(wave_sizze_32609, skip_threads_32642)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32642, local_tid_32607 -\n                              squot32(local_tid_32607, 32) * 32) &&\n               ",
            "         (squot32(local_tid_32607, 32) == 0 &&\n                         ltid_in_bounds_32640)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32607)] =\n                                x_32637;\n                            x_32638 = x_32637;\n                        }\n                    }\n                    if (sle32(wave_sizze_32609, skip_threads_32642)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32642 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32607, 32) == 0 || !ltid_in_bounds_32640)) {\n                // read operands\n                {\n                    x_32634 = x_32633;\n                    x_32633 = ((__local\n                                int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32607,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32635 = add64(x_32633, x_32634);\n                    \n                    x_32633 = defunc_1_op_res_32635;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n         ",
            "                                                 (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32607)] =\n                        x_32633;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32607, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32607)] =\n                    x_32634;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32607 == 0) {\n            acc_32636 = ((__local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30362 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32636 = ((__local\n                          int64_t *) local_mem_32615)[squot64(byte_offsets_32611,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32607) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32643;\n    \n    prefix_32643 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32623 == (int64_t) 0 && local_tid_32607 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32604)[dynamic_id_32623] = acc_32636;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32600)[dynamic_id_32623] = (int8_t) 2;\n            acc_32636 =",
            " (int64_t) 0;\n        }\n        if (!(dynamic_id_32623 == (int64_t) 0) && slt32(local_tid_32607,\n                                                        wave_sizze_32609)) {\n            if (local_tid_32607 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32602)[dynamic_id_32623] =\n                    acc_32636;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32600)[dynamic_id_32623] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32615)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32600)[dynamic_id_32623 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_32644;\n            \n            status_32644 = ((__local int8_t *) local_mem_32615)[(int64_t) 0];\n            if (status_32644 == (int8_t) 2) {\n                if (local_tid_32607 == 0) {\n                    prefix_32643 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32604)[dynamic_id_32623 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32645 = dynamic_id_32623 -\n                        sext_i32_i64(wave_sizze_32609);\n                \n                while (slt32(wave_sizze_32609 * -1, readOffset_32645)) {\n                    int32_t read_i_32646 = readOffset_32645 + local_tid_32607;\n                    int64_t aggr_32647 = (int64_t) 0;\n                    int8_t flag_32648 = (int8_t) 0;\n                    int8_t used_32649 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32646)) {\n                        flag_32648 = ((volatile __global\n                                      ",
            " int8_t *) status_flags_mem_32600)[sext_i32_i64(read_i_32646)];\n                        if (flag_32648 == (int8_t) 2) {\n                            aggr_32647 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32604)[sext_i32_i64(read_i_32646)];\n                        } else {\n                            if (flag_32648 == (int8_t) 1) {\n                                aggr_32647 = ((volatile __global\n                                               int64_t *) aggregates_mem_32602)[sext_i32_i64(read_i_32646)];\n                                used_32649 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32607)] =\n                        aggr_32647;\n                    \n                    int8_t tmp_32650;\n                    \n                    tmp_32650 = flag_32648 | used_32649 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32615)[sext_i32_i64(local_tid_32607)] =\n                        tmp_32650;\n                    mem_fence_local();\n                    flag_32648 = ((volatile __local\n                                   int8_t *) local_mem_32615)[sext_i32_i64(wave_sizze_32609) -\n                                                              (int64_t) 1];\n                    if (local_tid_32607 == 0) {\n                        if (!(flag_32648 == (int8_t) 2)) {\n                            int64_t x_32651 = (int64_t) 0;\n                            int64_t x_32652;\n                            int8_t flag1_32654;\n                            \n                            flag1_32654 = (int8_t) 0;\n                            \n                            int8_t flag2_32655;\n                            ",
            "int8_t used1_32656;\n                            \n                            used1_32656 = (int8_t) 0;\n                            \n                            int8_t used2_32657;\n                            \n                            for (int32_t i_32658 = 0; i_32658 <\n                                 wave_sizze_32609; i_32658++) {\n                                flag2_32655 = ((__local\n                                                int8_t *) local_mem_32615)[sext_i32_i64(i_32658)];\n                                used2_32657 = lshr8(flag2_32655, (int8_t) 2);\n                                flag2_32655 = flag2_32655 & (int8_t) 3;\n                                x_32652 = ((__local\n                                            int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_32658)];\n                                if (!(flag2_32655 == (int8_t) 1)) {\n                                    flag1_32654 = flag2_32655;\n                                    used1_32656 = used2_32657;\n                                    x_32651 = x_32652;\n                                } else {\n                                    used1_32656 += used2_32657;\n                                    \n                                    int64_t defunc_1_op_res_32653;\n                                    \n                                    defunc_1_op_res_32653 = add64(x_32651,\n                                                                  x_32652);\n                                    x_32651 = defunc_1_op_res_32653;\n                                }\n                            }\n                            flag_32648 = flag1_32654;\n                            used_32649 = used1_32656;\n                            aggr_32647 = x_32651;\n                        } else {\n                            aggr_32647 = ",
            "((__local\n                                           int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32609) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32648 == (int8_t) 2) {\n                            readOffset_32645 = wave_sizze_32609 * -1;\n                        } else {\n                            readOffset_32645 -= zext_i8_i32(used_32649);\n                        }\n                        ((__local int32_t *) local_mem_32615)[(int64_t) 0] =\n                            readOffset_32645;\n                        \n                        int64_t x_32659;\n                        \n                        x_32659 = aggr_32647;\n                        \n                        int64_t x_32660;\n                        \n                        x_32660 = prefix_32643;\n                        \n                        int64_t defunc_1_op_res_32661;\n                        \n                        defunc_1_op_res_32661 = add64(x_32659, x_32660);\n                        prefix_32643 = defunc_1_op_res_32661;\n                    }\n                    mem_fence_local();\n                    readOffset_32645 = ((__local\n                                         int32_t *) local_mem_32615)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32607 == 0) {\n                int64_t x_32662 = prefix_32643;\n                int64_t x_32663 = acc_32636;\n                int64_t defunc_1_op_res_32664 = add64(x_32662, x_32663);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32604)[dynamic_id_32623] =\n                    defunc_1_op_res_32664;\n                mem_fence_global();\n                ((volatile __global\n       ",
            "           int8_t *) status_flags_mem_32600)[dynamic_id_32623] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                      (int64_t) 8)] =\n                    prefix_32643;\n                acc_32636 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32623 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32643 = ((__local\n                             int64_t *) local_mem_32615)[squot64(warp_byte_offset_32613,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32665;\n        int64_t x_32666;\n        int64_t x_32668;\n        \n        x_32668 = prefix_32643;\n        \n        int64_t x_32669;\n        \n        x_32669 = acc_32636;\n        \n        int64_t defunc_1_op_res_32670;\n        \n        defunc_1_op_res_32670 = add64(x_32668, x_32669);\n        x_32665 = defunc_1_op_res_32670;\n        for (int64_t i_32671 = 0; i_32671 < (int64_t) 9; i_32671++) {\n            x_32666 = private_mem_32625[i_32671];\n            \n            int64_t defunc_1_op_res_32667;\n            \n            defunc_1_op_res_32667 = add64(x_32665, x_32666);\n            private_mem_32625[i_32671] = defunc_1_op_res_32667;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32672 = 0; i_32672 < (int64_t) 9; i_32672++) {\n            int64_t sharedIdx_32673 = sext_i32_i64(local_tid_32607 * 9) +\n                    i_32672;\n            \n            ((__local int64_t *) local_mem_32615)[sharedIdx_32673] =\n                private_mem_32625[i_32672];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32674 = 0; i_32674 < (int64_t) 9; i_32674++) {\n            int32_t sharedIdx_32675 = local_tid_32607 +\n                    sex",
            "t_i64_i32(segscan_group_sizze_30362 * i_32674);\n            \n            private_mem_32625[i_32674] = ((__local\n                                           int64_t *) local_mem_32615)[sext_i32_i64(sharedIdx_32675)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32676 = 0; i_32676 < (int64_t) 9; i_32676++) {\n            int64_t gtid_30366 = blockOff_32624 + segscan_group_sizze_30362 *\n                    i_32676 + sext_i32_i64(local_tid_32607);\n            \n            if (slt64(gtid_30366, implz2081U_28746)) {\n                ((__global int64_t *) mem_31961)[gtid_30366] =\n                    private_mem_32625[i_32676];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32623 == sdiv_up64(implz2081U_28746,\n                                          segscan_group_sizze_30362 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_mkSegsFromSort_segSizzeziid_counter_mem_32598)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30362\n}\n__kernel void test_mkSegsFromSort_segSizzezisegscan_30381(__global\n                                                          int *global_failure,\n                                                          uint local_mem_32711_backing_offset_0,\n                                                          int64_t num_segments_28781,\n                                                          __global\n                                                          unsigned char *mem_31963,\n                                                          __global\n                                                          unsigned char *mem_31967,\n                                                          __global\n                                                          unsigned char *test_mkS",
            "egsFromSort_segSizzeziid_counter_mem_32694,\n                                                          __global\n                                                          unsigned char *status_flags_mem_32696,\n                                                          __global\n                                                          unsigned char *aggregates_mem_32698,\n                                                          __global\n                                                          unsigned char *incprefixes_mem_32700)\n{\n    #define segscan_group_sizze_30376 (test_mkSegsFromSort_segSizzezisegscan_group_sizze_30375)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_32711_backing_0 =\n                  &shared_mem[local_mem_32711_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_32702;\n    int32_t local_tid_32703;\n    int64_t group_sizze_32706;\n    int32_t wave_sizze_32705;\n    int32_t group_tid_32704;\n    \n    global_tid_32702 = get_global_id(0);\n    local_tid_32703 = get_local_id(0);\n    group_sizze_32706 = get_local_size(0);\n    wave_sizze_32705 = LOCKSTEP_WIDTH;\n    group_tid_32704 = get_group_id(0);\n    \n    int32_t phys_tid_30381;\n    \n    phys_tid_30381 = global_tid_32702;\n    \n    int64_t byte_offsets_32707;\n    \n    byte_offsets_32707 = (int64_t) 0;\n    \n    int64_t byte_offsets_32708;\n    \n    byte_offsets_32708 = segscan_group_sizze_30376 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_32709;\n    \n    warp_byte_offset_32709 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_32710;\n    \n    warp_byte_offset_32710 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_32711;\n    \n    local_mem_32711 = (__local char *) local_mem_32711_backing_0;\n    \n    int64_t trans_arr_len_32712;\n    \n    trans_arr_len_32712 = (int64_t) 9 * segscan_group_sizze_30376;\n    \n    int32_t dynamic_id_32719;\n    \n",
            "    if (local_tid_32703 == 0) {\n        dynamic_id_32719 = atomic_add_i32_global(&((volatile __global\n                                                    int *) test_mkSegsFromSort_segSizzeziid_counter_mem_32694)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_32711)[(int64_t) 0] = dynamic_id_32719;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_32719 = ((__local int32_t *) local_mem_32711)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_32720;\n    \n    blockOff_32720 = sext_i32_i64(dynamic_id_32719) * (int64_t) 9 *\n        segscan_group_sizze_30376;\n    \n    int64_t private_mem_32721[9];\n    \n    // Load and map\n    {\n        for (int64_t i_32723 = 0; i_32723 < (int64_t) 9; i_32723++) {\n            int64_t gtid_30380 = blockOff_32720 +\n                    sext_i32_i64(local_tid_32703) + i_32723 *\n                    segscan_group_sizze_30376;\n            \n            if (slt64(gtid_30380, num_segments_28781)) {\n                int64_t x_28802 = ((__global int64_t *) mem_31963)[gtid_30380];\n                \n                private_mem_32721[i_32723] = x_28802;\n            } else {\n                private_mem_32721[i_32723] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32724 = 0; i_32724 < (int64_t) 9; i_32724++) {\n            int64_t sharedIdx_32725 = sext_i32_i64(local_tid_32703) + i_32724 *\n                    segscan_group_sizze_30376;\n            \n            ((__local int64_t *) local_mem_32711)[sharedIdx_32725] =\n                private_mem_32721[i_32724];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_32726 = 0; i_32726 < 9; i_32726++) {\n            int32_t sharedIdx_32727 = local_tid_32703 * 9 + i_32726;\n            \n            private_mem_32721[sext_i32_i64(i_32726)] = ((__local\n                                                         int64_t ",
            "*) local_mem_32711)[sext_i32_i64(sharedIdx_32727)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_32728 = 0; i_32728 < (int64_t) 8; i_32728++) {\n            int64_t x_28799;\n            int64_t x_28800;\n            \n            x_28799 = private_mem_32721[i_32728];\n            x_28800 = private_mem_32721[i_32728 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_28801;\n            \n            defunc_1_op_res_28801 = add64(x_28799, x_28800);\n            private_mem_32721[i_32728 + (int64_t) 1] = defunc_1_op_res_28801;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32703)] =\n            private_mem_32721[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_32732;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_32729;\n        int64_t x_32730;\n        int64_t x_32733;\n        int64_t x_32734;\n        bool ltid_in_bounds_32736;\n        \n        ltid_in_bounds_32736 = slt64(sext_i32_i64(local_tid_32703),\n                                     segscan_group_sizze_30376);\n        \n        int32_t skip_threads_32737;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_32736) {\n                x_32730 = ((volatile __local\n                            int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_32703)];\n                if ((local_tid_32703 - squot32(local_tid_32703, 32) * 32) ==\n                    0) {\n                    x_32729 = x_32730;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed",
            ")\n        {\n            skip_threads_32737 = 1;\n            while (slt32(skip_threads_32737, 32)) {\n                if (sle32(skip_threads_32737, local_tid_32703 -\n                          squot32(local_tid_32703, 32) * 32) &&\n                    ltid_in_bounds_32736) {\n                    // read operands\n                    {\n                        x_32729 = ((volatile __local\n                                    int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_32703) -\n                                                                 sext_i32_i64(skip_threads_32737))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_32731 = add64(x_32729, x_32730);\n                        \n                        x_32729 = defunc_1_op_res_32731;\n                    }\n                }\n                if (sle32(wave_sizze_32705, skip_threads_32737)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_32737, local_tid_32703 -\n                          squot32(local_tid_32703, 32) * 32) &&\n                    ltid_in_bounds_32736) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_32703)] =\n                            x_32729;\n                        x_32730 = x_32729;\n                    }\n                }\n                if (sle32(wave_sizze_32705, skip_threads_32737)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_32737 *= 2;\n ",
            "           }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_32703 - squot32(local_tid_32703, 32) * 32) == 31 &&\n                ltid_in_bounds_32736) {\n                ((volatile __local\n                  int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_32703,\n                                                                   32))] =\n                    x_32729;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_32738;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_32703, 32) == 0 && ltid_in_bounds_32736) {\n                    x_32734 = ((volatile __local\n                                int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_32703)];\n                    if ((local_tid_32703 - squot32(local_tid_32703, 32) * 32) ==\n                        0) {\n                        x_32733 = x_32734;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_32738 = 1;\n                while (slt32(skip_threads_32738, 32)) {\n                    if (sle32(skip_threads_32738, local_tid_32703 -\n                              squot32(local_tid_32703, 32) * 32) &&\n                        (squot32(local_tid_32703, 32) == 0 &&\n                         ltid_in_bounds_32736)) {\n                        // read operands\n                        {\n                  ",
            "          x_32733 = ((volatile __local\n                                        int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_32703) -\n                                                                     sext_i32_i64(skip_threads_32738))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_32735 = add64(x_32733,\n                                                                  x_32734);\n                            \n                            x_32733 = defunc_1_op_res_32735;\n                        }\n                    }\n                    if (sle32(wave_sizze_32705, skip_threads_32738)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_32738, local_tid_32703 -\n                              squot32(local_tid_32703, 32) * 32) &&\n                        (squot32(local_tid_32703, 32) == 0 &&\n                         ltid_in_bounds_32736)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_32703)] =\n                                x_32733;\n                            x_32734 = x_32733;\n                        }\n                    }\n                    if (sle32(wave_sizze_32705, skip_threads_32738)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_32738 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ",
            "// carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_32703, 32) == 0 || !ltid_in_bounds_32736)) {\n                // read operands\n                {\n                    x_32730 = x_32729;\n                    x_32729 = ((__local\n                                int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_32703,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_32731 = add64(x_32729, x_32730);\n                    \n                    x_32729 = defunc_1_op_res_32731;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_32703)] =\n                        x_32729;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_32703, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_32703)] =\n                    x_32730;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_32703 == 0) {\n            acc_32732 = ((__local\n                          int64_t *) local_mem_32711)[squot64(by",
            "te_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_30376 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_32732 = ((__local\n                          int64_t *) local_mem_32711)[squot64(byte_offsets_32707,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_32703) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_32739;\n    \n    prefix_32739 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_32719 == (int64_t) 0 && local_tid_32703 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_32700)[dynamic_id_32719] = acc_32732;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_32696)[dynamic_id_32719] = (int8_t) 2;\n            acc_32732 = (int64_t) 0;\n        }\n        if (!(dynamic_id_32719 == (int64_t) 0) && slt32(local_tid_32703,\n                                                        wave_sizze_32705)) {\n            if (local_tid_32703 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_32698)[dynamic_id_32719] =\n                    acc_32732;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32696)[dynamic_id_32719] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_32711)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_32696)[dynamic_id_32719 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_",
            "local();\n            \n            int8_t status_32740;\n            \n            status_32740 = ((__local int8_t *) local_mem_32711)[(int64_t) 0];\n            if (status_32740 == (int8_t) 2) {\n                if (local_tid_32703 == 0) {\n                    prefix_32739 = ((volatile __global\n                                     int64_t *) incprefixes_mem_32700)[dynamic_id_32719 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_32741 = dynamic_id_32719 -\n                        sext_i32_i64(wave_sizze_32705);\n                \n                while (slt32(wave_sizze_32705 * -1, readOffset_32741)) {\n                    int32_t read_i_32742 = readOffset_32741 + local_tid_32703;\n                    int64_t aggr_32743 = (int64_t) 0;\n                    int8_t flag_32744 = (int8_t) 0;\n                    int8_t used_32745 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_32742)) {\n                        flag_32744 = ((volatile __global\n                                       int8_t *) status_flags_mem_32696)[sext_i32_i64(read_i_32742)];\n                        if (flag_32744 == (int8_t) 2) {\n                            aggr_32743 = ((volatile __global\n                                           int64_t *) incprefixes_mem_32700)[sext_i32_i64(read_i_32742)];\n                        } else {\n                            if (flag_32744 == (int8_t) 1) {\n                                aggr_32743 = ((volatile __global\n                                               int64_t *) aggregates_mem_32698)[sext_i32_i64(read_i_32742)];\n                                used_32745 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                          (int64_t) 8) +\n          ",
            "                                        sext_i32_i64(local_tid_32703)] =\n                        aggr_32743;\n                    \n                    int8_t tmp_32746;\n                    \n                    tmp_32746 = flag_32744 | used_32745 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_32711)[sext_i32_i64(local_tid_32703)] =\n                        tmp_32746;\n                    mem_fence_local();\n                    flag_32744 = ((volatile __local\n                                   int8_t *) local_mem_32711)[sext_i32_i64(wave_sizze_32705) -\n                                                              (int64_t) 1];\n                    if (local_tid_32703 == 0) {\n                        if (!(flag_32744 == (int8_t) 2)) {\n                            int64_t x_32747 = (int64_t) 0;\n                            int64_t x_32748;\n                            int8_t flag1_32750;\n                            \n                            flag1_32750 = (int8_t) 0;\n                            \n                            int8_t flag2_32751;\n                            int8_t used1_32752;\n                            \n                            used1_32752 = (int8_t) 0;\n                            \n                            int8_t used2_32753;\n                            \n                            for (int32_t i_32754 = 0; i_32754 <\n                                 wave_sizze_32705; i_32754++) {\n                                flag2_32751 = ((__local\n                                                int8_t *) local_mem_32711)[sext_i32_i64(i_32754)];\n                                used2_32753 = lshr8(flag2_32751, (int8_t) 2);\n                                flag2_32751 = flag2_32751 & (int8_t) 3;\n                                x_32748 = ((__local\n                                            int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                                (int64",
            "_t) 8) +\n                                                                        sext_i32_i64(i_32754)];\n                                if (!(flag2_32751 == (int8_t) 1)) {\n                                    flag1_32750 = flag2_32751;\n                                    used1_32752 = used2_32753;\n                                    x_32747 = x_32748;\n                                } else {\n                                    used1_32752 += used2_32753;\n                                    \n                                    int64_t defunc_1_op_res_32749;\n                                    \n                                    defunc_1_op_res_32749 = add64(x_32747,\n                                                                  x_32748);\n                                    x_32747 = defunc_1_op_res_32749;\n                                }\n                            }\n                            flag_32744 = flag1_32750;\n                            used_32745 = used1_32752;\n                            aggr_32743 = x_32747;\n                        } else {\n                            aggr_32743 = ((__local\n                                           int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_32705) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_32744 == (int8_t) 2) {\n                            readOffset_32741 = wave_sizze_32705 * -1;\n                        } else {\n                            readOffset_32741 -= zext_i8_i32(used_32745);\n                        }\n                        ((__local int32_t *) local_mem_32711)[(int64_t) 0] =\n                            readOffset_32741;\n                        \n                        int64_t x_32755;\n            ",
            "            \n                        x_32755 = aggr_32743;\n                        \n                        int64_t x_32756;\n                        \n                        x_32756 = prefix_32739;\n                        \n                        int64_t defunc_1_op_res_32757;\n                        \n                        defunc_1_op_res_32757 = add64(x_32755, x_32756);\n                        prefix_32739 = defunc_1_op_res_32757;\n                    }\n                    mem_fence_local();\n                    readOffset_32741 = ((__local\n                                         int32_t *) local_mem_32711)[(int64_t) 0];\n                }\n            }\n            if (local_tid_32703 == 0) {\n                int64_t x_32758 = prefix_32739;\n                int64_t x_32759 = acc_32732;\n                int64_t defunc_1_op_res_32760 = add64(x_32758, x_32759);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_32700)[dynamic_id_32719] =\n                    defunc_1_op_res_32760;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_32696)[dynamic_id_32719] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                      (int64_t) 8)] =\n                    prefix_32739;\n                acc_32732 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_32719 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_32739 = ((__local\n                             int64_t *) local_mem_32711)[squot64(warp_byte_offset_32709,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_32761;\n        int64_t x_32762;\n        int64_t x_32764;\n        \n        x_32764 = prefix_32739;\n        \n ",
            "       int64_t x_32765;\n        \n        x_32765 = acc_32732;\n        \n        int64_t defunc_1_op_res_32766;\n        \n        defunc_1_op_res_32766 = add64(x_32764, x_32765);\n        x_32761 = defunc_1_op_res_32766;\n        for (int64_t i_32767 = 0; i_32767 < (int64_t) 9; i_32767++) {\n            x_32762 = private_mem_32721[i_32767];\n            \n            int64_t defunc_1_op_res_32763;\n            \n            defunc_1_op_res_32763 = add64(x_32761, x_32762);\n            private_mem_32721[i_32767] = defunc_1_op_res_32763;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32768 = 0; i_32768 < (int64_t) 9; i_32768++) {\n            int64_t sharedIdx_32769 = sext_i32_i64(local_tid_32703 * 9) +\n                    i_32768;\n            \n            ((__local int64_t *) local_mem_32711)[sharedIdx_32769] =\n                private_mem_32721[i_32768];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_32770 = 0; i_32770 < (int64_t) 9; i_32770++) {\n            int32_t sharedIdx_32771 = local_tid_32703 +\n                    sext_i64_i32(segscan_group_sizze_30376 * i_32770);\n            \n            private_mem_32721[i_32770] = ((__local\n                                           int64_t *) local_mem_32711)[sext_i32_i64(sharedIdx_32771)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_32772 = 0; i_32772 < (int64_t) 9; i_32772++) {\n            int64_t gtid_30380 = blockOff_32720 + segscan_group_sizze_30376 *\n                    i_32772 + sext_i32_i64(local_tid_32703);\n            \n            if (slt64(gtid_30380, num_segments_28781)) {\n                ((__global int64_t *) mem_31967)[gtid_30380] =\n                    private_mem_32721[i_32772];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_32719 == sdiv_up64(num_segments_28781,\n                  ",
            "                        segscan_group_sizze_30376 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) test_mkSegsFromSort_segSizzeziid_counter_mem_32694)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_30376\n}\n",
            NULL};
static const char *size_names[] = {"builtin#iota_i64.group_size_32452",
                                   "builtin#replicate_i32.group_size_33030",
                                   "builtin#replicate_i64.group_size_32928",
                                   "builtin#replicate_i8.group_size_32498",
                                   "test_ballQuery.L2_size_33215",
                                   "test_ballQuery.group_size_33020",
                                   "test_ballQuery.seghist_group_size_31622",
                                   "test_ballQuery.seghist_num_groups_31624",
                                   "test_ballQuery.segmap_group_size_31161",
                                   "test_ballQuery.segmap_group_size_31185",
                                   "test_ballQuery.segmap_group_size_31241",
                                   "test_ballQuery.segmap_group_size_31247",
                                   "test_ballQuery.segmap_group_size_31277",
                                   "test_ballQuery.segmap_group_size_31311",
                                   "test_ballQuery.segmap_group_size_31325",
                                   "test_ballQuery.segmap_group_size_31423",
                                   "test_ballQuery.segmap_group_size_31451",
                                   "test_ballQuery.segmap_group_size_31510",
                                   "test_ballQuery.segmap_group_size_31647",
                                   "test_ballQuery.segmap_group_size_31690",
                                   "test_ballQuery.segmap_group_size_31833",
                                   "test_ballQuery.segred_group_size_31612",
                                   "test_ballQuery.segred_group_size_31837",
                                   "test_ballQuery.segred_num_groups_31614",
                                   "test_ballQuery.segred_num_groups_31839",
                                   "test_ballQuery.segscan_group_size_31231",
                                   "test_ballQuery.segscan_group_size_31293",
                                   "test_ballQuery.segscan_group_size_31301",
                                   "test_ballQuery.segscan_group_size_31315",
                                   "test_ballQuery.segscan_group_size_31604",
                                   "test_ballQuery.segscan_group_size_31637",
                                   "test_ballQuery.segscan_group_size_31663",
                                   "test_ballQuery.segscan_group_size_31823",
                                   "test_ballQuery.segscan_num_groups_31233",
                                   "test_ballQuery.segscan_num_groups_31295",
                                   "test_ballQuery.segscan_num_groups_31303",
                                   "test_ballQuery.segscan_num_groups_31317",
                                   "test_ballQuery.segscan_num_groups_31606",
                                   "test_ballQuery.segscan_num_groups_31639",
                                   "test_ballQuery.segscan_num_groups_31665",
                                   "test_ballQuery.segscan_num_groups_31825",
                                   "test_clusterWith.L2_size_33319",
                                   "test_clusterWith.L2_size_34916",
                                   "test_clusterWith.group_size_33016",
                                   "test_clusterWith.group_size_34209",
                                   "test_clusterWith.group_size_34526",
                                   "test_clusterWith.group_size_35220",
                                   "test_clusterWith.seghist_group_size_30654",
                                   "test_clusterWith.seghist_group_size_31045",
                                   "test_clusterWith.seghist_num_groups_30656",
                                   "test_clusterWith.seghist_num_groups_31047",
                                   "test_clusterWith.segmap_group_size_30475",
                                   "test_clusterWith.segmap_group_size_30497",
                                   "test_clusterWith.segmap_group_size_30503",
                                   "test_clusterWith.segmap_group_size_30553",
                                   "test_clusterWith.segmap_group_size_30587",
                                   "test_clusterWith.segmap_group_size_30601",
                                   "test_clusterWith.segmap_group_size_30687",
                                   "test_clusterWith.segmap_group_size_30805",
                                   "test_clusterWith.segmap_group_size_30811",
                                   "test_clusterWith.segmap_group_size_30845",
                                   "test_clusterWith.segmap_group_size_30879",
                                   "test_clusterWith.segmap_group_size_30893",
                                   "test_clusterWith.segmap_group_size_30921",
                                   "test_clusterWith.segmap_group_size_30955",
                                   "test_clusterWith.segmap_group_size_30969",
                                   "test_clusterWith.segmap_group_size_31023",
                                   "test_clusterWith.segmap_group_size_31070",
                                   "test_clusterWith.segmap_group_size_31104",
                                   "test_clusterWith.segred_group_size_30605",
                                   "test_clusterWith.segred_group_size_30616",
                                   "test_clusterWith.segred_group_size_30626",
                                   "test_clusterWith.segred_group_size_30644",
                                   "test_clusterWith.segred_group_size_30973",
                                   "test_clusterWith.segred_group_size_30983",
                                   "test_clusterWith.segred_group_size_30993",
                                   "test_clusterWith.segred_group_size_31003",
                                   "test_clusterWith.segred_group_size_31035",
                                   "test_clusterWith.segred_num_groups_30607",
                                   "test_clusterWith.segred_num_groups_30618",
                                   "test_clusterWith.segred_num_groups_30628",
                                   "test_clusterWith.segred_num_groups_30646",
                                   "test_clusterWith.segred_num_groups_30975",
                                   "test_clusterWith.segred_num_groups_30985",
                                   "test_clusterWith.segred_num_groups_30995",
                                   "test_clusterWith.segred_num_groups_31005",
                                   "test_clusterWith.segred_num_groups_31037",
                                   "test_clusterWith.segscan_group_size_30487",
                                   "test_clusterWith.segscan_group_size_30569",
                                   "test_clusterWith.segscan_group_size_30577",
                                   "test_clusterWith.segscan_group_size_30591",
                                   "test_clusterWith.segscan_group_size_30636",
                                   "test_clusterWith.segscan_group_size_30669",
                                   "test_clusterWith.segscan_group_size_30677",
                                   "test_clusterWith.segscan_group_size_30795",
                                   "test_clusterWith.segscan_group_size_30861",
                                   "test_clusterWith.segscan_group_size_30869",
                                   "test_clusterWith.segscan_group_size_30883",
                                   "test_clusterWith.segscan_group_size_30937",
                                   "test_clusterWith.segscan_group_size_30945",
                                   "test_clusterWith.segscan_group_size_30959",
                                   "test_clusterWith.segscan_group_size_31013",
                                   "test_clusterWith.segscan_group_size_31027",
                                   "test_clusterWith.segscan_group_size_31060",
                                   "test_clusterWith.segscan_group_size_31086",
                                   "test_clusterWith.segscan_group_size_31094",
                                   "test_clusterWith.segscan_num_groups_30489",
                                   "test_clusterWith.segscan_num_groups_30571",
                                   "test_clusterWith.segscan_num_groups_30579",
                                   "test_clusterWith.segscan_num_groups_30593",
                                   "test_clusterWith.segscan_num_groups_30638",
                                   "test_clusterWith.segscan_num_groups_30671",
                                   "test_clusterWith.segscan_num_groups_30679",
                                   "test_clusterWith.segscan_num_groups_30797",
                                   "test_clusterWith.segscan_num_groups_30863",
                                   "test_clusterWith.segscan_num_groups_30871",
                                   "test_clusterWith.segscan_num_groups_30885",
                                   "test_clusterWith.segscan_num_groups_30939",
                                   "test_clusterWith.segscan_num_groups_30947",
                                   "test_clusterWith.segscan_num_groups_30961",
                                   "test_clusterWith.segscan_num_groups_31015",
                                   "test_clusterWith.segscan_num_groups_31029",
                                   "test_clusterWith.segscan_num_groups_31062",
                                   "test_clusterWith.segscan_num_groups_31088",
                                   "test_clusterWith.segscan_num_groups_31096",
                                   "test_elimDupesWith.group_size_32777",
                                   "test_elimDupesWith.segmap_group_size_30391",
                                   "test_elimDupesWith.segmap_group_size_30405",
                                   "test_elimDupesWith.segmap_group_size_30439",
                                   "test_elimDupesWith.segmap_group_size_30453",
                                   "test_elimDupesWith.segscan_group_size_30421",
                                   "test_elimDupesWith.segscan_group_size_30429",
                                   "test_elimDupesWith.segscan_group_size_30443",
                                   "test_elimDupesWith.segscan_num_groups_30423",
                                   "test_elimDupesWith.segscan_num_groups_30431",
                                   "test_elimDupesWith.segscan_num_groups_30445",
                                   "test_mkSegsFromSort_segInd.group_size_32776",
                                   "test_mkSegsFromSort_segInd.segmap_group_size_30255",
                                   "test_mkSegsFromSort_segInd.segmap_group_size_30269",
                                   "test_mkSegsFromSort_segInd.segmap_group_size_30303",
                                   "test_mkSegsFromSort_segInd.segmap_group_size_30317",
                                   "test_mkSegsFromSort_segInd.segscan_group_size_30285",
                                   "test_mkSegsFromSort_segInd.segscan_group_size_30293",
                                   "test_mkSegsFromSort_segInd.segscan_group_size_30307",
                                   "test_mkSegsFromSort_segInd.segscan_num_groups_30287",
                                   "test_mkSegsFromSort_segInd.segscan_num_groups_30295",
                                   "test_mkSegsFromSort_segInd.segscan_num_groups_30309",
                                   "test_mkSegsFromSort_segSize.group_size_32776",
                                   "test_mkSegsFromSort_segSize.segmap_group_size_30323",
                                   "test_mkSegsFromSort_segSize.segmap_group_size_30337",
                                   "test_mkSegsFromSort_segSize.segmap_group_size_30371",
                                   "test_mkSegsFromSort_segSize.segmap_group_size_30385",
                                   "test_mkSegsFromSort_segSize.segscan_group_size_30353",
                                   "test_mkSegsFromSort_segSize.segscan_group_size_30361",
                                   "test_mkSegsFromSort_segSize.segscan_group_size_30375",
                                   "test_mkSegsFromSort_segSize.segscan_num_groups_30355",
                                   "test_mkSegsFromSort_segSize.segscan_num_groups_30363",
                                   "test_mkSegsFromSort_segSize.segscan_num_groups_30377"};
static const char *size_vars[] = {"builtinzhiota_i64zigroup_sizze_32452",
                                  "builtinzhreplicate_i32zigroup_sizze_33030",
                                  "builtinzhreplicate_i64zigroup_sizze_32928",
                                  "builtinzhreplicate_i8zigroup_sizze_32498",
                                  "test_ballQueryziL2_sizze_33215",
                                  "test_ballQueryzigroup_sizze_33020",
                                  "test_ballQueryziseghist_group_sizze_31622",
                                  "test_ballQueryziseghist_num_groups_31624",
                                  "test_ballQueryzisegmap_group_sizze_31161",
                                  "test_ballQueryzisegmap_group_sizze_31185",
                                  "test_ballQueryzisegmap_group_sizze_31241",
                                  "test_ballQueryzisegmap_group_sizze_31247",
                                  "test_ballQueryzisegmap_group_sizze_31277",
                                  "test_ballQueryzisegmap_group_sizze_31311",
                                  "test_ballQueryzisegmap_group_sizze_31325",
                                  "test_ballQueryzisegmap_group_sizze_31423",
                                  "test_ballQueryzisegmap_group_sizze_31451",
                                  "test_ballQueryzisegmap_group_sizze_31510",
                                  "test_ballQueryzisegmap_group_sizze_31647",
                                  "test_ballQueryzisegmap_group_sizze_31690",
                                  "test_ballQueryzisegmap_group_sizze_31833",
                                  "test_ballQueryzisegred_group_sizze_31612",
                                  "test_ballQueryzisegred_group_sizze_31837",
                                  "test_ballQueryzisegred_num_groups_31614",
                                  "test_ballQueryzisegred_num_groups_31839",
                                  "test_ballQueryzisegscan_group_sizze_31231",
                                  "test_ballQueryzisegscan_group_sizze_31293",
                                  "test_ballQueryzisegscan_group_sizze_31301",
                                  "test_ballQueryzisegscan_group_sizze_31315",
                                  "test_ballQueryzisegscan_group_sizze_31604",
                                  "test_ballQueryzisegscan_group_sizze_31637",
                                  "test_ballQueryzisegscan_group_sizze_31663",
                                  "test_ballQueryzisegscan_group_sizze_31823",
                                  "test_ballQueryzisegscan_num_groups_31233",
                                  "test_ballQueryzisegscan_num_groups_31295",
                                  "test_ballQueryzisegscan_num_groups_31303",
                                  "test_ballQueryzisegscan_num_groups_31317",
                                  "test_ballQueryzisegscan_num_groups_31606",
                                  "test_ballQueryzisegscan_num_groups_31639",
                                  "test_ballQueryzisegscan_num_groups_31665",
                                  "test_ballQueryzisegscan_num_groups_31825",
                                  "test_clusterWithziL2_sizze_33319",
                                  "test_clusterWithziL2_sizze_34916",
                                  "test_clusterWithzigroup_sizze_33016",
                                  "test_clusterWithzigroup_sizze_34209",
                                  "test_clusterWithzigroup_sizze_34526",
                                  "test_clusterWithzigroup_sizze_35220",
                                  "test_clusterWithziseghist_group_sizze_30654",
                                  "test_clusterWithziseghist_group_sizze_31045",
                                  "test_clusterWithziseghist_num_groups_30656",
                                  "test_clusterWithziseghist_num_groups_31047",
                                  "test_clusterWithzisegmap_group_sizze_30475",
                                  "test_clusterWithzisegmap_group_sizze_30497",
                                  "test_clusterWithzisegmap_group_sizze_30503",
                                  "test_clusterWithzisegmap_group_sizze_30553",
                                  "test_clusterWithzisegmap_group_sizze_30587",
                                  "test_clusterWithzisegmap_group_sizze_30601",
                                  "test_clusterWithzisegmap_group_sizze_30687",
                                  "test_clusterWithzisegmap_group_sizze_30805",
                                  "test_clusterWithzisegmap_group_sizze_30811",
                                  "test_clusterWithzisegmap_group_sizze_30845",
                                  "test_clusterWithzisegmap_group_sizze_30879",
                                  "test_clusterWithzisegmap_group_sizze_30893",
                                  "test_clusterWithzisegmap_group_sizze_30921",
                                  "test_clusterWithzisegmap_group_sizze_30955",
                                  "test_clusterWithzisegmap_group_sizze_30969",
                                  "test_clusterWithzisegmap_group_sizze_31023",
                                  "test_clusterWithzisegmap_group_sizze_31070",
                                  "test_clusterWithzisegmap_group_sizze_31104",
                                  "test_clusterWithzisegred_group_sizze_30605",
                                  "test_clusterWithzisegred_group_sizze_30616",
                                  "test_clusterWithzisegred_group_sizze_30626",
                                  "test_clusterWithzisegred_group_sizze_30644",
                                  "test_clusterWithzisegred_group_sizze_30973",
                                  "test_clusterWithzisegred_group_sizze_30983",
                                  "test_clusterWithzisegred_group_sizze_30993",
                                  "test_clusterWithzisegred_group_sizze_31003",
                                  "test_clusterWithzisegred_group_sizze_31035",
                                  "test_clusterWithzisegred_num_groups_30607",
                                  "test_clusterWithzisegred_num_groups_30618",
                                  "test_clusterWithzisegred_num_groups_30628",
                                  "test_clusterWithzisegred_num_groups_30646",
                                  "test_clusterWithzisegred_num_groups_30975",
                                  "test_clusterWithzisegred_num_groups_30985",
                                  "test_clusterWithzisegred_num_groups_30995",
                                  "test_clusterWithzisegred_num_groups_31005",
                                  "test_clusterWithzisegred_num_groups_31037",
                                  "test_clusterWithzisegscan_group_sizze_30487",
                                  "test_clusterWithzisegscan_group_sizze_30569",
                                  "test_clusterWithzisegscan_group_sizze_30577",
                                  "test_clusterWithzisegscan_group_sizze_30591",
                                  "test_clusterWithzisegscan_group_sizze_30636",
                                  "test_clusterWithzisegscan_group_sizze_30669",
                                  "test_clusterWithzisegscan_group_sizze_30677",
                                  "test_clusterWithzisegscan_group_sizze_30795",
                                  "test_clusterWithzisegscan_group_sizze_30861",
                                  "test_clusterWithzisegscan_group_sizze_30869",
                                  "test_clusterWithzisegscan_group_sizze_30883",
                                  "test_clusterWithzisegscan_group_sizze_30937",
                                  "test_clusterWithzisegscan_group_sizze_30945",
                                  "test_clusterWithzisegscan_group_sizze_30959",
                                  "test_clusterWithzisegscan_group_sizze_31013",
                                  "test_clusterWithzisegscan_group_sizze_31027",
                                  "test_clusterWithzisegscan_group_sizze_31060",
                                  "test_clusterWithzisegscan_group_sizze_31086",
                                  "test_clusterWithzisegscan_group_sizze_31094",
                                  "test_clusterWithzisegscan_num_groups_30489",
                                  "test_clusterWithzisegscan_num_groups_30571",
                                  "test_clusterWithzisegscan_num_groups_30579",
                                  "test_clusterWithzisegscan_num_groups_30593",
                                  "test_clusterWithzisegscan_num_groups_30638",
                                  "test_clusterWithzisegscan_num_groups_30671",
                                  "test_clusterWithzisegscan_num_groups_30679",
                                  "test_clusterWithzisegscan_num_groups_30797",
                                  "test_clusterWithzisegscan_num_groups_30863",
                                  "test_clusterWithzisegscan_num_groups_30871",
                                  "test_clusterWithzisegscan_num_groups_30885",
                                  "test_clusterWithzisegscan_num_groups_30939",
                                  "test_clusterWithzisegscan_num_groups_30947",
                                  "test_clusterWithzisegscan_num_groups_30961",
                                  "test_clusterWithzisegscan_num_groups_31015",
                                  "test_clusterWithzisegscan_num_groups_31029",
                                  "test_clusterWithzisegscan_num_groups_31062",
                                  "test_clusterWithzisegscan_num_groups_31088",
                                  "test_clusterWithzisegscan_num_groups_31096",
                                  "test_elimDupesWithzigroup_sizze_32777",
                                  "test_elimDupesWithzisegmap_group_sizze_30391",
                                  "test_elimDupesWithzisegmap_group_sizze_30405",
                                  "test_elimDupesWithzisegmap_group_sizze_30439",
                                  "test_elimDupesWithzisegmap_group_sizze_30453",
                                  "test_elimDupesWithzisegscan_group_sizze_30421",
                                  "test_elimDupesWithzisegscan_group_sizze_30429",
                                  "test_elimDupesWithzisegscan_group_sizze_30443",
                                  "test_elimDupesWithzisegscan_num_groups_30423",
                                  "test_elimDupesWithzisegscan_num_groups_30431",
                                  "test_elimDupesWithzisegscan_num_groups_30445",
                                  "test_mkSegsFromSort_segIndzigroup_sizze_32776",
                                  "test_mkSegsFromSort_segIndzisegmap_group_sizze_30255",
                                  "test_mkSegsFromSort_segIndzisegmap_group_sizze_30269",
                                  "test_mkSegsFromSort_segIndzisegmap_group_sizze_30303",
                                  "test_mkSegsFromSort_segIndzisegmap_group_sizze_30317",
                                  "test_mkSegsFromSort_segIndzisegscan_group_sizze_30285",
                                  "test_mkSegsFromSort_segIndzisegscan_group_sizze_30293",
                                  "test_mkSegsFromSort_segIndzisegscan_group_sizze_30307",
                                  "test_mkSegsFromSort_segIndzisegscan_num_groups_30287",
                                  "test_mkSegsFromSort_segIndzisegscan_num_groups_30295",
                                  "test_mkSegsFromSort_segIndzisegscan_num_groups_30309",
                                  "test_mkSegsFromSort_segSizzezigroup_sizze_32776",
                                  "test_mkSegsFromSort_segSizzezisegmap_group_sizze_30323",
                                  "test_mkSegsFromSort_segSizzezisegmap_group_sizze_30337",
                                  "test_mkSegsFromSort_segSizzezisegmap_group_sizze_30371",
                                  "test_mkSegsFromSort_segSizzezisegmap_group_sizze_30385",
                                  "test_mkSegsFromSort_segSizzezisegscan_group_sizze_30353",
                                  "test_mkSegsFromSort_segSizzezisegscan_group_sizze_30361",
                                  "test_mkSegsFromSort_segSizzezisegscan_group_sizze_30375",
                                  "test_mkSegsFromSort_segSizzezisegscan_num_groups_30355",
                                  "test_mkSegsFromSort_segSizzezisegscan_num_groups_30363",
                                  "test_mkSegsFromSort_segSizzezisegscan_num_groups_30377"};
static const char *size_classes[] = {"group_size", "group_size", "group_size",
                                     "group_size",
                                     "bespoke(L2_for_histogram, 4194304)",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "bespoke(L2_for_histogram, 4194304)",
                                     "bespoke(L2_for_histogram, 4194304)",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups"};
struct sizes {
    int64_t builtinzhiota_i64zigroup_sizze_32452;
    int64_t builtinzhreplicate_i32zigroup_sizze_33030;
    int64_t builtinzhreplicate_i64zigroup_sizze_32928;
    int64_t builtinzhreplicate_i8zigroup_sizze_32498;
    int64_t test_ballQueryziL2_sizze_33215;
    int64_t test_ballQueryzigroup_sizze_33020;
    int64_t test_ballQueryziseghist_group_sizze_31622;
    int64_t test_ballQueryziseghist_num_groups_31624;
    int64_t test_ballQueryzisegmap_group_sizze_31161;
    int64_t test_ballQueryzisegmap_group_sizze_31185;
    int64_t test_ballQueryzisegmap_group_sizze_31241;
    int64_t test_ballQueryzisegmap_group_sizze_31247;
    int64_t test_ballQueryzisegmap_group_sizze_31277;
    int64_t test_ballQueryzisegmap_group_sizze_31311;
    int64_t test_ballQueryzisegmap_group_sizze_31325;
    int64_t test_ballQueryzisegmap_group_sizze_31423;
    int64_t test_ballQueryzisegmap_group_sizze_31451;
    int64_t test_ballQueryzisegmap_group_sizze_31510;
    int64_t test_ballQueryzisegmap_group_sizze_31647;
    int64_t test_ballQueryzisegmap_group_sizze_31690;
    int64_t test_ballQueryzisegmap_group_sizze_31833;
    int64_t test_ballQueryzisegred_group_sizze_31612;
    int64_t test_ballQueryzisegred_group_sizze_31837;
    int64_t test_ballQueryzisegred_num_groups_31614;
    int64_t test_ballQueryzisegred_num_groups_31839;
    int64_t test_ballQueryzisegscan_group_sizze_31231;
    int64_t test_ballQueryzisegscan_group_sizze_31293;
    int64_t test_ballQueryzisegscan_group_sizze_31301;
    int64_t test_ballQueryzisegscan_group_sizze_31315;
    int64_t test_ballQueryzisegscan_group_sizze_31604;
    int64_t test_ballQueryzisegscan_group_sizze_31637;
    int64_t test_ballQueryzisegscan_group_sizze_31663;
    int64_t test_ballQueryzisegscan_group_sizze_31823;
    int64_t test_ballQueryzisegscan_num_groups_31233;
    int64_t test_ballQueryzisegscan_num_groups_31295;
    int64_t test_ballQueryzisegscan_num_groups_31303;
    int64_t test_ballQueryzisegscan_num_groups_31317;
    int64_t test_ballQueryzisegscan_num_groups_31606;
    int64_t test_ballQueryzisegscan_num_groups_31639;
    int64_t test_ballQueryzisegscan_num_groups_31665;
    int64_t test_ballQueryzisegscan_num_groups_31825;
    int64_t test_clusterWithziL2_sizze_33319;
    int64_t test_clusterWithziL2_sizze_34916;
    int64_t test_clusterWithzigroup_sizze_33016;
    int64_t test_clusterWithzigroup_sizze_34209;
    int64_t test_clusterWithzigroup_sizze_34526;
    int64_t test_clusterWithzigroup_sizze_35220;
    int64_t test_clusterWithziseghist_group_sizze_30654;
    int64_t test_clusterWithziseghist_group_sizze_31045;
    int64_t test_clusterWithziseghist_num_groups_30656;
    int64_t test_clusterWithziseghist_num_groups_31047;
    int64_t test_clusterWithzisegmap_group_sizze_30475;
    int64_t test_clusterWithzisegmap_group_sizze_30497;
    int64_t test_clusterWithzisegmap_group_sizze_30503;
    int64_t test_clusterWithzisegmap_group_sizze_30553;
    int64_t test_clusterWithzisegmap_group_sizze_30587;
    int64_t test_clusterWithzisegmap_group_sizze_30601;
    int64_t test_clusterWithzisegmap_group_sizze_30687;
    int64_t test_clusterWithzisegmap_group_sizze_30805;
    int64_t test_clusterWithzisegmap_group_sizze_30811;
    int64_t test_clusterWithzisegmap_group_sizze_30845;
    int64_t test_clusterWithzisegmap_group_sizze_30879;
    int64_t test_clusterWithzisegmap_group_sizze_30893;
    int64_t test_clusterWithzisegmap_group_sizze_30921;
    int64_t test_clusterWithzisegmap_group_sizze_30955;
    int64_t test_clusterWithzisegmap_group_sizze_30969;
    int64_t test_clusterWithzisegmap_group_sizze_31023;
    int64_t test_clusterWithzisegmap_group_sizze_31070;
    int64_t test_clusterWithzisegmap_group_sizze_31104;
    int64_t test_clusterWithzisegred_group_sizze_30605;
    int64_t test_clusterWithzisegred_group_sizze_30616;
    int64_t test_clusterWithzisegred_group_sizze_30626;
    int64_t test_clusterWithzisegred_group_sizze_30644;
    int64_t test_clusterWithzisegred_group_sizze_30973;
    int64_t test_clusterWithzisegred_group_sizze_30983;
    int64_t test_clusterWithzisegred_group_sizze_30993;
    int64_t test_clusterWithzisegred_group_sizze_31003;
    int64_t test_clusterWithzisegred_group_sizze_31035;
    int64_t test_clusterWithzisegred_num_groups_30607;
    int64_t test_clusterWithzisegred_num_groups_30618;
    int64_t test_clusterWithzisegred_num_groups_30628;
    int64_t test_clusterWithzisegred_num_groups_30646;
    int64_t test_clusterWithzisegred_num_groups_30975;
    int64_t test_clusterWithzisegred_num_groups_30985;
    int64_t test_clusterWithzisegred_num_groups_30995;
    int64_t test_clusterWithzisegred_num_groups_31005;
    int64_t test_clusterWithzisegred_num_groups_31037;
    int64_t test_clusterWithzisegscan_group_sizze_30487;
    int64_t test_clusterWithzisegscan_group_sizze_30569;
    int64_t test_clusterWithzisegscan_group_sizze_30577;
    int64_t test_clusterWithzisegscan_group_sizze_30591;
    int64_t test_clusterWithzisegscan_group_sizze_30636;
    int64_t test_clusterWithzisegscan_group_sizze_30669;
    int64_t test_clusterWithzisegscan_group_sizze_30677;
    int64_t test_clusterWithzisegscan_group_sizze_30795;
    int64_t test_clusterWithzisegscan_group_sizze_30861;
    int64_t test_clusterWithzisegscan_group_sizze_30869;
    int64_t test_clusterWithzisegscan_group_sizze_30883;
    int64_t test_clusterWithzisegscan_group_sizze_30937;
    int64_t test_clusterWithzisegscan_group_sizze_30945;
    int64_t test_clusterWithzisegscan_group_sizze_30959;
    int64_t test_clusterWithzisegscan_group_sizze_31013;
    int64_t test_clusterWithzisegscan_group_sizze_31027;
    int64_t test_clusterWithzisegscan_group_sizze_31060;
    int64_t test_clusterWithzisegscan_group_sizze_31086;
    int64_t test_clusterWithzisegscan_group_sizze_31094;
    int64_t test_clusterWithzisegscan_num_groups_30489;
    int64_t test_clusterWithzisegscan_num_groups_30571;
    int64_t test_clusterWithzisegscan_num_groups_30579;
    int64_t test_clusterWithzisegscan_num_groups_30593;
    int64_t test_clusterWithzisegscan_num_groups_30638;
    int64_t test_clusterWithzisegscan_num_groups_30671;
    int64_t test_clusterWithzisegscan_num_groups_30679;
    int64_t test_clusterWithzisegscan_num_groups_30797;
    int64_t test_clusterWithzisegscan_num_groups_30863;
    int64_t test_clusterWithzisegscan_num_groups_30871;
    int64_t test_clusterWithzisegscan_num_groups_30885;
    int64_t test_clusterWithzisegscan_num_groups_30939;
    int64_t test_clusterWithzisegscan_num_groups_30947;
    int64_t test_clusterWithzisegscan_num_groups_30961;
    int64_t test_clusterWithzisegscan_num_groups_31015;
    int64_t test_clusterWithzisegscan_num_groups_31029;
    int64_t test_clusterWithzisegscan_num_groups_31062;
    int64_t test_clusterWithzisegscan_num_groups_31088;
    int64_t test_clusterWithzisegscan_num_groups_31096;
    int64_t test_elimDupesWithzigroup_sizze_32777;
    int64_t test_elimDupesWithzisegmap_group_sizze_30391;
    int64_t test_elimDupesWithzisegmap_group_sizze_30405;
    int64_t test_elimDupesWithzisegmap_group_sizze_30439;
    int64_t test_elimDupesWithzisegmap_group_sizze_30453;
    int64_t test_elimDupesWithzisegscan_group_sizze_30421;
    int64_t test_elimDupesWithzisegscan_group_sizze_30429;
    int64_t test_elimDupesWithzisegscan_group_sizze_30443;
    int64_t test_elimDupesWithzisegscan_num_groups_30423;
    int64_t test_elimDupesWithzisegscan_num_groups_30431;
    int64_t test_elimDupesWithzisegscan_num_groups_30445;
    int64_t test_mkSegsFromSort_segIndzigroup_sizze_32776;
    int64_t test_mkSegsFromSort_segIndzisegmap_group_sizze_30255;
    int64_t test_mkSegsFromSort_segIndzisegmap_group_sizze_30269;
    int64_t test_mkSegsFromSort_segIndzisegmap_group_sizze_30303;
    int64_t test_mkSegsFromSort_segIndzisegmap_group_sizze_30317;
    int64_t test_mkSegsFromSort_segIndzisegscan_group_sizze_30285;
    int64_t test_mkSegsFromSort_segIndzisegscan_group_sizze_30293;
    int64_t test_mkSegsFromSort_segIndzisegscan_group_sizze_30307;
    int64_t test_mkSegsFromSort_segIndzisegscan_num_groups_30287;
    int64_t test_mkSegsFromSort_segIndzisegscan_num_groups_30295;
    int64_t test_mkSegsFromSort_segIndzisegscan_num_groups_30309;
    int64_t test_mkSegsFromSort_segSizzezigroup_sizze_32776;
    int64_t test_mkSegsFromSort_segSizzezisegmap_group_sizze_30323;
    int64_t test_mkSegsFromSort_segSizzezisegmap_group_sizze_30337;
    int64_t test_mkSegsFromSort_segSizzezisegmap_group_sizze_30371;
    int64_t test_mkSegsFromSort_segSizzezisegmap_group_sizze_30385;
    int64_t test_mkSegsFromSort_segSizzezisegscan_group_sizze_30353;
    int64_t test_mkSegsFromSort_segSizzezisegscan_group_sizze_30361;
    int64_t test_mkSegsFromSort_segSizzezisegscan_group_sizze_30375;
    int64_t test_mkSegsFromSort_segSizzezisegscan_num_groups_30355;
    int64_t test_mkSegsFromSort_segSizzezisegscan_num_groups_30363;
    int64_t test_mkSegsFromSort_segSizzezisegscan_num_groups_30377;
} ;
struct futhark_context_config {
    struct cuda_config cu_cfg;
    int profiling;
    int64_t sizes[158];
    int num_nvrtc_opts;
    const char **nvrtc_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->profiling = 0;
    cfg->num_nvrtc_opts = 0;
    cfg->nvrtc_opts = (const char **) malloc(sizeof(const char *));
    cfg->nvrtc_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 0;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 4194304;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 4194304;
    cfg->sizes[42] = 4194304;
    cfg->sizes[43] = 0;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 0;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    cfg->sizes[60] = 0;
    cfg->sizes[61] = 0;
    cfg->sizes[62] = 0;
    cfg->sizes[63] = 0;
    cfg->sizes[64] = 0;
    cfg->sizes[65] = 0;
    cfg->sizes[66] = 0;
    cfg->sizes[67] = 0;
    cfg->sizes[68] = 0;
    cfg->sizes[69] = 0;
    cfg->sizes[70] = 0;
    cfg->sizes[71] = 0;
    cfg->sizes[72] = 0;
    cfg->sizes[73] = 0;
    cfg->sizes[74] = 0;
    cfg->sizes[75] = 0;
    cfg->sizes[76] = 0;
    cfg->sizes[77] = 0;
    cfg->sizes[78] = 0;
    cfg->sizes[79] = 0;
    cfg->sizes[80] = 0;
    cfg->sizes[81] = 0;
    cfg->sizes[82] = 0;
    cfg->sizes[83] = 0;
    cfg->sizes[84] = 0;
    cfg->sizes[85] = 0;
    cfg->sizes[86] = 0;
    cfg->sizes[87] = 0;
    cfg->sizes[88] = 0;
    cfg->sizes[89] = 0;
    cfg->sizes[90] = 0;
    cfg->sizes[91] = 0;
    cfg->sizes[92] = 0;
    cfg->sizes[93] = 0;
    cfg->sizes[94] = 0;
    cfg->sizes[95] = 0;
    cfg->sizes[96] = 0;
    cfg->sizes[97] = 0;
    cfg->sizes[98] = 0;
    cfg->sizes[99] = 0;
    cfg->sizes[100] = 0;
    cfg->sizes[101] = 0;
    cfg->sizes[102] = 0;
    cfg->sizes[103] = 0;
    cfg->sizes[104] = 0;
    cfg->sizes[105] = 0;
    cfg->sizes[106] = 0;
    cfg->sizes[107] = 0;
    cfg->sizes[108] = 0;
    cfg->sizes[109] = 0;
    cfg->sizes[110] = 0;
    cfg->sizes[111] = 0;
    cfg->sizes[112] = 0;
    cfg->sizes[113] = 0;
    cfg->sizes[114] = 0;
    cfg->sizes[115] = 0;
    cfg->sizes[116] = 0;
    cfg->sizes[117] = 0;
    cfg->sizes[118] = 0;
    cfg->sizes[119] = 0;
    cfg->sizes[120] = 0;
    cfg->sizes[121] = 0;
    cfg->sizes[122] = 0;
    cfg->sizes[123] = 0;
    cfg->sizes[124] = 0;
    cfg->sizes[125] = 0;
    cfg->sizes[126] = 0;
    cfg->sizes[127] = 0;
    cfg->sizes[128] = 0;
    cfg->sizes[129] = 0;
    cfg->sizes[130] = 0;
    cfg->sizes[131] = 0;
    cfg->sizes[132] = 0;
    cfg->sizes[133] = 0;
    cfg->sizes[134] = 0;
    cfg->sizes[135] = 0;
    cfg->sizes[136] = 0;
    cfg->sizes[137] = 0;
    cfg->sizes[138] = 0;
    cfg->sizes[139] = 0;
    cfg->sizes[140] = 0;
    cfg->sizes[141] = 0;
    cfg->sizes[142] = 0;
    cfg->sizes[143] = 0;
    cfg->sizes[144] = 0;
    cfg->sizes[145] = 0;
    cfg->sizes[146] = 0;
    cfg->sizes[147] = 0;
    cfg->sizes[148] = 0;
    cfg->sizes[149] = 0;
    cfg->sizes[150] = 0;
    cfg->sizes[151] = 0;
    cfg->sizes[152] = 0;
    cfg->sizes[153] = 0;
    cfg->sizes[154] = 0;
    cfg->sizes[155] = 0;
    cfg->sizes[156] = 0;
    cfg->sizes[157] = 0;
    cuda_config_init(&cfg->cu_cfg, 158, size_names, size_vars, cfg->sizes,
                     size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->nvrtc_opts);
    free(cfg);
}
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->nvrtc_opts[cfg->num_nvrtc_opts] = opt;
    cfg->num_nvrtc_opts++;
    cfg->nvrtc_opts = (const char **) realloc(cfg->nvrtc_opts,
                                              (cfg->num_nvrtc_opts + 1) *
                                              sizeof(const char *));
    cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->cu_cfg.logging = cfg->cu_cfg.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->cu_cfg.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->cu_cfg, s);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->cu_cfg.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->cu_cfg.load_program_from = path;
}
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg,
                                        const char *path)
{
    cfg->cu_cfg.dump_ptx_to = path;
}
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg,
                                          const char *path)
{
    cfg->cu_cfg.load_ptx_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->cu_cfg.default_block_size = size;
    cfg->cu_cfg.default_block_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->cu_cfg.default_grid_size = num;
    cfg->cu_cfg.default_grid_size_changed = 1;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->cu_cfg.default_tile_size = size;
    cfg->cu_cfg.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg,
                                                      int size)
{
    cfg->cu_cfg.default_reg_tile_size = size;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->cu_cfg.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 158; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->cu_cfg.default_block_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->cu_cfg.default_grid_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->cu_cfg.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->cu_cfg.default_tile_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_reg_tile_size") == 0) {
        cfg->cu_cfg.default_reg_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    FILE *log;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device test_ballQueryziid_counter_mem_32471;
    struct memblock_device test_ballQueryziid_counter_mem_32709;
    struct memblock_device test_ballQueryziid_counter_mem_32842;
    struct memblock_device test_ballQueryziid_counter_mem_32938;
    struct memblock_device test_ballQueryziid_counter_mem_33045;
    struct memblock_device test_ballQueryzicounter_mem_33125;
    struct memblock_device test_ballQueryzicounter_mem_33264;
    struct memblock_device test_ballQueryziid_counter_mem_33299;
    struct memblock_device test_ballQueryziid_counter_mem_33437;
    struct memblock_device test_ballQueryziid_counter_mem_33580;
    struct memblock_device test_ballQueryzicounter_mem_33797;
    struct memblock_device test_clusterWithziid_counter_mem_32467;
    struct memblock_device test_clusterWithziid_counter_mem_32705;
    struct memblock_device test_clusterWithziid_counter_mem_32838;
    struct memblock_device test_clusterWithziid_counter_mem_32934;
    struct memblock_device test_clusterWithzicounter_mem_33033;
    struct memblock_device test_clusterWithzicounter_mem_33081;
    struct memblock_device test_clusterWithzicounter_mem_33112;
    struct memblock_device test_clusterWithziid_counter_mem_33151;
    struct memblock_device test_clusterWithzicounter_mem_33230;
    struct memblock_device test_clusterWithzicounter_mem_33368;
    struct memblock_device test_clusterWithziid_counter_mem_33403;
    struct memblock_device test_clusterWithziid_counter_mem_33536;
    struct memblock_device test_clusterWithziid_counter_mem_33678;
    struct memblock_device test_clusterWithziid_counter_mem_33907;
    struct memblock_device test_clusterWithziid_counter_mem_34040;
    struct memblock_device test_clusterWithziid_counter_mem_34127;
    struct memblock_device test_clusterWithziid_counter_mem_34224;
    struct memblock_device test_clusterWithziid_counter_mem_34357;
    struct memblock_device test_clusterWithziid_counter_mem_34444;
    struct memblock_device test_clusterWithzicounter_mem_34534;
    struct memblock_device test_clusterWithzicounter_mem_34565;
    struct memblock_device test_clusterWithzicounter_mem_34596;
    struct memblock_device test_clusterWithzicounter_mem_34626;
    struct memblock_device test_clusterWithziid_counter_mem_34659;
    struct memblock_device test_clusterWithziid_counter_mem_34747;
    struct memblock_device test_clusterWithzicounter_mem_34826;
    struct memblock_device test_clusterWithzicounter_mem_34965;
    struct memblock_device test_clusterWithziid_counter_mem_35000;
    struct memblock_device test_clusterWithziid_counter_mem_35138;
    struct memblock_device test_clusterWithziid_counter_mem_35225;
    struct memblock_device test_elimDupesWithziid_counter_mem_32457;
    struct memblock_device test_elimDupesWithziid_counter_mem_32599;
    struct memblock_device test_elimDupesWithziid_counter_mem_32695;
    struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32456;
    struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32598;
    struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32694;
    struct memblock_device test_mkSegsFromSort_segSizzeziid_counter_mem_32456;
    struct memblock_device test_mkSegsFromSort_segSizzeziid_counter_mem_32598;
    struct memblock_device test_mkSegsFromSort_segSizzeziid_counter_mem_32694;
    CUfunction builtinzhiota_i64ziiota_i64_32449;
    int64_t builtinzhiota_i64ziiota_i64_32449_total_runtime;
    int builtinzhiota_i64ziiota_i64_32449_runs;
    CUfunction builtinzhreplicate_i32zireplicate_33027;
    int64_t builtinzhreplicate_i32zireplicate_33027_total_runtime;
    int builtinzhreplicate_i32zireplicate_33027_runs;
    CUfunction builtinzhreplicate_i64zireplicate_32925;
    int64_t builtinzhreplicate_i64zireplicate_32925_total_runtime;
    int builtinzhreplicate_i64zireplicate_32925_runs;
    CUfunction builtinzhreplicate_i8zireplicate_32495;
    int64_t builtinzhreplicate_i8zireplicate_32495_total_runtime;
    int builtinzhreplicate_i8zireplicate_32495_runs;
    CUfunction test_ballQueryzicopy_33017;
    int64_t test_ballQueryzicopy_33017_total_runtime;
    int test_ballQueryzicopy_33017_runs;
    CUfunction test_ballQueryziseghist_global_31628;
    int64_t test_ballQueryziseghist_global_31628_total_runtime;
    int test_ballQueryziseghist_global_31628_runs;
    CUfunction test_ballQueryziseghist_local_31628;
    int64_t test_ballQueryziseghist_local_31628_total_runtime;
    int test_ballQueryziseghist_local_31628_runs;
    CUfunction test_ballQueryzisegmap_31159;
    int64_t test_ballQueryzisegmap_31159_total_runtime;
    int test_ballQueryzisegmap_31159_runs;
    CUfunction test_ballQueryzisegmap_31182;
    int64_t test_ballQueryzisegmap_31182_total_runtime;
    int test_ballQueryzisegmap_31182_runs;
    CUfunction test_ballQueryzisegmap_31239;
    int64_t test_ballQueryzisegmap_31239_total_runtime;
    int test_ballQueryzisegmap_31239_runs;
    CUfunction test_ballQueryzisegmap_31245;
    int64_t test_ballQueryzisegmap_31245_total_runtime;
    int test_ballQueryzisegmap_31245_runs;
    CUfunction test_ballQueryzisegmap_31275;
    int64_t test_ballQueryzisegmap_31275_total_runtime;
    int test_ballQueryzisegmap_31275_runs;
    CUfunction test_ballQueryzisegmap_31309;
    int64_t test_ballQueryzisegmap_31309_total_runtime;
    int test_ballQueryzisegmap_31309_runs;
    CUfunction test_ballQueryzisegmap_31323;
    int64_t test_ballQueryzisegmap_31323_total_runtime;
    int test_ballQueryzisegmap_31323_runs;
    CUfunction test_ballQueryzisegmap_31420;
    int64_t test_ballQueryzisegmap_31420_total_runtime;
    int test_ballQueryzisegmap_31420_runs;
    CUfunction test_ballQueryzisegmap_31447;
    int64_t test_ballQueryzisegmap_31447_total_runtime;
    int test_ballQueryzisegmap_31447_runs;
    CUfunction test_ballQueryzisegmap_31507;
    int64_t test_ballQueryzisegmap_31507_total_runtime;
    int test_ballQueryzisegmap_31507_runs;
    CUfunction test_ballQueryzisegmap_31645;
    int64_t test_ballQueryzisegmap_31645_total_runtime;
    int test_ballQueryzisegmap_31645_runs;
    CUfunction test_ballQueryzisegmap_31688;
    int64_t test_ballQueryzisegmap_31688_total_runtime;
    int test_ballQueryzisegmap_31688_runs;
    CUfunction test_ballQueryzisegmap_31831;
    int64_t test_ballQueryzisegmap_31831_total_runtime;
    int test_ballQueryzisegmap_31831_runs;
    CUfunction test_ballQueryzisegred_large_33235;
    int64_t test_ballQueryzisegred_large_33235_total_runtime;
    int test_ballQueryzisegred_large_33235_runs;
    CUfunction test_ballQueryzisegred_nonseg_31620;
    int64_t test_ballQueryzisegred_nonseg_31620_total_runtime;
    int test_ballQueryzisegred_nonseg_31620_runs;
    CUfunction test_ballQueryzisegred_nonseg_31846;
    int64_t test_ballQueryzisegred_nonseg_31846_total_runtime;
    int test_ballQueryzisegred_nonseg_31846_runs;
    CUfunction test_ballQueryzisegred_small_33235;
    int64_t test_ballQueryzisegred_small_33235_total_runtime;
    int test_ballQueryzisegred_small_33235_runs;
    CUfunction test_ballQueryzisegscan_31237;
    int64_t test_ballQueryzisegscan_31237_total_runtime;
    int test_ballQueryzisegscan_31237_runs;
    CUfunction test_ballQueryzisegscan_31299;
    int64_t test_ballQueryzisegscan_31299_total_runtime;
    int test_ballQueryzisegscan_31299_runs;
    CUfunction test_ballQueryzisegscan_31307;
    int64_t test_ballQueryzisegscan_31307_total_runtime;
    int test_ballQueryzisegscan_31307_runs;
    CUfunction test_ballQueryzisegscan_31321;
    int64_t test_ballQueryzisegscan_31321_total_runtime;
    int test_ballQueryzisegscan_31321_runs;
    CUfunction test_ballQueryzisegscan_31610;
    int64_t test_ballQueryzisegscan_31610_total_runtime;
    int test_ballQueryzisegscan_31610_runs;
    CUfunction test_ballQueryzisegscan_31643;
    int64_t test_ballQueryzisegscan_31643_total_runtime;
    int test_ballQueryzisegscan_31643_runs;
    CUfunction test_ballQueryzisegscan_31669;
    int64_t test_ballQueryzisegscan_31669_total_runtime;
    int test_ballQueryzisegscan_31669_runs;
    CUfunction test_ballQueryzisegscan_31829;
    int64_t test_ballQueryzisegscan_31829_total_runtime;
    int test_ballQueryzisegscan_31829_runs;
    CUfunction test_clusterWithzicopy_33013;
    int64_t test_clusterWithzicopy_33013_total_runtime;
    int test_clusterWithzicopy_33013_runs;
    CUfunction test_clusterWithzicopy_34206;
    int64_t test_clusterWithzicopy_34206_total_runtime;
    int test_clusterWithzicopy_34206_runs;
    CUfunction test_clusterWithzicopy_34523;
    int64_t test_clusterWithzicopy_34523_total_runtime;
    int test_clusterWithzicopy_34523_runs;
    CUfunction test_clusterWithzicopy_35217;
    int64_t test_clusterWithzicopy_35217_total_runtime;
    int test_clusterWithzicopy_35217_runs;
    CUfunction test_clusterWithziseghist_global_30660;
    int64_t test_clusterWithziseghist_global_30660_total_runtime;
    int test_clusterWithziseghist_global_30660_runs;
    CUfunction test_clusterWithziseghist_global_31051;
    int64_t test_clusterWithziseghist_global_31051_total_runtime;
    int test_clusterWithziseghist_global_31051_runs;
    CUfunction test_clusterWithziseghist_local_30660;
    int64_t test_clusterWithziseghist_local_30660_total_runtime;
    int test_clusterWithziseghist_local_30660_runs;
    CUfunction test_clusterWithziseghist_local_31051;
    int64_t test_clusterWithziseghist_local_31051_total_runtime;
    int test_clusterWithziseghist_local_31051_runs;
    CUfunction test_clusterWithzisegmap_30473;
    int64_t test_clusterWithzisegmap_30473_total_runtime;
    int test_clusterWithzisegmap_30473_runs;
    CUfunction test_clusterWithzisegmap_30495;
    int64_t test_clusterWithzisegmap_30495_total_runtime;
    int test_clusterWithzisegmap_30495_runs;
    CUfunction test_clusterWithzisegmap_30501;
    int64_t test_clusterWithzisegmap_30501_total_runtime;
    int test_clusterWithzisegmap_30501_runs;
    CUfunction test_clusterWithzisegmap_30551;
    int64_t test_clusterWithzisegmap_30551_total_runtime;
    int test_clusterWithzisegmap_30551_runs;
    CUfunction test_clusterWithzisegmap_30585;
    int64_t test_clusterWithzisegmap_30585_total_runtime;
    int test_clusterWithzisegmap_30585_runs;
    CUfunction test_clusterWithzisegmap_30599;
    int64_t test_clusterWithzisegmap_30599_total_runtime;
    int test_clusterWithzisegmap_30599_runs;
    CUfunction test_clusterWithzisegmap_30685;
    int64_t test_clusterWithzisegmap_30685_total_runtime;
    int test_clusterWithzisegmap_30685_runs;
    CUfunction test_clusterWithzisegmap_30803;
    int64_t test_clusterWithzisegmap_30803_total_runtime;
    int test_clusterWithzisegmap_30803_runs;
    CUfunction test_clusterWithzisegmap_30809;
    int64_t test_clusterWithzisegmap_30809_total_runtime;
    int test_clusterWithzisegmap_30809_runs;
    CUfunction test_clusterWithzisegmap_30843;
    int64_t test_clusterWithzisegmap_30843_total_runtime;
    int test_clusterWithzisegmap_30843_runs;
    CUfunction test_clusterWithzisegmap_30877;
    int64_t test_clusterWithzisegmap_30877_total_runtime;
    int test_clusterWithzisegmap_30877_runs;
    CUfunction test_clusterWithzisegmap_30891;
    int64_t test_clusterWithzisegmap_30891_total_runtime;
    int test_clusterWithzisegmap_30891_runs;
    CUfunction test_clusterWithzisegmap_30919;
    int64_t test_clusterWithzisegmap_30919_total_runtime;
    int test_clusterWithzisegmap_30919_runs;
    CUfunction test_clusterWithzisegmap_30953;
    int64_t test_clusterWithzisegmap_30953_total_runtime;
    int test_clusterWithzisegmap_30953_runs;
    CUfunction test_clusterWithzisegmap_30967;
    int64_t test_clusterWithzisegmap_30967_total_runtime;
    int test_clusterWithzisegmap_30967_runs;
    CUfunction test_clusterWithzisegmap_31021;
    int64_t test_clusterWithzisegmap_31021_total_runtime;
    int test_clusterWithzisegmap_31021_runs;
    CUfunction test_clusterWithzisegmap_31068;
    int64_t test_clusterWithzisegmap_31068_total_runtime;
    int test_clusterWithzisegmap_31068_runs;
    CUfunction test_clusterWithzisegmap_31102;
    int64_t test_clusterWithzisegmap_31102_total_runtime;
    int test_clusterWithzisegmap_31102_runs;
    CUfunction test_clusterWithzisegred_large_33339;
    int64_t test_clusterWithzisegred_large_33339_total_runtime;
    int test_clusterWithzisegred_large_33339_runs;
    CUfunction test_clusterWithzisegred_large_34936;
    int64_t test_clusterWithzisegred_large_34936_total_runtime;
    int test_clusterWithzisegred_large_34936_runs;
    CUfunction test_clusterWithzisegred_nonseg_30614;
    int64_t test_clusterWithzisegred_nonseg_30614_total_runtime;
    int test_clusterWithzisegred_nonseg_30614_runs;
    CUfunction test_clusterWithzisegred_nonseg_30624;
    int64_t test_clusterWithzisegred_nonseg_30624_total_runtime;
    int test_clusterWithzisegred_nonseg_30624_runs;
    CUfunction test_clusterWithzisegred_nonseg_30634;
    int64_t test_clusterWithzisegred_nonseg_30634_total_runtime;
    int test_clusterWithzisegred_nonseg_30634_runs;
    CUfunction test_clusterWithzisegred_nonseg_30652;
    int64_t test_clusterWithzisegred_nonseg_30652_total_runtime;
    int test_clusterWithzisegred_nonseg_30652_runs;
    CUfunction test_clusterWithzisegred_nonseg_30981;
    int64_t test_clusterWithzisegred_nonseg_30981_total_runtime;
    int test_clusterWithzisegred_nonseg_30981_runs;
    CUfunction test_clusterWithzisegred_nonseg_30991;
    int64_t test_clusterWithzisegred_nonseg_30991_total_runtime;
    int test_clusterWithzisegred_nonseg_30991_runs;
    CUfunction test_clusterWithzisegred_nonseg_31001;
    int64_t test_clusterWithzisegred_nonseg_31001_total_runtime;
    int test_clusterWithzisegred_nonseg_31001_runs;
    CUfunction test_clusterWithzisegred_nonseg_31011;
    int64_t test_clusterWithzisegred_nonseg_31011_total_runtime;
    int test_clusterWithzisegred_nonseg_31011_runs;
    CUfunction test_clusterWithzisegred_nonseg_31043;
    int64_t test_clusterWithzisegred_nonseg_31043_total_runtime;
    int test_clusterWithzisegred_nonseg_31043_runs;
    CUfunction test_clusterWithzisegred_small_33339;
    int64_t test_clusterWithzisegred_small_33339_total_runtime;
    int test_clusterWithzisegred_small_33339_runs;
    CUfunction test_clusterWithzisegred_small_34936;
    int64_t test_clusterWithzisegred_small_34936_total_runtime;
    int test_clusterWithzisegred_small_34936_runs;
    CUfunction test_clusterWithzisegscan_30493;
    int64_t test_clusterWithzisegscan_30493_total_runtime;
    int test_clusterWithzisegscan_30493_runs;
    CUfunction test_clusterWithzisegscan_30575;
    int64_t test_clusterWithzisegscan_30575_total_runtime;
    int test_clusterWithzisegscan_30575_runs;
    CUfunction test_clusterWithzisegscan_30583;
    int64_t test_clusterWithzisegscan_30583_total_runtime;
    int test_clusterWithzisegscan_30583_runs;
    CUfunction test_clusterWithzisegscan_30597;
    int64_t test_clusterWithzisegscan_30597_total_runtime;
    int test_clusterWithzisegscan_30597_runs;
    CUfunction test_clusterWithzisegscan_30642;
    int64_t test_clusterWithzisegscan_30642_total_runtime;
    int test_clusterWithzisegscan_30642_runs;
    CUfunction test_clusterWithzisegscan_30675;
    int64_t test_clusterWithzisegscan_30675_total_runtime;
    int test_clusterWithzisegscan_30675_runs;
    CUfunction test_clusterWithzisegscan_30683;
    int64_t test_clusterWithzisegscan_30683_total_runtime;
    int test_clusterWithzisegscan_30683_runs;
    CUfunction test_clusterWithzisegscan_30801;
    int64_t test_clusterWithzisegscan_30801_total_runtime;
    int test_clusterWithzisegscan_30801_runs;
    CUfunction test_clusterWithzisegscan_30867;
    int64_t test_clusterWithzisegscan_30867_total_runtime;
    int test_clusterWithzisegscan_30867_runs;
    CUfunction test_clusterWithzisegscan_30875;
    int64_t test_clusterWithzisegscan_30875_total_runtime;
    int test_clusterWithzisegscan_30875_runs;
    CUfunction test_clusterWithzisegscan_30889;
    int64_t test_clusterWithzisegscan_30889_total_runtime;
    int test_clusterWithzisegscan_30889_runs;
    CUfunction test_clusterWithzisegscan_30943;
    int64_t test_clusterWithzisegscan_30943_total_runtime;
    int test_clusterWithzisegscan_30943_runs;
    CUfunction test_clusterWithzisegscan_30951;
    int64_t test_clusterWithzisegscan_30951_total_runtime;
    int test_clusterWithzisegscan_30951_runs;
    CUfunction test_clusterWithzisegscan_30965;
    int64_t test_clusterWithzisegscan_30965_total_runtime;
    int test_clusterWithzisegscan_30965_runs;
    CUfunction test_clusterWithzisegscan_31019;
    int64_t test_clusterWithzisegscan_31019_total_runtime;
    int test_clusterWithzisegscan_31019_runs;
    CUfunction test_clusterWithzisegscan_31033;
    int64_t test_clusterWithzisegscan_31033_total_runtime;
    int test_clusterWithzisegscan_31033_runs;
    CUfunction test_clusterWithzisegscan_31066;
    int64_t test_clusterWithzisegscan_31066_total_runtime;
    int test_clusterWithzisegscan_31066_runs;
    CUfunction test_clusterWithzisegscan_31092;
    int64_t test_clusterWithzisegscan_31092_total_runtime;
    int test_clusterWithzisegscan_31092_runs;
    CUfunction test_clusterWithzisegscan_31100;
    int64_t test_clusterWithzisegscan_31100_total_runtime;
    int test_clusterWithzisegscan_31100_runs;
    CUfunction test_elimDupesWithzicopy_32774;
    int64_t test_elimDupesWithzicopy_32774_total_runtime;
    int test_elimDupesWithzicopy_32774_runs;
    CUfunction test_elimDupesWithzisegmap_30389;
    int64_t test_elimDupesWithzisegmap_30389_total_runtime;
    int test_elimDupesWithzisegmap_30389_runs;
    CUfunction test_elimDupesWithzisegmap_30403;
    int64_t test_elimDupesWithzisegmap_30403_total_runtime;
    int test_elimDupesWithzisegmap_30403_runs;
    CUfunction test_elimDupesWithzisegmap_30437;
    int64_t test_elimDupesWithzisegmap_30437_total_runtime;
    int test_elimDupesWithzisegmap_30437_runs;
    CUfunction test_elimDupesWithzisegmap_30451;
    int64_t test_elimDupesWithzisegmap_30451_total_runtime;
    int test_elimDupesWithzisegmap_30451_runs;
    CUfunction test_elimDupesWithzisegscan_30427;
    int64_t test_elimDupesWithzisegscan_30427_total_runtime;
    int test_elimDupesWithzisegscan_30427_runs;
    CUfunction test_elimDupesWithzisegscan_30435;
    int64_t test_elimDupesWithzisegscan_30435_total_runtime;
    int test_elimDupesWithzisegscan_30435_runs;
    CUfunction test_elimDupesWithzisegscan_30449;
    int64_t test_elimDupesWithzisegscan_30449_total_runtime;
    int test_elimDupesWithzisegscan_30449_runs;
    CUfunction test_mkSegsFromSort_segIndzicopy_32773;
    int64_t test_mkSegsFromSort_segIndzicopy_32773_total_runtime;
    int test_mkSegsFromSort_segIndzicopy_32773_runs;
    CUfunction test_mkSegsFromSort_segIndzisegmap_30253;
    int64_t test_mkSegsFromSort_segIndzisegmap_30253_total_runtime;
    int test_mkSegsFromSort_segIndzisegmap_30253_runs;
    CUfunction test_mkSegsFromSort_segIndzisegmap_30267;
    int64_t test_mkSegsFromSort_segIndzisegmap_30267_total_runtime;
    int test_mkSegsFromSort_segIndzisegmap_30267_runs;
    CUfunction test_mkSegsFromSort_segIndzisegmap_30301;
    int64_t test_mkSegsFromSort_segIndzisegmap_30301_total_runtime;
    int test_mkSegsFromSort_segIndzisegmap_30301_runs;
    CUfunction test_mkSegsFromSort_segIndzisegmap_30315;
    int64_t test_mkSegsFromSort_segIndzisegmap_30315_total_runtime;
    int test_mkSegsFromSort_segIndzisegmap_30315_runs;
    CUfunction test_mkSegsFromSort_segIndzisegscan_30291;
    int64_t test_mkSegsFromSort_segIndzisegscan_30291_total_runtime;
    int test_mkSegsFromSort_segIndzisegscan_30291_runs;
    CUfunction test_mkSegsFromSort_segIndzisegscan_30299;
    int64_t test_mkSegsFromSort_segIndzisegscan_30299_total_runtime;
    int test_mkSegsFromSort_segIndzisegscan_30299_runs;
    CUfunction test_mkSegsFromSort_segIndzisegscan_30313;
    int64_t test_mkSegsFromSort_segIndzisegscan_30313_total_runtime;
    int test_mkSegsFromSort_segIndzisegscan_30313_runs;
    CUfunction test_mkSegsFromSort_segSizzezicopy_32773;
    int64_t test_mkSegsFromSort_segSizzezicopy_32773_total_runtime;
    int test_mkSegsFromSort_segSizzezicopy_32773_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegmap_30321;
    int64_t test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime;
    int test_mkSegsFromSort_segSizzezisegmap_30321_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegmap_30335;
    int64_t test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime;
    int test_mkSegsFromSort_segSizzezisegmap_30335_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegmap_30369;
    int64_t test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime;
    int test_mkSegsFromSort_segSizzezisegmap_30369_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegmap_30383;
    int64_t test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime;
    int test_mkSegsFromSort_segSizzezisegmap_30383_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegscan_30359;
    int64_t test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime;
    int test_mkSegsFromSort_segSizzezisegscan_30359_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegscan_30367;
    int64_t test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime;
    int test_mkSegsFromSort_segSizzezisegscan_30367_runs;
    CUfunction test_mkSegsFromSort_segSizzezisegscan_30381;
    int64_t test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime;
    int test_mkSegsFromSort_segSizzezisegscan_30381_runs;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    CUdeviceptr global_failure;
    CUdeviceptr global_failure_args;
    struct cuda_context cuda;
    struct sizes sizes;
    int32_t failure_is_an_option;
    int total_runs;
    long total_runtime;
} ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    ctx->debugging = ctx->detail_memory = cfg->cu_cfg.debugging;
    ctx->profiling = cfg->profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->cu_cfg.logging;
    ctx->error = NULL;
    ctx->log = stderr;
    ctx->cuda.profiling_records_capacity = 200;
    ctx->cuda.profiling_records_used = 0;
    ctx->cuda.profiling_records = malloc(ctx->cuda.profiling_records_capacity *
        sizeof(struct profiling_record));
    ctx->cuda.cfg = cfg->cu_cfg;
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    cuda_setup(&ctx->cuda, cuda_program, cfg->nvrtc_opts);
    
    int32_t no_error = -1;
    
    CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
    CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error,
                                    sizeof(no_error)));
    // The +1 is to avoid zero-byte allocations.
    CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t) *
                                  (2 + 1)));
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->builtinzhiota_i64ziiota_i64_32449,
                                           ctx->cuda.module,
                                           "builtinzhiota_i64ziiota_i64_32449"));
    ctx->builtinzhiota_i64ziiota_i64_32449_total_runtime = 0;
    ctx->builtinzhiota_i64ziiota_i64_32449_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->builtinzhreplicate_i32zireplicate_33027,
                                           ctx->cuda.module,
                                           "builtinzhreplicate_i32zireplicate_33027"));
    ctx->builtinzhreplicate_i32zireplicate_33027_total_runtime = 0;
    ctx->builtinzhreplicate_i32zireplicate_33027_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->builtinzhreplicate_i64zireplicate_32925,
                                           ctx->cuda.module,
                                           "builtinzhreplicate_i64zireplicate_32925"));
    ctx->builtinzhreplicate_i64zireplicate_32925_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_32925_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->builtinzhreplicate_i8zireplicate_32495,
                                           ctx->cuda.module,
                                           "builtinzhreplicate_i8zireplicate_32495"));
    ctx->builtinzhreplicate_i8zireplicate_32495_total_runtime = 0;
    ctx->builtinzhreplicate_i8zireplicate_32495_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzicopy_33017,
                                           ctx->cuda.module,
                                           "test_ballQueryzicopy_33017"));
    ctx->test_ballQueryzicopy_33017_total_runtime = 0;
    ctx->test_ballQueryzicopy_33017_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryziseghist_global_31628,
                                           ctx->cuda.module,
                                           "test_ballQueryziseghist_global_31628"));
    ctx->test_ballQueryziseghist_global_31628_total_runtime = 0;
    ctx->test_ballQueryziseghist_global_31628_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryziseghist_local_31628,
                                           ctx->cuda.module,
                                           "test_ballQueryziseghist_local_31628"));
    ctx->test_ballQueryziseghist_local_31628_total_runtime = 0;
    ctx->test_ballQueryziseghist_local_31628_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31159,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31159"));
    ctx->test_ballQueryzisegmap_31159_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31159_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31182,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31182"));
    ctx->test_ballQueryzisegmap_31182_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31182_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31239,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31239"));
    ctx->test_ballQueryzisegmap_31239_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31239_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31245,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31245"));
    ctx->test_ballQueryzisegmap_31245_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31245_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31275,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31275"));
    ctx->test_ballQueryzisegmap_31275_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31275_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31309,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31309"));
    ctx->test_ballQueryzisegmap_31309_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31309_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31323,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31323"));
    ctx->test_ballQueryzisegmap_31323_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31323_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31420,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31420"));
    ctx->test_ballQueryzisegmap_31420_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31420_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31447,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31447"));
    ctx->test_ballQueryzisegmap_31447_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31447_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31507,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31507"));
    ctx->test_ballQueryzisegmap_31507_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31507_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31645,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31645"));
    ctx->test_ballQueryzisegmap_31645_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31645_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31688,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31688"));
    ctx->test_ballQueryzisegmap_31688_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31688_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegmap_31831,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegmap_31831"));
    ctx->test_ballQueryzisegmap_31831_total_runtime = 0;
    ctx->test_ballQueryzisegmap_31831_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegred_large_33235,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegred_large_33235"));
    ctx->test_ballQueryzisegred_large_33235_total_runtime = 0;
    ctx->test_ballQueryzisegred_large_33235_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegred_nonseg_31620,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegred_nonseg_31620"));
    ctx->test_ballQueryzisegred_nonseg_31620_total_runtime = 0;
    ctx->test_ballQueryzisegred_nonseg_31620_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegred_nonseg_31846,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegred_nonseg_31846"));
    ctx->test_ballQueryzisegred_nonseg_31846_total_runtime = 0;
    ctx->test_ballQueryzisegred_nonseg_31846_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegred_small_33235,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegred_small_33235"));
    ctx->test_ballQueryzisegred_small_33235_total_runtime = 0;
    ctx->test_ballQueryzisegred_small_33235_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31237,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31237"));
    ctx->test_ballQueryzisegscan_31237_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31237_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31299,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31299"));
    ctx->test_ballQueryzisegscan_31299_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31299_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31307,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31307"));
    ctx->test_ballQueryzisegscan_31307_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31307_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31321,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31321"));
    ctx->test_ballQueryzisegscan_31321_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31321_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31610,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31610"));
    ctx->test_ballQueryzisegscan_31610_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31610_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31643,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31643"));
    ctx->test_ballQueryzisegscan_31643_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31643_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31669,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31669"));
    ctx->test_ballQueryzisegscan_31669_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31669_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_ballQueryzisegscan_31829,
                                           ctx->cuda.module,
                                           "test_ballQueryzisegscan_31829"));
    ctx->test_ballQueryzisegscan_31829_total_runtime = 0;
    ctx->test_ballQueryzisegscan_31829_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzicopy_33013,
                                           ctx->cuda.module,
                                           "test_clusterWithzicopy_33013"));
    ctx->test_clusterWithzicopy_33013_total_runtime = 0;
    ctx->test_clusterWithzicopy_33013_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzicopy_34206,
                                           ctx->cuda.module,
                                           "test_clusterWithzicopy_34206"));
    ctx->test_clusterWithzicopy_34206_total_runtime = 0;
    ctx->test_clusterWithzicopy_34206_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzicopy_34523,
                                           ctx->cuda.module,
                                           "test_clusterWithzicopy_34523"));
    ctx->test_clusterWithzicopy_34523_total_runtime = 0;
    ctx->test_clusterWithzicopy_34523_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzicopy_35217,
                                           ctx->cuda.module,
                                           "test_clusterWithzicopy_35217"));
    ctx->test_clusterWithzicopy_35217_total_runtime = 0;
    ctx->test_clusterWithzicopy_35217_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithziseghist_global_30660,
                                           ctx->cuda.module,
                                           "test_clusterWithziseghist_global_30660"));
    ctx->test_clusterWithziseghist_global_30660_total_runtime = 0;
    ctx->test_clusterWithziseghist_global_30660_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithziseghist_global_31051,
                                           ctx->cuda.module,
                                           "test_clusterWithziseghist_global_31051"));
    ctx->test_clusterWithziseghist_global_31051_total_runtime = 0;
    ctx->test_clusterWithziseghist_global_31051_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithziseghist_local_30660,
                                           ctx->cuda.module,
                                           "test_clusterWithziseghist_local_30660"));
    ctx->test_clusterWithziseghist_local_30660_total_runtime = 0;
    ctx->test_clusterWithziseghist_local_30660_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithziseghist_local_31051,
                                           ctx->cuda.module,
                                           "test_clusterWithziseghist_local_31051"));
    ctx->test_clusterWithziseghist_local_31051_total_runtime = 0;
    ctx->test_clusterWithziseghist_local_31051_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30473,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30473"));
    ctx->test_clusterWithzisegmap_30473_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30473_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30495,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30495"));
    ctx->test_clusterWithzisegmap_30495_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30495_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30501,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30501"));
    ctx->test_clusterWithzisegmap_30501_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30501_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30551,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30551"));
    ctx->test_clusterWithzisegmap_30551_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30551_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30585,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30585"));
    ctx->test_clusterWithzisegmap_30585_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30585_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30599,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30599"));
    ctx->test_clusterWithzisegmap_30599_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30599_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30685,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30685"));
    ctx->test_clusterWithzisegmap_30685_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30685_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30803,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30803"));
    ctx->test_clusterWithzisegmap_30803_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30803_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30809,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30809"));
    ctx->test_clusterWithzisegmap_30809_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30809_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30843,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30843"));
    ctx->test_clusterWithzisegmap_30843_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30843_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30877,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30877"));
    ctx->test_clusterWithzisegmap_30877_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30877_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30891,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30891"));
    ctx->test_clusterWithzisegmap_30891_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30891_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30919,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30919"));
    ctx->test_clusterWithzisegmap_30919_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30919_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30953,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30953"));
    ctx->test_clusterWithzisegmap_30953_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30953_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_30967,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_30967"));
    ctx->test_clusterWithzisegmap_30967_total_runtime = 0;
    ctx->test_clusterWithzisegmap_30967_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_31021,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_31021"));
    ctx->test_clusterWithzisegmap_31021_total_runtime = 0;
    ctx->test_clusterWithzisegmap_31021_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_31068,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_31068"));
    ctx->test_clusterWithzisegmap_31068_total_runtime = 0;
    ctx->test_clusterWithzisegmap_31068_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegmap_31102,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegmap_31102"));
    ctx->test_clusterWithzisegmap_31102_total_runtime = 0;
    ctx->test_clusterWithzisegmap_31102_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_large_33339,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_large_33339"));
    ctx->test_clusterWithzisegred_large_33339_total_runtime = 0;
    ctx->test_clusterWithzisegred_large_33339_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_large_34936,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_large_34936"));
    ctx->test_clusterWithzisegred_large_34936_total_runtime = 0;
    ctx->test_clusterWithzisegred_large_34936_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30614,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30614"));
    ctx->test_clusterWithzisegred_nonseg_30614_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30614_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30624,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30624"));
    ctx->test_clusterWithzisegred_nonseg_30624_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30624_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30634,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30634"));
    ctx->test_clusterWithzisegred_nonseg_30634_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30634_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30652,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30652"));
    ctx->test_clusterWithzisegred_nonseg_30652_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30652_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30981,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30981"));
    ctx->test_clusterWithzisegred_nonseg_30981_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30981_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_30991,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_30991"));
    ctx->test_clusterWithzisegred_nonseg_30991_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_30991_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_31001,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_31001"));
    ctx->test_clusterWithzisegred_nonseg_31001_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_31001_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_31011,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_31011"));
    ctx->test_clusterWithzisegred_nonseg_31011_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_31011_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_nonseg_31043,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_nonseg_31043"));
    ctx->test_clusterWithzisegred_nonseg_31043_total_runtime = 0;
    ctx->test_clusterWithzisegred_nonseg_31043_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_small_33339,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_small_33339"));
    ctx->test_clusterWithzisegred_small_33339_total_runtime = 0;
    ctx->test_clusterWithzisegred_small_33339_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegred_small_34936,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegred_small_34936"));
    ctx->test_clusterWithzisegred_small_34936_total_runtime = 0;
    ctx->test_clusterWithzisegred_small_34936_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30493,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30493"));
    ctx->test_clusterWithzisegscan_30493_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30493_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30575,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30575"));
    ctx->test_clusterWithzisegscan_30575_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30575_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30583,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30583"));
    ctx->test_clusterWithzisegscan_30583_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30583_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30597,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30597"));
    ctx->test_clusterWithzisegscan_30597_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30597_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30642,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30642"));
    ctx->test_clusterWithzisegscan_30642_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30642_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30675,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30675"));
    ctx->test_clusterWithzisegscan_30675_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30675_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30683,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30683"));
    ctx->test_clusterWithzisegscan_30683_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30683_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30801,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30801"));
    ctx->test_clusterWithzisegscan_30801_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30801_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30867,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30867"));
    ctx->test_clusterWithzisegscan_30867_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30867_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30875,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30875"));
    ctx->test_clusterWithzisegscan_30875_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30875_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30889,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30889"));
    ctx->test_clusterWithzisegscan_30889_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30889_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30943,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30943"));
    ctx->test_clusterWithzisegscan_30943_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30943_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30951,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30951"));
    ctx->test_clusterWithzisegscan_30951_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30951_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_30965,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_30965"));
    ctx->test_clusterWithzisegscan_30965_total_runtime = 0;
    ctx->test_clusterWithzisegscan_30965_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_31019,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_31019"));
    ctx->test_clusterWithzisegscan_31019_total_runtime = 0;
    ctx->test_clusterWithzisegscan_31019_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_31033,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_31033"));
    ctx->test_clusterWithzisegscan_31033_total_runtime = 0;
    ctx->test_clusterWithzisegscan_31033_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_31066,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_31066"));
    ctx->test_clusterWithzisegscan_31066_total_runtime = 0;
    ctx->test_clusterWithzisegscan_31066_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_31092,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_31092"));
    ctx->test_clusterWithzisegscan_31092_total_runtime = 0;
    ctx->test_clusterWithzisegscan_31092_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_clusterWithzisegscan_31100,
                                           ctx->cuda.module,
                                           "test_clusterWithzisegscan_31100"));
    ctx->test_clusterWithzisegscan_31100_total_runtime = 0;
    ctx->test_clusterWithzisegscan_31100_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzicopy_32774,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzicopy_32774"));
    ctx->test_elimDupesWithzicopy_32774_total_runtime = 0;
    ctx->test_elimDupesWithzicopy_32774_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegmap_30389,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegmap_30389"));
    ctx->test_elimDupesWithzisegmap_30389_total_runtime = 0;
    ctx->test_elimDupesWithzisegmap_30389_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegmap_30403,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegmap_30403"));
    ctx->test_elimDupesWithzisegmap_30403_total_runtime = 0;
    ctx->test_elimDupesWithzisegmap_30403_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegmap_30437,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegmap_30437"));
    ctx->test_elimDupesWithzisegmap_30437_total_runtime = 0;
    ctx->test_elimDupesWithzisegmap_30437_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegmap_30451,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegmap_30451"));
    ctx->test_elimDupesWithzisegmap_30451_total_runtime = 0;
    ctx->test_elimDupesWithzisegmap_30451_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegscan_30427,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegscan_30427"));
    ctx->test_elimDupesWithzisegscan_30427_total_runtime = 0;
    ctx->test_elimDupesWithzisegscan_30427_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegscan_30435,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegscan_30435"));
    ctx->test_elimDupesWithzisegscan_30435_total_runtime = 0;
    ctx->test_elimDupesWithzisegscan_30435_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_elimDupesWithzisegscan_30449,
                                           ctx->cuda.module,
                                           "test_elimDupesWithzisegscan_30449"));
    ctx->test_elimDupesWithzisegscan_30449_total_runtime = 0;
    ctx->test_elimDupesWithzisegscan_30449_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzicopy_32773,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzicopy_32773"));
    ctx->test_mkSegsFromSort_segIndzicopy_32773_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzicopy_32773_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegmap_30253,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegmap_30253"));
    ctx->test_mkSegsFromSort_segIndzisegmap_30253_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegmap_30267,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegmap_30267"));
    ctx->test_mkSegsFromSort_segIndzisegmap_30267_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegmap_30301,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegmap_30301"));
    ctx->test_mkSegsFromSort_segIndzisegmap_30301_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegmap_30315,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegmap_30315"));
    ctx->test_mkSegsFromSort_segIndzisegmap_30315_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegscan_30291,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegscan_30291"));
    ctx->test_mkSegsFromSort_segIndzisegscan_30291_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegscan_30299,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegscan_30299"));
    ctx->test_mkSegsFromSort_segIndzisegscan_30299_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segIndzisegscan_30313,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segIndzisegscan_30313"));
    ctx->test_mkSegsFromSort_segIndzisegscan_30313_total_runtime = 0;
    ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezicopy_32773,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezicopy_32773"));
    ctx->test_mkSegsFromSort_segSizzezicopy_32773_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegmap_30321,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegmap_30321"));
    ctx->test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegmap_30335,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegmap_30335"));
    ctx->test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegmap_30369,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegmap_30369"));
    ctx->test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegmap_30383,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegmap_30383"));
    ctx->test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegscan_30359,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegscan_30359"));
    ctx->test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegscan_30367,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegscan_30367"));
    ctx->test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs = 0;
    CUDA_SUCCEED_FATAL(cuModuleGetFunction(&ctx->test_mkSegsFromSort_segSizzezisegscan_30381,
                                           ctx->cuda.module,
                                           "test_mkSegsFromSort_segSizzezisegscan_30381"));
    ctx->test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime = 0;
    ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    {
        ctx->test_ballQueryziid_counter_mem_32471.references = NULL;
        ctx->test_ballQueryziid_counter_mem_32471.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_32471.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_32471.mem,
                                            test_ballQueryziid_counter_mem_realtype_35388,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_32709.references = NULL;
        ctx->test_ballQueryziid_counter_mem_32709.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_32709.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_32709.mem,
                                            test_ballQueryziid_counter_mem_realtype_35439,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_32842.references = NULL;
        ctx->test_ballQueryziid_counter_mem_32842.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_32842.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_32842.mem,
                                            test_ballQueryziid_counter_mem_realtype_35454,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_32938.references = NULL;
        ctx->test_ballQueryziid_counter_mem_32938.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_32938.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_32938.mem,
                                            test_ballQueryziid_counter_mem_realtype_35474,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_33045.references = NULL;
        ctx->test_ballQueryziid_counter_mem_33045.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_33045.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_33045.mem,
                                            test_ballQueryziid_counter_mem_realtype_35515,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryzicounter_mem_33125.references = NULL;
        ctx->test_ballQueryzicounter_mem_33125.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryzicounter_mem_33125.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryzicounter_mem_33125.mem,
                                            test_ballQueryzicounter_mem_realtype_35529,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryzicounter_mem_33264.references = NULL;
        ctx->test_ballQueryzicounter_mem_33264.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryzicounter_mem_33264.mem,
                                      (10240 > 0 ? 10240 : 1) *
                                      sizeof(int32_t)));
        if (10240 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryzicounter_mem_33264.mem,
                                            test_ballQueryzicounter_mem_realtype_35561,
                                            10240 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_33299.references = NULL;
        ctx->test_ballQueryziid_counter_mem_33299.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_33299.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_33299.mem,
                                            test_ballQueryziid_counter_mem_realtype_35573,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_33437.references = NULL;
        ctx->test_ballQueryziid_counter_mem_33437.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_33437.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_33437.mem,
                                            test_ballQueryziid_counter_mem_realtype_35594,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryziid_counter_mem_33580.references = NULL;
        ctx->test_ballQueryziid_counter_mem_33580.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryziid_counter_mem_33580.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryziid_counter_mem_33580.mem,
                                            test_ballQueryziid_counter_mem_realtype_35621,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_ballQueryzicounter_mem_33797.references = NULL;
        ctx->test_ballQueryzicounter_mem_33797.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_ballQueryzicounter_mem_33797.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_ballQueryzicounter_mem_33797.mem,
                                            test_ballQueryzicounter_mem_realtype_35658,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_32467.references = NULL;
        ctx->test_clusterWithziid_counter_mem_32467.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_32467.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_32467.mem,
                                            test_clusterWithziid_counter_mem_realtype_35679,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_32705.references = NULL;
        ctx->test_clusterWithziid_counter_mem_32705.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_32705.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_32705.mem,
                                            test_clusterWithziid_counter_mem_realtype_35731,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_32838.references = NULL;
        ctx->test_clusterWithziid_counter_mem_32838.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_32838.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_32838.mem,
                                            test_clusterWithziid_counter_mem_realtype_35746,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_32934.references = NULL;
        ctx->test_clusterWithziid_counter_mem_32934.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_32934.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_32934.mem,
                                            test_clusterWithziid_counter_mem_realtype_35766,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_33033.references = NULL;
        ctx->test_clusterWithzicounter_mem_33033.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_33033.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_33033.mem,
                                            test_clusterWithzicounter_mem_realtype_35792,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_33081.references = NULL;
        ctx->test_clusterWithzicounter_mem_33081.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_33081.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_33081.mem,
                                            test_clusterWithzicounter_mem_realtype_35806,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_33112.references = NULL;
        ctx->test_clusterWithzicounter_mem_33112.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_33112.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_33112.mem,
                                            test_clusterWithzicounter_mem_realtype_35819,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_33151.references = NULL;
        ctx->test_clusterWithziid_counter_mem_33151.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_33151.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_33151.mem,
                                            test_clusterWithziid_counter_mem_realtype_35832,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_33230.references = NULL;
        ctx->test_clusterWithzicounter_mem_33230.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_33230.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_33230.mem,
                                            test_clusterWithzicounter_mem_realtype_35849,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_33368.references = NULL;
        ctx->test_clusterWithzicounter_mem_33368.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_33368.mem,
                                      (10240 > 0 ? 10240 : 1) *
                                      sizeof(int32_t)));
        if (10240 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_33368.mem,
                                            test_clusterWithzicounter_mem_realtype_35881,
                                            10240 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_33403.references = NULL;
        ctx->test_clusterWithziid_counter_mem_33403.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_33403.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_33403.mem,
                                            test_clusterWithziid_counter_mem_realtype_35893,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_33536.references = NULL;
        ctx->test_clusterWithziid_counter_mem_33536.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_33536.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_33536.mem,
                                            test_clusterWithziid_counter_mem_realtype_35908,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_33678.references = NULL;
        ctx->test_clusterWithziid_counter_mem_33678.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_33678.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_33678.mem,
                                            test_clusterWithziid_counter_mem_realtype_35934,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_33907.references = NULL;
        ctx->test_clusterWithziid_counter_mem_33907.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_33907.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_33907.mem,
                                            test_clusterWithziid_counter_mem_realtype_35986,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34040.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34040.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34040.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34040.mem,
                                            test_clusterWithziid_counter_mem_realtype_36001,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34127.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34127.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34127.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34127.mem,
                                            test_clusterWithziid_counter_mem_realtype_36021,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34224.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34224.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34224.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34224.mem,
                                            test_clusterWithziid_counter_mem_realtype_36054,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34357.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34357.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34357.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34357.mem,
                                            test_clusterWithziid_counter_mem_realtype_36069,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34444.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34444.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34444.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34444.mem,
                                            test_clusterWithziid_counter_mem_realtype_36089,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34534.references = NULL;
        ctx->test_clusterWithzicounter_mem_34534.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34534.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34534.mem,
                                            test_clusterWithzicounter_mem_realtype_36115,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34565.references = NULL;
        ctx->test_clusterWithzicounter_mem_34565.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34565.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34565.mem,
                                            test_clusterWithzicounter_mem_realtype_36129,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34596.references = NULL;
        ctx->test_clusterWithzicounter_mem_34596.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34596.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34596.mem,
                                            test_clusterWithzicounter_mem_realtype_36143,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34626.references = NULL;
        ctx->test_clusterWithzicounter_mem_34626.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34626.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34626.mem,
                                            test_clusterWithzicounter_mem_realtype_36156,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34659.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34659.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34659.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34659.mem,
                                            test_clusterWithziid_counter_mem_realtype_36169,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_34747.references = NULL;
        ctx->test_clusterWithziid_counter_mem_34747.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_34747.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_34747.mem,
                                            test_clusterWithziid_counter_mem_realtype_36190,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34826.references = NULL;
        ctx->test_clusterWithzicounter_mem_34826.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34826.mem,
                                      (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34826.mem,
                                            test_clusterWithzicounter_mem_realtype_36204,
                                            10 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithzicounter_mem_34965.references = NULL;
        ctx->test_clusterWithzicounter_mem_34965.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithzicounter_mem_34965.mem,
                                      (10240 > 0 ? 10240 : 1) *
                                      sizeof(int32_t)));
        if (10240 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithzicounter_mem_34965.mem,
                                            test_clusterWithzicounter_mem_realtype_36236,
                                            10240 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_35000.references = NULL;
        ctx->test_clusterWithziid_counter_mem_35000.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_35000.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_35000.mem,
                                            test_clusterWithziid_counter_mem_realtype_36248,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_35138.references = NULL;
        ctx->test_clusterWithziid_counter_mem_35138.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_35138.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_35138.mem,
                                            test_clusterWithziid_counter_mem_realtype_36269,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_clusterWithziid_counter_mem_35225.references = NULL;
        ctx->test_clusterWithziid_counter_mem_35225.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_clusterWithziid_counter_mem_35225.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_clusterWithziid_counter_mem_35225.mem,
                                            test_clusterWithziid_counter_mem_realtype_36287,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_elimDupesWithziid_counter_mem_32457.references = NULL;
        ctx->test_elimDupesWithziid_counter_mem_32457.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_elimDupesWithziid_counter_mem_32457.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_elimDupesWithziid_counter_mem_32457.mem,
                                            test_elimDupesWithziid_counter_mem_realtype_36324,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_elimDupesWithziid_counter_mem_32599.references = NULL;
        ctx->test_elimDupesWithziid_counter_mem_32599.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_elimDupesWithziid_counter_mem_32599.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_elimDupesWithziid_counter_mem_32599.mem,
                                            test_elimDupesWithziid_counter_mem_realtype_36339,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_elimDupesWithziid_counter_mem_32695.references = NULL;
        ctx->test_elimDupesWithziid_counter_mem_32695.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_elimDupesWithziid_counter_mem_32695.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_elimDupesWithziid_counter_mem_32695.mem,
                                            test_elimDupesWithziid_counter_mem_realtype_36359,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32456.references = NULL;
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32456.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segIndziid_counter_mem_32456.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segIndziid_counter_mem_32456.mem,
                                            test_mkSegsFromSort_segIndziid_counter_mem_realtype_36395,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32598.references = NULL;
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32598.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segIndziid_counter_mem_32598.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segIndziid_counter_mem_32598.mem,
                                            test_mkSegsFromSort_segIndziid_counter_mem_realtype_36410,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32694.references = NULL;
        ctx->test_mkSegsFromSort_segIndziid_counter_mem_32694.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segIndziid_counter_mem_32694.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segIndziid_counter_mem_32694.mem,
                                            test_mkSegsFromSort_segIndziid_counter_mem_realtype_36430,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32456.references =
            NULL;
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32456.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32456.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32456.mem,
                                            test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36466,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32598.references =
            NULL;
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32598.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32598.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32598.mem,
                                            test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36481,
                                            1 * sizeof(int32_t)));
    }
    {
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32694.references =
            NULL;
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32694.size = 0;
        CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32694.mem,
                                      (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32694.mem,
                                            test_mkSegsFromSort_segSizzeziid_counter_mem_realtype_36501,
                                            1 * sizeof(int32_t)));
    }
    ctx->sizes.builtinzhiota_i64zigroup_sizze_32452 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_i32zigroup_sizze_33030 = cfg->sizes[1];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_32928 = cfg->sizes[2];
    ctx->sizes.builtinzhreplicate_i8zigroup_sizze_32498 = cfg->sizes[3];
    ctx->sizes.test_ballQueryziL2_sizze_33215 = cfg->sizes[4];
    ctx->sizes.test_ballQueryzigroup_sizze_33020 = cfg->sizes[5];
    ctx->sizes.test_ballQueryziseghist_group_sizze_31622 = cfg->sizes[6];
    ctx->sizes.test_ballQueryziseghist_num_groups_31624 = cfg->sizes[7];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31161 = cfg->sizes[8];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31185 = cfg->sizes[9];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31241 = cfg->sizes[10];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31247 = cfg->sizes[11];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31277 = cfg->sizes[12];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31311 = cfg->sizes[13];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31325 = cfg->sizes[14];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31423 = cfg->sizes[15];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31451 = cfg->sizes[16];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31510 = cfg->sizes[17];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31647 = cfg->sizes[18];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31690 = cfg->sizes[19];
    ctx->sizes.test_ballQueryzisegmap_group_sizze_31833 = cfg->sizes[20];
    ctx->sizes.test_ballQueryzisegred_group_sizze_31612 = cfg->sizes[21];
    ctx->sizes.test_ballQueryzisegred_group_sizze_31837 = cfg->sizes[22];
    ctx->sizes.test_ballQueryzisegred_num_groups_31614 = cfg->sizes[23];
    ctx->sizes.test_ballQueryzisegred_num_groups_31839 = cfg->sizes[24];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31231 = cfg->sizes[25];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31293 = cfg->sizes[26];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31301 = cfg->sizes[27];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31315 = cfg->sizes[28];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31604 = cfg->sizes[29];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31637 = cfg->sizes[30];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31663 = cfg->sizes[31];
    ctx->sizes.test_ballQueryzisegscan_group_sizze_31823 = cfg->sizes[32];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31233 = cfg->sizes[33];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31295 = cfg->sizes[34];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31303 = cfg->sizes[35];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31317 = cfg->sizes[36];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31606 = cfg->sizes[37];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31639 = cfg->sizes[38];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31665 = cfg->sizes[39];
    ctx->sizes.test_ballQueryzisegscan_num_groups_31825 = cfg->sizes[40];
    ctx->sizes.test_clusterWithziL2_sizze_33319 = cfg->sizes[41];
    ctx->sizes.test_clusterWithziL2_sizze_34916 = cfg->sizes[42];
    ctx->sizes.test_clusterWithzigroup_sizze_33016 = cfg->sizes[43];
    ctx->sizes.test_clusterWithzigroup_sizze_34209 = cfg->sizes[44];
    ctx->sizes.test_clusterWithzigroup_sizze_34526 = cfg->sizes[45];
    ctx->sizes.test_clusterWithzigroup_sizze_35220 = cfg->sizes[46];
    ctx->sizes.test_clusterWithziseghist_group_sizze_30654 = cfg->sizes[47];
    ctx->sizes.test_clusterWithziseghist_group_sizze_31045 = cfg->sizes[48];
    ctx->sizes.test_clusterWithziseghist_num_groups_30656 = cfg->sizes[49];
    ctx->sizes.test_clusterWithziseghist_num_groups_31047 = cfg->sizes[50];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30475 = cfg->sizes[51];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30497 = cfg->sizes[52];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30503 = cfg->sizes[53];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30553 = cfg->sizes[54];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30587 = cfg->sizes[55];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30601 = cfg->sizes[56];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30687 = cfg->sizes[57];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30805 = cfg->sizes[58];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30811 = cfg->sizes[59];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30845 = cfg->sizes[60];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30879 = cfg->sizes[61];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30893 = cfg->sizes[62];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30921 = cfg->sizes[63];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30955 = cfg->sizes[64];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_30969 = cfg->sizes[65];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_31023 = cfg->sizes[66];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_31070 = cfg->sizes[67];
    ctx->sizes.test_clusterWithzisegmap_group_sizze_31104 = cfg->sizes[68];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30605 = cfg->sizes[69];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30616 = cfg->sizes[70];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30626 = cfg->sizes[71];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30644 = cfg->sizes[72];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30973 = cfg->sizes[73];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30983 = cfg->sizes[74];
    ctx->sizes.test_clusterWithzisegred_group_sizze_30993 = cfg->sizes[75];
    ctx->sizes.test_clusterWithzisegred_group_sizze_31003 = cfg->sizes[76];
    ctx->sizes.test_clusterWithzisegred_group_sizze_31035 = cfg->sizes[77];
    ctx->sizes.test_clusterWithzisegred_num_groups_30607 = cfg->sizes[78];
    ctx->sizes.test_clusterWithzisegred_num_groups_30618 = cfg->sizes[79];
    ctx->sizes.test_clusterWithzisegred_num_groups_30628 = cfg->sizes[80];
    ctx->sizes.test_clusterWithzisegred_num_groups_30646 = cfg->sizes[81];
    ctx->sizes.test_clusterWithzisegred_num_groups_30975 = cfg->sizes[82];
    ctx->sizes.test_clusterWithzisegred_num_groups_30985 = cfg->sizes[83];
    ctx->sizes.test_clusterWithzisegred_num_groups_30995 = cfg->sizes[84];
    ctx->sizes.test_clusterWithzisegred_num_groups_31005 = cfg->sizes[85];
    ctx->sizes.test_clusterWithzisegred_num_groups_31037 = cfg->sizes[86];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30487 = cfg->sizes[87];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30569 = cfg->sizes[88];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30577 = cfg->sizes[89];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30591 = cfg->sizes[90];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30636 = cfg->sizes[91];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30669 = cfg->sizes[92];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30677 = cfg->sizes[93];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30795 = cfg->sizes[94];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30861 = cfg->sizes[95];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30869 = cfg->sizes[96];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30883 = cfg->sizes[97];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30937 = cfg->sizes[98];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30945 = cfg->sizes[99];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_30959 = cfg->sizes[100];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_31013 = cfg->sizes[101];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_31027 = cfg->sizes[102];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_31060 = cfg->sizes[103];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_31086 = cfg->sizes[104];
    ctx->sizes.test_clusterWithzisegscan_group_sizze_31094 = cfg->sizes[105];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30489 = cfg->sizes[106];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30571 = cfg->sizes[107];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30579 = cfg->sizes[108];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30593 = cfg->sizes[109];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30638 = cfg->sizes[110];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30671 = cfg->sizes[111];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30679 = cfg->sizes[112];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30797 = cfg->sizes[113];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30863 = cfg->sizes[114];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30871 = cfg->sizes[115];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30885 = cfg->sizes[116];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30939 = cfg->sizes[117];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30947 = cfg->sizes[118];
    ctx->sizes.test_clusterWithzisegscan_num_groups_30961 = cfg->sizes[119];
    ctx->sizes.test_clusterWithzisegscan_num_groups_31015 = cfg->sizes[120];
    ctx->sizes.test_clusterWithzisegscan_num_groups_31029 = cfg->sizes[121];
    ctx->sizes.test_clusterWithzisegscan_num_groups_31062 = cfg->sizes[122];
    ctx->sizes.test_clusterWithzisegscan_num_groups_31088 = cfg->sizes[123];
    ctx->sizes.test_clusterWithzisegscan_num_groups_31096 = cfg->sizes[124];
    ctx->sizes.test_elimDupesWithzigroup_sizze_32777 = cfg->sizes[125];
    ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30391 = cfg->sizes[126];
    ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30405 = cfg->sizes[127];
    ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30439 = cfg->sizes[128];
    ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30453 = cfg->sizes[129];
    ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30421 = cfg->sizes[130];
    ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30429 = cfg->sizes[131];
    ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30443 = cfg->sizes[132];
    ctx->sizes.test_elimDupesWithzisegscan_num_groups_30423 = cfg->sizes[133];
    ctx->sizes.test_elimDupesWithzisegscan_num_groups_30431 = cfg->sizes[134];
    ctx->sizes.test_elimDupesWithzisegscan_num_groups_30445 = cfg->sizes[135];
    ctx->sizes.test_mkSegsFromSort_segIndzigroup_sizze_32776 = cfg->sizes[136];
    ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30255 =
        cfg->sizes[137];
    ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30269 =
        cfg->sizes[138];
    ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30303 =
        cfg->sizes[139];
    ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30317 =
        cfg->sizes[140];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30285 =
        cfg->sizes[141];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30293 =
        cfg->sizes[142];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30307 =
        cfg->sizes[143];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30287 =
        cfg->sizes[144];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30295 =
        cfg->sizes[145];
    ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30309 =
        cfg->sizes[146];
    ctx->sizes.test_mkSegsFromSort_segSizzezigroup_sizze_32776 =
        cfg->sizes[147];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30323 =
        cfg->sizes[148];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30337 =
        cfg->sizes[149];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30371 =
        cfg->sizes[150];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30385 =
        cfg->sizes[151];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30353 =
        cfg->sizes[152];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30361 =
        cfg->sizes[153];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30375 =
        cfg->sizes[154];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30355 =
        cfg->sizes[155];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30363 =
        cfg->sizes[156];
    ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30377 =
        cfg->sizes[157];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    CUDA_SUCCEED_FATAL(cuda_free_all(&ctx->cuda));
    futhark_context_sync(ctx);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    cuda_cleanup(&ctx->cuda);
    free_lock(&ctx->lock);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
    if (ctx->failure_is_an_option) {
        int32_t failure_idx;
        
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&failure_idx, ctx->global_failure,
                                            sizeof(int32_t)));
        ctx->failure_is_an_option = 0;
        if (failure_idx >= 0) {
            int32_t no_failure = -1;
            
            CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(ctx->global_failure,
                                                &no_failure, sizeof(int32_t)));
            
            int64_t args[2 + 1];
            
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&args, ctx->global_failure_args,
                                                sizeof(args)));
            switch (failure_idx) {
                
              case 0:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:100:16-71\n   #6  src/cluster_test.fut:49:17-45\n   #7  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 1:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:63:37-43\n   #1  src/cluster.fut:63:18-52\n   #2  src/cluster.fut:101:19-56\n   #3  src/cluster_test.fut:49:17-45\n   #4  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 2:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:108:43-62\n   #1  src/cluster.fut:50:13-22\n   #2  src/cluster.fut:108:19-120\n   #3  src/cluster_test.fut:49:17-45\n   #4  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 3:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:55:32-37\n   #1  /prelude/soacs.fut:67:19-23\n   #2  /prelude/soacs.fut:67:3-37\n   #3  src/cluster.fut:55:14-51\n   #4  src/cluster.fut:108:19-120\n   #5  src/cluster_test.fut:49:17-45\n   #6  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 4:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:12-25\n   #1  src/cluster.fut:108:84-105\n   #2  src/cluster.fut:55:28-39\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  src/cluster.fut:55:14-51\n   #6  src/cluster.fut:108:19-120\n   #7  src/cluster_test.fut:49:17-45\n   #8  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 5:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:3-30\n   #1  src/cluster.fut:108:84-105\n   #2  src/cluster.fut:55:28-39\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  src/cluster.fut:55:14-51\n   #6  src/cluster.fut:108:19-120\n   #7  src/cluster_test.fut:49:17-45\n   #8  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 6:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:91:32-38\n   #1  src/cluster.fut:123:13-26\n   #2  src/cluster.fut:126:28-39\n   #3  /prelude/functional.fut:9:42-44\n   #4  src/cluster.fut:125:21-126:41\n   #5  src/cluster_test.fut:49:17-45\n   #6  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 7:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:91:25-30\n   #1  src/cluster.fut:123:13-26\n   #2  src/cluster.fut:126:28-39\n   #3  /prelude/functional.fut:9:42-44\n   #4  src/cluster.fut:125:21-126:41\n   #5  src/cluster_test.fut:49:17-45\n   #6  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 8:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:125:21-127:59\n   #6  src/cluster_test.fut:49:17-45\n   #7  src/cluster_test.fut:48:1-50:16\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 9:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster_test.fut:38:18-39:57\n   #6  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 10:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:63:37-43\n   #1  src/cluster.fut:63:18-52\n   #2  src/cluster_test.fut:41:17-45\n   #3  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 11:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:146:29-38\n   #1  src/cluster.fut:146:18-50\n   #2  src/cluster.fut:170:14-27\n   #3  src/cluster.fut:176:27-76\n   #4  src/cluster_test.fut:42:9-31\n   #5  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 12:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:149:15-28\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:71:13-22\n   #2  /prelude/functional.fut:9:42-44\n   #3  src/cluster.fut:148:23-152:51\n   #4  src/cluster.fut:170:14-27\n   #5  src/cluster.fut:176:27-76\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 13:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:74:24-29\n   #1  /prelude/soacs.fut:67:19-23\n   #2  /prelude/soacs.fut:67:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:148:23-152:51\n   #6  src/cluster.fut:170:14-27\n   #7  src/cluster.fut:176:27-76\n   #8  src/cluster_test.fut:42:9-31\n   #9  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 14:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:151:15-23\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #2  /prelude/soacs.fut:67:19-23\n   #3  /prelude/soacs.fut:67:3-37\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #5  /prelude/functional.fut:9:42-44\n   #6  src/cluster.fut:148:23-152:51\n   #7  src/cluster.fut:170:14-27\n   #8  src/cluster.fut:176:27-76\n   #9  src/cluster_test.fut:42:9-31\n   #10 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 15:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:12-25\n   #1  src/cluster.fut:151:26-48\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:148:23-152:51\n   #8  src/cluster.fut:170:14-27\n   #9  src/cluster.fut:176:27-76\n   #10 src/cluster_test.fut:42:9-31\n   #11 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 16:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:3-30\n   #1  src/cluster.fut:151:26-48\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:148:23-152:51\n   #8  src/cluster.fut:170:14-27\n   #9  src/cluster.fut:176:27-76\n   #10 src/cluster_test.fut:42:9-31\n   #11 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 17:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:12-25\n   #1  src/cluster.fut:152:15-37\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:148:23-152:51\n   #8  src/cluster.fut:170:14-27\n   #9  src/cluster.fut:176:27-76\n   #10 src/cluster_test.fut:42:9-31\n   #11 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 18:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:3-30\n   #1  src/cluster.fut:152:15-37\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #3  /prelude/soacs.fut:67:19-23\n   #4  /prelude/soacs.fut:67:3-37\n   #5  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:148:23-152:51\n   #8  src/cluster.fut:170:14-27\n   #9  src/cluster.fut:176:27-76\n   #10 src/cluster_test.fut:42:9-31\n   #11 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 19:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:152:40-48\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:74:20-31\n   #2  /prelude/soacs.fut:67:19-23\n   #3  /prelude/soacs.fut:67:3-37\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:74:6-43\n   #5  /prelude/functional.fut:9:42-44\n   #6  src/cluster.fut:148:23-152:51\n   #7  src/cluster.fut:170:14-27\n   #8  src/cluster.fut:176:27-76\n   #9  src/cluster_test.fut:42:9-31\n   #10 src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 20:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:154:23-155:69\n   #6  src/cluster.fut:170:14-27\n   #7  src/cluster.fut:176:27-76\n   #8  src/cluster_test.fut:42:9-31\n   #9  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 21:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:30:17-22\n   #1  src/cluster.fut:30:6-28\n   #2  /prelude/functional.fut:9:42-44\n   #3  src/cluster.fut:154:23-156:40\n   #4  src/cluster.fut:170:14-27\n   #5  src/cluster.fut:176:27-76\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 22:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:63:37-43\n   #1  src/cluster.fut:63:18-52\n   #2  src/cluster.fut:158:8-43\n   #3  src/cluster.fut:170:14-27\n   #4  src/cluster.fut:176:27-76\n   #5  src/cluster_test.fut:42:9-31\n   #6  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 23:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:184:28-46\n   #1  src/cluster.fut:50:13-22\n   #2  src/cluster.fut:184:10-74\n   #3  src/cluster_test.fut:42:9-31\n   #4  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 24:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:55:32-37\n   #1  /prelude/soacs.fut:67:19-23\n   #2  /prelude/soacs.fut:67:3-37\n   #3  src/cluster.fut:55:14-51\n   #4  src/cluster.fut:184:10-74\n   #5  src/cluster_test.fut:42:9-31\n   #6  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 25:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:12-25\n   #1  src/cluster.fut:55:28-39\n   #2  /prelude/soacs.fut:67:19-23\n   #3  /prelude/soacs.fut:67:3-37\n   #4  src/cluster.fut:55:14-51\n   #5  src/cluster.fut:184:10-74\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 26:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:71:3-30\n   #1  src/cluster.fut:55:28-39\n   #2  /prelude/soacs.fut:67:19-23\n   #3  /prelude/soacs.fut:67:3-37\n   #4  src/cluster.fut:55:14-51\n   #5  src/cluster.fut:184:10-74\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 27:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:30:17-22\n   #1  src/cluster.fut:30:6-28\n   #2  src/cluster_test.fut:57:1-51\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 28:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:63:37-43\n   #1  src/cluster.fut:63:18-52\n   #2  src/cluster_test.fut:16:4-39\n   #3  src/cluster_test.fut:15:1-16:47\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 29:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  src/cluster.fut:63:37-43\n   #1  src/cluster.fut:63:18-52\n   #2  src/cluster_test.fut:25:4-39\n   #3  src/cluster_test.fut:24:1-25:48\n",
                                  args[0], args[1]);
                    break;
                }
            }
            return 1;
        }
    }
    CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    return 0;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            CUDA_SUCCEED_OR_RETURN(cuda_free(&ctx->cuda, block->mem, desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(ctx->log,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(ctx->log, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(ctx->log, ".\n");
    CUDA_SUCCEED_OR_RETURN(cuda_alloc(&ctx->cuda, size, desc, &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(ctx->log,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(ctx->log, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(ctx->log, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int futhark_get_num_sizes(void)
{
    return sizeof(size_names) / sizeof(size_names[0]);
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling || ctx->logging) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        CUDA_SUCCEED_FATAL(cuda_tally_profiling_records(&ctx->cuda));
        str_builder(&builder,
                    "copy_dev_to_dev                           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#iota_i64.iota_i64_32449           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhiota_i64ziiota_i64_32449_runs,
                    (long) ctx->builtinzhiota_i64ziiota_i64_32449_total_runtime /
                    (ctx->builtinzhiota_i64ziiota_i64_32449_runs !=
                     0 ? ctx->builtinzhiota_i64ziiota_i64_32449_runs : 1),
                    (long) ctx->builtinzhiota_i64ziiota_i64_32449_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhiota_i64ziiota_i64_32449_total_runtime;
        ctx->total_runs += ctx->builtinzhiota_i64ziiota_i64_32449_runs;
        str_builder(&builder,
                    "builtin#replicate_i32.replicate_33027     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i32zireplicate_33027_runs,
                    (long) ctx->builtinzhreplicate_i32zireplicate_33027_total_runtime /
                    (ctx->builtinzhreplicate_i32zireplicate_33027_runs !=
                     0 ? ctx->builtinzhreplicate_i32zireplicate_33027_runs : 1),
                    (long) ctx->builtinzhreplicate_i32zireplicate_33027_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i32zireplicate_33027_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i32zireplicate_33027_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_32925     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_32925_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_32925_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_32925_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_32925_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_32925_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_32925_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_32925_runs;
        str_builder(&builder,
                    "builtin#replicate_i8.replicate_32495      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i8zireplicate_32495_runs,
                    (long) ctx->builtinzhreplicate_i8zireplicate_32495_total_runtime /
                    (ctx->builtinzhreplicate_i8zireplicate_32495_runs !=
                     0 ? ctx->builtinzhreplicate_i8zireplicate_32495_runs : 1),
                    (long) ctx->builtinzhreplicate_i8zireplicate_32495_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i8zireplicate_32495_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i8zireplicate_32495_runs;
        str_builder(&builder,
                    "test_ballQuery.copy_33017                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzicopy_33017_runs,
                    (long) ctx->test_ballQueryzicopy_33017_total_runtime /
                    (ctx->test_ballQueryzicopy_33017_runs !=
                     0 ? ctx->test_ballQueryzicopy_33017_runs : 1),
                    (long) ctx->test_ballQueryzicopy_33017_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzicopy_33017_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzicopy_33017_runs;
        str_builder(&builder,
                    "test_ballQuery.seghist_global_31628       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryziseghist_global_31628_runs,
                    (long) ctx->test_ballQueryziseghist_global_31628_total_runtime /
                    (ctx->test_ballQueryziseghist_global_31628_runs !=
                     0 ? ctx->test_ballQueryziseghist_global_31628_runs : 1),
                    (long) ctx->test_ballQueryziseghist_global_31628_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryziseghist_global_31628_total_runtime;
        ctx->total_runs += ctx->test_ballQueryziseghist_global_31628_runs;
        str_builder(&builder,
                    "test_ballQuery.seghist_local_31628        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryziseghist_local_31628_runs,
                    (long) ctx->test_ballQueryziseghist_local_31628_total_runtime /
                    (ctx->test_ballQueryziseghist_local_31628_runs !=
                     0 ? ctx->test_ballQueryziseghist_local_31628_runs : 1),
                    (long) ctx->test_ballQueryziseghist_local_31628_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryziseghist_local_31628_total_runtime;
        ctx->total_runs += ctx->test_ballQueryziseghist_local_31628_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31159               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31159_runs,
                    (long) ctx->test_ballQueryzisegmap_31159_total_runtime /
                    (ctx->test_ballQueryzisegmap_31159_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31159_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31159_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31159_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31159_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31182               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31182_runs,
                    (long) ctx->test_ballQueryzisegmap_31182_total_runtime /
                    (ctx->test_ballQueryzisegmap_31182_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31182_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31182_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31182_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31182_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31239               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31239_runs,
                    (long) ctx->test_ballQueryzisegmap_31239_total_runtime /
                    (ctx->test_ballQueryzisegmap_31239_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31239_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31239_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31239_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31239_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31245               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31245_runs,
                    (long) ctx->test_ballQueryzisegmap_31245_total_runtime /
                    (ctx->test_ballQueryzisegmap_31245_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31245_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31245_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31245_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31245_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31275               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31275_runs,
                    (long) ctx->test_ballQueryzisegmap_31275_total_runtime /
                    (ctx->test_ballQueryzisegmap_31275_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31275_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31275_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31275_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31275_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31309               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31309_runs,
                    (long) ctx->test_ballQueryzisegmap_31309_total_runtime /
                    (ctx->test_ballQueryzisegmap_31309_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31309_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31309_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31309_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31309_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31323               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31323_runs,
                    (long) ctx->test_ballQueryzisegmap_31323_total_runtime /
                    (ctx->test_ballQueryzisegmap_31323_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31323_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31323_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31323_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31323_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31420               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31420_runs,
                    (long) ctx->test_ballQueryzisegmap_31420_total_runtime /
                    (ctx->test_ballQueryzisegmap_31420_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31420_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31420_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31420_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31420_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31447               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31447_runs,
                    (long) ctx->test_ballQueryzisegmap_31447_total_runtime /
                    (ctx->test_ballQueryzisegmap_31447_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31447_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31447_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31447_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31447_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31507               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31507_runs,
                    (long) ctx->test_ballQueryzisegmap_31507_total_runtime /
                    (ctx->test_ballQueryzisegmap_31507_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31507_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31507_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31507_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31507_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31645               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31645_runs,
                    (long) ctx->test_ballQueryzisegmap_31645_total_runtime /
                    (ctx->test_ballQueryzisegmap_31645_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31645_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31645_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31645_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31645_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31688               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31688_runs,
                    (long) ctx->test_ballQueryzisegmap_31688_total_runtime /
                    (ctx->test_ballQueryzisegmap_31688_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31688_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31688_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31688_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31688_runs;
        str_builder(&builder,
                    "test_ballQuery.segmap_31831               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegmap_31831_runs,
                    (long) ctx->test_ballQueryzisegmap_31831_total_runtime /
                    (ctx->test_ballQueryzisegmap_31831_runs !=
                     0 ? ctx->test_ballQueryzisegmap_31831_runs : 1),
                    (long) ctx->test_ballQueryzisegmap_31831_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegmap_31831_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegmap_31831_runs;
        str_builder(&builder,
                    "test_ballQuery.segred_large_33235         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegred_large_33235_runs,
                    (long) ctx->test_ballQueryzisegred_large_33235_total_runtime /
                    (ctx->test_ballQueryzisegred_large_33235_runs !=
                     0 ? ctx->test_ballQueryzisegred_large_33235_runs : 1),
                    (long) ctx->test_ballQueryzisegred_large_33235_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryzisegred_large_33235_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegred_large_33235_runs;
        str_builder(&builder,
                    "test_ballQuery.segred_nonseg_31620        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegred_nonseg_31620_runs,
                    (long) ctx->test_ballQueryzisegred_nonseg_31620_total_runtime /
                    (ctx->test_ballQueryzisegred_nonseg_31620_runs !=
                     0 ? ctx->test_ballQueryzisegred_nonseg_31620_runs : 1),
                    (long) ctx->test_ballQueryzisegred_nonseg_31620_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryzisegred_nonseg_31620_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegred_nonseg_31620_runs;
        str_builder(&builder,
                    "test_ballQuery.segred_nonseg_31846        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegred_nonseg_31846_runs,
                    (long) ctx->test_ballQueryzisegred_nonseg_31846_total_runtime /
                    (ctx->test_ballQueryzisegred_nonseg_31846_runs !=
                     0 ? ctx->test_ballQueryzisegred_nonseg_31846_runs : 1),
                    (long) ctx->test_ballQueryzisegred_nonseg_31846_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryzisegred_nonseg_31846_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegred_nonseg_31846_runs;
        str_builder(&builder,
                    "test_ballQuery.segred_small_33235         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegred_small_33235_runs,
                    (long) ctx->test_ballQueryzisegred_small_33235_total_runtime /
                    (ctx->test_ballQueryzisegred_small_33235_runs !=
                     0 ? ctx->test_ballQueryzisegred_small_33235_runs : 1),
                    (long) ctx->test_ballQueryzisegred_small_33235_total_runtime);
        ctx->total_runtime +=
            ctx->test_ballQueryzisegred_small_33235_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegred_small_33235_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31237              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31237_runs,
                    (long) ctx->test_ballQueryzisegscan_31237_total_runtime /
                    (ctx->test_ballQueryzisegscan_31237_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31237_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31237_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31237_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31237_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31299              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31299_runs,
                    (long) ctx->test_ballQueryzisegscan_31299_total_runtime /
                    (ctx->test_ballQueryzisegscan_31299_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31299_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31299_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31299_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31299_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31307              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31307_runs,
                    (long) ctx->test_ballQueryzisegscan_31307_total_runtime /
                    (ctx->test_ballQueryzisegscan_31307_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31307_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31307_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31307_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31307_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31321              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31321_runs,
                    (long) ctx->test_ballQueryzisegscan_31321_total_runtime /
                    (ctx->test_ballQueryzisegscan_31321_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31321_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31321_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31321_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31321_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31610              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31610_runs,
                    (long) ctx->test_ballQueryzisegscan_31610_total_runtime /
                    (ctx->test_ballQueryzisegscan_31610_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31610_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31610_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31610_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31610_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31643              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31643_runs,
                    (long) ctx->test_ballQueryzisegscan_31643_total_runtime /
                    (ctx->test_ballQueryzisegscan_31643_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31643_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31643_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31643_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31643_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31669              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31669_runs,
                    (long) ctx->test_ballQueryzisegscan_31669_total_runtime /
                    (ctx->test_ballQueryzisegscan_31669_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31669_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31669_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31669_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31669_runs;
        str_builder(&builder,
                    "test_ballQuery.segscan_31829              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_ballQueryzisegscan_31829_runs,
                    (long) ctx->test_ballQueryzisegscan_31829_total_runtime /
                    (ctx->test_ballQueryzisegscan_31829_runs !=
                     0 ? ctx->test_ballQueryzisegscan_31829_runs : 1),
                    (long) ctx->test_ballQueryzisegscan_31829_total_runtime);
        ctx->total_runtime += ctx->test_ballQueryzisegscan_31829_total_runtime;
        ctx->total_runs += ctx->test_ballQueryzisegscan_31829_runs;
        str_builder(&builder,
                    "test_clusterWith.copy_33013               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzicopy_33013_runs,
                    (long) ctx->test_clusterWithzicopy_33013_total_runtime /
                    (ctx->test_clusterWithzicopy_33013_runs !=
                     0 ? ctx->test_clusterWithzicopy_33013_runs : 1),
                    (long) ctx->test_clusterWithzicopy_33013_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzicopy_33013_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzicopy_33013_runs;
        str_builder(&builder,
                    "test_clusterWith.copy_34206               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzicopy_34206_runs,
                    (long) ctx->test_clusterWithzicopy_34206_total_runtime /
                    (ctx->test_clusterWithzicopy_34206_runs !=
                     0 ? ctx->test_clusterWithzicopy_34206_runs : 1),
                    (long) ctx->test_clusterWithzicopy_34206_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzicopy_34206_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzicopy_34206_runs;
        str_builder(&builder,
                    "test_clusterWith.copy_34523               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzicopy_34523_runs,
                    (long) ctx->test_clusterWithzicopy_34523_total_runtime /
                    (ctx->test_clusterWithzicopy_34523_runs !=
                     0 ? ctx->test_clusterWithzicopy_34523_runs : 1),
                    (long) ctx->test_clusterWithzicopy_34523_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzicopy_34523_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzicopy_34523_runs;
        str_builder(&builder,
                    "test_clusterWith.copy_35217               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzicopy_35217_runs,
                    (long) ctx->test_clusterWithzicopy_35217_total_runtime /
                    (ctx->test_clusterWithzicopy_35217_runs !=
                     0 ? ctx->test_clusterWithzicopy_35217_runs : 1),
                    (long) ctx->test_clusterWithzicopy_35217_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzicopy_35217_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzicopy_35217_runs;
        str_builder(&builder,
                    "test_clusterWith.seghist_global_30660     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithziseghist_global_30660_runs,
                    (long) ctx->test_clusterWithziseghist_global_30660_total_runtime /
                    (ctx->test_clusterWithziseghist_global_30660_runs !=
                     0 ? ctx->test_clusterWithziseghist_global_30660_runs : 1),
                    (long) ctx->test_clusterWithziseghist_global_30660_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithziseghist_global_30660_total_runtime;
        ctx->total_runs += ctx->test_clusterWithziseghist_global_30660_runs;
        str_builder(&builder,
                    "test_clusterWith.seghist_global_31051     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithziseghist_global_31051_runs,
                    (long) ctx->test_clusterWithziseghist_global_31051_total_runtime /
                    (ctx->test_clusterWithziseghist_global_31051_runs !=
                     0 ? ctx->test_clusterWithziseghist_global_31051_runs : 1),
                    (long) ctx->test_clusterWithziseghist_global_31051_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithziseghist_global_31051_total_runtime;
        ctx->total_runs += ctx->test_clusterWithziseghist_global_31051_runs;
        str_builder(&builder,
                    "test_clusterWith.seghist_local_30660      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithziseghist_local_30660_runs,
                    (long) ctx->test_clusterWithziseghist_local_30660_total_runtime /
                    (ctx->test_clusterWithziseghist_local_30660_runs !=
                     0 ? ctx->test_clusterWithziseghist_local_30660_runs : 1),
                    (long) ctx->test_clusterWithziseghist_local_30660_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithziseghist_local_30660_total_runtime;
        ctx->total_runs += ctx->test_clusterWithziseghist_local_30660_runs;
        str_builder(&builder,
                    "test_clusterWith.seghist_local_31051      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithziseghist_local_31051_runs,
                    (long) ctx->test_clusterWithziseghist_local_31051_total_runtime /
                    (ctx->test_clusterWithziseghist_local_31051_runs !=
                     0 ? ctx->test_clusterWithziseghist_local_31051_runs : 1),
                    (long) ctx->test_clusterWithziseghist_local_31051_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithziseghist_local_31051_total_runtime;
        ctx->total_runs += ctx->test_clusterWithziseghist_local_31051_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30473             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30473_runs,
                    (long) ctx->test_clusterWithzisegmap_30473_total_runtime /
                    (ctx->test_clusterWithzisegmap_30473_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30473_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30473_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30473_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30473_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30495             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30495_runs,
                    (long) ctx->test_clusterWithzisegmap_30495_total_runtime /
                    (ctx->test_clusterWithzisegmap_30495_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30495_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30495_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30495_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30495_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30501             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30501_runs,
                    (long) ctx->test_clusterWithzisegmap_30501_total_runtime /
                    (ctx->test_clusterWithzisegmap_30501_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30501_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30501_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30501_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30501_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30551             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30551_runs,
                    (long) ctx->test_clusterWithzisegmap_30551_total_runtime /
                    (ctx->test_clusterWithzisegmap_30551_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30551_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30551_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30551_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30551_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30585             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30585_runs,
                    (long) ctx->test_clusterWithzisegmap_30585_total_runtime /
                    (ctx->test_clusterWithzisegmap_30585_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30585_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30585_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30585_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30585_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30599             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30599_runs,
                    (long) ctx->test_clusterWithzisegmap_30599_total_runtime /
                    (ctx->test_clusterWithzisegmap_30599_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30599_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30599_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30599_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30599_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30685             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30685_runs,
                    (long) ctx->test_clusterWithzisegmap_30685_total_runtime /
                    (ctx->test_clusterWithzisegmap_30685_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30685_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30685_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30685_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30685_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30803             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30803_runs,
                    (long) ctx->test_clusterWithzisegmap_30803_total_runtime /
                    (ctx->test_clusterWithzisegmap_30803_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30803_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30803_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30803_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30803_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30809             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30809_runs,
                    (long) ctx->test_clusterWithzisegmap_30809_total_runtime /
                    (ctx->test_clusterWithzisegmap_30809_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30809_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30809_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30809_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30809_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30843             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30843_runs,
                    (long) ctx->test_clusterWithzisegmap_30843_total_runtime /
                    (ctx->test_clusterWithzisegmap_30843_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30843_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30843_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30843_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30843_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30877             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30877_runs,
                    (long) ctx->test_clusterWithzisegmap_30877_total_runtime /
                    (ctx->test_clusterWithzisegmap_30877_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30877_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30877_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30877_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30877_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30891             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30891_runs,
                    (long) ctx->test_clusterWithzisegmap_30891_total_runtime /
                    (ctx->test_clusterWithzisegmap_30891_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30891_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30891_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30891_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30891_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30919             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30919_runs,
                    (long) ctx->test_clusterWithzisegmap_30919_total_runtime /
                    (ctx->test_clusterWithzisegmap_30919_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30919_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30919_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30919_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30919_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30953             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30953_runs,
                    (long) ctx->test_clusterWithzisegmap_30953_total_runtime /
                    (ctx->test_clusterWithzisegmap_30953_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30953_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30953_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30953_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30953_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_30967             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_30967_runs,
                    (long) ctx->test_clusterWithzisegmap_30967_total_runtime /
                    (ctx->test_clusterWithzisegmap_30967_runs !=
                     0 ? ctx->test_clusterWithzisegmap_30967_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_30967_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_30967_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_30967_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_31021             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_31021_runs,
                    (long) ctx->test_clusterWithzisegmap_31021_total_runtime /
                    (ctx->test_clusterWithzisegmap_31021_runs !=
                     0 ? ctx->test_clusterWithzisegmap_31021_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_31021_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_31021_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_31021_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_31068             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_31068_runs,
                    (long) ctx->test_clusterWithzisegmap_31068_total_runtime /
                    (ctx->test_clusterWithzisegmap_31068_runs !=
                     0 ? ctx->test_clusterWithzisegmap_31068_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_31068_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_31068_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_31068_runs;
        str_builder(&builder,
                    "test_clusterWith.segmap_31102             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegmap_31102_runs,
                    (long) ctx->test_clusterWithzisegmap_31102_total_runtime /
                    (ctx->test_clusterWithzisegmap_31102_runs !=
                     0 ? ctx->test_clusterWithzisegmap_31102_runs : 1),
                    (long) ctx->test_clusterWithzisegmap_31102_total_runtime);
        ctx->total_runtime += ctx->test_clusterWithzisegmap_31102_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegmap_31102_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_large_33339       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_large_33339_runs,
                    (long) ctx->test_clusterWithzisegred_large_33339_total_runtime /
                    (ctx->test_clusterWithzisegred_large_33339_runs !=
                     0 ? ctx->test_clusterWithzisegred_large_33339_runs : 1),
                    (long) ctx->test_clusterWithzisegred_large_33339_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_large_33339_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_large_33339_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_large_34936       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_large_34936_runs,
                    (long) ctx->test_clusterWithzisegred_large_34936_total_runtime /
                    (ctx->test_clusterWithzisegred_large_34936_runs !=
                     0 ? ctx->test_clusterWithzisegred_large_34936_runs : 1),
                    (long) ctx->test_clusterWithzisegred_large_34936_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_large_34936_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_large_34936_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30614      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30614_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30614_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30614_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30614_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30614_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30614_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30614_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30624      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30624_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30624_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30624_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30624_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30624_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30624_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30624_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30634      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30634_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30634_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30634_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30634_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30634_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30634_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30634_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30652      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30652_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30652_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30652_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30652_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30652_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30652_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30652_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30981      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30981_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30981_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30981_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30981_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30981_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30981_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30981_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_30991      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_30991_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_30991_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_30991_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_30991_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_30991_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_30991_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_30991_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_31001      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_31001_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_31001_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_31001_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_31001_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_31001_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_31001_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_31001_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_31011      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_31011_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_31011_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_31011_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_31011_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_31011_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_31011_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_31011_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_nonseg_31043      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_nonseg_31043_runs,
                    (long) ctx->test_clusterWithzisegred_nonseg_31043_total_runtime /
                    (ctx->test_clusterWithzisegred_nonseg_31043_runs !=
                     0 ? ctx->test_clusterWithzisegred_nonseg_31043_runs : 1),
                    (long) ctx->test_clusterWithzisegred_nonseg_31043_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_nonseg_31043_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_nonseg_31043_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_small_33339       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_small_33339_runs,
                    (long) ctx->test_clusterWithzisegred_small_33339_total_runtime /
                    (ctx->test_clusterWithzisegred_small_33339_runs !=
                     0 ? ctx->test_clusterWithzisegred_small_33339_runs : 1),
                    (long) ctx->test_clusterWithzisegred_small_33339_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_small_33339_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_small_33339_runs;
        str_builder(&builder,
                    "test_clusterWith.segred_small_34936       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegred_small_34936_runs,
                    (long) ctx->test_clusterWithzisegred_small_34936_total_runtime /
                    (ctx->test_clusterWithzisegred_small_34936_runs !=
                     0 ? ctx->test_clusterWithzisegred_small_34936_runs : 1),
                    (long) ctx->test_clusterWithzisegred_small_34936_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegred_small_34936_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegred_small_34936_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30493            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30493_runs,
                    (long) ctx->test_clusterWithzisegscan_30493_total_runtime /
                    (ctx->test_clusterWithzisegscan_30493_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30493_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30493_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30493_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30493_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30575            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30575_runs,
                    (long) ctx->test_clusterWithzisegscan_30575_total_runtime /
                    (ctx->test_clusterWithzisegscan_30575_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30575_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30575_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30575_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30575_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30583            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30583_runs,
                    (long) ctx->test_clusterWithzisegscan_30583_total_runtime /
                    (ctx->test_clusterWithzisegscan_30583_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30583_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30583_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30583_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30583_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30597            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30597_runs,
                    (long) ctx->test_clusterWithzisegscan_30597_total_runtime /
                    (ctx->test_clusterWithzisegscan_30597_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30597_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30597_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30597_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30597_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30642            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30642_runs,
                    (long) ctx->test_clusterWithzisegscan_30642_total_runtime /
                    (ctx->test_clusterWithzisegscan_30642_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30642_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30642_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30642_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30642_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30675            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30675_runs,
                    (long) ctx->test_clusterWithzisegscan_30675_total_runtime /
                    (ctx->test_clusterWithzisegscan_30675_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30675_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30675_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30675_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30675_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30683            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30683_runs,
                    (long) ctx->test_clusterWithzisegscan_30683_total_runtime /
                    (ctx->test_clusterWithzisegscan_30683_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30683_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30683_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30683_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30683_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30801            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30801_runs,
                    (long) ctx->test_clusterWithzisegscan_30801_total_runtime /
                    (ctx->test_clusterWithzisegscan_30801_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30801_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30801_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30801_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30801_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30867            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30867_runs,
                    (long) ctx->test_clusterWithzisegscan_30867_total_runtime /
                    (ctx->test_clusterWithzisegscan_30867_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30867_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30867_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30867_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30867_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30875            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30875_runs,
                    (long) ctx->test_clusterWithzisegscan_30875_total_runtime /
                    (ctx->test_clusterWithzisegscan_30875_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30875_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30875_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30875_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30875_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30889            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30889_runs,
                    (long) ctx->test_clusterWithzisegscan_30889_total_runtime /
                    (ctx->test_clusterWithzisegscan_30889_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30889_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30889_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30889_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30889_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30943            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30943_runs,
                    (long) ctx->test_clusterWithzisegscan_30943_total_runtime /
                    (ctx->test_clusterWithzisegscan_30943_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30943_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30943_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30943_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30943_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30951            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30951_runs,
                    (long) ctx->test_clusterWithzisegscan_30951_total_runtime /
                    (ctx->test_clusterWithzisegscan_30951_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30951_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30951_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30951_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30951_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_30965            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_30965_runs,
                    (long) ctx->test_clusterWithzisegscan_30965_total_runtime /
                    (ctx->test_clusterWithzisegscan_30965_runs !=
                     0 ? ctx->test_clusterWithzisegscan_30965_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_30965_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_30965_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_30965_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_31019            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_31019_runs,
                    (long) ctx->test_clusterWithzisegscan_31019_total_runtime /
                    (ctx->test_clusterWithzisegscan_31019_runs !=
                     0 ? ctx->test_clusterWithzisegscan_31019_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_31019_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_31019_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_31019_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_31033            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_31033_runs,
                    (long) ctx->test_clusterWithzisegscan_31033_total_runtime /
                    (ctx->test_clusterWithzisegscan_31033_runs !=
                     0 ? ctx->test_clusterWithzisegscan_31033_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_31033_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_31033_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_31033_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_31066            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_31066_runs,
                    (long) ctx->test_clusterWithzisegscan_31066_total_runtime /
                    (ctx->test_clusterWithzisegscan_31066_runs !=
                     0 ? ctx->test_clusterWithzisegscan_31066_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_31066_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_31066_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_31066_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_31092            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_31092_runs,
                    (long) ctx->test_clusterWithzisegscan_31092_total_runtime /
                    (ctx->test_clusterWithzisegscan_31092_runs !=
                     0 ? ctx->test_clusterWithzisegscan_31092_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_31092_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_31092_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_31092_runs;
        str_builder(&builder,
                    "test_clusterWith.segscan_31100            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_clusterWithzisegscan_31100_runs,
                    (long) ctx->test_clusterWithzisegscan_31100_total_runtime /
                    (ctx->test_clusterWithzisegscan_31100_runs !=
                     0 ? ctx->test_clusterWithzisegscan_31100_runs : 1),
                    (long) ctx->test_clusterWithzisegscan_31100_total_runtime);
        ctx->total_runtime +=
            ctx->test_clusterWithzisegscan_31100_total_runtime;
        ctx->total_runs += ctx->test_clusterWithzisegscan_31100_runs;
        str_builder(&builder,
                    "test_elimDupesWith.copy_32774             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzicopy_32774_runs,
                    (long) ctx->test_elimDupesWithzicopy_32774_total_runtime /
                    (ctx->test_elimDupesWithzicopy_32774_runs !=
                     0 ? ctx->test_elimDupesWithzicopy_32774_runs : 1),
                    (long) ctx->test_elimDupesWithzicopy_32774_total_runtime);
        ctx->total_runtime += ctx->test_elimDupesWithzicopy_32774_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzicopy_32774_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segmap_30389           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegmap_30389_runs,
                    (long) ctx->test_elimDupesWithzisegmap_30389_total_runtime /
                    (ctx->test_elimDupesWithzisegmap_30389_runs !=
                     0 ? ctx->test_elimDupesWithzisegmap_30389_runs : 1),
                    (long) ctx->test_elimDupesWithzisegmap_30389_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegmap_30389_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegmap_30389_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segmap_30403           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegmap_30403_runs,
                    (long) ctx->test_elimDupesWithzisegmap_30403_total_runtime /
                    (ctx->test_elimDupesWithzisegmap_30403_runs !=
                     0 ? ctx->test_elimDupesWithzisegmap_30403_runs : 1),
                    (long) ctx->test_elimDupesWithzisegmap_30403_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegmap_30403_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegmap_30403_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segmap_30437           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegmap_30437_runs,
                    (long) ctx->test_elimDupesWithzisegmap_30437_total_runtime /
                    (ctx->test_elimDupesWithzisegmap_30437_runs !=
                     0 ? ctx->test_elimDupesWithzisegmap_30437_runs : 1),
                    (long) ctx->test_elimDupesWithzisegmap_30437_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegmap_30437_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegmap_30437_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segmap_30451           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegmap_30451_runs,
                    (long) ctx->test_elimDupesWithzisegmap_30451_total_runtime /
                    (ctx->test_elimDupesWithzisegmap_30451_runs !=
                     0 ? ctx->test_elimDupesWithzisegmap_30451_runs : 1),
                    (long) ctx->test_elimDupesWithzisegmap_30451_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegmap_30451_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegmap_30451_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segscan_30427          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegscan_30427_runs,
                    (long) ctx->test_elimDupesWithzisegscan_30427_total_runtime /
                    (ctx->test_elimDupesWithzisegscan_30427_runs !=
                     0 ? ctx->test_elimDupesWithzisegscan_30427_runs : 1),
                    (long) ctx->test_elimDupesWithzisegscan_30427_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegscan_30427_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegscan_30427_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segscan_30435          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegscan_30435_runs,
                    (long) ctx->test_elimDupesWithzisegscan_30435_total_runtime /
                    (ctx->test_elimDupesWithzisegscan_30435_runs !=
                     0 ? ctx->test_elimDupesWithzisegscan_30435_runs : 1),
                    (long) ctx->test_elimDupesWithzisegscan_30435_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegscan_30435_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegscan_30435_runs;
        str_builder(&builder,
                    "test_elimDupesWith.segscan_30449          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_elimDupesWithzisegscan_30449_runs,
                    (long) ctx->test_elimDupesWithzisegscan_30449_total_runtime /
                    (ctx->test_elimDupesWithzisegscan_30449_runs !=
                     0 ? ctx->test_elimDupesWithzisegscan_30449_runs : 1),
                    (long) ctx->test_elimDupesWithzisegscan_30449_total_runtime);
        ctx->total_runtime +=
            ctx->test_elimDupesWithzisegscan_30449_total_runtime;
        ctx->total_runs += ctx->test_elimDupesWithzisegscan_30449_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.copy_32773     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzicopy_32773_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzicopy_32773_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzicopy_32773_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzicopy_32773_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzicopy_32773_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzicopy_32773_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzicopy_32773_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segmap_30253   ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30253_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30253_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegmap_30253_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segmap_30267   ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30267_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30267_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegmap_30267_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segmap_30301   ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30301_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30301_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegmap_30301_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segmap_30315   ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30315_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegmap_30315_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegmap_30315_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segscan_30291  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30291_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30291_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegscan_30291_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segscan_30299  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30299_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30299_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegscan_30299_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segInd.segscan_30313  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs,
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30313_total_runtime /
                    (ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs !=
                     0 ? ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segIndzisegscan_30313_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segIndzisegscan_30313_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.copy_32773    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezicopy_32773_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezicopy_32773_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezicopy_32773_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segmap_30321  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segmap_30335  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segmap_30369  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segmap_30383  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime;
        ctx->total_runs += ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segscan_30359 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime;
        ctx->total_runs +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segscan_30367 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime;
        ctx->total_runs +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs;
        str_builder(&builder,
                    "test_mkSegsFromSort_segSize.segscan_30381 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs,
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime /
                    (ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs !=
                     0 ? ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs : 1),
                    (long) ctx->test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime);
        ctx->total_runtime +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime;
        ctx->total_runs +=
            ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f)
{
    ctx->log = f;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        CUDA_SUCCEED_NONFATAL(cuda_free_all(&ctx->cuda));
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}
static int futrts_builtinzhiota_i64(struct futhark_context *ctx,
                                    struct memblock_device mem_32444,
                                    int32_t n_32445, int64_t x_32446,
                                    int64_t s_32447);
static int futrts_builtinzhreplicate_i32(struct futhark_context *ctx,
                                         struct memblock_device mem_33023,
                                         int32_t num_elems_33024,
                                         int32_t val_33025);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_32921,
                                         int32_t num_elems_32922,
                                         int64_t val_32923);
static int futrts_builtinzhreplicate_i8(struct futhark_context *ctx,
                                        struct memblock_device mem_32491,
                                        int32_t num_elems_32492,
                                        int8_t val_32493);
static int futrts_entry_test_ballQuery(struct futhark_context *ctx,
                                       struct memblock_device *out_mem_p_35376,
                                       int64_t *out_out_arrsizze_35377,
                                       struct memblock_device pos_mem_31946,
                                       struct memblock_device labels_mem_31947,
                                       int64_t implz2081U_29737,
                                       float radius_29738);
static int futrts_entry_test_clusterWith(struct futhark_context *ctx,
                                         struct memblock_device *out_mem_p_35673,
                                         int64_t *out_out_arrsizze_35674,
                                         struct memblock_device graph_from_mem_31946,
                                         struct memblock_device graph_to_mem_31947,
                                         int64_t implz2081U_28888,
                                         int32_t thres_28889,
                                         int64_t numVert_28890);
static int futrts_entry_test_elimDupesWith(struct futhark_context *ctx,
                                           struct memblock_device *out_mem_p_36311,
                                           int64_t *out_out_arrsizze_36312,
                                           struct memblock_device arr_mem_31946,
                                           int64_t implz2081U_28821);
static int futrts_entry_test_mkSegsFromSort_segInd(struct futhark_context *ctx,
                                                   struct memblock_device *out_mem_p_36383,
                                                   struct memblock_device keys_mem_31946,
                                                   struct memblock_device values_mem_31947,
                                                   int64_t implz2081U_28671,
                                                   int64_t numKey_28672);
static int
futrts_entry_test_mkSegsFromSort_segSizze(struct futhark_context *ctx,
                                          struct memblock_device *out_mem_p_36454,
                                          struct memblock_device keys_mem_31946,
                                          struct memblock_device values_mem_31947,
                                          int64_t implz2081U_28746,
                                          int64_t numKey_28747);
static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhiota_i64(struct futhark_context *ctx,
                                    struct memblock_device mem_32444,
                                    int32_t n_32445, int64_t x_32446,
                                    int64_t s_32447)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_32452;
    
    group_sizze_32452 = ctx->sizes.builtinzhiota_i64zigroup_sizze_32452;
    
    int64_t num_groups_32453;
    
    num_groups_32453 = sdiv_up64(n_32445, group_sizze_32452);
    
    CUdeviceptr kernel_arg_35363 = mem_32444.mem;
    
    if ((((((1 && num_groups_32453 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32452 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32453;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35360[] = {&n_32445, &x_32446, &s_32447,
                                     &kernel_arg_35363};
        int64_t time_start_35361 = 0, time_end_35362 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "builtin#iota_i64.iota_i64_32449");
            fprintf(ctx->log, "%ld", (long) num_groups_32453);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32452);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35361 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhiota_i64ziiota_i64_32449_runs,
                                      &ctx->builtinzhiota_i64ziiota_i64_32449_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->builtinzhiota_i64ziiota_i64_32449,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32452, 1, 1, 0, NULL,
                                              kernel_args_35360, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35362 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "builtin#iota_i64.iota_i64_32449", time_end_35362 -
                    time_start_35361);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i32(struct futhark_context *ctx,
                                         struct memblock_device mem_33023,
                                         int32_t num_elems_33024,
                                         int32_t val_33025)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_33030;
    
    group_sizze_33030 = ctx->sizes.builtinzhreplicate_i32zigroup_sizze_33030;
    
    int64_t num_groups_33031;
    
    num_groups_33031 = sdiv_up64(num_elems_33024, group_sizze_33030);
    
    CUdeviceptr kernel_arg_35367 = mem_33023.mem;
    
    if ((((((1 && num_groups_33031 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_33030 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_33031;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35364[] = {&num_elems_33024, &val_33025,
                                     &kernel_arg_35367};
        int64_t time_start_35365 = 0, time_end_35366 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "builtin#replicate_i32.replicate_33027");
            fprintf(ctx->log, "%ld", (long) num_groups_33031);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_33030);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35365 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_i32zireplicate_33027_runs,
                                      &ctx->builtinzhreplicate_i32zireplicate_33027_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->builtinzhreplicate_i32zireplicate_33027,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_33030, 1, 1, 0, NULL,
                                              kernel_args_35364, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35366 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_i32.replicate_33027", time_end_35366 -
                    time_start_35365);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_32921,
                                         int32_t num_elems_32922,
                                         int64_t val_32923)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_32928;
    
    group_sizze_32928 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_32928;
    
    int64_t num_groups_32929;
    
    num_groups_32929 = sdiv_up64(num_elems_32922, group_sizze_32928);
    
    CUdeviceptr kernel_arg_35371 = mem_32921.mem;
    
    if ((((((1 && num_groups_32929 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32928 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32929;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35368[] = {&num_elems_32922, &val_32923,
                                     &kernel_arg_35371};
        int64_t time_start_35369 = 0, time_end_35370 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "builtin#replicate_i64.replicate_32925");
            fprintf(ctx->log, "%ld", (long) num_groups_32929);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32928);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35369 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_i64zireplicate_32925_runs,
                                      &ctx->builtinzhreplicate_i64zireplicate_32925_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->builtinzhreplicate_i64zireplicate_32925,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32928, 1, 1, 0, NULL,
                                              kernel_args_35368, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35370 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_32925", time_end_35370 -
                    time_start_35369);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i8(struct futhark_context *ctx,
                                        struct memblock_device mem_32491,
                                        int32_t num_elems_32492,
                                        int8_t val_32493)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_32498;
    
    group_sizze_32498 = ctx->sizes.builtinzhreplicate_i8zigroup_sizze_32498;
    
    int64_t num_groups_32499;
    
    num_groups_32499 = sdiv_up64(num_elems_32492, group_sizze_32498);
    
    CUdeviceptr kernel_arg_35375 = mem_32491.mem;
    
    if ((((((1 && num_groups_32499 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32498 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32499;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35372[] = {&num_elems_32492, &val_32493,
                                     &kernel_arg_35375};
        int64_t time_start_35373 = 0, time_end_35374 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "builtin#replicate_i8.replicate_32495");
            fprintf(ctx->log, "%ld", (long) num_groups_32499);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32498);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35373 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_i8zireplicate_32495_runs,
                                      &ctx->builtinzhreplicate_i8zireplicate_32495_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->builtinzhreplicate_i8zireplicate_32495,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32498, 1, 1, 0, NULL,
                                              kernel_args_35372, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35374 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_i8.replicate_32495", time_end_35374 -
                    time_start_35373);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_entry_test_ballQuery(struct futhark_context *ctx,
                                       struct memblock_device *out_mem_p_35376,
                                       int64_t *out_out_arrsizze_35377,
                                       struct memblock_device pos_mem_31946,
                                       struct memblock_device labels_mem_31947,
                                       int64_t implz2081U_29737,
                                       float radius_29738)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    int64_t bytes_31948 = (int64_t) 8 * implz2081U_29737;
    struct memblock_device mem_31949;
    
    mem_31949.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31949, bytes_31948, "mem_31949")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_31949, implz2081U_29737, (int64_t) 0,
                                 (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t nest_sizze_31208 = (int64_t) 3 * implz2081U_29737;
    int64_t segmap_group_sizze_31209;
    
    segmap_group_sizze_31209 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31185;
    
    int64_t segmap_usable_groups_31210 = sdiv_up64(nest_sizze_31208,
                                                   segmap_group_sizze_31209);
    int64_t bytes_31951 = (int64_t) 4 * nest_sizze_31208;
    struct memblock_device mem_31953;
    
    mem_31953.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31953, bytes_31951, "mem_31953")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35381 = pos_mem_31946.mem;
    CUdeviceptr kernel_arg_35382 = mem_31953.mem;
    
    if ((((((1 && segmap_usable_groups_31210 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31209 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31210;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35378[] = {&ctx->global_failure, &implz2081U_29737,
                                     &radius_29738, &kernel_arg_35381,
                                     &kernel_arg_35382};
        int64_t time_start_35379 = 0, time_end_35380 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31182");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31210);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31209);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35379 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31182_runs,
                                      &ctx->test_ballQueryzisegmap_31182_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31182,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31209, 1, 1, 0,
                                              NULL, kernel_args_35378, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35380 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31182", time_end_35380 -
                    time_start_35379);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_group_sizze_31219;
    
    segmap_group_sizze_31219 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31161;
    
    int64_t segmap_usable_groups_31220 = sdiv_up64(implz2081U_29737,
                                                   segmap_group_sizze_31219);
    int64_t bytes_31955 = (int64_t) 4 * implz2081U_29737;
    struct memblock_device mem_31956;
    
    mem_31956.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31956, bytes_31955, "mem_31956")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35386 = mem_31953.mem;
    CUdeviceptr kernel_arg_35387 = mem_31956.mem;
    
    if ((((((1 && segmap_usable_groups_31220 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31219 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31220;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35383[] = {&ctx->global_failure, &implz2081U_29737,
                                     &kernel_arg_35386, &kernel_arg_35387};
        int64_t time_start_35384 = 0, time_end_35385 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31159");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31220);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31219);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35384 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31159_runs,
                                      &ctx->test_ballQueryzisegmap_31159_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31159,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31219, 1, 1, 0,
                                              NULL, kernel_args_35383, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35385 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31159", time_end_35385 -
                    time_start_35384);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    
    bool cond_29757 = implz2081U_29737 == (int64_t) 0;
    int32_t iters_29758;
    
    if (cond_29757) {
        iters_29758 = 0;
    } else {
        iters_29758 = 6;
    }
    
    bool loop_nonempty_29759 = slt32(0, iters_29758);
    int64_t i_29760 = sub64(implz2081U_29737, (int64_t) 1);
    bool x_29761 = sle64((int64_t) 0, i_29760);
    bool y_29762 = slt64(i_29760, implz2081U_29737);
    bool bounds_check_29763 = x_29761 && y_29762;
    bool loop_not_taken_29764 = !loop_nonempty_29759;
    bool protect_assert_disj_29765 = bounds_check_29763 || loop_not_taken_29764;
    bool index_certs_29766;
    
    if (!protect_assert_disj_29765) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_29760,
                               "] out of bounds for array of shape [",
                               implz2081U_29737, "].",
                               "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:100:16-71\n   #8  src/cluster_test.fut:49:17-45\n   #9  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t segscan_group_sizze_31232;
    
    segscan_group_sizze_31232 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31231;
    
    int64_t num_groups_31234;
    int32_t max_num_groups_32464;
    
    max_num_groups_32464 = ctx->sizes.test_ballQueryzisegscan_num_groups_31233;
    num_groups_31234 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_29737,
                                                            segscan_group_sizze_31232),
                                                  sext_i32_i64(max_num_groups_32464))));
    
    int64_t segmap_group_sizze_31242;
    
    segmap_group_sizze_31242 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31241;
    
    int64_t segmap_usable_groups_31243 = sdiv_up_safe64(implz2081U_29737,
                                                        segmap_group_sizze_31242);
    struct memblock_device mem_31973;
    
    mem_31973.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31973, bytes_31948, "mem_31973")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31975;
    
    mem_31975.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31975, bytes_31948, "mem_31975")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31977;
    
    mem_31977.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31977, bytes_31948, "mem_31977")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31979;
    
    mem_31979.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31979, bytes_31948, "mem_31979")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31981;
    
    mem_31981.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31981, bytes_31955, "mem_31981")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device defunc_0_f_res_mem_31995;
    
    defunc_0_f_res_mem_31995.references = NULL;
    
    struct memblock_device defunc_0_f_res_mem_32000;
    
    defunc_0_f_res_mem_32000.references = NULL;
    
    struct memblock_device mem_param_31961;
    
    mem_param_31961.references = NULL;
    
    struct memblock_device mem_param_31966;
    
    mem_param_31966.references = NULL;
    if (memblock_set_device(ctx, &mem_param_31961, &mem_31956, "mem_31956") !=
        0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_31966, &mem_31949, "mem_31949") !=
        0)
        return 1;
    for (int32_t i_29769 = 0; i_29769 < iters_29758; i_29769++) {
        int32_t defunc_2_radix_sort_step_arg_29772 = mul32(2, i_29769);
        int32_t defunc_0_get_bit_arg_29773 = add32(1,
                                                   defunc_2_radix_sort_step_arg_29772);
        
        if (slt64((int64_t) 0, implz2081U_29737)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_32469;
            
            numThreads_32469 = sdiv_up64(implz2081U_29737,
                                         segscan_group_sizze_31232 *
                                         (int64_t) 9) *
                segscan_group_sizze_31232;
            
            int64_t numGroups_32470;
            
            numGroups_32470 = sdiv_up64(implz2081U_29737,
                                        segscan_group_sizze_31232 *
                                        (int64_t) 9);
            
            struct memblock_device test_ballQueryziid_counter_mem_32471 =
                                   ctx->test_ballQueryziid_counter_mem_32471;
            struct memblock_device status_flags_mem_32473;
            
            status_flags_mem_32473.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_32473,
                                      numGroups_32470,
                                      "status_flags_mem_32473")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32475;
            
            aggregates_mem_32475.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32475, (int64_t) 8 *
                                      numGroups_32470,
                                      "aggregates_mem_32475")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32477;
            
            incprefixes_mem_32477.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32477, (int64_t) 8 *
                                      numGroups_32470,
                                      "incprefixes_mem_32477")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32479;
            
            aggregates_mem_32479.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32479, (int64_t) 8 *
                                      numGroups_32470,
                                      "aggregates_mem_32479")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32481;
            
            incprefixes_mem_32481.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32481, (int64_t) 8 *
                                      numGroups_32470,
                                      "incprefixes_mem_32481")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32483;
            
            aggregates_mem_32483.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32483, (int64_t) 8 *
                                      numGroups_32470,
                                      "aggregates_mem_32483")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32485;
            
            incprefixes_mem_32485.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32485, (int64_t) 8 *
                                      numGroups_32470,
                                      "incprefixes_mem_32485")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32487;
            
            aggregates_mem_32487.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32487, (int64_t) 8 *
                                      numGroups_32470,
                                      "aggregates_mem_32487")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32489;
            
            incprefixes_mem_32489.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32489, (int64_t) 8 *
                                      numGroups_32470,
                                      "incprefixes_mem_32489")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32473,
                                             numGroups_32470, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_35392 = smax64(smax64((int64_t) 1056,
                                                            sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                          segscan_group_sizze_31232,
                                                                                          (int64_t) 8) *
                                                                                (int64_t) 8 +
                                                                                (int64_t) 8 *
                                                                                segscan_group_sizze_31232,
                                                                                (int64_t) 8) *
                                                                      (int64_t) 8 +
                                                                      (int64_t) 8 *
                                                                      segscan_group_sizze_31232,
                                                                      (int64_t) 8) *
                                                            (int64_t) 8 +
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31232),
                                                     smax64(smax64(smax64((int64_t) 9 *
                                                                          segscan_group_sizze_31232 *
                                                                          (int64_t) 8,
                                                                          (int64_t) 9 *
                                                                          segscan_group_sizze_31232 *
                                                                          (int64_t) 8),
                                                                   (int64_t) 9 *
                                                                   segscan_group_sizze_31232 *
                                                                   (int64_t) 8),
                                                            (int64_t) 9 *
                                                            segscan_group_sizze_31232 *
                                                            (int64_t) 8));
            CUdeviceptr kernel_arg_35394 = mem_param_31961.mem;
            CUdeviceptr kernel_arg_35395 = mem_31973.mem;
            CUdeviceptr kernel_arg_35396 = mem_31975.mem;
            CUdeviceptr kernel_arg_35397 = mem_31977.mem;
            CUdeviceptr kernel_arg_35398 = mem_31979.mem;
            CUdeviceptr kernel_arg_35399 = mem_31981.mem;
            CUdeviceptr kernel_arg_35400 =
                        test_ballQueryziid_counter_mem_32471.mem;
            CUdeviceptr kernel_arg_35401 = status_flags_mem_32473.mem;
            CUdeviceptr kernel_arg_35402 = aggregates_mem_32475.mem;
            CUdeviceptr kernel_arg_35403 = incprefixes_mem_32477.mem;
            CUdeviceptr kernel_arg_35404 = aggregates_mem_32479.mem;
            CUdeviceptr kernel_arg_35405 = incprefixes_mem_32481.mem;
            CUdeviceptr kernel_arg_35406 = aggregates_mem_32483.mem;
            CUdeviceptr kernel_arg_35407 = incprefixes_mem_32485.mem;
            CUdeviceptr kernel_arg_35408 = aggregates_mem_32487.mem;
            CUdeviceptr kernel_arg_35409 = incprefixes_mem_32489.mem;
            unsigned int shared_offset_35393 = 0;
            
            if ((((((1 && sdiv_up64(implz2081U_29737,
                                    segscan_group_sizze_31232 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31232 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(implz2081U_29737,
                                          segscan_group_sizze_31232 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35389[] = {&ctx->global_failure,
                                             &shared_offset_35393,
                                             &implz2081U_29737,
                                             &defunc_2_radix_sort_step_arg_29772,
                                             &defunc_0_get_bit_arg_29773,
                                             &kernel_arg_35394,
                                             &kernel_arg_35395,
                                             &kernel_arg_35396,
                                             &kernel_arg_35397,
                                             &kernel_arg_35398,
                                             &kernel_arg_35399,
                                             &kernel_arg_35400,
                                             &kernel_arg_35401,
                                             &kernel_arg_35402,
                                             &kernel_arg_35403,
                                             &kernel_arg_35404,
                                             &kernel_arg_35405,
                                             &kernel_arg_35406,
                                             &kernel_arg_35407,
                                             &kernel_arg_35408,
                                             &kernel_arg_35409};
                int64_t time_start_35390 = 0, time_end_35391 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_ballQuery.segscan_31237");
                    fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_29737,
                                                              segscan_group_sizze_31232 *
                                                              (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31232);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35390 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_ballQueryzisegscan_31237_runs,
                                              &ctx->test_ballQueryzisegscan_31237_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31237,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31232,
                                                      1, 1, 0 +
                                                      (shared_sizze_35392 + (8 -
                                                                             shared_sizze_35392 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35389, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35391 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_ballQuery.segscan_31237", time_end_35391 -
                            time_start_35390);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_32489,
                                      "incprefixes_mem_32489") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32487,
                                      "aggregates_mem_32487") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32485,
                                      "incprefixes_mem_32485") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32483,
                                      "aggregates_mem_32483") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32481,
                                      "incprefixes_mem_32481") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32479,
                                      "aggregates_mem_32479") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32477,
                                      "incprefixes_mem_32477") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32475,
                                      "aggregates_mem_32475") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_32473,
                                      "status_flags_mem_32473") != 0)
                return 1;
        }
        
        int64_t read_res_35410;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35410, mem_31973.mem +
                                                i_29760 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_29824 = read_res_35410;
        int64_t read_res_35411;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35411, mem_31975.mem +
                                                i_29760 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_29825 = read_res_35411;
        int64_t read_res_35412;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35412, mem_31977.mem +
                                                i_29760 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_29826 = read_res_35412;
        struct memblock_device mem_31983;
        
        mem_31983.references = NULL;
        if (memblock_alloc_device(ctx, &mem_31983, bytes_31955, "mem_31983")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31983.mem + (int64_t) 0,
                                            mem_param_31961.mem + (int64_t) 0,
                                            implz2081U_29737 * (int64_t) 4));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        
        struct memblock_device mem_31985;
        
        mem_31985.references = NULL;
        if (memblock_alloc_device(ctx, &mem_31985, bytes_31948, "mem_31985")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31985.mem + (int64_t) 0,
                                            mem_param_31966.mem + (int64_t) 0,
                                            implz2081U_29737 * (int64_t) 8));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_35416 = mem_param_31961.mem;
        CUdeviceptr kernel_arg_35417 = mem_param_31966.mem;
        CUdeviceptr kernel_arg_35418 = mem_31973.mem;
        CUdeviceptr kernel_arg_35419 = mem_31975.mem;
        CUdeviceptr kernel_arg_35420 = mem_31977.mem;
        CUdeviceptr kernel_arg_35421 = mem_31979.mem;
        CUdeviceptr kernel_arg_35422 = mem_31981.mem;
        CUdeviceptr kernel_arg_35423 = mem_31983.mem;
        CUdeviceptr kernel_arg_35424 = mem_31985.mem;
        
        if ((((((1 && segmap_usable_groups_31243 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_31242 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_31243;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35413[] = {&ctx->global_failure,
                                         &implz2081U_29737, &last_res_29824,
                                         &last_res_29825, &last_res_29826,
                                         &kernel_arg_35416, &kernel_arg_35417,
                                         &kernel_arg_35418, &kernel_arg_35419,
                                         &kernel_arg_35420, &kernel_arg_35421,
                                         &kernel_arg_35422, &kernel_arg_35423,
                                         &kernel_arg_35424};
            int64_t time_start_35414 = 0, time_end_35415 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segmap_31239");
                fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31243);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31242);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35414 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegmap_31239_runs,
                                          &ctx->test_ballQueryzisegmap_31239_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31239,
                                                  grid[0], grid[1], grid[2],
                                                  segmap_group_sizze_31242, 1,
                                                  1, 0, NULL, kernel_args_35413,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35415 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segmap_31239", time_end_35415 -
                        time_start_35414);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        struct memblock_device mem_param_tmp_32465;
        
        mem_param_tmp_32465.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_32465, &mem_31983,
                                "mem_31983") != 0)
            return 1;
        
        struct memblock_device mem_param_tmp_32466;
        
        mem_param_tmp_32466.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_32466, &mem_31985,
                                "mem_31985") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_31961, &mem_param_tmp_32465,
                                "mem_param_tmp_32465") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_31966, &mem_param_tmp_32466,
                                "mem_param_tmp_32466") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_32466,
                                  "mem_param_tmp_32466") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_32465,
                                  "mem_param_tmp_32465") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31985, "mem_31985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31983, "mem_31983") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_31995, &mem_param_31961,
                            "mem_param_31961") != 0)
        return 1;
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_32000, &mem_param_31966,
                            "mem_param_31966") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31260;
    
    segmap_group_sizze_31260 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31247;
    
    int64_t segmap_usable_groups_31261 = sdiv_up64(implz2081U_29737,
                                                   segmap_group_sizze_31260);
    struct memblock_device mem_32003;
    
    mem_32003.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32003, bytes_31948, "mem_32003")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32005;
    
    mem_32005.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32005, bytes_31955, "mem_32005")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32007;
    
    mem_32007.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32007, bytes_31955, "mem_32007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35428 = mem_31956.mem;
    CUdeviceptr kernel_arg_35429 = defunc_0_f_res_mem_32000.mem;
    CUdeviceptr kernel_arg_35430 = mem_32003.mem;
    CUdeviceptr kernel_arg_35431 = mem_32005.mem;
    CUdeviceptr kernel_arg_35432 = mem_32007.mem;
    
    if ((((((1 && segmap_usable_groups_31261 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31260 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31261;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35425[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_29737, &kernel_arg_35428,
                                     &kernel_arg_35429, &kernel_arg_35430,
                                     &kernel_arg_35431, &kernel_arg_35432};
        int64_t time_start_35426 = 0, time_end_35427 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31245");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31261);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31260);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35426 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31245_runs,
                                      &ctx->test_ballQueryzisegmap_31245_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31245,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31260, 1, 1, 0,
                                              NULL, kernel_args_35425, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35427 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31245", time_end_35427 -
                    time_start_35426);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                              "defunc_0_f_res_mem_32000") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31285;
    
    segmap_group_sizze_31285 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31277;
    
    int64_t segmap_usable_groups_31286 = sdiv_up64(implz2081U_29737,
                                                   segmap_group_sizze_31285);
    struct memblock_device mem_32010;
    
    mem_32010.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32010, implz2081U_29737, "mem_32010")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35436 = mem_32003.mem;
    CUdeviceptr kernel_arg_35437 = mem_32010.mem;
    
    if ((((((1 && segmap_usable_groups_31286 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31285 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31286;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35433[] = {&ctx->global_failure, &implz2081U_29737,
                                     &kernel_arg_35436, &kernel_arg_35437};
        int64_t time_start_35434 = 0, time_end_35435 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31275");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31286);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31285);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35434 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31275_runs,
                                      &ctx->test_ballQueryzisegmap_31275_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31275,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31285, 1, 1, 0,
                                              NULL, kernel_args_35433, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35435 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31275", time_end_35435 -
                    time_start_35434);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
        return 1;
    
    bool y_29872 = slt64((int64_t) 0, implz2081U_29737);
    bool index_certs_29873;
    
    if (!y_29872) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               implz2081U_29737, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:60:15-41\n   #2  src/cluster.fut:101:19-56\n   #3  src/cluster_test.fut:49:17-45\n   #4  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_35438 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32010.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_35438,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_31294;
    
    segscan_group_sizze_31294 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31293;
    
    int64_t num_groups_31296;
    int32_t max_num_groups_32706;
    
    max_num_groups_32706 = ctx->sizes.test_ballQueryzisegscan_num_groups_31295;
    num_groups_31296 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_29737,
                                                            segscan_group_sizze_31294),
                                                  sext_i32_i64(max_num_groups_32706))));
    
    struct memblock_device mem_32013;
    
    mem_32013.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32013, implz2081U_29737, "mem_32013")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32015;
    
    mem_32015.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32015, bytes_31948, "mem_32015")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_29737)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32707;
        
        numThreads_32707 = sdiv_up64(implz2081U_29737,
                                     segscan_group_sizze_31294 * (int64_t) 9) *
            segscan_group_sizze_31294;
        
        int64_t numGroups_32708;
        
        numGroups_32708 = sdiv_up64(implz2081U_29737,
                                    segscan_group_sizze_31294 * (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_32709 =
                               ctx->test_ballQueryziid_counter_mem_32709;
        struct memblock_device status_flags_mem_32711;
        
        status_flags_mem_32711.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32711, numGroups_32708,
                                  "status_flags_mem_32711")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32713;
        
        aggregates_mem_32713.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32713, numGroups_32708,
                                  "aggregates_mem_32713")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32715;
        
        incprefixes_mem_32715.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32715, numGroups_32708,
                                  "incprefixes_mem_32715")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32717;
        
        aggregates_mem_32717.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32717, (int64_t) 8 *
                                  numGroups_32708, "aggregates_mem_32717")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32719;
        
        incprefixes_mem_32719.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32719, (int64_t) 8 *
                                  numGroups_32708, "incprefixes_mem_32719")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32711,
                                         numGroups_32708, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35443 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_31294,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31294),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_31294,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_31294 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_35445 = mem_32010.mem;
        CUdeviceptr kernel_arg_35446 = mem_32013.mem;
        CUdeviceptr kernel_arg_35447 = mem_32015.mem;
        CUdeviceptr kernel_arg_35448 = test_ballQueryziid_counter_mem_32709.mem;
        CUdeviceptr kernel_arg_35449 = status_flags_mem_32711.mem;
        CUdeviceptr kernel_arg_35450 = aggregates_mem_32713.mem;
        CUdeviceptr kernel_arg_35451 = incprefixes_mem_32715.mem;
        CUdeviceptr kernel_arg_35452 = aggregates_mem_32717.mem;
        CUdeviceptr kernel_arg_35453 = incprefixes_mem_32719.mem;
        unsigned int shared_offset_35444 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_29737, segscan_group_sizze_31294 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_31294 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_29737,
                                      segscan_group_sizze_31294 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35440[] = {&ctx->global_failure,
                                         &shared_offset_35444,
                                         &implz2081U_29737, &kernel_arg_35445,
                                         &kernel_arg_35446, &kernel_arg_35447,
                                         &kernel_arg_35448, &kernel_arg_35449,
                                         &kernel_arg_35450, &kernel_arg_35451,
                                         &kernel_arg_35452, &kernel_arg_35453};
            int64_t time_start_35441 = 0, time_end_35442 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31299");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_29737,
                                                          segscan_group_sizze_31294 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31294);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35441 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31299_runs,
                                          &ctx->test_ballQueryzisegscan_31299_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31299,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31294, 1,
                                                  1, 0 + (shared_sizze_35443 +
                                                          (8 -
                                                           shared_sizze_35443 %
                                                           8) % 8), NULL,
                                                  kernel_args_35440, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35442 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31299", time_end_35442 -
                        time_start_35441);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32719,
                                  "incprefixes_mem_32719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32717,
                                  "aggregates_mem_32717") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_32715,
                                  "incprefixes_mem_32715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32713,
                                  "aggregates_mem_32713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32711,
                                  "status_flags_mem_32711") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
        return 1;
    
    int64_t segscan_group_sizze_31302;
    
    segscan_group_sizze_31302 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31301;
    
    int64_t num_groups_31304;
    int32_t max_num_groups_32839;
    
    max_num_groups_32839 = ctx->sizes.test_ballQueryzisegscan_num_groups_31303;
    num_groups_31304 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_29737,
                                                            segscan_group_sizze_31302),
                                                  sext_i32_i64(max_num_groups_32839))));
    
    struct memblock_device mem_32018;
    
    mem_32018.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32018, bytes_31948, "mem_32018")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_29737)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32840;
        
        numThreads_32840 = sdiv_up64(implz2081U_29737,
                                     segscan_group_sizze_31302 * (int64_t) 9) *
            segscan_group_sizze_31302;
        
        int64_t numGroups_32841;
        
        numGroups_32841 = sdiv_up64(implz2081U_29737,
                                    segscan_group_sizze_31302 * (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_32842 =
                               ctx->test_ballQueryziid_counter_mem_32842;
        struct memblock_device status_flags_mem_32844;
        
        status_flags_mem_32844.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32844, numGroups_32841,
                                  "status_flags_mem_32844")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32846;
        
        aggregates_mem_32846.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32846, (int64_t) 8 *
                                  numGroups_32841, "aggregates_mem_32846")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32848;
        
        incprefixes_mem_32848.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32848, (int64_t) 8 *
                                  numGroups_32841, "incprefixes_mem_32848")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32844,
                                         numGroups_32841, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35458 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31302),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_31302 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_35460 = mem_32010.mem;
        CUdeviceptr kernel_arg_35461 = mem_32018.mem;
        CUdeviceptr kernel_arg_35462 = test_ballQueryziid_counter_mem_32842.mem;
        CUdeviceptr kernel_arg_35463 = status_flags_mem_32844.mem;
        CUdeviceptr kernel_arg_35464 = aggregates_mem_32846.mem;
        CUdeviceptr kernel_arg_35465 = incprefixes_mem_32848.mem;
        unsigned int shared_offset_35459 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_29737, segscan_group_sizze_31302 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_31302 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_29737,
                                      segscan_group_sizze_31302 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35455[] = {&ctx->global_failure,
                                         &shared_offset_35459,
                                         &implz2081U_29737, &kernel_arg_35460,
                                         &kernel_arg_35461, &kernel_arg_35462,
                                         &kernel_arg_35463, &kernel_arg_35464,
                                         &kernel_arg_35465};
            int64_t time_start_35456 = 0, time_end_35457 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31307");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_29737,
                                                          segscan_group_sizze_31302 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31302);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35456 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31307_runs,
                                          &ctx->test_ballQueryzisegscan_31307_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31307,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31302, 1,
                                                  1, 0 + (shared_sizze_35458 +
                                                          (8 -
                                                           shared_sizze_35458 %
                                                           8) % 8), NULL,
                                                  kernel_args_35455, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35457 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31307", time_end_35457 -
                        time_start_35456);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32848,
                                  "incprefixes_mem_32848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32846,
                                  "aggregates_mem_32846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32844,
                                  "status_flags_mem_32844") != 0)
            return 1;
    }
    
    int64_t num_segments_29894;
    
    if (y_29872) {
        bool index_certs_29895;
        
        if (!bounds_check_29763) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_29760,
                                   "] out of bounds for array of shape [",
                                   implz2081U_29737, "].",
                                   "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:61:18-34\n   #4  src/cluster.fut:101:19-56\n   #5  src/cluster_test.fut:49:17-45\n   #6  src/cluster_test.fut:48:1-50:16\n");
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31966,
                                      "mem_param_31966") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31961,
                                      "mem_param_31961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                      "defunc_0_f_res_mem_32000") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                      "defunc_0_f_res_mem_31995") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_35466;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35466, mem_32018.mem +
                                                i_29760 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_29896 = read_res_35466;
        
        num_segments_29894 = last_res_29896;
    } else {
        num_segments_29894 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_29897 = slt64(num_segments_29894, (int64_t) 0);
    bool valid_29898 = !bounds_invalid_upwards_29897;
    bool range_valid_c_29899;
    
    if (!valid_29898) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               num_segments_29894, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:61:18-34\n   #5  src/cluster.fut:101:19-56\n   #6  src/cluster_test.fut:49:17-45\n   #7  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_32019 = (int64_t) 8 * num_segments_29894;
    struct memblock_device mem_32020;
    
    mem_32020.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32020, bytes_32019, "mem_32020")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32020, num_segments_29894,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_31312;
    
    segmap_group_sizze_31312 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31311;
    
    int64_t segmap_usable_groups_31313 = sdiv_up64(implz2081U_29737,
                                                   segmap_group_sizze_31312);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35470 = mem_32010.mem;
    CUdeviceptr kernel_arg_35471 = mem_32015.mem;
    CUdeviceptr kernel_arg_35472 = mem_32018.mem;
    CUdeviceptr kernel_arg_35473 = mem_32020.mem;
    
    if ((((((1 && segmap_usable_groups_31313 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31312 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31313;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35467[] = {&ctx->global_failure, &implz2081U_29737,
                                     &num_segments_29894, &kernel_arg_35470,
                                     &kernel_arg_35471, &kernel_arg_35472,
                                     &kernel_arg_35473};
        int64_t time_start_35468 = 0, time_end_35469 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31309");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31313);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31312);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35468 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31309_runs,
                                      &ctx->test_ballQueryzisegmap_31309_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31309,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31312, 1, 1, 0,
                                              NULL, kernel_args_35467, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35469 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31309", time_end_35469 -
                    time_start_35468);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
        return 1;
    
    int64_t segscan_group_sizze_31316;
    
    segscan_group_sizze_31316 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31315;
    
    int64_t num_groups_31318;
    int32_t max_num_groups_32935;
    
    max_num_groups_32935 = ctx->sizes.test_ballQueryzisegscan_num_groups_31317;
    num_groups_31318 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(num_segments_29894,
                                                            segscan_group_sizze_31316),
                                                  sext_i32_i64(max_num_groups_32935))));
    
    struct memblock_device mem_32024;
    
    mem_32024.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32024, bytes_32019, "mem_32024")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, num_segments_29894)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32936;
        
        numThreads_32936 = sdiv_up64(num_segments_29894,
                                     segscan_group_sizze_31316 * (int64_t) 9) *
            segscan_group_sizze_31316;
        
        int64_t numGroups_32937;
        
        numGroups_32937 = sdiv_up64(num_segments_29894,
                                    segscan_group_sizze_31316 * (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_32938 =
                               ctx->test_ballQueryziid_counter_mem_32938;
        struct memblock_device status_flags_mem_32940;
        
        status_flags_mem_32940.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32940, numGroups_32937,
                                  "status_flags_mem_32940")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32942;
        
        aggregates_mem_32942.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32942, (int64_t) 8 *
                                  numGroups_32937, "aggregates_mem_32942")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32944;
        
        incprefixes_mem_32944.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32944, (int64_t) 8 *
                                  numGroups_32937, "incprefixes_mem_32944")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32940,
                                         numGroups_32937, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35478 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31316),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_31316 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_35480 = mem_32020.mem;
        CUdeviceptr kernel_arg_35481 = mem_32024.mem;
        CUdeviceptr kernel_arg_35482 = test_ballQueryziid_counter_mem_32938.mem;
        CUdeviceptr kernel_arg_35483 = status_flags_mem_32940.mem;
        CUdeviceptr kernel_arg_35484 = aggregates_mem_32942.mem;
        CUdeviceptr kernel_arg_35485 = incprefixes_mem_32944.mem;
        unsigned int shared_offset_35479 = 0;
        
        if ((((((1 && sdiv_up64(num_segments_29894, segscan_group_sizze_31316 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_31316 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(num_segments_29894,
                                      segscan_group_sizze_31316 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35475[] = {&ctx->global_failure,
                                         &shared_offset_35479,
                                         &num_segments_29894, &kernel_arg_35480,
                                         &kernel_arg_35481, &kernel_arg_35482,
                                         &kernel_arg_35483, &kernel_arg_35484,
                                         &kernel_arg_35485};
            int64_t time_start_35476 = 0, time_end_35477 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31321");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(num_segments_29894,
                                                          segscan_group_sizze_31316 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31316);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35476 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31321_runs,
                                          &ctx->test_ballQueryzisegscan_31321_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31321,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31316, 1,
                                                  1, 0 + (shared_sizze_35478 +
                                                          (8 -
                                                           shared_sizze_35478 %
                                                           8) % 8), NULL,
                                                  kernel_args_35475, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35477 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31321", time_end_35477 -
                        time_start_35476);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32944,
                                  "incprefixes_mem_32944") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32942,
                                  "aggregates_mem_32942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32940,
                                  "status_flags_mem_32940") != 0)
            return 1;
    }
    
    struct memblock_device mem_32026;
    
    mem_32026.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32026, bytes_32019, "mem_32026")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t group_sizze_33020;
    
    group_sizze_33020 = ctx->sizes.test_ballQueryzigroup_sizze_33020;
    
    int64_t num_groups_33021;
    
    num_groups_33021 = sdiv_up64(num_segments_29894, group_sizze_33020);
    
    CUdeviceptr kernel_arg_35489 = mem_32024.mem;
    CUdeviceptr kernel_arg_35490 = mem_32026.mem;
    
    if ((((((1 && num_groups_33021 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_33020 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_33021;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35486[] = {&num_segments_29894, &kernel_arg_35489,
                                     &kernel_arg_35490};
        int64_t time_start_35487 = 0, time_end_35488 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.copy_33017");
            fprintf(ctx->log, "%ld", (long) num_groups_33021);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_33020);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35487 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzicopy_33017_runs,
                                      &ctx->test_ballQueryzicopy_33017_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzicopy_33017,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_33020, 1, 1, 0, NULL,
                                              kernel_args_35486, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35488 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.copy_33017", time_end_35488 -
                    time_start_35487);
        }
    }
    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
        return 1;
    
    bool y_29914 = slt64((int64_t) 0, num_segments_29894);
    bool index_certs_29915;
    
    if (!y_29914) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               num_segments_29894, "].",
                               "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:62:17-38\n   #2  src/cluster.fut:101:19-56\n   #3  src/cluster_test.fut:49:17-45\n   #4  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        int64_t write_tmp_35491 = (int64_t) 0;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32026.mem + (int64_t) 0 *
                                            sizeof(int64_t), &write_tmp_35491,
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    struct memblock_device mem_32028;
    
    mem_32028.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32028, (int64_t) 32768, "mem_32028")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32028, (int64_t) 4096,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32030;
    
    mem_32030.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32030, (int64_t) 32768, "mem_32030")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32030, (int64_t) 4096,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_31326;
    
    segmap_group_sizze_31326 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31325;
    
    int64_t segmap_usable_groups_31327 = sdiv_up64(num_segments_29894,
                                                   segmap_group_sizze_31326);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35495 = mem_32005.mem;
    CUdeviceptr kernel_arg_35496 = mem_32020.mem;
    CUdeviceptr kernel_arg_35497 = mem_32026.mem;
    CUdeviceptr kernel_arg_35498 = mem_32028.mem;
    CUdeviceptr kernel_arg_35499 = mem_32030.mem;
    
    if ((((((1 && segmap_usable_groups_31327 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31326 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31327;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35492[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_29737, &num_segments_29894,
                                     &kernel_arg_35495, &kernel_arg_35496,
                                     &kernel_arg_35497, &kernel_arg_35498,
                                     &kernel_arg_35499};
        int64_t time_start_35493 = 0, time_end_35494 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31323");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31327);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31326);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35493 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31323_runs,
                                      &ctx->test_ballQueryzisegmap_31323_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31323,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31326, 1, 1, 0,
                                              NULL, kernel_args_35492, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35494 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31323", time_end_35494 -
                    time_start_35493);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31548;
    
    segmap_group_sizze_31548 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31510;
    
    int64_t segmap_usable_groups_31549 = sdiv_up64(nest_sizze_31208,
                                                   segmap_group_sizze_31548);
    struct memblock_device mem_32035;
    
    mem_32035.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32035, bytes_31951, "mem_32035")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35503 = pos_mem_31946.mem;
    CUdeviceptr kernel_arg_35504 = mem_32035.mem;
    
    if ((((((1 && segmap_usable_groups_31549 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31548 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31549;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35500[] = {&ctx->global_failure, &implz2081U_29737,
                                     &radius_29738, &kernel_arg_35503,
                                     &kernel_arg_35504};
        int64_t time_start_35501 = 0, time_end_35502 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31507");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31549);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31548);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35501 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31507_runs,
                                      &ctx->test_ballQueryzisegmap_31507_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31507,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31548, 1, 1, 0,
                                              NULL, kernel_args_35500, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35502 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31507", time_end_35502 -
                    time_start_35501);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t nest_sizze_31568 = (int64_t) 24 * implz2081U_29737;
    int64_t segmap_group_sizze_31569;
    
    segmap_group_sizze_31569 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31451;
    
    int64_t segmap_usable_groups_31570 = sdiv_up64(nest_sizze_31568,
                                                   segmap_group_sizze_31569);
    int64_t binop_x_32039 = (int64_t) 3 * bytes_31948;
    int64_t bytes_32037 = (int64_t) 4 * binop_x_32039;
    struct memblock_device mem_32040;
    
    mem_32040.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32040, bytes_32037, "mem_32040")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35508 = mem_32035.mem;
    CUdeviceptr kernel_arg_35509 = mem_32040.mem;
    
    if ((((((1 && segmap_usable_groups_31570 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31569 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31570;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35505[] = {&ctx->global_failure, &implz2081U_29737,
                                     &kernel_arg_35508, &kernel_arg_35509};
        int64_t time_start_35506 = 0, time_end_35507 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31447");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31570);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31569);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35506 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31447_runs,
                                      &ctx->test_ballQueryzisegmap_31447_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31447,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31569, 1, 1, 0,
                                              NULL, kernel_args_35505, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35507 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31447", time_end_35507 -
                    time_start_35506);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31579;
    
    segmap_group_sizze_31579 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31423;
    
    int64_t segmap_usable_groups_31580 = sdiv_up64(bytes_31948,
                                                   segmap_group_sizze_31579);
    int64_t bytes_32042 = (int64_t) 4 * bytes_31948;
    struct memblock_device mem_32044;
    
    mem_32044.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32044, bytes_32042, "mem_32044")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35513 = mem_32040.mem;
    CUdeviceptr kernel_arg_35514 = mem_32044.mem;
    
    if ((((((1 && segmap_usable_groups_31580 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31579 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31580;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35510[] = {&ctx->global_failure, &implz2081U_29737,
                                     &kernel_arg_35513, &kernel_arg_35514};
        int64_t time_start_35511 = 0, time_end_35512 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31420");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31580);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31579);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35511 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31420_runs,
                                      &ctx->test_ballQueryzisegmap_31420_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31420,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31579, 1, 1, 0,
                                              NULL, kernel_args_35510, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35512 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31420", time_end_35512 -
                    time_start_35511);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
        return 1;
    
    int64_t segscan_group_sizze_31605;
    
    segscan_group_sizze_31605 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31604;
    
    int64_t num_groups_31607;
    int32_t max_num_groups_33042;
    
    max_num_groups_33042 = ctx->sizes.test_ballQueryzisegscan_num_groups_31606;
    num_groups_31607 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(bytes_31948,
                                                            segscan_group_sizze_31605),
                                                  sext_i32_i64(max_num_groups_33042))));
    
    int64_t bytes_32046 = (int64_t) 8 * bytes_31948;
    struct memblock_device mem_32047;
    
    mem_32047.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32047, bytes_32046, "mem_32047")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32049;
    
    mem_32049.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32049, bytes_32046, "mem_32049")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, bytes_31948)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_33043;
        
        numThreads_33043 = sdiv_up64(bytes_31948, segscan_group_sizze_31605 *
                                     (int64_t) 9) * segscan_group_sizze_31605;
        
        int64_t numGroups_33044;
        
        numGroups_33044 = sdiv_up64(bytes_31948, segscan_group_sizze_31605 *
                                    (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_33045 =
                               ctx->test_ballQueryziid_counter_mem_33045;
        struct memblock_device status_flags_mem_33047;
        
        status_flags_mem_33047.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_33047, numGroups_33044,
                                  "status_flags_mem_33047")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_33049;
        
        aggregates_mem_33049.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_33049, (int64_t) 8 *
                                  numGroups_33044, "aggregates_mem_33049")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_33051;
        
        incprefixes_mem_33051.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_33051, (int64_t) 8 *
                                  numGroups_33044, "incprefixes_mem_33051")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33047,
                                         numGroups_33044, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35519 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31605),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_31605 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_35521 = mem_32028.mem;
        CUdeviceptr kernel_arg_35522 = mem_32044.mem;
        CUdeviceptr kernel_arg_35523 = mem_32047.mem;
        CUdeviceptr kernel_arg_35524 = mem_32049.mem;
        CUdeviceptr kernel_arg_35525 = test_ballQueryziid_counter_mem_33045.mem;
        CUdeviceptr kernel_arg_35526 = status_flags_mem_33047.mem;
        CUdeviceptr kernel_arg_35527 = aggregates_mem_33049.mem;
        CUdeviceptr kernel_arg_35528 = incprefixes_mem_33051.mem;
        unsigned int shared_offset_35520 = 0;
        
        if ((((((1 && sdiv_up64(bytes_31948, segscan_group_sizze_31605 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_31605 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(bytes_31948, segscan_group_sizze_31605 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35516[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &shared_offset_35520, &bytes_31948,
                                         &kernel_arg_35521, &kernel_arg_35522,
                                         &kernel_arg_35523, &kernel_arg_35524,
                                         &kernel_arg_35525, &kernel_arg_35526,
                                         &kernel_arg_35527, &kernel_arg_35528};
            int64_t time_start_35517 = 0, time_end_35518 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31610");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(bytes_31948,
                                                          segscan_group_sizze_31605 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31605);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35517 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31610_runs,
                                          &ctx->test_ballQueryzisegscan_31610_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31610,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31605, 1,
                                                  1, 0 + (shared_sizze_35519 +
                                                          (8 -
                                                           shared_sizze_35519 %
                                                           8) % 8), NULL,
                                                  kernel_args_35516, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35518 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31610", time_end_35518 -
                        time_start_35517);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_33051,
                                  "incprefixes_mem_33051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_33049,
                                  "aggregates_mem_33049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_33047,
                                  "status_flags_mem_33047") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
        return 1;
    
    int64_t segred_group_sizze_31613;
    
    segred_group_sizze_31613 =
        ctx->sizes.test_ballQueryzisegred_group_sizze_31612;
    
    int64_t num_groups_31615;
    int32_t max_num_groups_33124;
    
    max_num_groups_33124 = ctx->sizes.test_ballQueryzisegred_num_groups_31614;
    num_groups_31615 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(bytes_31948,
                                                            segred_group_sizze_31613),
                                                  sext_i32_i64(max_num_groups_33124))));
    
    struct memblock_device mem_32052;
    
    mem_32052.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32052, (int64_t) 8, "mem_32052")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device test_ballQueryzicounter_mem_33125 =
                           ctx->test_ballQueryzicounter_mem_33125;
    struct memblock_device group_res_arr_mem_33127;
    
    group_res_arr_mem_33127.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_33127, (int64_t) 8 *
                              (segred_group_sizze_31613 * num_groups_31615),
                              "group_res_arr_mem_33127")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_33129;
    
    num_threads_33129 = num_groups_31615 * segred_group_sizze_31613;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_35533 = (int64_t) 8 * segred_group_sizze_31613;
    unsigned int shared_sizze_35535 = 1;
    CUdeviceptr kernel_arg_35537 = mem_32049.mem;
    CUdeviceptr kernel_arg_35538 = mem_32052.mem;
    CUdeviceptr kernel_arg_35539 = test_ballQueryzicounter_mem_33125.mem;
    CUdeviceptr kernel_arg_35540 = group_res_arr_mem_33127.mem;
    unsigned int shared_offset_35534 = 0;
    unsigned int shared_offset_35536 = 0 + (shared_sizze_35533 + (8 -
                                                                  shared_sizze_35533 %
                                                                  8) % 8);
    
    if ((((((1 && num_groups_31615 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_31613 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_31615;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35530[] = {&ctx->global_failure, &shared_offset_35534,
                                     &shared_offset_35536, &num_groups_31615,
                                     &bytes_31948, &num_threads_33129,
                                     &kernel_arg_35537, &kernel_arg_35538,
                                     &kernel_arg_35539, &kernel_arg_35540};
        int64_t time_start_35531 = 0, time_end_35532 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segred_nonseg_31620");
            fprintf(ctx->log, "%ld", (long) num_groups_31615);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segred_group_sizze_31613);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35531 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegred_nonseg_31620_runs,
                                      &ctx->test_ballQueryzisegred_nonseg_31620_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegred_nonseg_31620,
                                              grid[0], grid[1], grid[2],
                                              segred_group_sizze_31613, 1, 1,
                                              0 + (shared_sizze_35533 + (8 -
                                                                         shared_sizze_35533 %
                                                                         8) %
                                                   8) + (shared_sizze_35535 +
                                                         (8 -
                                                          shared_sizze_35535 %
                                                          8) % 8), NULL,
                                              kernel_args_35530, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35532 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segred_nonseg_31620", time_end_35532 -
                    time_start_35531);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
        return 1;
    
    int64_t read_res_35541;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35541, mem_32052.mem +
                                            (int64_t) 0 * sizeof(int64_t),
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t defunc_2_reduce_res_29982 = read_res_35541;
    
    if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
        return 1;
    
    bool bounds_invalid_upwards_29987 = slt64(defunc_2_reduce_res_29982,
                                              (int64_t) 0);
    bool valid_29988 = !bounds_invalid_upwards_29987;
    bool range_valid_c_29989;
    
    if (!valid_29988) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               defunc_2_reduce_res_29982, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  src/cluster.fut:51:14-32\n   #4  src/cluster.fut:108:19-120\n   #5  src/cluster_test.fut:49:17-45\n   #6  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_33127,
                                  "group_res_arr_mem_33127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_32053 = (int64_t) 8 * defunc_2_reduce_res_29982;
    struct memblock_device mem_32054;
    
    mem_32054.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32054, bytes_32053, "mem_32054")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32054, defunc_2_reduce_res_29982,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_group_sizze_31623;
    
    seghist_group_sizze_31623 =
        ctx->sizes.test_ballQueryziseghist_group_sizze_31622;
    
    int64_t num_groups_31625;
    int32_t max_num_groups_33155;
    
    max_num_groups_33155 = ctx->sizes.test_ballQueryziseghist_num_groups_31624;
    num_groups_31625 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(bytes_31948,
                                                            seghist_group_sizze_31623),
                                                  sext_i32_i64(max_num_groups_33155))));
    
    int32_t num_subhistos_33156;
    struct memblock_device defunc_1_map_res_subhistos_mem_33157;
    
    defunc_1_map_res_subhistos_mem_33157.references = NULL;
    
    int64_t h_33159;
    
    h_33159 = (int64_t) 8 * defunc_2_reduce_res_29982;
    
    int64_t seg_h_33160;
    
    seg_h_33160 = (int64_t) 8 * defunc_2_reduce_res_29982;
    if (!(seg_h_33160 == (int64_t) 0)) {
        int64_t hist_H_33161 = defunc_2_reduce_res_29982;
        int64_t hist_el_sizze_33162 = sdiv_up64(h_33159, hist_H_33161);
        int64_t hist_N_33163 = bytes_31948;
        int32_t hist_RF_33164 = 1;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)",
                    (long long) sext_i64_i32(num_groups_31625 *
                    seghist_group_sizze_31623), '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Desired group size (B)",
                    (long long) seghist_group_sizze_31623, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                    (long long) hist_H_33161, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Input elements per histogram (N)",
                    (long long) hist_N_33163, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Number of segments",
                    (long long) (int64_t) 1, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Histogram element size (el_size)",
                    (long long) hist_el_sizze_33162, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)",
                    (long long) hist_RF_33164, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c",
                    "Memory per set of subhistograms per segment",
                    (long long) h_33159, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c",
                    "Memory per set of subhistograms times segments",
                    (long long) seg_h_33160, '\n');
        
        int32_t hist_L_33165;
        
        hist_L_33165 = ctx->cuda.max_shared_memory;
        
        int32_t max_group_sizze_33166;
        
        max_group_sizze_33166 = ctx->cuda.max_block_size;
        
        int64_t num_groups_33167;
        
        num_groups_33167 =
            sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_31625 *
                      seghist_group_sizze_31623)), max_group_sizze_33166);
        
        double hist_m_prime_33168;
        
        hist_m_prime_33168 =
            sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_33165,
                                                       hist_el_sizze_33162)),
                                  sdiv_up64(hist_N_33163, num_groups_33167))) /
            sitofp_i64_f64(hist_H_33161);
        
        int64_t hist_M0_33169;
        
        hist_M0_33169 = smax64((int64_t) 1,
                               smin64(fptosi_f64_i64(hist_m_prime_33168),
                                      max_group_sizze_33166));
        
        int64_t hist_Nout_33170;
        
        hist_Nout_33170 = (int64_t) 1;
        
        int64_t hist_Nin_33171;
        
        hist_Nin_33171 = bytes_31948;
        
        int64_t work_asymp_M_max_33172;
        
        work_asymp_M_max_33172 = squot64(hist_Nout_33170 * hist_N_33163,
                                         (int64_t) 2 * num_groups_33167 *
                                         hist_H_33161);
        
        int32_t hist_M_33173;
        
        hist_M_33173 = sext_i64_i32(smin64(hist_M0_33169,
                                           work_asymp_M_max_33172));
        
        int64_t hist_C_33174;
        
        hist_C_33174 = sdiv_up64(max_group_sizze_33166, sext_i32_i64(smax32(1,
                                                                            hist_M_33173)));
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local hist_M0",
                    (long long) hist_M0_33169, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local work asymp M max",
                    (long long) work_asymp_M_max_33172, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local C", (long long) hist_C_33174,
                    '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local B",
                    (long long) max_group_sizze_33166, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local M", (long long) hist_M_33173,
                    '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local memory needed",
                    (long long) (hist_H_33161 * hist_el_sizze_33162 *
                                 sext_i32_i64(hist_M_33173)), '\n');
        
        int64_t local_mem_needed_33175;
        
        local_mem_needed_33175 = hist_el_sizze_33162 *
            sext_i32_i64(hist_M_33173);
        
        int32_t hist_S_33176;
        
        hist_S_33176 = sext_i64_i32(sdiv_up64(hist_H_33161 *
                                              local_mem_needed_33175,
                                              hist_L_33165));
        if (sle64(hist_H_33161, hist_Nin_33171) &&
            (sle64(local_mem_needed_33175, hist_L_33165) && (sle32(hist_S_33176,
                                                                   3) &&
                                                             (sle64(hist_C_33174,
                                                                    max_group_sizze_33166) &&
                                                              slt32(0,
                                                                    hist_M_33173))))) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "## Using local memory");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_33161, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_33173, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)",
                        (long long) hist_C_33174, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_33176, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Number of local subhistograms per group",
                        (long long) hist_M_33173, '\n');
            
            int64_t num_segments_33177;
            
            num_segments_33177 = (int64_t) 1;
            num_subhistos_33156 = num_groups_33167 * num_segments_33177;
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Number of subhistograms in global memory",
                        (long long) num_subhistos_33156, '\n');
            if (num_subhistos_33156 == (int64_t) 1) {
                if (memblock_set_device(ctx,
                                        &defunc_1_map_res_subhistos_mem_33157,
                                        &mem_32054, "mem_32054") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33157,
                                          sext_i32_i64(num_subhistos_33156) *
                                          defunc_2_reduce_res_29982 *
                                          (int64_t) 8,
                                          "defunc_1_map_res_subhistos_mem_33157")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx,
                                                  defunc_1_map_res_subhistos_mem_33157,
                                                  num_subhistos_33156 *
                                                  defunc_2_reduce_res_29982,
                                                  (int64_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_dev_to_dev_runs,
                                                  &ctx->copy_dev_to_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_33157.mem +
                                                    (int64_t) 0, mem_32054.mem +
                                                    (int64_t) 0,
                                                    defunc_2_reduce_res_29982 *
                                                    (int64_t) 8));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
            }
            for (int32_t chk_i_33178 = 0; chk_i_33178 < hist_S_33176;
                 chk_i_33178++) {
                int64_t num_segments_33179 = (int64_t) 1;
                int64_t hist_H_chk_33180 = sdiv_up64(defunc_2_reduce_res_29982,
                                                     sext_i32_i64(hist_S_33176));
                int64_t histo_sizze_33181 = hist_H_chk_33180;
                int32_t init_per_thread_33182 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_33173) *
                                               histo_sizze_33181,
                                               max_group_sizze_33166));
                unsigned int shared_sizze_35545 = (int64_t) 8 * (hist_M_33173 *
                                                                 hist_H_chk_33180);
                CUdeviceptr kernel_arg_35547 = mem_32047.mem;
                CUdeviceptr kernel_arg_35548 =
                            defunc_1_map_res_subhistos_mem_33157.mem;
                unsigned int shared_offset_35546 = 0;
                
                if ((((((1 && num_groups_33167 != 0) && 1 != 0) && 1 != 0) &&
                      max_group_sizze_33166 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_33167;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35542[] = {&ctx->global_failure,
                                                 &shared_offset_35546,
                                                 &defunc_2_reduce_res_29982,
                                                 &bytes_31948,
                                                 &max_group_sizze_33166,
                                                 &num_groups_33167,
                                                 &hist_M_33173, &chk_i_33178,
                                                 &num_segments_33179,
                                                 &hist_H_chk_33180,
                                                 &histo_sizze_33181,
                                                 &init_per_thread_33182,
                                                 &kernel_arg_35547,
                                                 &kernel_arg_35548};
                    int64_t time_start_35543 = 0, time_end_35544 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_ballQuery.seghist_local_31628");
                        fprintf(ctx->log, "%ld", (long) num_groups_33167);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld", (long) max_group_sizze_33166);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35543 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_ballQueryziseghist_local_31628_runs,
                                                  &ctx->test_ballQueryziseghist_local_31628_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryziseghist_local_31628,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          max_group_sizze_33166,
                                                          1, 1, 0 +
                                                          (shared_sizze_35545 +
                                                           (8 -
                                                            shared_sizze_35545 %
                                                            8) % 8), NULL,
                                                          kernel_args_35542,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35544 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_ballQuery.seghist_local_31628",
                                time_end_35544 - time_start_35543);
                    }
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "## Using global memory");
            
            int64_t hist_H_33210;
            
            hist_H_33210 = defunc_2_reduce_res_29982;
            
            double hist_RF_33211;
            
            hist_RF_33211 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
            
            int32_t hist_el_sizze_33212;
            
            hist_el_sizze_33212 = 8;
            
            double hist_C_max_33213;
            
            hist_C_max_33213 =
                fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_31625 *
                       seghist_group_sizze_31623)),
                       sitofp_i32_f64(hist_H_33210) / 2.0);
            
            int32_t hist_M_min_33214;
            
            hist_M_min_33214 = smax32(1,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_31625 *
                                      seghist_group_sizze_31623)) /
                                      hist_C_max_33213)));
            
            int32_t L2_sizze_33215;
            
            L2_sizze_33215 = ctx->sizes.test_ballQueryziL2_sizze_33215;
            
            double hist_RACE_exp_33216;
            
            hist_RACE_exp_33216 = fmax64(1.0, 0.75 * hist_RF_33211 / (64.0 /
                                                                      sitofp_i32_f64(hist_el_sizze_33212)));
            
            int32_t hist_S_33217;
            
            if (slt64(bytes_31948, hist_H_33210)) {
                hist_S_33217 = 1;
            } else {
                hist_S_33217 =
                    sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_33214) *
                                           hist_H_33210 *
                                           sext_i32_i64(hist_el_sizze_33212),
                                           fptosi_f64_i64(0.4 *
                                           sitofp_i32_f64(L2_sizze_33215) *
                                           hist_RACE_exp_33216)));
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c",
                        "Race expansion factor (RACE^exp)",
                        (double) hist_RACE_exp_33216, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_33217, '\n');
            
            int64_t hist_H_chk_33218;
            
            hist_H_chk_33218 = sdiv_up64(defunc_2_reduce_res_29982,
                                         sext_i32_i64(hist_S_33217));
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)",
                        (long long) hist_H_chk_33218, '\n');
            
            double hist_k_max_33219;
            
            hist_k_max_33219 = fmin64(0.4 * (sitofp_i32_f64(L2_sizze_33215) /
                                             sitofp_i32_f64(8)) *
                                      hist_RACE_exp_33216,
                                      sitofp_i32_f64(bytes_31948)) /
                sitofp_i32_f64(sext_i64_i32(num_groups_31625 *
                seghist_group_sizze_31623));
            
            int64_t hist_u_33220;
            
            hist_u_33220 = (int64_t) 2;
            
            double hist_C_33221;
            
            hist_C_33221 = fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_31625 *
                                  seghist_group_sizze_31623)),
                                  sitofp_i32_f64(hist_u_33220 *
                                  hist_H_chk_33218) / hist_k_max_33219);
            
            int32_t hist_M_33222;
            
            hist_M_33222 = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c",
                        "Elements/thread in L2 cache (k_max)",
                        (double) hist_k_max_33219, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_33222, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)",
                        (double) hist_C_33221, '\n');
            num_subhistos_33156 = sext_i32_i64(hist_M_33222);
            if (hist_M_33222 == 1) {
                if (memblock_set_device(ctx,
                                        &defunc_1_map_res_subhistos_mem_33157,
                                        &mem_32054, "mem_32054") != 0)
                    return 1;
            } else {
                if (num_subhistos_33156 == (int64_t) 1) {
                    if (memblock_set_device(ctx,
                                            &defunc_1_map_res_subhistos_mem_33157,
                                            &mem_32054, "mem_32054") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx,
                                              &defunc_1_map_res_subhistos_mem_33157,
                                              sext_i32_i64(num_subhistos_33156) *
                                              defunc_2_reduce_res_29982 *
                                              (int64_t) 8,
                                              "defunc_1_map_res_subhistos_mem_33157")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      defunc_1_map_res_subhistos_mem_33157,
                                                      num_subhistos_33156 *
                                                      defunc_2_reduce_res_29982,
                                                      (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_33157.mem +
                                                        (int64_t) 0,
                                                        mem_32054.mem +
                                                        (int64_t) 0,
                                                        defunc_2_reduce_res_29982 *
                                                        (int64_t) 8));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    }
                }
            }
            for (int32_t chk_i_33223 = 0; chk_i_33223 < hist_S_33217;
                 chk_i_33223++) {
                int64_t hist_H_chk_33224 = sdiv_up64(defunc_2_reduce_res_29982,
                                                     sext_i32_i64(hist_S_33217));
                CUdeviceptr kernel_arg_35552 = mem_32047.mem;
                CUdeviceptr kernel_arg_35553 =
                            defunc_1_map_res_subhistos_mem_33157.mem;
                
                if ((((((1 && num_groups_31625 != 0) && 1 != 0) && 1 != 0) &&
                      seghist_group_sizze_31623 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_31625;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35549[] = {&ctx->global_failure,
                                                 &defunc_2_reduce_res_29982,
                                                 &num_groups_31625,
                                                 &bytes_31948,
                                                 &num_subhistos_33156,
                                                 &chk_i_33223,
                                                 &hist_H_chk_33224,
                                                 &kernel_arg_35552,
                                                 &kernel_arg_35553};
                    int64_t time_start_35550 = 0, time_end_35551 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_ballQuery.seghist_global_31628");
                        fprintf(ctx->log, "%ld", (long) num_groups_31625);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) seghist_group_sizze_31623);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35550 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_ballQueryziseghist_global_31628_runs,
                                                  &ctx->test_ballQueryziseghist_global_31628_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryziseghist_global_31628,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          seghist_group_sizze_31623,
                                                          1, 1, 0, NULL,
                                                          kernel_args_35549,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35551 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_ballQuery.seghist_global_31628",
                                time_end_35551 - time_start_35550);
                    }
                }
            }
        }
        if (num_subhistos_33156 == (int64_t) 1) {
            if (memblock_set_device(ctx, &mem_32054,
                                    &defunc_1_map_res_subhistos_mem_33157,
                                    "defunc_1_map_res_subhistos_mem_33157") !=
                0)
                return 1;
        } else {
            if (slt64(num_subhistos_33156 * (int64_t) 2,
                      seghist_group_sizze_31623)) {
                int64_t segment_sizze_nonzzero_33236 = smax64((int64_t) 1,
                                                              num_subhistos_33156);
                int64_t num_threads_33237 = num_groups_31625 *
                        seghist_group_sizze_31623;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments",
                            (long long) defunc_2_reduce_res_29982, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_33156, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(seghist_group_sizze_31623,
                                                segment_sizze_nonzzero_33236),
                            '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29982,
                                                               squot64(seghist_group_sizze_31623,
                                                                       segment_sizze_nonzzero_33236))),
                            '\n');
                
                unsigned int shared_sizze_35557 = (int64_t) 8 *
                             seghist_group_sizze_31623;
                CUdeviceptr kernel_arg_35559 = mem_32054.mem;
                CUdeviceptr kernel_arg_35560 =
                            defunc_1_map_res_subhistos_mem_33157.mem;
                unsigned int shared_offset_35558 = 0;
                
                if ((((((1 && num_groups_31625 != 0) && 1 != 0) && 1 != 0) &&
                      seghist_group_sizze_31623 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_31625;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35554[] = {&ctx->global_failure,
                                                 &shared_offset_35558,
                                                 &defunc_2_reduce_res_29982,
                                                 &num_groups_31625,
                                                 &num_subhistos_33156,
                                                 &segment_sizze_nonzzero_33236,
                                                 &kernel_arg_35559,
                                                 &kernel_arg_35560};
                    int64_t time_start_35555 = 0, time_end_35556 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_ballQuery.segred_small_33235");
                        fprintf(ctx->log, "%ld", (long) num_groups_31625);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) seghist_group_sizze_31623);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35555 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_ballQueryzisegred_small_33235_runs,
                                                  &ctx->test_ballQueryzisegred_small_33235_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegred_small_33235,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          seghist_group_sizze_31623,
                                                          1, 1, 0 +
                                                          (shared_sizze_35557 +
                                                           (8 -
                                                            shared_sizze_35557 %
                                                            8) % 8), NULL,
                                                          kernel_args_35554,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35556 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_ballQuery.segred_small_33235",
                                time_end_35556 - time_start_35555);
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            } else {
                int64_t groups_per_segment_33257 = sdiv_up64(num_groups_31625,
                                                             smax64((int64_t) 1,
                                                                    defunc_2_reduce_res_29982));
                int64_t elements_per_thread_33258 =
                        sdiv_up64(num_subhistos_33156,
                                  seghist_group_sizze_31623 *
                                  groups_per_segment_33257);
                int64_t virt_num_groups_33259 = groups_per_segment_33257 *
                        defunc_2_reduce_res_29982;
                int64_t num_threads_33260 = num_groups_31625 *
                        seghist_group_sizze_31623;
                int64_t threads_per_segment_33261 = groups_per_segment_33257 *
                        seghist_group_sizze_31623;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments",
                            (long long) defunc_2_reduce_res_29982, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_33156, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_33259, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_groups",
                            (long long) num_groups_31625, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "group_size",
                            (long long) seghist_group_sizze_31623, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_33258, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_33257, '\n');
                
                struct memblock_device group_res_arr_mem_33262;
                
                group_res_arr_mem_33262.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_33262,
                                          (int64_t) 8 *
                                          (seghist_group_sizze_31623 *
                                           virt_num_groups_33259),
                                          "group_res_arr_mem_33262")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device test_ballQueryzicounter_mem_33264 =
                                       ctx->test_ballQueryzicounter_mem_33264;
                unsigned int shared_sizze_35565 = 1;
                unsigned int shared_sizze_35567 = (int64_t) 8 *
                             seghist_group_sizze_31623;
                CUdeviceptr kernel_arg_35569 = mem_32054.mem;
                CUdeviceptr kernel_arg_35570 =
                            defunc_1_map_res_subhistos_mem_33157.mem;
                CUdeviceptr kernel_arg_35571 = group_res_arr_mem_33262.mem;
                CUdeviceptr kernel_arg_35572 =
                            test_ballQueryzicounter_mem_33264.mem;
                unsigned int shared_offset_35566 = 0;
                unsigned int shared_offset_35568 = 0 + (shared_sizze_35565 +
                                                        (8 -
                                                         shared_sizze_35565 %
                                                         8) % 8);
                
                if ((((((1 && num_groups_31625 != 0) && 1 != 0) && 1 != 0) &&
                      seghist_group_sizze_31623 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_31625;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35562[] = {&ctx->global_failure,
                                                 &shared_offset_35566,
                                                 &shared_offset_35568,
                                                 &defunc_2_reduce_res_29982,
                                                 &num_groups_31625,
                                                 &num_subhistos_33156,
                                                 &groups_per_segment_33257,
                                                 &elements_per_thread_33258,
                                                 &virt_num_groups_33259,
                                                 &threads_per_segment_33261,
                                                 &kernel_arg_35569,
                                                 &kernel_arg_35570,
                                                 &kernel_arg_35571,
                                                 &kernel_arg_35572};
                    int64_t time_start_35563 = 0, time_end_35564 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_ballQuery.segred_large_33235");
                        fprintf(ctx->log, "%ld", (long) num_groups_31625);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) seghist_group_sizze_31623);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35563 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_ballQueryzisegred_large_33235_runs,
                                                  &ctx->test_ballQueryzisegred_large_33235_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegred_large_33235,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          seghist_group_sizze_31623,
                                                          1, 1, 0 +
                                                          (shared_sizze_35565 +
                                                           (8 -
                                                            shared_sizze_35565 %
                                                            8) % 8) +
                                                          (shared_sizze_35567 +
                                                           (8 -
                                                            shared_sizze_35567 %
                                                            8) % 8), NULL,
                                                          kernel_args_35562,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35564 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_ballQuery.segred_large_33235",
                                time_end_35564 - time_start_35563);
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &group_res_arr_mem_33262,
                                          "group_res_arr_mem_33262") != 0)
                    return 1;
            }
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
        return 1;
    
    int64_t segscan_group_sizze_31638;
    
    segscan_group_sizze_31638 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31637;
    
    int64_t num_groups_31640;
    int32_t max_num_groups_33296;
    
    max_num_groups_33296 = ctx->sizes.test_ballQueryzisegscan_num_groups_31639;
    num_groups_31640 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(defunc_2_reduce_res_29982,
                                                            segscan_group_sizze_31638),
                                                  sext_i32_i64(max_num_groups_33296))));
    
    struct memblock_device mem_32058;
    
    mem_32058.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32058, defunc_2_reduce_res_29982,
                              "mem_32058")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32060;
    
    mem_32060.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32060, bytes_32053, "mem_32060")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, defunc_2_reduce_res_29982)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_33297;
        
        numThreads_33297 = sdiv_up64(defunc_2_reduce_res_29982,
                                     segscan_group_sizze_31638 * (int64_t) 9) *
            segscan_group_sizze_31638;
        
        int64_t numGroups_33298;
        
        numGroups_33298 = sdiv_up64(defunc_2_reduce_res_29982,
                                    segscan_group_sizze_31638 * (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_33299 =
                               ctx->test_ballQueryziid_counter_mem_33299;
        struct memblock_device status_flags_mem_33301;
        
        status_flags_mem_33301.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_33301, numGroups_33298,
                                  "status_flags_mem_33301")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_33303;
        
        aggregates_mem_33303.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_33303, numGroups_33298,
                                  "aggregates_mem_33303")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_33305;
        
        incprefixes_mem_33305.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_33305, numGroups_33298,
                                  "incprefixes_mem_33305")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_33307;
        
        aggregates_mem_33307.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_33307, (int64_t) 8 *
                                  numGroups_33298, "aggregates_mem_33307")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_33309;
        
        incprefixes_mem_33309.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_33309, (int64_t) 8 *
                                  numGroups_33298, "incprefixes_mem_33309")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33301,
                                         numGroups_33298, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35577 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_31638,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31638),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_31638,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_31638 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_35579 = mem_32054.mem;
        CUdeviceptr kernel_arg_35580 = mem_32058.mem;
        CUdeviceptr kernel_arg_35581 = mem_32060.mem;
        CUdeviceptr kernel_arg_35582 = test_ballQueryziid_counter_mem_33299.mem;
        CUdeviceptr kernel_arg_35583 = status_flags_mem_33301.mem;
        CUdeviceptr kernel_arg_35584 = aggregates_mem_33303.mem;
        CUdeviceptr kernel_arg_35585 = incprefixes_mem_33305.mem;
        CUdeviceptr kernel_arg_35586 = aggregates_mem_33307.mem;
        CUdeviceptr kernel_arg_35587 = incprefixes_mem_33309.mem;
        unsigned int shared_offset_35578 = 0;
        
        if ((((((1 && sdiv_up64(defunc_2_reduce_res_29982,
                                segscan_group_sizze_31638 * (int64_t) 9) !=
                 0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31638 != 0) &&
             1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29982,
                                      segscan_group_sizze_31638 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35574[] = {&ctx->global_failure,
                                         &shared_offset_35578,
                                         &defunc_2_reduce_res_29982,
                                         &kernel_arg_35579, &kernel_arg_35580,
                                         &kernel_arg_35581, &kernel_arg_35582,
                                         &kernel_arg_35583, &kernel_arg_35584,
                                         &kernel_arg_35585, &kernel_arg_35586,
                                         &kernel_arg_35587};
            int64_t time_start_35575 = 0, time_end_35576 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31643");
                fprintf(ctx->log, "%ld",
                        (long) sdiv_up64(defunc_2_reduce_res_29982,
                                         segscan_group_sizze_31638 *
                                         (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31638);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35575 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31643_runs,
                                          &ctx->test_ballQueryzisegscan_31643_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31643,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31638, 1,
                                                  1, 0 + (shared_sizze_35577 +
                                                          (8 -
                                                           shared_sizze_35577 %
                                                           8) % 8), NULL,
                                                  kernel_args_35574, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35576 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31643", time_end_35576 -
                        time_start_35575);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_33309,
                                  "incprefixes_mem_33309") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_33307,
                                  "aggregates_mem_33307") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_33305,
                                  "incprefixes_mem_33305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_33303,
                                  "aggregates_mem_33303") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_33301,
                                  "status_flags_mem_33301") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_32054, "mem_32054") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32058, "mem_32058") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31655;
    
    segmap_group_sizze_31655 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31647;
    
    int64_t segmap_usable_groups_31656 = sdiv_up64(defunc_2_reduce_res_29982,
                                                   segmap_group_sizze_31655);
    struct memblock_device mem_32063;
    
    mem_32063.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32063, defunc_2_reduce_res_29982,
                              "mem_32063")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35591 = mem_32060.mem;
    CUdeviceptr kernel_arg_35592 = mem_32063.mem;
    
    if ((((((1 && segmap_usable_groups_31656 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31655 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31656;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35588[] = {&ctx->global_failure,
                                     &defunc_2_reduce_res_29982,
                                     &kernel_arg_35591, &kernel_arg_35592};
        int64_t time_start_35589 = 0, time_end_35590 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31645");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31656);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31655);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35589 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31645_runs,
                                      &ctx->test_ballQueryzisegmap_31645_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31645,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31655, 1, 1, 0,
                                              NULL, kernel_args_35588, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35590 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31645", time_end_35590 -
                    time_start_35589);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    bool y_30016 = slt64((int64_t) 0, defunc_2_reduce_res_29982);
    bool index_certs_30017;
    
    if (!y_30016) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               defunc_2_reduce_res_29982, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:52:15-27\n   #2  src/cluster.fut:108:19-120\n   #3  src/cluster_test.fut:49:17-45\n   #4  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32060, "mem_32060") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32058, "mem_32058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_1_map_res_subhistos_mem_33157,
                                  "defunc_1_map_res_subhistos_mem_33157") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32054, "mem_32054") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_33127,
                                  "group_res_arr_mem_33127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_35593 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32063.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_35593,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_31664;
    
    segscan_group_sizze_31664 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31663;
    
    int64_t num_groups_31666;
    int32_t max_num_groups_33434;
    
    max_num_groups_33434 = ctx->sizes.test_ballQueryzisegscan_num_groups_31665;
    num_groups_31666 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(defunc_2_reduce_res_29982,
                                                            segscan_group_sizze_31664),
                                                  sext_i32_i64(max_num_groups_33434))));
    
    struct memblock_device mem_32066;
    
    mem_32066.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32066, defunc_2_reduce_res_29982,
                              "mem_32066")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32068;
    
    mem_32068.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32068, bytes_32053, "mem_32068")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, defunc_2_reduce_res_29982)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_33435;
        
        numThreads_33435 = sdiv_up64(defunc_2_reduce_res_29982,
                                     segscan_group_sizze_31664 * (int64_t) 9) *
            segscan_group_sizze_31664;
        
        int64_t numGroups_33436;
        
        numGroups_33436 = sdiv_up64(defunc_2_reduce_res_29982,
                                    segscan_group_sizze_31664 * (int64_t) 9);
        
        struct memblock_device test_ballQueryziid_counter_mem_33437 =
                               ctx->test_ballQueryziid_counter_mem_33437;
        struct memblock_device status_flags_mem_33439;
        
        status_flags_mem_33439.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_33439, numGroups_33436,
                                  "status_flags_mem_33439")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_33441;
        
        aggregates_mem_33441.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_33441, numGroups_33436,
                                  "aggregates_mem_33441")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_33443;
        
        incprefixes_mem_33443.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_33443, numGroups_33436,
                                  "incprefixes_mem_33443")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_33445;
        
        aggregates_mem_33445.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_33445, (int64_t) 8 *
                                  numGroups_33436, "aggregates_mem_33445")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_33447;
        
        incprefixes_mem_33447.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_33447, (int64_t) 8 *
                                  numGroups_33436, "incprefixes_mem_33447")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33439,
                                         numGroups_33436, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35598 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_31664,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31664),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_31664,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_31664 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_35600 = mem_32063.mem;
        CUdeviceptr kernel_arg_35601 = mem_32066.mem;
        CUdeviceptr kernel_arg_35602 = mem_32068.mem;
        CUdeviceptr kernel_arg_35603 = test_ballQueryziid_counter_mem_33437.mem;
        CUdeviceptr kernel_arg_35604 = status_flags_mem_33439.mem;
        CUdeviceptr kernel_arg_35605 = aggregates_mem_33441.mem;
        CUdeviceptr kernel_arg_35606 = incprefixes_mem_33443.mem;
        CUdeviceptr kernel_arg_35607 = aggregates_mem_33445.mem;
        CUdeviceptr kernel_arg_35608 = incprefixes_mem_33447.mem;
        unsigned int shared_offset_35599 = 0;
        
        if ((((((1 && sdiv_up64(defunc_2_reduce_res_29982,
                                segscan_group_sizze_31664 * (int64_t) 9) !=
                 0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31664 != 0) &&
             1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29982,
                                      segscan_group_sizze_31664 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35595[] = {&ctx->global_failure,
                                         &shared_offset_35599,
                                         &defunc_2_reduce_res_29982,
                                         &kernel_arg_35600, &kernel_arg_35601,
                                         &kernel_arg_35602, &kernel_arg_35603,
                                         &kernel_arg_35604, &kernel_arg_35605,
                                         &kernel_arg_35606, &kernel_arg_35607,
                                         &kernel_arg_35608};
            int64_t time_start_35596 = 0, time_end_35597 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segscan_31669");
                fprintf(ctx->log, "%ld",
                        (long) sdiv_up64(defunc_2_reduce_res_29982,
                                         segscan_group_sizze_31664 *
                                         (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31664);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35596 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegscan_31669_runs,
                                          &ctx->test_ballQueryzisegscan_31669_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31669,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31664, 1,
                                                  1, 0 + (shared_sizze_35598 +
                                                          (8 -
                                                           shared_sizze_35598 %
                                                           8) % 8), NULL,
                                                  kernel_args_35595, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35597 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segscan_31669", time_end_35597 -
                        time_start_35596);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_33447,
                                  "incprefixes_mem_33447") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_33445,
                                  "aggregates_mem_33445") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_33443,
                                  "incprefixes_mem_33443") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_33441,
                                  "aggregates_mem_33441") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_33439,
                                  "status_flags_mem_33439") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
        return 1;
    
    int64_t segmap_group_sizze_31756;
    
    segmap_group_sizze_31756 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31690;
    
    int64_t segmap_usable_groups_31757 = sdiv_up64(defunc_2_reduce_res_29982,
                                                   segmap_group_sizze_31756);
    struct memblock_device mem_32071;
    
    mem_32071.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32071, bytes_32053, "mem_32071")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_32072 = (int64_t) 4 * defunc_2_reduce_res_29982;
    struct memblock_device mem_32073;
    
    mem_32073.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32073, bytes_32072, "mem_32073")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35612 = pos_mem_31946.mem;
    CUdeviceptr kernel_arg_35613 = labels_mem_31947.mem;
    CUdeviceptr kernel_arg_35614 = mem_32007.mem;
    CUdeviceptr kernel_arg_35615 = mem_32030.mem;
    CUdeviceptr kernel_arg_35616 = mem_32044.mem;
    CUdeviceptr kernel_arg_35617 = mem_32060.mem;
    CUdeviceptr kernel_arg_35618 = mem_32068.mem;
    CUdeviceptr kernel_arg_35619 = mem_32071.mem;
    CUdeviceptr kernel_arg_35620 = mem_32073.mem;
    
    if ((((((1 && segmap_usable_groups_31757 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31756 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31757;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35609[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_29737, &radius_29738,
                                     &defunc_2_reduce_res_29982, &bytes_31948,
                                     &kernel_arg_35612, &kernel_arg_35613,
                                     &kernel_arg_35614, &kernel_arg_35615,
                                     &kernel_arg_35616, &kernel_arg_35617,
                                     &kernel_arg_35618, &kernel_arg_35619,
                                     &kernel_arg_35620};
        int64_t time_start_35610 = 0, time_end_35611 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segmap_31688");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31757);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31756);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35610 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegmap_31688_runs,
                                      &ctx->test_ballQueryzisegmap_31688_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31688,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31756, 1, 1, 0,
                                              NULL, kernel_args_35609, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35611 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segmap_31688", time_end_35611 -
                    time_start_35610);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32060, "mem_32060") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32068, "mem_32068") != 0)
        return 1;
    
    struct memblock_device mem_32075;
    
    mem_32075.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32075, bytes_32053, "mem_32075")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_32075, defunc_2_reduce_res_29982,
                                 (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_30115 = defunc_2_reduce_res_29982 == (int64_t) 0;
    int32_t iters_30116;
    
    if (cond_30115) {
        iters_30116 = 0;
    } else {
        iters_30116 = 32;
    }
    
    bool loop_nonempty_30117 = slt32(0, iters_30116);
    int64_t i_30118 = sub64(defunc_2_reduce_res_29982, (int64_t) 1);
    bool x_30119 = sle64((int64_t) 0, i_30118);
    bool y_30120 = slt64(i_30118, defunc_2_reduce_res_29982);
    bool bounds_check_30121 = x_30119 && y_30120;
    bool loop_not_taken_30122 = !loop_nonempty_30117;
    bool protect_assert_disj_30123 = bounds_check_30121 || loop_not_taken_30122;
    bool index_certs_30124;
    
    if (!protect_assert_disj_30123) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_30118,
                               "] out of bounds for array of shape [",
                               defunc_2_reduce_res_29982, "].",
                               "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:125:21-127:59\n   #8  src/cluster_test.fut:49:17-45\n   #9  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &mem_32075, "mem_32075") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32073, "mem_32073") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32071, "mem_32071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32068, "mem_32068") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32060, "mem_32060") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32058, "mem_32058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_1_map_res_subhistos_mem_33157,
                                  "defunc_1_map_res_subhistos_mem_33157") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32054, "mem_32054") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_33127,
                                  "group_res_arr_mem_33127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t segscan_group_sizze_31824;
    
    segscan_group_sizze_31824 =
        ctx->sizes.test_ballQueryzisegscan_group_sizze_31823;
    
    int64_t num_groups_31826;
    int32_t max_num_groups_33573;
    
    max_num_groups_33573 = ctx->sizes.test_ballQueryzisegscan_num_groups_31825;
    num_groups_31826 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(defunc_2_reduce_res_29982,
                                                            segscan_group_sizze_31824),
                                                  sext_i32_i64(max_num_groups_33573))));
    
    int64_t segmap_group_sizze_31834;
    
    segmap_group_sizze_31834 =
        ctx->sizes.test_ballQueryzisegmap_group_sizze_31833;
    
    int64_t segmap_usable_groups_31835 =
            sdiv_up_safe64(defunc_2_reduce_res_29982, segmap_group_sizze_31834);
    struct memblock_device mem_32092;
    
    mem_32092.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32092, bytes_32053, "mem_32092")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32094;
    
    mem_32094.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32094, bytes_32053, "mem_32094")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32096;
    
    mem_32096.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32096, bytes_32053, "mem_32096")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32098;
    
    mem_32098.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32098, bytes_32053, "mem_32098")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32100;
    
    mem_32100.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32100, bytes_32072, "mem_32100")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device defunc_0_f_res_mem_32114;
    
    defunc_0_f_res_mem_32114.references = NULL;
    
    struct memblock_device defunc_0_f_res_mem_32119;
    
    defunc_0_f_res_mem_32119.references = NULL;
    
    struct memblock_device mem_param_32080;
    
    mem_param_32080.references = NULL;
    
    struct memblock_device mem_param_32085;
    
    mem_param_32085.references = NULL;
    if (memblock_set_device(ctx, &mem_param_32080, &mem_32071, "mem_32071") !=
        0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_32085, &mem_32075, "mem_32075") !=
        0)
        return 1;
    for (int32_t i_30127 = 0; i_30127 < iters_30116; i_30127++) {
        int32_t defunc_2_radix_sort_step_arg_30130 = mul32(2, i_30127);
        int32_t defunc_0_get_bit_arg_30131 = add32(1,
                                                   defunc_2_radix_sort_step_arg_30130);
        int64_t i32_res_30132 = sext_i32_i64(defunc_0_get_bit_arg_30131);
        int64_t i32_res_30133 =
                sext_i32_i64(defunc_2_radix_sort_step_arg_30130);
        
        if (slt64((int64_t) 0, defunc_2_reduce_res_29982)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_33578;
            
            numThreads_33578 = sdiv_up64(defunc_2_reduce_res_29982,
                                         segscan_group_sizze_31824 *
                                         (int64_t) 9) *
                segscan_group_sizze_31824;
            
            int64_t numGroups_33579;
            
            numGroups_33579 = sdiv_up64(defunc_2_reduce_res_29982,
                                        segscan_group_sizze_31824 *
                                        (int64_t) 9);
            
            struct memblock_device test_ballQueryziid_counter_mem_33580 =
                                   ctx->test_ballQueryziid_counter_mem_33580;
            struct memblock_device status_flags_mem_33582;
            
            status_flags_mem_33582.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_33582,
                                      numGroups_33579,
                                      "status_flags_mem_33582")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_33584;
            
            aggregates_mem_33584.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_33584, (int64_t) 8 *
                                      numGroups_33579,
                                      "aggregates_mem_33584")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_33586;
            
            incprefixes_mem_33586.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_33586, (int64_t) 8 *
                                      numGroups_33579,
                                      "incprefixes_mem_33586")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_33588;
            
            aggregates_mem_33588.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_33588, (int64_t) 8 *
                                      numGroups_33579,
                                      "aggregates_mem_33588")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_33590;
            
            incprefixes_mem_33590.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_33590, (int64_t) 8 *
                                      numGroups_33579,
                                      "incprefixes_mem_33590")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_33592;
            
            aggregates_mem_33592.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_33592, (int64_t) 8 *
                                      numGroups_33579,
                                      "aggregates_mem_33592")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_33594;
            
            incprefixes_mem_33594.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_33594, (int64_t) 8 *
                                      numGroups_33579,
                                      "incprefixes_mem_33594")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_33596;
            
            aggregates_mem_33596.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_33596, (int64_t) 8 *
                                      numGroups_33579,
                                      "aggregates_mem_33596")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_33598;
            
            incprefixes_mem_33598.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_33598, (int64_t) 8 *
                                      numGroups_33579,
                                      "incprefixes_mem_33598")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33582,
                                             numGroups_33579, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_35625 = smax64(smax64((int64_t) 1056,
                                                            sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                          segscan_group_sizze_31824,
                                                                                          (int64_t) 8) *
                                                                                (int64_t) 8 +
                                                                                (int64_t) 8 *
                                                                                segscan_group_sizze_31824,
                                                                                (int64_t) 8) *
                                                                      (int64_t) 8 +
                                                                      (int64_t) 8 *
                                                                      segscan_group_sizze_31824,
                                                                      (int64_t) 8) *
                                                            (int64_t) 8 +
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31824),
                                                     smax64(smax64(smax64((int64_t) 9 *
                                                                          segscan_group_sizze_31824 *
                                                                          (int64_t) 8,
                                                                          (int64_t) 9 *
                                                                          segscan_group_sizze_31824 *
                                                                          (int64_t) 8),
                                                                   (int64_t) 9 *
                                                                   segscan_group_sizze_31824 *
                                                                   (int64_t) 8),
                                                            (int64_t) 9 *
                                                            segscan_group_sizze_31824 *
                                                            (int64_t) 8));
            CUdeviceptr kernel_arg_35627 = mem_param_32080.mem;
            CUdeviceptr kernel_arg_35628 = mem_32092.mem;
            CUdeviceptr kernel_arg_35629 = mem_32094.mem;
            CUdeviceptr kernel_arg_35630 = mem_32096.mem;
            CUdeviceptr kernel_arg_35631 = mem_32098.mem;
            CUdeviceptr kernel_arg_35632 = mem_32100.mem;
            CUdeviceptr kernel_arg_35633 =
                        test_ballQueryziid_counter_mem_33580.mem;
            CUdeviceptr kernel_arg_35634 = status_flags_mem_33582.mem;
            CUdeviceptr kernel_arg_35635 = aggregates_mem_33584.mem;
            CUdeviceptr kernel_arg_35636 = incprefixes_mem_33586.mem;
            CUdeviceptr kernel_arg_35637 = aggregates_mem_33588.mem;
            CUdeviceptr kernel_arg_35638 = incprefixes_mem_33590.mem;
            CUdeviceptr kernel_arg_35639 = aggregates_mem_33592.mem;
            CUdeviceptr kernel_arg_35640 = incprefixes_mem_33594.mem;
            CUdeviceptr kernel_arg_35641 = aggregates_mem_33596.mem;
            CUdeviceptr kernel_arg_35642 = incprefixes_mem_33598.mem;
            unsigned int shared_offset_35626 = 0;
            
            if ((((((1 && sdiv_up64(defunc_2_reduce_res_29982,
                                    segscan_group_sizze_31824 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31824 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29982,
                                          segscan_group_sizze_31824 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35622[] = {&ctx->global_failure,
                                             &shared_offset_35626,
                                             &defunc_2_reduce_res_29982,
                                             &i32_res_30132, &i32_res_30133,
                                             &kernel_arg_35627,
                                             &kernel_arg_35628,
                                             &kernel_arg_35629,
                                             &kernel_arg_35630,
                                             &kernel_arg_35631,
                                             &kernel_arg_35632,
                                             &kernel_arg_35633,
                                             &kernel_arg_35634,
                                             &kernel_arg_35635,
                                             &kernel_arg_35636,
                                             &kernel_arg_35637,
                                             &kernel_arg_35638,
                                             &kernel_arg_35639,
                                             &kernel_arg_35640,
                                             &kernel_arg_35641,
                                             &kernel_arg_35642};
                int64_t time_start_35623 = 0, time_end_35624 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_ballQuery.segscan_31829");
                    fprintf(ctx->log, "%ld",
                            (long) sdiv_up64(defunc_2_reduce_res_29982,
                                             segscan_group_sizze_31824 *
                                             (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31824);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35623 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_ballQueryzisegscan_31829_runs,
                                              &ctx->test_ballQueryzisegscan_31829_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegscan_31829,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31824,
                                                      1, 1, 0 +
                                                      (shared_sizze_35625 + (8 -
                                                                             shared_sizze_35625 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35622, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35624 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_ballQuery.segscan_31829", time_end_35624 -
                            time_start_35623);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_33598,
                                      "incprefixes_mem_33598") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_33596,
                                      "aggregates_mem_33596") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_33594,
                                      "incprefixes_mem_33594") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_33592,
                                      "aggregates_mem_33592") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_33590,
                                      "incprefixes_mem_33590") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_33588,
                                      "aggregates_mem_33588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_33586,
                                      "incprefixes_mem_33586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_33584,
                                      "aggregates_mem_33584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_33582,
                                      "status_flags_mem_33582") != 0)
                return 1;
        }
        
        int64_t read_res_35643;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35643, mem_32092.mem +
                                                i_30118 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_30188 = read_res_35643;
        int64_t read_res_35644;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35644, mem_32094.mem +
                                                i_30118 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_30189 = read_res_35644;
        int64_t read_res_35645;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35645, mem_32096.mem +
                                                i_30118 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_30190 = read_res_35645;
        struct memblock_device mem_32102;
        
        mem_32102.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32102, bytes_32053, "mem_32102")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32102.mem + (int64_t) 0,
                                            mem_param_32080.mem + (int64_t) 0,
                                            defunc_2_reduce_res_29982 *
                                            (int64_t) 8));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        
        struct memblock_device mem_32104;
        
        mem_32104.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32104, bytes_32053, "mem_32104")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32104.mem + (int64_t) 0,
                                            mem_param_32085.mem + (int64_t) 0,
                                            defunc_2_reduce_res_29982 *
                                            (int64_t) 8));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_35649 = mem_param_32080.mem;
        CUdeviceptr kernel_arg_35650 = mem_param_32085.mem;
        CUdeviceptr kernel_arg_35651 = mem_32092.mem;
        CUdeviceptr kernel_arg_35652 = mem_32094.mem;
        CUdeviceptr kernel_arg_35653 = mem_32096.mem;
        CUdeviceptr kernel_arg_35654 = mem_32098.mem;
        CUdeviceptr kernel_arg_35655 = mem_32100.mem;
        CUdeviceptr kernel_arg_35656 = mem_32102.mem;
        CUdeviceptr kernel_arg_35657 = mem_32104.mem;
        
        if ((((((1 && segmap_usable_groups_31835 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_31834 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_31835;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35646[] = {&ctx->global_failure,
                                         &defunc_2_reduce_res_29982,
                                         &last_res_30188, &last_res_30189,
                                         &last_res_30190, &kernel_arg_35649,
                                         &kernel_arg_35650, &kernel_arg_35651,
                                         &kernel_arg_35652, &kernel_arg_35653,
                                         &kernel_arg_35654, &kernel_arg_35655,
                                         &kernel_arg_35656, &kernel_arg_35657};
            int64_t time_start_35647 = 0, time_end_35648 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_ballQuery.segmap_31831");
                fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31835);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31834);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35647 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_ballQueryzisegmap_31831_runs,
                                          &ctx->test_ballQueryzisegmap_31831_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegmap_31831,
                                                  grid[0], grid[1], grid[2],
                                                  segmap_group_sizze_31834, 1,
                                                  1, 0, NULL, kernel_args_35646,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35648 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_ballQuery.segmap_31831", time_end_35648 -
                        time_start_35647);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        struct memblock_device mem_param_tmp_33574;
        
        mem_param_tmp_33574.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_33574, &mem_32102,
                                "mem_32102") != 0)
            return 1;
        
        struct memblock_device mem_param_tmp_33575;
        
        mem_param_tmp_33575.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_33575, &mem_32104,
                                "mem_32104") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32080, &mem_param_tmp_33574,
                                "mem_param_tmp_33574") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32085, &mem_param_tmp_33575,
                                "mem_param_tmp_33575") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_33575,
                                  "mem_param_tmp_33575") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_33574,
                                  "mem_param_tmp_33574") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32104, "mem_32104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_32114, &mem_param_32080,
                            "mem_param_32080") != 0)
        return 1;
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_32119, &mem_param_32085,
                            "mem_param_32085") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32071, "mem_32071") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32075, "mem_32075") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32092, "mem_32092") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32094, "mem_32094") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32096, "mem_32096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32098, "mem_32098") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
        return 1;
    
    int64_t segred_group_sizze_31838;
    
    segred_group_sizze_31838 =
        ctx->sizes.test_ballQueryzisegred_group_sizze_31837;
    
    int64_t num_groups_31840;
    int32_t max_num_groups_33796;
    
    max_num_groups_33796 = ctx->sizes.test_ballQueryzisegred_num_groups_31839;
    num_groups_31840 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(defunc_2_reduce_res_29982,
                                                            segred_group_sizze_31838),
                                                  sext_i32_i64(max_num_groups_33796))));
    
    struct memblock_device mem_32122;
    
    mem_32122.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32122, (int64_t) 4, "mem_32122")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32124;
    
    mem_32124.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32124, bytes_32072, "mem_32124")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device test_ballQueryzicounter_mem_33797 =
                           ctx->test_ballQueryzicounter_mem_33797;
    struct memblock_device group_res_arr_mem_33799;
    
    group_res_arr_mem_33799.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_33799, (int64_t) 4 *
                              (segred_group_sizze_31838 * num_groups_31840),
                              "group_res_arr_mem_33799")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_33801;
    
    num_threads_33801 = num_groups_31840 * segred_group_sizze_31838;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_35662 = (int64_t) 4 * segred_group_sizze_31838;
    unsigned int shared_sizze_35664 = 1;
    CUdeviceptr kernel_arg_35666 = mem_32073.mem;
    CUdeviceptr kernel_arg_35667 = defunc_0_f_res_mem_32119.mem;
    CUdeviceptr kernel_arg_35668 = mem_32122.mem;
    CUdeviceptr kernel_arg_35669 = mem_32124.mem;
    CUdeviceptr kernel_arg_35670 = test_ballQueryzicounter_mem_33797.mem;
    CUdeviceptr kernel_arg_35671 = group_res_arr_mem_33799.mem;
    unsigned int shared_offset_35663 = 0;
    unsigned int shared_offset_35665 = 0 + (shared_sizze_35662 + (8 -
                                                                  shared_sizze_35662 %
                                                                  8) % 8);
    
    if ((((((1 && num_groups_31840 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_31838 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_31840;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35659[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &shared_offset_35663, &shared_offset_35665,
                                     &defunc_2_reduce_res_29982,
                                     &num_groups_31840, &num_threads_33801,
                                     &kernel_arg_35666, &kernel_arg_35667,
                                     &kernel_arg_35668, &kernel_arg_35669,
                                     &kernel_arg_35670, &kernel_arg_35671};
        int64_t time_start_35660 = 0, time_end_35661 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_ballQuery.segred_nonseg_31846");
            fprintf(ctx->log, "%ld", (long) num_groups_31840);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segred_group_sizze_31838);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35660 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_ballQueryzisegred_nonseg_31846_runs,
                                      &ctx->test_ballQueryzisegred_nonseg_31846_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_ballQueryzisegred_nonseg_31846,
                                              grid[0], grid[1], grid[2],
                                              segred_group_sizze_31838, 1, 1,
                                              0 + (shared_sizze_35662 + (8 -
                                                                         shared_sizze_35662 %
                                                                         8) %
                                                   8) + (shared_sizze_35664 +
                                                         (8 -
                                                          shared_sizze_35664 %
                                                          8) % 8), NULL,
                                              kernel_args_35659, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35661 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_ballQuery.segred_nonseg_31846", time_end_35661 -
                    time_start_35660);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32073, "mem_32073") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32119,
                              "defunc_0_f_res_mem_32119") != 0)
        return 1;
    
    int32_t read_res_35672;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35672, mem_32122.mem +
                                            (int64_t) 0 * sizeof(int32_t),
                                            sizeof(int32_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int32_t defunc_0_f_res_30225 = read_res_35672;
    
    if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
        return 1;
    
    int64_t defunc_0_f_res_30241 = sext_i32_i64(defunc_0_f_res_30225);
    bool empty_slice_30242 = defunc_0_f_res_30241 == (int64_t) 0;
    int64_t m_30243 = sub64(defunc_0_f_res_30241, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_30244 = sle64((int64_t) 0, m_30243);
    bool i_p_m_t_s_leq_w_30245 = slt64(m_30243, defunc_2_reduce_res_29982);
    bool i_lte_j_30246 = sle64((int64_t) 0, defunc_0_f_res_30241);
    bool y_30247 = zzero_leq_i_p_m_t_s_30244 && i_p_m_t_s_leq_w_30245;
    bool y_30248 = i_lte_j_30246 && y_30247;
    bool ok_or_empty_30249 = empty_slice_30242 || y_30248;
    bool index_certs_30250;
    
    if (!ok_or_empty_30249) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0, ":",
                               defunc_0_f_res_30241,
                               "] out of bounds for array of shape [",
                               defunc_2_reduce_res_29982, "].",
                               "-> #0  /prelude/array.fut:41:44-49\n   #1  src/cluster.fut:129:40-66\n   #2  src/cluster_test.fut:49:17-45\n   #3  src/cluster_test.fut:48:1-50:16\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_33799,
                                  "group_res_arr_mem_33799") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32124, "mem_32124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32085, "mem_param_32085") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32080, "mem_param_32080") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32119,
                                  "defunc_0_f_res_mem_32119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32114,
                                  "defunc_0_f_res_mem_32114") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32098, "mem_32098") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32096, "mem_32096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32094, "mem_32094") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32092, "mem_32092") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32075, "mem_32075") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32073, "mem_32073") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32071, "mem_32071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32068, "mem_32068") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32060, "mem_32060") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32058, "mem_32058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_1_map_res_subhistos_mem_33157,
                                  "defunc_1_map_res_subhistos_mem_33157") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32054, "mem_32054") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_33127,
                                  "group_res_arr_mem_33127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                                  "defunc_0_f_res_mem_32000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                                  "defunc_0_f_res_mem_31995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_32125 = (int64_t) 4 * defunc_0_f_res_30241;
    struct memblock_device mem_32126;
    
    mem_32126.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32126, bytes_32125, "mem_32126")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32126.mem + (int64_t) 0,
                                        mem_32124.mem + (int64_t) 0,
                                        defunc_0_f_res_30241 * (int64_t) 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_32124, "mem_32124") != 0)
        return 1;
    out_arrsizze_32443 = defunc_0_f_res_30241;
    if (memblock_set_device(ctx, &out_mem_32442, &mem_32126, "mem_32126") != 0)
        return 1;
    (*out_mem_p_35376).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_35376, &out_mem_32442,
                            "out_mem_32442") != 0)
        return 1;
    *out_out_arrsizze_35377 = out_arrsizze_32443;
    if (memblock_unref_device(ctx, &mem_32126, "mem_32126") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_33799,
                              "group_res_arr_mem_33799") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32124, "mem_32124") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_32085, "mem_param_32085") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_32080, "mem_param_32080") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32119,
                              "defunc_0_f_res_mem_32119") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32114,
                              "defunc_0_f_res_mem_32114") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32098, "mem_32098") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32096, "mem_32096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32094, "mem_32094") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32092, "mem_32092") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32075, "mem_32075") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32073, "mem_32073") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32071, "mem_32071") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32068, "mem_32068") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32060, "mem_32060") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32058, "mem_32058") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_1_map_res_subhistos_mem_33157,
                              "defunc_1_map_res_subhistos_mem_33157") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32054, "mem_32054") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_33127,
                              "group_res_arr_mem_33127") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32052, "mem_32052") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32049, "mem_32049") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32047, "mem_32047") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32044, "mem_32044") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32040, "mem_32040") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32035, "mem_32035") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32030, "mem_32030") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32020, "mem_32020") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32015, "mem_32015") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32010, "mem_32010") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32007, "mem_32007") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_31966, "mem_param_31966") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_31961, "mem_param_31961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32000,
                              "defunc_0_f_res_mem_32000") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31995,
                              "defunc_0_f_res_mem_31995") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_entry_test_clusterWith(struct futhark_context *ctx,
                                         struct memblock_device *out_mem_p_35673,
                                         int64_t *out_out_arrsizze_35674,
                                         struct memblock_device graph_from_mem_31946,
                                         struct memblock_device graph_to_mem_31947,
                                         int64_t implz2081U_28888,
                                         int32_t thres_28889,
                                         int64_t numVert_28890)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    bool bounds_invalid_upwards_28893 = slt64(numVert_28890, (int64_t) 0);
    bool valid_28894 = !bounds_invalid_upwards_28893;
    bool range_valid_c_28895;
    
    if (!valid_28894) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               numVert_28890, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  src/cluster_test.fut:37:17-28\n   #2  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t segmap_group_sizze_30481;
    
    segmap_group_sizze_30481 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30475;
    
    int64_t segmap_usable_groups_30482 = sdiv_up64(numVert_28890,
                                                   segmap_group_sizze_30481);
    int64_t bytes_31949 = (int64_t) 4 * numVert_28890;
    struct memblock_device mem_31950;
    
    mem_31950.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31950, bytes_31949, "mem_31950")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35678 = mem_31950.mem;
    
    if ((((((1 && segmap_usable_groups_30482 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30481 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30482;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35675[] = {&ctx->global_failure, &numVert_28890,
                                     &kernel_arg_35678};
        int64_t time_start_35676 = 0, time_end_35677 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_30473");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30482);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30481);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35676 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_30473_runs,
                                      &ctx->test_clusterWithzisegmap_30473_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30473,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30481, 1, 1, 0,
                                              NULL, kernel_args_35675, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35677 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_30473", time_end_35677 -
                    time_start_35676);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t conc_tmp_28900 = implz2081U_28888 + numVert_28890;
    int64_t bytes_31951 = (int64_t) 4 * conc_tmp_28900;
    struct memblock_device mem_31952;
    
    mem_31952.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31952, bytes_31951, "mem_31952")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_32449 = (int64_t) 0;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31952.mem + tmp_offs_32449 *
                                        (int64_t) 4, graph_from_mem_31946.mem +
                                        (int64_t) 0, implz2081U_28888 *
                                        (int64_t) 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    tmp_offs_32449 += implz2081U_28888;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31952.mem + tmp_offs_32449 *
                                        (int64_t) 4, mem_31950.mem +
                                        (int64_t) 0, numVert_28890 *
                                        (int64_t) 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    tmp_offs_32449 += numVert_28890;
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    
    int64_t bytes_31953 = (int64_t) 8 * conc_tmp_28900;
    struct memblock_device mem_31954;
    
    mem_31954.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31954, bytes_31953, "mem_31954")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_31954, conc_tmp_28900, (int64_t) 0,
                                 (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_28903 = conc_tmp_28900 == (int64_t) 0;
    int32_t iters_28904;
    
    if (cond_28903) {
        iters_28904 = 0;
    } else {
        iters_28904 = 16;
    }
    
    bool loop_nonempty_28905 = slt32(0, iters_28904);
    int64_t i_28906 = sub64(conc_tmp_28900, (int64_t) 1);
    bool x_28907 = sle64((int64_t) 0, i_28906);
    bool y_28908 = slt64(i_28906, conc_tmp_28900);
    bool bounds_check_28909 = x_28907 && y_28908;
    bool loop_not_taken_28910 = !loop_nonempty_28905;
    bool protect_assert_disj_28911 = bounds_check_28909 || loop_not_taken_28910;
    bool index_certs_28912;
    
    if (!protect_assert_disj_28911) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_28906,
                               "] out of bounds for array of shape [",
                               conc_tmp_28900, "].",
                               "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster_test.fut:38:18-39:57\n   #8  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t segscan_group_sizze_30488;
    
    segscan_group_sizze_30488 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30487;
    
    int64_t num_groups_30490;
    int32_t max_num_groups_32460;
    
    max_num_groups_32460 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_30489;
    num_groups_30490 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(conc_tmp_28900,
                                                            segscan_group_sizze_30488),
                                                  sext_i32_i64(max_num_groups_32460))));
    
    int64_t segmap_group_sizze_30498;
    
    segmap_group_sizze_30498 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30497;
    
    int64_t segmap_usable_groups_30499 = sdiv_up_safe64(conc_tmp_28900,
                                                        segmap_group_sizze_30498);
    struct memblock_device mem_31971;
    
    mem_31971.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31971, bytes_31953, "mem_31971")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31973;
    
    mem_31973.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31973, bytes_31953, "mem_31973")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31975;
    
    mem_31975.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31975, bytes_31953, "mem_31975")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31977;
    
    mem_31977.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31977, bytes_31953, "mem_31977")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31979;
    
    mem_31979.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31979, bytes_31951, "mem_31979")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device defunc_0_f_res_mem_31993;
    
    defunc_0_f_res_mem_31993.references = NULL;
    
    struct memblock_device defunc_0_f_res_mem_31998;
    
    defunc_0_f_res_mem_31998.references = NULL;
    
    struct memblock_device mem_param_31959;
    
    mem_param_31959.references = NULL;
    
    struct memblock_device mem_param_31964;
    
    mem_param_31964.references = NULL;
    if (memblock_set_device(ctx, &mem_param_31959, &mem_31952, "mem_31952") !=
        0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_31964, &mem_31954, "mem_31954") !=
        0)
        return 1;
    for (int32_t i_28915 = 0; i_28915 < iters_28904; i_28915++) {
        int32_t defunc_2_radix_sort_step_arg_28918 = mul32(2, i_28915);
        int32_t defunc_0_get_bit_arg_28919 = add32(1,
                                                   defunc_2_radix_sort_step_arg_28918);
        
        if (slt64((int64_t) 0, conc_tmp_28900)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_32465;
            
            numThreads_32465 = sdiv_up64(conc_tmp_28900,
                                         segscan_group_sizze_30488 *
                                         (int64_t) 9) *
                segscan_group_sizze_30488;
            
            int64_t numGroups_32466;
            
            numGroups_32466 = sdiv_up64(conc_tmp_28900,
                                        segscan_group_sizze_30488 *
                                        (int64_t) 9);
            
            struct memblock_device test_clusterWithziid_counter_mem_32467 =
                                   ctx->test_clusterWithziid_counter_mem_32467;
            struct memblock_device status_flags_mem_32469;
            
            status_flags_mem_32469.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_32469,
                                      numGroups_32466,
                                      "status_flags_mem_32469")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32471;
            
            aggregates_mem_32471.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32471, (int64_t) 8 *
                                      numGroups_32466,
                                      "aggregates_mem_32471")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32473;
            
            incprefixes_mem_32473.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32473, (int64_t) 8 *
                                      numGroups_32466,
                                      "incprefixes_mem_32473")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32475;
            
            aggregates_mem_32475.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32475, (int64_t) 8 *
                                      numGroups_32466,
                                      "aggregates_mem_32475")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32477;
            
            incprefixes_mem_32477.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32477, (int64_t) 8 *
                                      numGroups_32466,
                                      "incprefixes_mem_32477")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32479;
            
            aggregates_mem_32479.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32479, (int64_t) 8 *
                                      numGroups_32466,
                                      "aggregates_mem_32479")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32481;
            
            incprefixes_mem_32481.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32481, (int64_t) 8 *
                                      numGroups_32466,
                                      "incprefixes_mem_32481")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_32483;
            
            aggregates_mem_32483.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_32483, (int64_t) 8 *
                                      numGroups_32466,
                                      "aggregates_mem_32483")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_32485;
            
            incprefixes_mem_32485.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_32485, (int64_t) 8 *
                                      numGroups_32466,
                                      "incprefixes_mem_32485")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32469,
                                             numGroups_32466, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_35683 = smax64(smax64((int64_t) 1056,
                                                            sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                          segscan_group_sizze_30488,
                                                                                          (int64_t) 8) *
                                                                                (int64_t) 8 +
                                                                                (int64_t) 8 *
                                                                                segscan_group_sizze_30488,
                                                                                (int64_t) 8) *
                                                                      (int64_t) 8 +
                                                                      (int64_t) 8 *
                                                                      segscan_group_sizze_30488,
                                                                      (int64_t) 8) *
                                                            (int64_t) 8 +
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_30488),
                                                     smax64(smax64(smax64((int64_t) 9 *
                                                                          segscan_group_sizze_30488 *
                                                                          (int64_t) 8,
                                                                          (int64_t) 9 *
                                                                          segscan_group_sizze_30488 *
                                                                          (int64_t) 8),
                                                                   (int64_t) 9 *
                                                                   segscan_group_sizze_30488 *
                                                                   (int64_t) 8),
                                                            (int64_t) 9 *
                                                            segscan_group_sizze_30488 *
                                                            (int64_t) 8));
            CUdeviceptr kernel_arg_35685 = mem_param_31959.mem;
            CUdeviceptr kernel_arg_35686 = mem_31971.mem;
            CUdeviceptr kernel_arg_35687 = mem_31973.mem;
            CUdeviceptr kernel_arg_35688 = mem_31975.mem;
            CUdeviceptr kernel_arg_35689 = mem_31977.mem;
            CUdeviceptr kernel_arg_35690 = mem_31979.mem;
            CUdeviceptr kernel_arg_35691 =
                        test_clusterWithziid_counter_mem_32467.mem;
            CUdeviceptr kernel_arg_35692 = status_flags_mem_32469.mem;
            CUdeviceptr kernel_arg_35693 = aggregates_mem_32471.mem;
            CUdeviceptr kernel_arg_35694 = incprefixes_mem_32473.mem;
            CUdeviceptr kernel_arg_35695 = aggregates_mem_32475.mem;
            CUdeviceptr kernel_arg_35696 = incprefixes_mem_32477.mem;
            CUdeviceptr kernel_arg_35697 = aggregates_mem_32479.mem;
            CUdeviceptr kernel_arg_35698 = incprefixes_mem_32481.mem;
            CUdeviceptr kernel_arg_35699 = aggregates_mem_32483.mem;
            CUdeviceptr kernel_arg_35700 = incprefixes_mem_32485.mem;
            unsigned int shared_offset_35684 = 0;
            
            if ((((((1 && sdiv_up64(conc_tmp_28900, segscan_group_sizze_30488 *
                                    (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
                  segscan_group_sizze_30488 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(conc_tmp_28900,
                                          segscan_group_sizze_30488 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35680[] = {&ctx->global_failure,
                                             &shared_offset_35684,
                                             &conc_tmp_28900,
                                             &defunc_2_radix_sort_step_arg_28918,
                                             &defunc_0_get_bit_arg_28919,
                                             &kernel_arg_35685,
                                             &kernel_arg_35686,
                                             &kernel_arg_35687,
                                             &kernel_arg_35688,
                                             &kernel_arg_35689,
                                             &kernel_arg_35690,
                                             &kernel_arg_35691,
                                             &kernel_arg_35692,
                                             &kernel_arg_35693,
                                             &kernel_arg_35694,
                                             &kernel_arg_35695,
                                             &kernel_arg_35696,
                                             &kernel_arg_35697,
                                             &kernel_arg_35698,
                                             &kernel_arg_35699,
                                             &kernel_arg_35700};
                int64_t time_start_35681 = 0, time_end_35682 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segscan_30493");
                    fprintf(ctx->log, "%ld", (long) sdiv_up64(conc_tmp_28900,
                                                              segscan_group_sizze_30488 *
                                                              (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30488);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35681 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegscan_30493_runs,
                                              &ctx->test_clusterWithzisegscan_30493_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30493,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_30488,
                                                      1, 1, 0 +
                                                      (shared_sizze_35683 + (8 -
                                                                             shared_sizze_35683 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35680, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35682 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segscan_30493", time_end_35682 -
                            time_start_35681);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_32485,
                                      "incprefixes_mem_32485") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32483,
                                      "aggregates_mem_32483") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32481,
                                      "incprefixes_mem_32481") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32479,
                                      "aggregates_mem_32479") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32477,
                                      "incprefixes_mem_32477") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32475,
                                      "aggregates_mem_32475") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_32473,
                                      "incprefixes_mem_32473") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_32471,
                                      "aggregates_mem_32471") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_32469,
                                      "status_flags_mem_32469") != 0)
                return 1;
        }
        
        int64_t read_res_35701;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35701, mem_31971.mem +
                                                i_28906 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28970 = read_res_35701;
        int64_t read_res_35702;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35702, mem_31973.mem +
                                                i_28906 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28971 = read_res_35702;
        int64_t read_res_35703;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35703, mem_31975.mem +
                                                i_28906 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28972 = read_res_35703;
        struct memblock_device mem_31981;
        
        mem_31981.references = NULL;
        if (memblock_alloc_device(ctx, &mem_31981, bytes_31951, "mem_31981")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31981.mem + (int64_t) 0,
                                            mem_param_31959.mem + (int64_t) 0,
                                            conc_tmp_28900 * (int64_t) 4));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        
        struct memblock_device mem_31983;
        
        mem_31983.references = NULL;
        if (memblock_alloc_device(ctx, &mem_31983, bytes_31953, "mem_31983")) {
            err = 1;
            goto cleanup;
        }
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_31983.mem + (int64_t) 0,
                                            mem_param_31964.mem + (int64_t) 0,
                                            conc_tmp_28900 * (int64_t) 8));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_35707 = mem_param_31959.mem;
        CUdeviceptr kernel_arg_35708 = mem_param_31964.mem;
        CUdeviceptr kernel_arg_35709 = mem_31971.mem;
        CUdeviceptr kernel_arg_35710 = mem_31973.mem;
        CUdeviceptr kernel_arg_35711 = mem_31975.mem;
        CUdeviceptr kernel_arg_35712 = mem_31977.mem;
        CUdeviceptr kernel_arg_35713 = mem_31979.mem;
        CUdeviceptr kernel_arg_35714 = mem_31981.mem;
        CUdeviceptr kernel_arg_35715 = mem_31983.mem;
        
        if ((((((1 && segmap_usable_groups_30499 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_30498 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_30499;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35704[] = {&ctx->global_failure, &conc_tmp_28900,
                                         &last_res_28970, &last_res_28971,
                                         &last_res_28972, &kernel_arg_35707,
                                         &kernel_arg_35708, &kernel_arg_35709,
                                         &kernel_arg_35710, &kernel_arg_35711,
                                         &kernel_arg_35712, &kernel_arg_35713,
                                         &kernel_arg_35714, &kernel_arg_35715};
            int64_t time_start_35705 = 0, time_end_35706 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segmap_30495");
                fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30499);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30498);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35705 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegmap_30495_runs,
                                          &ctx->test_clusterWithzisegmap_30495_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30495,
                                                  grid[0], grid[1], grid[2],
                                                  segmap_group_sizze_30498, 1,
                                                  1, 0, NULL, kernel_args_35704,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35706 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segmap_30495", time_end_35706 -
                        time_start_35705);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        struct memblock_device mem_param_tmp_32461;
        
        mem_param_tmp_32461.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_32461, &mem_31981,
                                "mem_31981") != 0)
            return 1;
        
        struct memblock_device mem_param_tmp_32462;
        
        mem_param_tmp_32462.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_32462, &mem_31983,
                                "mem_31983") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_31959, &mem_param_tmp_32461,
                                "mem_param_tmp_32461") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_31964, &mem_param_tmp_32462,
                                "mem_param_tmp_32462") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_32462,
                                  "mem_param_tmp_32462") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_32461,
                                  "mem_param_tmp_32461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31983, "mem_31983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31981, "mem_31981") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_31993, &mem_param_31959,
                            "mem_param_31959") != 0)
        return 1;
    if (memblock_set_device(ctx, &defunc_0_f_res_mem_31998, &mem_param_31964,
                            "mem_param_31964") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
        return 1;
    
    int64_t segmap_group_sizze_30526;
    
    segmap_group_sizze_30526 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30503;
    
    int64_t segmap_usable_groups_30527 = sdiv_up64(conc_tmp_28900,
                                                   segmap_group_sizze_30526);
    struct memblock_device mem_32001;
    
    mem_32001.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32001, bytes_31953, "mem_32001")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32003;
    
    mem_32003.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32003, bytes_31951, "mem_32003")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32005;
    
    mem_32005.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32005, bytes_31951, "mem_32005")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35719 = graph_from_mem_31946.mem;
    CUdeviceptr kernel_arg_35720 = graph_to_mem_31947.mem;
    CUdeviceptr kernel_arg_35721 = defunc_0_f_res_mem_31998.mem;
    CUdeviceptr kernel_arg_35722 = mem_32001.mem;
    CUdeviceptr kernel_arg_35723 = mem_32003.mem;
    CUdeviceptr kernel_arg_35724 = mem_32005.mem;
    
    if ((((((1 && segmap_usable_groups_30527 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30526 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30527;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35716[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_28888, &conc_tmp_28900,
                                     &kernel_arg_35719, &kernel_arg_35720,
                                     &kernel_arg_35721, &kernel_arg_35722,
                                     &kernel_arg_35723, &kernel_arg_35724};
        int64_t time_start_35717 = 0, time_end_35718 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_30501");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30527);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30526);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35717 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_30501_runs,
                                      &ctx->test_clusterWithzisegmap_30501_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30501,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30526, 1, 1, 0,
                                              NULL, kernel_args_35716, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35718 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_30501", time_end_35718 -
                    time_start_35717);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                              "defunc_0_f_res_mem_31998") != 0)
        return 1;
    
    int64_t segmap_group_sizze_30561;
    
    segmap_group_sizze_30561 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30553;
    
    int64_t segmap_usable_groups_30562 = sdiv_up64(conc_tmp_28900,
                                                   segmap_group_sizze_30561);
    struct memblock_device mem_32008;
    
    mem_32008.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32008, conc_tmp_28900, "mem_32008")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35728 = mem_32001.mem;
    CUdeviceptr kernel_arg_35729 = mem_32008.mem;
    
    if ((((((1 && segmap_usable_groups_30562 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30561 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30562;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35725[] = {&ctx->global_failure, &conc_tmp_28900,
                                     &kernel_arg_35728, &kernel_arg_35729};
        int64_t time_start_35726 = 0, time_end_35727 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_30551");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30562);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30561);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35726 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_30551_runs,
                                      &ctx->test_clusterWithzisegmap_30551_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30551,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30561, 1, 1, 0,
                                              NULL, kernel_args_35725, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35727 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_30551", time_end_35727 -
                    time_start_35726);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
        return 1;
    
    bool y_29028 = slt64((int64_t) 0, conc_tmp_28900);
    bool index_certs_29029;
    
    if (!y_29028) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               conc_tmp_28900, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:60:15-41\n   #2  src/cluster_test.fut:41:17-45\n   #3  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                  "defunc_0_f_res_mem_31998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                  "defunc_0_f_res_mem_31993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_35730 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32008.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_35730,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_30570;
    
    segscan_group_sizze_30570 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30569;
    
    int64_t num_groups_30572;
    int32_t max_num_groups_32702;
    
    max_num_groups_32702 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_30571;
    num_groups_30572 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(conc_tmp_28900,
                                                            segscan_group_sizze_30570),
                                                  sext_i32_i64(max_num_groups_32702))));
    
    struct memblock_device mem_32011;
    
    mem_32011.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32011, conc_tmp_28900, "mem_32011")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32013;
    
    mem_32013.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32013, bytes_31953, "mem_32013")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_28900)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32703;
        
        numThreads_32703 = sdiv_up64(conc_tmp_28900, segscan_group_sizze_30570 *
                                     (int64_t) 9) * segscan_group_sizze_30570;
        
        int64_t numGroups_32704;
        
        numGroups_32704 = sdiv_up64(conc_tmp_28900, segscan_group_sizze_30570 *
                                    (int64_t) 9);
        
        struct memblock_device test_clusterWithziid_counter_mem_32705 =
                               ctx->test_clusterWithziid_counter_mem_32705;
        struct memblock_device status_flags_mem_32707;
        
        status_flags_mem_32707.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32707, numGroups_32704,
                                  "status_flags_mem_32707")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32709;
        
        aggregates_mem_32709.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32709, numGroups_32704,
                                  "aggregates_mem_32709")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32711;
        
        incprefixes_mem_32711.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32711, numGroups_32704,
                                  "incprefixes_mem_32711")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32713;
        
        aggregates_mem_32713.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32713, (int64_t) 8 *
                                  numGroups_32704, "aggregates_mem_32713")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32715;
        
        incprefixes_mem_32715.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32715, (int64_t) 8 *
                                  numGroups_32704, "incprefixes_mem_32715")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32707,
                                         numGroups_32704, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35735 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_30570,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30570),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_30570,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_30570 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_35737 = mem_32008.mem;
        CUdeviceptr kernel_arg_35738 = mem_32011.mem;
        CUdeviceptr kernel_arg_35739 = mem_32013.mem;
        CUdeviceptr kernel_arg_35740 =
                    test_clusterWithziid_counter_mem_32705.mem;
        CUdeviceptr kernel_arg_35741 = status_flags_mem_32707.mem;
        CUdeviceptr kernel_arg_35742 = aggregates_mem_32709.mem;
        CUdeviceptr kernel_arg_35743 = incprefixes_mem_32711.mem;
        CUdeviceptr kernel_arg_35744 = aggregates_mem_32713.mem;
        CUdeviceptr kernel_arg_35745 = incprefixes_mem_32715.mem;
        unsigned int shared_offset_35736 = 0;
        
        if ((((((1 && sdiv_up64(conc_tmp_28900, segscan_group_sizze_30570 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30570 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(conc_tmp_28900,
                                      segscan_group_sizze_30570 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35732[] = {&ctx->global_failure,
                                         &shared_offset_35736, &conc_tmp_28900,
                                         &kernel_arg_35737, &kernel_arg_35738,
                                         &kernel_arg_35739, &kernel_arg_35740,
                                         &kernel_arg_35741, &kernel_arg_35742,
                                         &kernel_arg_35743, &kernel_arg_35744,
                                         &kernel_arg_35745};
            int64_t time_start_35733 = 0, time_end_35734 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segscan_30575");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(conc_tmp_28900,
                                                          segscan_group_sizze_30570 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30570);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35733 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegscan_30575_runs,
                                          &ctx->test_clusterWithzisegscan_30575_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30575,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30570, 1,
                                                  1, 0 + (shared_sizze_35735 +
                                                          (8 -
                                                           shared_sizze_35735 %
                                                           8) % 8), NULL,
                                                  kernel_args_35732, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35734 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segscan_30575", time_end_35734 -
                        time_start_35733);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32715,
                                  "incprefixes_mem_32715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32713,
                                  "aggregates_mem_32713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_32711,
                                  "incprefixes_mem_32711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32709,
                                  "aggregates_mem_32709") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32707,
                                  "status_flags_mem_32707") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30578;
    
    segscan_group_sizze_30578 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30577;
    
    int64_t num_groups_30580;
    int32_t max_num_groups_32835;
    
    max_num_groups_32835 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_30579;
    num_groups_30580 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(conc_tmp_28900,
                                                            segscan_group_sizze_30578),
                                                  sext_i32_i64(max_num_groups_32835))));
    
    struct memblock_device mem_32016;
    
    mem_32016.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32016, bytes_31953, "mem_32016")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_28900)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32836;
        
        numThreads_32836 = sdiv_up64(conc_tmp_28900, segscan_group_sizze_30578 *
                                     (int64_t) 9) * segscan_group_sizze_30578;
        
        int64_t numGroups_32837;
        
        numGroups_32837 = sdiv_up64(conc_tmp_28900, segscan_group_sizze_30578 *
                                    (int64_t) 9);
        
        struct memblock_device test_clusterWithziid_counter_mem_32838 =
                               ctx->test_clusterWithziid_counter_mem_32838;
        struct memblock_device status_flags_mem_32840;
        
        status_flags_mem_32840.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32840, numGroups_32837,
                                  "status_flags_mem_32840")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32842;
        
        aggregates_mem_32842.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32842, (int64_t) 8 *
                                  numGroups_32837, "aggregates_mem_32842")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32844;
        
        incprefixes_mem_32844.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32844, (int64_t) 8 *
                                  numGroups_32837, "incprefixes_mem_32844")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32840,
                                         numGroups_32837, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35750 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30578),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30578 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_35752 = mem_32008.mem;
        CUdeviceptr kernel_arg_35753 = mem_32016.mem;
        CUdeviceptr kernel_arg_35754 =
                    test_clusterWithziid_counter_mem_32838.mem;
        CUdeviceptr kernel_arg_35755 = status_flags_mem_32840.mem;
        CUdeviceptr kernel_arg_35756 = aggregates_mem_32842.mem;
        CUdeviceptr kernel_arg_35757 = incprefixes_mem_32844.mem;
        unsigned int shared_offset_35751 = 0;
        
        if ((((((1 && sdiv_up64(conc_tmp_28900, segscan_group_sizze_30578 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30578 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(conc_tmp_28900,
                                      segscan_group_sizze_30578 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35747[] = {&ctx->global_failure,
                                         &shared_offset_35751, &conc_tmp_28900,
                                         &kernel_arg_35752, &kernel_arg_35753,
                                         &kernel_arg_35754, &kernel_arg_35755,
                                         &kernel_arg_35756, &kernel_arg_35757};
            int64_t time_start_35748 = 0, time_end_35749 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segscan_30583");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(conc_tmp_28900,
                                                          segscan_group_sizze_30578 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30578);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35748 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegscan_30583_runs,
                                          &ctx->test_clusterWithzisegscan_30583_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30583,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30578, 1,
                                                  1, 0 + (shared_sizze_35750 +
                                                          (8 -
                                                           shared_sizze_35750 %
                                                           8) % 8), NULL,
                                                  kernel_args_35747, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35749 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segscan_30583", time_end_35749 -
                        time_start_35748);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32844,
                                  "incprefixes_mem_32844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32842,
                                  "aggregates_mem_32842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32840,
                                  "status_flags_mem_32840") != 0)
            return 1;
    }
    
    int64_t num_segments_29050;
    
    if (y_29028) {
        bool index_certs_29051;
        
        if (!bounds_check_28909) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_28906,
                                   "] out of bounds for array of shape [",
                                   conc_tmp_28900, "].",
                                   "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:61:18-34\n   #4  src/cluster_test.fut:41:17-45\n   #5  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_35758;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35758, mem_32016.mem +
                                                i_28906 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_29052 = read_res_35758;
        
        num_segments_29050 = last_res_29052;
    } else {
        num_segments_29050 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_29053 = slt64(num_segments_29050, (int64_t) 0);
    bool valid_29054 = !bounds_invalid_upwards_29053;
    bool range_valid_c_29055;
    
    if (!valid_29054) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               num_segments_29050, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:61:18-34\n   #5  src/cluster_test.fut:41:17-45\n   #6  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                  "defunc_0_f_res_mem_31998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                  "defunc_0_f_res_mem_31993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_32017 = (int64_t) 8 * num_segments_29050;
    struct memblock_device mem_32018;
    
    mem_32018.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32018, bytes_32017, "mem_32018")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32018, num_segments_29050,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30588;
    
    segmap_group_sizze_30588 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30587;
    
    int64_t segmap_usable_groups_30589 = sdiv_up64(conc_tmp_28900,
                                                   segmap_group_sizze_30588);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35762 = mem_32008.mem;
    CUdeviceptr kernel_arg_35763 = mem_32013.mem;
    CUdeviceptr kernel_arg_35764 = mem_32016.mem;
    CUdeviceptr kernel_arg_35765 = mem_32018.mem;
    
    if ((((((1 && segmap_usable_groups_30589 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30588 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30589;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35759[] = {&ctx->global_failure, &conc_tmp_28900,
                                     &num_segments_29050, &kernel_arg_35762,
                                     &kernel_arg_35763, &kernel_arg_35764,
                                     &kernel_arg_35765};
        int64_t time_start_35760 = 0, time_end_35761 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_30585");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30589);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30588);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35760 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_30585_runs,
                                      &ctx->test_clusterWithzisegmap_30585_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30585,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30588, 1, 1, 0,
                                              NULL, kernel_args_35759, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35761 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_30585", time_end_35761 -
                    time_start_35760);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30592;
    
    segscan_group_sizze_30592 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30591;
    
    int64_t num_groups_30594;
    int32_t max_num_groups_32931;
    
    max_num_groups_32931 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_30593;
    num_groups_30594 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(num_segments_29050,
                                                            segscan_group_sizze_30592),
                                                  sext_i32_i64(max_num_groups_32931))));
    
    struct memblock_device mem_32022;
    
    mem_32022.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32022, bytes_32017, "mem_32022")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, num_segments_29050)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32932;
        
        numThreads_32932 = sdiv_up64(num_segments_29050,
                                     segscan_group_sizze_30592 * (int64_t) 9) *
            segscan_group_sizze_30592;
        
        int64_t numGroups_32933;
        
        numGroups_32933 = sdiv_up64(num_segments_29050,
                                    segscan_group_sizze_30592 * (int64_t) 9);
        
        struct memblock_device test_clusterWithziid_counter_mem_32934 =
                               ctx->test_clusterWithziid_counter_mem_32934;
        struct memblock_device status_flags_mem_32936;
        
        status_flags_mem_32936.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32936, numGroups_32933,
                                  "status_flags_mem_32936")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32938;
        
        aggregates_mem_32938.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32938, (int64_t) 8 *
                                  numGroups_32933, "aggregates_mem_32938")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32940;
        
        incprefixes_mem_32940.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32940, (int64_t) 8 *
                                  numGroups_32933, "incprefixes_mem_32940")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32936,
                                         numGroups_32933, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_35770 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30592),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30592 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_35772 = mem_32018.mem;
        CUdeviceptr kernel_arg_35773 = mem_32022.mem;
        CUdeviceptr kernel_arg_35774 =
                    test_clusterWithziid_counter_mem_32934.mem;
        CUdeviceptr kernel_arg_35775 = status_flags_mem_32936.mem;
        CUdeviceptr kernel_arg_35776 = aggregates_mem_32938.mem;
        CUdeviceptr kernel_arg_35777 = incprefixes_mem_32940.mem;
        unsigned int shared_offset_35771 = 0;
        
        if ((((((1 && sdiv_up64(num_segments_29050, segscan_group_sizze_30592 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30592 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(num_segments_29050,
                                      segscan_group_sizze_30592 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_35767[] = {&ctx->global_failure,
                                         &shared_offset_35771,
                                         &num_segments_29050, &kernel_arg_35772,
                                         &kernel_arg_35773, &kernel_arg_35774,
                                         &kernel_arg_35775, &kernel_arg_35776,
                                         &kernel_arg_35777};
            int64_t time_start_35768 = 0, time_end_35769 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segscan_30597");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(num_segments_29050,
                                                          segscan_group_sizze_30592 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30592);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_35768 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegscan_30597_runs,
                                          &ctx->test_clusterWithzisegscan_30597_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30597,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30592, 1,
                                                  1, 0 + (shared_sizze_35770 +
                                                          (8 -
                                                           shared_sizze_35770 %
                                                           8) % 8), NULL,
                                                  kernel_args_35767, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_35769 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segscan_30597", time_end_35769 -
                        time_start_35768);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32940,
                                  "incprefixes_mem_32940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32938,
                                  "aggregates_mem_32938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32936,
                                  "status_flags_mem_32936") != 0)
            return 1;
    }
    
    struct memblock_device mem_32024;
    
    mem_32024.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32024, bytes_32017, "mem_32024")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t group_sizze_33016;
    
    group_sizze_33016 = ctx->sizes.test_clusterWithzigroup_sizze_33016;
    
    int64_t num_groups_33017;
    
    num_groups_33017 = sdiv_up64(num_segments_29050, group_sizze_33016);
    
    CUdeviceptr kernel_arg_35781 = mem_32022.mem;
    CUdeviceptr kernel_arg_35782 = mem_32024.mem;
    
    if ((((((1 && num_groups_33017 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_33016 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_33017;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35778[] = {&num_segments_29050, &kernel_arg_35781,
                                     &kernel_arg_35782};
        int64_t time_start_35779 = 0, time_end_35780 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.copy_33013");
            fprintf(ctx->log, "%ld", (long) num_groups_33017);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_33016);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35779 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzicopy_33013_runs,
                                      &ctx->test_clusterWithzicopy_33013_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzicopy_33013,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_33016, 1, 1, 0, NULL,
                                              kernel_args_35778, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35780 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.copy_33013", time_end_35780 -
                    time_start_35779);
        }
    }
    if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
        return 1;
    
    bool y_29070 = slt64((int64_t) 0, num_segments_29050);
    bool index_certs_29071;
    
    if (!y_29070) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               num_segments_29050, "].",
                               "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:62:17-38\n   #2  src/cluster_test.fut:41:17-45\n   #3  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                  "defunc_0_f_res_mem_31998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                  "defunc_0_f_res_mem_31993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        int64_t write_tmp_35783 = (int64_t) 0;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32024.mem + (int64_t) 0 *
                                            sizeof(int64_t), &write_tmp_35783,
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t bytes_32025 = (int64_t) 8 * numVert_28890;
    struct memblock_device mem_32026;
    
    mem_32026.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32026, bytes_32025, "mem_32026")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32026, numVert_28890,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32028;
    
    mem_32028.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32028, bytes_32025, "mem_32028")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32028, numVert_28890,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30602;
    
    segmap_group_sizze_30602 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30601;
    
    int64_t segmap_usable_groups_30603 = sdiv_up64(num_segments_29050,
                                                   segmap_group_sizze_30602);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_35787 = mem_32003.mem;
    CUdeviceptr kernel_arg_35788 = mem_32018.mem;
    CUdeviceptr kernel_arg_35789 = mem_32024.mem;
    CUdeviceptr kernel_arg_35790 = mem_32026.mem;
    CUdeviceptr kernel_arg_35791 = mem_32028.mem;
    
    if ((((((1 && segmap_usable_groups_30603 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30602 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30603;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35784[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args, &numVert_28890,
                                     &conc_tmp_28900, &num_segments_29050,
                                     &kernel_arg_35787, &kernel_arg_35788,
                                     &kernel_arg_35789, &kernel_arg_35790,
                                     &kernel_arg_35791};
        int64_t time_start_35785 = 0, time_end_35786 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_30599");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30603);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30602);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35785 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_30599_runs,
                                      &ctx->test_clusterWithzisegmap_30599_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30599,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30602, 1, 1, 0,
                                              NULL, kernel_args_35784, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35786 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_30599", time_end_35786 -
                    time_start_35785);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
        return 1;
    
    int64_t loop_init_29088 = conc_tmp_28900 << (int64_t) 1;
    int64_t allocate_arg_29089 = numVert_28890 << (int64_t) 1;
    bool bounds_invalid_upwards_29090 = slt64(allocate_arg_29089, (int64_t) 0);
    bool valid_29091 = !bounds_invalid_upwards_29090;
    bool range_valid_c_29092;
    
    if (!valid_29091) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               allocate_arg_29089, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:41:11-23\n   #3  src/cluster.fut:174:52-70\n   #4  src/cluster_test.fut:42:9-31\n   #5  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                  "defunc_0_f_res_mem_31998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                  "defunc_0_f_res_mem_31993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_32030 = (int64_t) 4 * allocate_arg_29089;
    struct memblock_device mem_32031;
    
    mem_32031.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32031, bytes_32030, "mem_32031")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, mem_32031, allocate_arg_29089, 0) !=
        0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32033;
    
    mem_32033.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32033, bytes_32025, "mem_32033")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_32033, numVert_28890,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segred_group_sizze_30606;
    
    segred_group_sizze_30606 =
        ctx->sizes.test_clusterWithzisegred_group_sizze_30605;
    
    int64_t num_groups_30608;
    int32_t max_num_groups_33032;
    
    max_num_groups_33032 = ctx->sizes.test_clusterWithzisegred_num_groups_30607;
    num_groups_30608 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segred_group_sizze_30606),
                                                  sext_i32_i64(max_num_groups_33032))));
    
    struct memblock_device mem_32036;
    
    mem_32036.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32036, (int64_t) 1, "mem_32036")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32038;
    
    mem_32038.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32038, bytes_31949, "mem_32038")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device test_clusterWithzicounter_mem_33033 =
                           ctx->test_clusterWithzicounter_mem_33033;
    struct memblock_device group_res_arr_mem_33035;
    
    group_res_arr_mem_33035.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_33035,
                              segred_group_sizze_30606 * num_groups_30608,
                              "group_res_arr_mem_33035")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_33037;
    
    num_threads_33037 = num_groups_30608 * segred_group_sizze_30606;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_35796 = segred_group_sizze_30606;
    unsigned int shared_sizze_35798 = 1;
    CUdeviceptr kernel_arg_35800 = mem_32026.mem;
    CUdeviceptr kernel_arg_35801 = mem_32036.mem;
    CUdeviceptr kernel_arg_35802 = mem_32038.mem;
    CUdeviceptr kernel_arg_35803 = test_clusterWithzicounter_mem_33033.mem;
    CUdeviceptr kernel_arg_35804 = group_res_arr_mem_33035.mem;
    unsigned int shared_offset_35797 = 0;
    unsigned int shared_offset_35799 = 0 + (shared_sizze_35796 + (8 -
                                                                  shared_sizze_35796 %
                                                                  8) % 8);
    
    if ((((((1 && num_groups_30608 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_30606 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_30608;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_35793[] = {&ctx->global_failure, &shared_offset_35797,
                                     &shared_offset_35799, &numVert_28890,
                                     &num_groups_30608, &num_threads_33037,
                                     &kernel_arg_35800, &kernel_arg_35801,
                                     &kernel_arg_35802, &kernel_arg_35803,
                                     &kernel_arg_35804};
        int64_t time_start_35794 = 0, time_end_35795 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segred_nonseg_30614");
            fprintf(ctx->log, "%ld", (long) num_groups_30608);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segred_group_sizze_30606);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_35794 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegred_nonseg_30614_runs,
                                      &ctx->test_clusterWithzisegred_nonseg_30614_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30614,
                                              grid[0], grid[1], grid[2],
                                              segred_group_sizze_30606, 1, 1,
                                              0 + (shared_sizze_35796 + (8 -
                                                                         shared_sizze_35796 %
                                                                         8) %
                                                   8) + (shared_sizze_35798 +
                                                         (8 -
                                                          shared_sizze_35798 %
                                                          8) % 8), NULL,
                                              kernel_args_35793, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_35795 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segred_nonseg_30614", time_end_35795 -
                    time_start_35794);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    bool read_res_35805;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35805, mem_32036.mem +
                                            (int64_t) 0 * sizeof(bool),
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    bool x_29095 = read_res_35805;
    
    if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30637;
    
    segscan_group_sizze_30637 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30636;
    
    int64_t num_groups_30639;
    int32_t max_num_groups_33063;
    
    max_num_groups_33063 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_30638;
    num_groups_30639 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segscan_group_sizze_30637),
                                                  sext_i32_i64(max_num_groups_33063))));
    
    int64_t segred_group_sizze_30645;
    
    segred_group_sizze_30645 =
        ctx->sizes.test_clusterWithzisegred_group_sizze_30644;
    
    int64_t num_groups_30647;
    int32_t max_num_groups_33064;
    
    max_num_groups_33064 = ctx->sizes.test_clusterWithzisegred_num_groups_30646;
    num_groups_30647 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segred_group_sizze_30645),
                                                  sext_i32_i64(max_num_groups_33064))));
    
    int64_t seghist_group_sizze_30655;
    
    seghist_group_sizze_30655 =
        ctx->sizes.test_clusterWithziseghist_group_sizze_30654;
    
    int64_t num_groups_30657;
    int32_t max_num_groups_33065;
    
    max_num_groups_33065 =
        ctx->sizes.test_clusterWithziseghist_num_groups_30656;
    num_groups_30657 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            seghist_group_sizze_30655),
                                                  sext_i32_i64(max_num_groups_33065))));
    
    int64_t segscan_group_sizze_30670;
    
    segscan_group_sizze_30670 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30669;
    
    int64_t segscan_group_sizze_30678;
    
    segscan_group_sizze_30678 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30677;
    
    int64_t segmap_group_sizze_30740;
    
    segmap_group_sizze_30740 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30687;
    
    int64_t segscan_group_sizze_30796;
    
    segscan_group_sizze_30796 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30795;
    
    int64_t segmap_group_sizze_30806;
    
    segmap_group_sizze_30806 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30805;
    
    int64_t segmap_group_sizze_30826;
    
    segmap_group_sizze_30826 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30811;
    
    int64_t segmap_group_sizze_30853;
    
    segmap_group_sizze_30853 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30845;
    
    int64_t segscan_group_sizze_30862;
    
    segscan_group_sizze_30862 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30861;
    
    int64_t segscan_group_sizze_30870;
    
    segscan_group_sizze_30870 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30869;
    
    int64_t segscan_group_sizze_30884;
    
    segscan_group_sizze_30884 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30883;
    
    int64_t segmap_group_sizze_30905;
    
    segmap_group_sizze_30905 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30893;
    
    int64_t segmap_group_sizze_30929;
    
    segmap_group_sizze_30929 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30921;
    
    int64_t segscan_group_sizze_30938;
    
    segscan_group_sizze_30938 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30937;
    
    int64_t segscan_group_sizze_30946;
    
    segscan_group_sizze_30946 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30945;
    
    int64_t segscan_group_sizze_30960;
    
    segscan_group_sizze_30960 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_30959;
    
    int64_t segmap_group_sizze_30970;
    
    segmap_group_sizze_30970 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_30969;
    
    int64_t segred_group_sizze_30974;
    
    segred_group_sizze_30974 =
        ctx->sizes.test_clusterWithzisegred_group_sizze_30973;
    
    int64_t num_groups_30976;
    int32_t max_num_groups_33066;
    
    max_num_groups_33066 = ctx->sizes.test_clusterWithzisegred_num_groups_30975;
    num_groups_30976 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segred_group_sizze_30974),
                                                  sext_i32_i64(max_num_groups_33066))));
    
    int64_t segred_group_sizze_31004;
    
    segred_group_sizze_31004 =
        ctx->sizes.test_clusterWithzisegred_group_sizze_31003;
    
    int64_t num_groups_31006;
    int32_t max_num_groups_33067;
    
    max_num_groups_33067 = ctx->sizes.test_clusterWithzisegred_num_groups_31005;
    num_groups_31006 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segred_group_sizze_31004),
                                                  sext_i32_i64(max_num_groups_33067))));
    
    struct memblock_device mem_32093;
    
    mem_32093.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32093, bytes_32025, "mem_32093")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32095;
    
    mem_32095.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32095, bytes_32025, "mem_32095")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32097;
    
    mem_32097.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32097, bytes_31949, "mem_32097")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32100;
    
    mem_32100.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32100, (int64_t) 8, "mem_32100")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32230;
    
    mem_32230.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32230, (int64_t) 1, "mem_32230")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32260;
    
    mem_32260.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32260, (int64_t) 8, "mem_32260")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t sizze_29106;
    int64_t clusterWith_res_ixfn_32261;
    int64_t clusterWith_res_ixfn_32264;
    struct memblock_device clusterWith_res_mem_32265;
    
    clusterWith_res_mem_32265.references = NULL;
    
    struct memblock_device clusterWith_res_mem_32270;
    
    clusterWith_res_mem_32270.references = NULL;
    
    struct memblock_device clusterWith_res_mem_32275;
    
    clusterWith_res_mem_32275.references = NULL;
    
    bool clusterWith_res_29107;
    int64_t clusterWith_res_29108;
    int64_t loopz2081Uz2082Uz2086U_29112;
    bool loop_while_29113;
    int64_t maxSizze_29114;
    int64_t ctx_param_ext_32039;
    int64_t ctx_param_ext_32042;
    struct memblock_device mem_param_32043;
    
    mem_param_32043.references = NULL;
    
    struct memblock_device mem_param_32048;
    
    mem_param_32048.references = NULL;
    
    struct memblock_device mem_param_32053;
    
    mem_param_32053.references = NULL;
    loopz2081Uz2082Uz2086U_29112 = allocate_arg_29089;
    ctx_param_ext_32039 = allocate_arg_29089;
    ctx_param_ext_32042 = allocate_arg_29089;
    if (memblock_set_device(ctx, &mem_param_32043, &mem_32031, "mem_32031") !=
        0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_32048, &mem_32033, "mem_32033") !=
        0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_32053, &mem_32033, "mem_32033") !=
        0)
        return 1;
    loop_while_29113 = 1;
    maxSizze_29114 = loop_init_29088;
    while (loop_while_29113) {
        bool bounds_invalid_upwards_29118 = slt64(maxSizze_29114, (int64_t) 0);
        bool valid_29119 = !bounds_invalid_upwards_29118;
        bool range_valid_c_29120;
        
        if (!valid_29119) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                          maxSizze_29114, " is invalid.",
                          "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:41:11-23\n   #3  src/cluster.fut:176:37-54\n   #4  src/cluster_test.fut:42:9-31\n   #5  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &mem_param_32053,
                                      "mem_param_32053") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32048,
                                      "mem_param_32048") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32043,
                                      "mem_param_32043") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                      "clusterWith_res_mem_32275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                      "clusterWith_res_mem_32270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                      "clusterWith_res_mem_32265") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                      "group_res_arr_mem_33035") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t replicate_arg_29121 = sub64(maxSizze_29114, conc_tmp_28900);
        bool bounds_invalid_upwards_29122 = slt64(replicate_arg_29121,
                                                  (int64_t) 0);
        bool valid_29123 = !bounds_invalid_upwards_29122;
        bool range_valid_c_29124;
        
        if (!valid_29123) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                          replicate_arg_29121, " is invalid.",
                          "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:43:34-50\n   #3  src/cluster.fut:176:57-75\n   #4  src/cluster_test.fut:42:9-31\n   #5  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &mem_param_32053,
                                      "mem_param_32053") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32048,
                                      "mem_param_32048") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32043,
                                      "mem_param_32043") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                      "clusterWith_res_mem_32275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                      "clusterWith_res_mem_32270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                      "clusterWith_res_mem_32265") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                      "group_res_arr_mem_33035") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_32060 = (int64_t) 4 * replicate_arg_29121;
        struct memblock_device mem_32061;
        
        mem_32061.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32061, bytes_32060, "mem_32061")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i32(ctx, mem_32061, replicate_arg_29121,
                                          0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t bytes_32062 = (int64_t) 4 * maxSizze_29114;
        struct memblock_device mem_32063;
        
        mem_32063.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32063, bytes_32062, "mem_32063")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_33079 = (int64_t) 0;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32063.mem + tmp_offs_33079 *
                                            (int64_t) 4, mem_32005.mem +
                                            (int64_t) 0, conc_tmp_28900 *
                                            (int64_t) 4));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        tmp_offs_33079 += conc_tmp_28900;
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_dev_to_dev_runs,
                                          &ctx->copy_dev_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32063.mem + tmp_offs_33079 *
                                            (int64_t) 4, mem_32061.mem +
                                            (int64_t) 0, replicate_arg_29121 *
                                            (int64_t) 4));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        tmp_offs_33079 += replicate_arg_29121;
        if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
            return 1;
        
        bool lifted_checkEqual_res_29127;
        
        if (x_29095) {
            int64_t segred_group_sizze_30617;
            
            segred_group_sizze_30617 =
                ctx->sizes.test_clusterWithzisegred_group_sizze_30616;
            
            int64_t num_groups_30619;
            int32_t max_num_groups_33080;
            
            max_num_groups_33080 =
                ctx->sizes.test_clusterWithzisegred_num_groups_30618;
            num_groups_30619 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(maxSizze_29114,
                                                                    segred_group_sizze_30617),
                                                          sext_i32_i64(max_num_groups_33080))));
            
            struct memblock_device mem_32066;
            
            mem_32066.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32066, (int64_t) 1,
                                      "mem_32066")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device test_clusterWithzicounter_mem_33081 =
                                   ctx->test_clusterWithzicounter_mem_33081;
            struct memblock_device group_res_arr_mem_33083;
            
            group_res_arr_mem_33083.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_33083,
                                      segred_group_sizze_30617 *
                                      num_groups_30619,
                                      "group_res_arr_mem_33083")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_33085;
            
            num_threads_33085 = num_groups_30619 * segred_group_sizze_30617;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            unsigned int shared_sizze_35810 = segred_group_sizze_30617;
            unsigned int shared_sizze_35812 = 1;
            CUdeviceptr kernel_arg_35814 = mem_32005.mem;
            CUdeviceptr kernel_arg_35815 = mem_32066.mem;
            CUdeviceptr kernel_arg_35816 =
                        test_clusterWithzicounter_mem_33081.mem;
            CUdeviceptr kernel_arg_35817 = group_res_arr_mem_33083.mem;
            unsigned int shared_offset_35811 = 0;
            unsigned int shared_offset_35813 = 0 + (shared_sizze_35810 + (8 -
                                                                          shared_sizze_35810 %
                                                                          8) %
                                                    8);
            
            if ((((((1 && num_groups_30619 != 0) && 1 != 0) && 1 != 0) &&
                  segred_group_sizze_30617 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_30619;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35807[] = {&ctx->global_failure,
                                             &shared_offset_35811,
                                             &shared_offset_35813,
                                             &conc_tmp_28900, &maxSizze_29114,
                                             &num_groups_30619,
                                             &num_threads_33085,
                                             &kernel_arg_35814,
                                             &kernel_arg_35815,
                                             &kernel_arg_35816,
                                             &kernel_arg_35817};
                int64_t time_start_35808 = 0, time_end_35809 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segred_nonseg_30624");
                    fprintf(ctx->log, "%ld", (long) num_groups_30619);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segred_group_sizze_30617);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35808 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegred_nonseg_30624_runs,
                                              &ctx->test_clusterWithzisegred_nonseg_30624_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30624,
                                                      grid[0], grid[1], grid[2],
                                                      segred_group_sizze_30617,
                                                      1, 1, 0 +
                                                      (shared_sizze_35810 + (8 -
                                                                             shared_sizze_35810 %
                                                                             8) %
                                                       8) +
                                                      (shared_sizze_35812 + (8 -
                                                                             shared_sizze_35812 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35807, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35809 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segred_nonseg_30624",
                            time_end_35809 - time_start_35808);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            bool read_res_35818;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_from_dev_runs,
                                              &ctx->copy_scalar_from_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35818,
                                                    mem_32066.mem +
                                                    (int64_t) 0 * sizeof(bool),
                                                    sizeof(bool)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            if (futhark_context_sync(ctx) != 0)
                return 1;
            
            bool defunc_2_reduce_res_29128 = read_res_35818;
            
            if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
                return 1;
            lifted_checkEqual_res_29127 = defunc_2_reduce_res_29128;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33083,
                                      "group_res_arr_mem_33083") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32066, "mem_32066") != 0)
                return 1;
        } else {
            lifted_checkEqual_res_29127 = 0;
        }
        
        bool cond_29134 = !lifted_checkEqual_res_29127;
        bool loop_cond_29135;
        
        if (cond_29134) {
            int64_t segred_group_sizze_30627;
            
            segred_group_sizze_30627 =
                ctx->sizes.test_clusterWithzisegred_group_sizze_30626;
            
            int64_t num_groups_30629;
            int32_t max_num_groups_33111;
            
            max_num_groups_33111 =
                ctx->sizes.test_clusterWithzisegred_num_groups_30628;
            num_groups_30629 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(numVert_28890,
                                                                    segred_group_sizze_30627),
                                                          sext_i32_i64(max_num_groups_33111))));
            
            struct memblock_device mem_32069;
            
            mem_32069.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32069, (int64_t) 8,
                                      "mem_32069")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device test_clusterWithzicounter_mem_33112 =
                                   ctx->test_clusterWithzicounter_mem_33112;
            struct memblock_device group_res_arr_mem_33114;
            
            group_res_arr_mem_33114.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_33114,
                                      (int64_t) 8 * (segred_group_sizze_30627 *
                                                     num_groups_30629),
                                      "group_res_arr_mem_33114")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_33116;
            
            num_threads_33116 = num_groups_30629 * segred_group_sizze_30627;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            unsigned int shared_sizze_35823 = (int64_t) 8 *
                         segred_group_sizze_30627;
            unsigned int shared_sizze_35825 = 1;
            CUdeviceptr kernel_arg_35827 = mem_32026.mem;
            CUdeviceptr kernel_arg_35828 = mem_32069.mem;
            CUdeviceptr kernel_arg_35829 =
                        test_clusterWithzicounter_mem_33112.mem;
            CUdeviceptr kernel_arg_35830 = group_res_arr_mem_33114.mem;
            unsigned int shared_offset_35824 = 0;
            unsigned int shared_offset_35826 = 0 + (shared_sizze_35823 + (8 -
                                                                          shared_sizze_35823 %
                                                                          8) %
                                                    8);
            
            if ((((((1 && num_groups_30629 != 0) && 1 != 0) && 1 != 0) &&
                  segred_group_sizze_30627 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_30629;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35820[] = {&ctx->global_failure,
                                             &shared_offset_35824,
                                             &shared_offset_35826,
                                             &numVert_28890, &num_groups_30629,
                                             &num_threads_33116,
                                             &kernel_arg_35827,
                                             &kernel_arg_35828,
                                             &kernel_arg_35829,
                                             &kernel_arg_35830};
                int64_t time_start_35821 = 0, time_end_35822 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segred_nonseg_30634");
                    fprintf(ctx->log, "%ld", (long) num_groups_30629);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segred_group_sizze_30627);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35821 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegred_nonseg_30634_runs,
                                              &ctx->test_clusterWithzisegred_nonseg_30634_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30634,
                                                      grid[0], grid[1], grid[2],
                                                      segred_group_sizze_30627,
                                                      1, 1, 0 +
                                                      (shared_sizze_35823 + (8 -
                                                                             shared_sizze_35823 %
                                                                             8) %
                                                       8) +
                                                      (shared_sizze_35825 + (8 -
                                                                             shared_sizze_35825 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35820, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35822 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segred_nonseg_30634",
                            time_end_35822 - time_start_35821);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t read_res_35831;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_from_dev_runs,
                                              &ctx->copy_scalar_from_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35831,
                                                    mem_32069.mem +
                                                    (int64_t) 0 *
                                                    sizeof(int64_t),
                                                    sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            if (futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t defunc_2_reduce_res_29136 = read_res_35831;
            
            if (memblock_unref_device(ctx, &mem_32069, "mem_32069") != 0)
                return 1;
            
            bool loop_cond_t_res_29141 = sle64(defunc_2_reduce_res_29136,
                                               maxSizze_29114);
            
            loop_cond_29135 = loop_cond_t_res_29141;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33114,
                                      "group_res_arr_mem_33114") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32069, "mem_32069") != 0)
                return 1;
        } else {
            loop_cond_29135 = 0;
        }
        
        struct memblock_device lifted_fromInit_res_mem_32247;
        
        lifted_fromInit_res_mem_32247.references = NULL;
        
        struct memblock_device lifted_fromInit_res_mem_32252;
        
        lifted_fromInit_res_mem_32252.references = NULL;
        
        struct memblock_device lifted_fromInit_res_mem_32257;
        
        lifted_fromInit_res_mem_32257.references = NULL;
        
        bool lifted_fromInit_res_29142;
        bool loop_while_29146;
        struct memblock_device mem_param_32074;
        
        mem_param_32074.references = NULL;
        
        struct memblock_device mem_param_32079;
        
        mem_param_32079.references = NULL;
        
        struct memblock_device mem_param_32084;
        
        mem_param_32084.references = NULL;
        if (memblock_set_device(ctx, &mem_param_32074, &mem_32063,
                                "mem_32063") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32079, &mem_32028,
                                "mem_32028") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32084, &mem_32026,
                                "mem_32026") != 0)
            return 1;
        loop_while_29146 = loop_cond_29135;
        while (loop_while_29146) {
            if (slt64((int64_t) 0, numVert_28890)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_33149;
                
                numThreads_33149 = sdiv_up64(numVert_28890,
                                             segscan_group_sizze_30637 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30637;
                
                int64_t numGroups_33150;
                
                numGroups_33150 = sdiv_up64(numVert_28890,
                                            segscan_group_sizze_30637 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_33151 =
                                       ctx->test_clusterWithziid_counter_mem_33151;
                struct memblock_device status_flags_mem_33153;
                
                status_flags_mem_33153.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_33153,
                                          numGroups_33150,
                                          "status_flags_mem_33153")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33155;
                
                aggregates_mem_33155.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33155,
                                          (int64_t) 8 * numGroups_33150,
                                          "aggregates_mem_33155")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33157;
                
                incprefixes_mem_33157.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33157,
                                          (int64_t) 8 * numGroups_33150,
                                          "incprefixes_mem_33157")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33153,
                                                 numGroups_33150, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_35836 = smax64(smax64((int64_t) 288,
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30637),
                                                         (int64_t) 9 *
                                                         segscan_group_sizze_30637 *
                                                         (int64_t) 8);
                CUdeviceptr kernel_arg_35838 = mem_32038.mem;
                CUdeviceptr kernel_arg_35839 = mem_param_32074.mem;
                CUdeviceptr kernel_arg_35840 = mem_param_32079.mem;
                CUdeviceptr kernel_arg_35841 = mem_param_32084.mem;
                CUdeviceptr kernel_arg_35842 = mem_32093.mem;
                CUdeviceptr kernel_arg_35843 = mem_32095.mem;
                CUdeviceptr kernel_arg_35844 = mem_32097.mem;
                CUdeviceptr kernel_arg_35845 =
                            test_clusterWithziid_counter_mem_33151.mem;
                CUdeviceptr kernel_arg_35846 = status_flags_mem_33153.mem;
                CUdeviceptr kernel_arg_35847 = aggregates_mem_33155.mem;
                CUdeviceptr kernel_arg_35848 = incprefixes_mem_33157.mem;
                unsigned int shared_offset_35837 = 0;
                
                if ((((((1 && sdiv_up64(numVert_28890,
                                        segscan_group_sizze_30637 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30637 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(numVert_28890,
                                              segscan_group_sizze_30637 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35833[] = {&ctx->global_failure,
                                                 &ctx->failure_is_an_option,
                                                 &ctx->global_failure_args,
                                                 &shared_offset_35837,
                                                 &numVert_28890,
                                                 &maxSizze_29114,
                                                 &kernel_arg_35838,
                                                 &kernel_arg_35839,
                                                 &kernel_arg_35840,
                                                 &kernel_arg_35841,
                                                 &kernel_arg_35842,
                                                 &kernel_arg_35843,
                                                 &kernel_arg_35844,
                                                 &kernel_arg_35845,
                                                 &kernel_arg_35846,
                                                 &kernel_arg_35847,
                                                 &kernel_arg_35848};
                    int64_t time_start_35834 = 0, time_end_35835 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30642");
                        fprintf(ctx->log, "%ld", (long) sdiv_up64(numVert_28890,
                                                                  segscan_group_sizze_30637 *
                                                                  (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30637);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35834 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30642_runs,
                                                  &ctx->test_clusterWithzisegscan_30642_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30642,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30637,
                                                          1, 1, 0 +
                                                          (shared_sizze_35836 +
                                                           (8 -
                                                            shared_sizze_35836 %
                                                            8) % 8), NULL,
                                                          kernel_args_35833,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35835 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30642",
                                time_end_35835 - time_start_35834);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_unref_device(ctx, &incprefixes_mem_33157,
                                          "incprefixes_mem_33157") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33155,
                                          "aggregates_mem_33155") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_33153,
                                          "status_flags_mem_33153") != 0)
                    return 1;
            }
            
            struct memblock_device test_clusterWithzicounter_mem_33230 =
                                   ctx->test_clusterWithzicounter_mem_33230;
            struct memblock_device group_res_arr_mem_33232;
            
            group_res_arr_mem_33232.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_33232,
                                      (int64_t) 8 * (segred_group_sizze_30645 *
                                                     num_groups_30647),
                                      "group_res_arr_mem_33232")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_33234;
            
            num_threads_33234 = num_groups_30647 * segred_group_sizze_30645;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            unsigned int shared_sizze_35853 = (int64_t) 8 *
                         segred_group_sizze_30645;
            unsigned int shared_sizze_35855 = 1;
            CUdeviceptr kernel_arg_35857 = mem_32095.mem;
            CUdeviceptr kernel_arg_35858 = mem_32100.mem;
            CUdeviceptr kernel_arg_35859 =
                        test_clusterWithzicounter_mem_33230.mem;
            CUdeviceptr kernel_arg_35860 = group_res_arr_mem_33232.mem;
            unsigned int shared_offset_35854 = 0;
            unsigned int shared_offset_35856 = 0 + (shared_sizze_35853 + (8 -
                                                                          shared_sizze_35853 %
                                                                          8) %
                                                    8);
            
            if ((((((1 && num_groups_30647 != 0) && 1 != 0) && 1 != 0) &&
                  segred_group_sizze_30645 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_30647;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35850[] = {&ctx->global_failure,
                                             &shared_offset_35854,
                                             &shared_offset_35856,
                                             &numVert_28890, &num_groups_30647,
                                             &num_threads_33234,
                                             &kernel_arg_35857,
                                             &kernel_arg_35858,
                                             &kernel_arg_35859,
                                             &kernel_arg_35860};
                int64_t time_start_35851 = 0, time_end_35852 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segred_nonseg_30652");
                    fprintf(ctx->log, "%ld", (long) num_groups_30647);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segred_group_sizze_30645);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35851 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegred_nonseg_30652_runs,
                                              &ctx->test_clusterWithzisegred_nonseg_30652_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30652,
                                                      grid[0], grid[1], grid[2],
                                                      segred_group_sizze_30645,
                                                      1, 1, 0 +
                                                      (shared_sizze_35853 + (8 -
                                                                             shared_sizze_35853 %
                                                                             8) %
                                                       8) +
                                                      (shared_sizze_35855 + (8 -
                                                                             shared_sizze_35855 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_35850, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35852 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segred_nonseg_30652",
                            time_end_35852 - time_start_35851);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t read_res_35861;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_from_dev_runs,
                                              &ctx->copy_scalar_from_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35861,
                                                    mem_32100.mem +
                                                    (int64_t) 0 *
                                                    sizeof(int64_t),
                                                    sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            if (futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t defunc_2_reduce_res_29171 = read_res_35861;
            bool bounds_invalid_upwards_29176 = slt64(defunc_2_reduce_res_29171,
                                                      (int64_t) 0);
            bool valid_29177 = !bounds_invalid_upwards_29176;
            bool range_valid_c_29178;
            
            if (!valid_29177) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                              defunc_2_reduce_res_29171, " is invalid.",
                              "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:72:14-32\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:148:23-152:51\n   #6  src/cluster.fut:170:14-27\n   #7  src/cluster.fut:176:27-76\n   #8  src/cluster_test.fut:42:9-31\n   #9  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            
            int64_t bytes_32101 = (int64_t) 8 * defunc_2_reduce_res_29171;
            struct memblock_device mem_32102;
            
            mem_32102.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32102, bytes_32101,
                                      "mem_32102")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_32102,
                                              defunc_2_reduce_res_29171,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int32_t num_subhistos_33260;
            struct memblock_device defunc_1_map_res_subhistos_mem_33261;
            
            defunc_1_map_res_subhistos_mem_33261.references = NULL;
            
            int64_t h_33263;
            
            h_33263 = (int64_t) 8 * defunc_2_reduce_res_29171;
            
            int64_t seg_h_33264;
            
            seg_h_33264 = (int64_t) 8 * defunc_2_reduce_res_29171;
            if (!(seg_h_33264 == (int64_t) 0)) {
                int64_t hist_H_33265 = defunc_2_reduce_res_29171;
                int64_t hist_el_sizze_33266 = sdiv_up64(h_33263, hist_H_33265);
                int64_t hist_N_33267 = numVert_28890;
                int32_t hist_RF_33268 = 1;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegHist");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)",
                            (long long) sext_i64_i32(num_groups_30657 *
                            seghist_group_sizze_30655), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Desired group size (B)",
                            (long long) seghist_group_sizze_30655, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_33265, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Input elements per histogram (N)",
                            (long long) hist_N_33267, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of segments",
                            (long long) (int64_t) 1, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Histogram element size (el_size)",
                            (long long) hist_el_sizze_33266, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)",
                            (long long) hist_RF_33268, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Memory per set of subhistograms per segment",
                            (long long) h_33263, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Memory per set of subhistograms times segments",
                            (long long) seg_h_33264, '\n');
                
                int32_t hist_L_33269;
                
                hist_L_33269 = ctx->cuda.max_shared_memory;
                
                int32_t max_group_sizze_33270;
                
                max_group_sizze_33270 = ctx->cuda.max_block_size;
                
                int64_t num_groups_33271;
                
                num_groups_33271 =
                    sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_30657 *
                              seghist_group_sizze_30655)),
                              max_group_sizze_33270);
                
                double hist_m_prime_33272;
                
                hist_m_prime_33272 =
                    sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_33269,
                                                               hist_el_sizze_33266)),
                                          sdiv_up64(hist_N_33267,
                                                    num_groups_33271))) /
                    sitofp_i64_f64(hist_H_33265);
                
                int64_t hist_M0_33273;
                
                hist_M0_33273 = smax64((int64_t) 1,
                                       smin64(fptosi_f64_i64(hist_m_prime_33272),
                                              max_group_sizze_33270));
                
                int64_t hist_Nout_33274;
                
                hist_Nout_33274 = (int64_t) 1;
                
                int64_t hist_Nin_33275;
                
                hist_Nin_33275 = numVert_28890;
                
                int64_t work_asymp_M_max_33276;
                
                work_asymp_M_max_33276 = squot64(hist_Nout_33274 * hist_N_33267,
                                                 (int64_t) 2 *
                                                 num_groups_33271 *
                                                 hist_H_33265);
                
                int32_t hist_M_33277;
                
                hist_M_33277 = sext_i64_i32(smin64(hist_M0_33273,
                                                   work_asymp_M_max_33276));
                
                int64_t hist_C_33278;
                
                hist_C_33278 = sdiv_up64(max_group_sizze_33270,
                                         sext_i32_i64(smax32(1, hist_M_33277)));
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local hist_M0",
                            (long long) hist_M0_33273, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local work asymp M max",
                            (long long) work_asymp_M_max_33276, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local C",
                            (long long) hist_C_33278, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local B",
                            (long long) max_group_sizze_33270, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local M",
                            (long long) hist_M_33277, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local memory needed",
                            (long long) (hist_H_33265 * hist_el_sizze_33266 *
                                         sext_i32_i64(hist_M_33277)), '\n');
                
                int64_t local_mem_needed_33279;
                
                local_mem_needed_33279 = hist_el_sizze_33266 *
                    sext_i32_i64(hist_M_33277);
                
                int32_t hist_S_33280;
                
                hist_S_33280 = sext_i64_i32(sdiv_up64(hist_H_33265 *
                                                      local_mem_needed_33279,
                                                      hist_L_33269));
                if (sle64(hist_H_33265, hist_Nin_33275) &&
                    (sle64(local_mem_needed_33279, hist_L_33269) &&
                     (sle32(hist_S_33280, 3) && (sle64(hist_C_33278,
                                                       max_group_sizze_33270) &&
                                                 slt32(0, hist_M_33277))))) {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "## Using local memory");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                                (long long) hist_H_33265, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c",
                                "Multiplication degree (M)",
                                (long long) hist_M_33277, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)",
                                (long long) hist_C_33278, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                                (long long) hist_S_33280, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c",
                                "Number of local subhistograms per group",
                                (long long) hist_M_33277, '\n');
                    
                    int64_t num_segments_33281;
                    
                    num_segments_33281 = (int64_t) 1;
                    num_subhistos_33260 = num_groups_33271 * num_segments_33281;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c",
                                "Number of subhistograms in global memory",
                                (long long) num_subhistos_33260, '\n');
                    if (num_subhistos_33260 == (int64_t) 1) {
                        if (memblock_set_device(ctx,
                                                &defunc_1_map_res_subhistos_mem_33261,
                                                &mem_32102, "mem_32102") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx,
                                                  &defunc_1_map_res_subhistos_mem_33261,
                                                  sext_i32_i64(num_subhistos_33260) *
                                                  defunc_2_reduce_res_29171 *
                                                  (int64_t) 8,
                                                  "defunc_1_map_res_subhistos_mem_33261")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          defunc_1_map_res_subhistos_mem_33261,
                                                          num_subhistos_33260 *
                                                          defunc_2_reduce_res_29171,
                                                          (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->copy_dev_to_dev_runs,
                                                          &ctx->copy_dev_to_dev_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_33261.mem +
                                                            (int64_t) 0,
                                                            mem_32102.mem +
                                                            (int64_t) 0,
                                                            defunc_2_reduce_res_29171 *
                                                            (int64_t) 8));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                        }
                    }
                    for (int32_t chk_i_33282 = 0; chk_i_33282 < hist_S_33280;
                         chk_i_33282++) {
                        int64_t num_segments_33283 = (int64_t) 1;
                        int64_t hist_H_chk_33284 =
                                sdiv_up64(defunc_2_reduce_res_29171,
                                          sext_i32_i64(hist_S_33280));
                        int64_t histo_sizze_33285 = hist_H_chk_33284;
                        int32_t init_per_thread_33286 =
                                sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_33277) *
                                                       histo_sizze_33285,
                                                       max_group_sizze_33270));
                        unsigned int shared_sizze_35865 = (int64_t) 8 *
                                     (hist_M_33277 * hist_H_chk_33284);
                        CUdeviceptr kernel_arg_35867 = mem_32093.mem;
                        CUdeviceptr kernel_arg_35868 =
                                    defunc_1_map_res_subhistos_mem_33261.mem;
                        unsigned int shared_offset_35866 = 0;
                        
                        if ((((((1 && num_groups_33271 != 0) && 1 != 0) && 1 !=
                               0) && max_group_sizze_33270 != 0) && 1 != 0) &&
                            1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = num_groups_33271;
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_35862[] = {&ctx->global_failure,
                                                         &shared_offset_35866,
                                                         &numVert_28890,
                                                         &defunc_2_reduce_res_29171,
                                                         &max_group_sizze_33270,
                                                         &num_groups_33271,
                                                         &hist_M_33277,
                                                         &chk_i_33282,
                                                         &num_segments_33283,
                                                         &hist_H_chk_33284,
                                                         &histo_sizze_33285,
                                                         &init_per_thread_33286,
                                                         &kernel_arg_35867,
                                                         &kernel_arg_35868};
                            int64_t time_start_35863 = 0, time_end_35864 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(ctx->log,
                                        "Launching %s with grid size (",
                                        "test_clusterWith.seghist_local_30660");
                                fprintf(ctx->log, "%ld",
                                        (long) num_groups_33271);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ") and block size (");
                                fprintf(ctx->log, "%ld",
                                        (long) max_group_sizze_33270);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ").\n");
                                time_start_35863 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->test_clusterWithziseghist_local_30660_runs,
                                                          &ctx->test_clusterWithziseghist_local_30660_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithziseghist_local_30660,
                                                                  grid[0],
                                                                  grid[1],
                                                                  grid[2],
                                                                  max_group_sizze_33270,
                                                                  1, 1, 0 +
                                                                  (shared_sizze_35865 +
                                                                   (8 -
                                                                    shared_sizze_35865 %
                                                                    8) % 8),
                                                                  NULL,
                                                                  kernel_args_35862,
                                                                  NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                                time_end_35864 = get_wall_time();
                                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                        "test_clusterWith.seghist_local_30660",
                                        time_end_35864 - time_start_35863);
                            }
                        }
                    }
                } else {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "## Using global memory");
                    
                    int64_t hist_H_33314;
                    
                    hist_H_33314 = defunc_2_reduce_res_29171;
                    
                    double hist_RF_33315;
                    
                    hist_RF_33315 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
                    
                    int32_t hist_el_sizze_33316;
                    
                    hist_el_sizze_33316 = 8;
                    
                    double hist_C_max_33317;
                    
                    hist_C_max_33317 =
                        fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_30657 *
                               seghist_group_sizze_30655)),
                               sitofp_i32_f64(hist_H_33314) / 2.0);
                    
                    int32_t hist_M_min_33318;
                    
                    hist_M_min_33318 = smax32(1,
                                              sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_30657 *
                                              seghist_group_sizze_30655)) /
                                              hist_C_max_33317)));
                    
                    int32_t L2_sizze_33319;
                    
                    L2_sizze_33319 =
                        ctx->sizes.test_clusterWithziL2_sizze_33319;
                    
                    double hist_RACE_exp_33320;
                    
                    hist_RACE_exp_33320 = fmax64(1.0, 0.75 * hist_RF_33315 /
                                                 (64.0 /
                                                  sitofp_i32_f64(hist_el_sizze_33316)));
                    
                    int32_t hist_S_33321;
                    
                    if (slt64(numVert_28890, hist_H_33314)) {
                        hist_S_33321 = 1;
                    } else {
                        hist_S_33321 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_33318) *
                                                   hist_H_33314 *
                                                   sext_i32_i64(hist_el_sizze_33316),
                                                   fptosi_f64_i64(0.4 *
                                                   sitofp_i32_f64(L2_sizze_33319) *
                                                   hist_RACE_exp_33320)));
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c",
                                "Race expansion factor (RACE^exp)",
                                (double) hist_RACE_exp_33320, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                                (long long) hist_S_33321, '\n');
                    
                    int64_t hist_H_chk_33322;
                    
                    hist_H_chk_33322 = sdiv_up64(defunc_2_reduce_res_29171,
                                                 sext_i32_i64(hist_S_33321));
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)",
                                (long long) hist_H_chk_33322, '\n');
                    
                    double hist_k_max_33323;
                    
                    hist_k_max_33323 = fmin64(0.4 *
                                              (sitofp_i32_f64(L2_sizze_33319) /
                                               sitofp_i32_f64(8)) *
                                              hist_RACE_exp_33320,
                                              sitofp_i32_f64(numVert_28890)) /
                        sitofp_i32_f64(sext_i64_i32(num_groups_30657 *
                        seghist_group_sizze_30655));
                    
                    int64_t hist_u_33324;
                    
                    hist_u_33324 = (int64_t) 2;
                    
                    double hist_C_33325;
                    
                    hist_C_33325 =
                        fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_30657 *
                               seghist_group_sizze_30655)),
                               sitofp_i32_f64(hist_u_33324 * hist_H_chk_33322) /
                               hist_k_max_33323);
                    
                    int32_t hist_M_33326;
                    
                    hist_M_33326 = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c",
                                "Elements/thread in L2 cache (k_max)",
                                (double) hist_k_max_33323, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c",
                                "Multiplication degree (M)",
                                (long long) hist_M_33326, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)",
                                (double) hist_C_33325, '\n');
                    num_subhistos_33260 = sext_i32_i64(hist_M_33326);
                    if (hist_M_33326 == 1) {
                        if (memblock_set_device(ctx,
                                                &defunc_1_map_res_subhistos_mem_33261,
                                                &mem_32102, "mem_32102") != 0)
                            return 1;
                    } else {
                        if (num_subhistos_33260 == (int64_t) 1) {
                            if (memblock_set_device(ctx,
                                                    &defunc_1_map_res_subhistos_mem_33261,
                                                    &mem_32102, "mem_32102") !=
                                0)
                                return 1;
                        } else {
                            if (memblock_alloc_device(ctx,
                                                      &defunc_1_map_res_subhistos_mem_33261,
                                                      sext_i32_i64(num_subhistos_33260) *
                                                      defunc_2_reduce_res_29171 *
                                                      (int64_t) 8,
                                                      "defunc_1_map_res_subhistos_mem_33261")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx,
                                                              defunc_1_map_res_subhistos_mem_33261,
                                                              num_subhistos_33260 *
                                                              defunc_2_reduce_res_29171,
                                                              (int64_t) 0) !=
                                0) {
                                err = 1;
                                goto cleanup;
                            }
                            {
                                cudaEvent_t *pevents = NULL;
                                
                                if (ctx->profiling && !ctx->profiling_paused) {
                                    pevents = cuda_get_events(&ctx->cuda,
                                                              &ctx->copy_dev_to_dev_runs,
                                                              &ctx->copy_dev_to_dev_total_runtime);
                                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                       0));
                                }
                                CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_33261.mem +
                                                                (int64_t) 0,
                                                                mem_32102.mem +
                                                                (int64_t) 0,
                                                                defunc_2_reduce_res_29171 *
                                                                (int64_t) 8));
                                if (pevents != NULL)
                                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                       0));
                            }
                        }
                    }
                    for (int32_t chk_i_33327 = 0; chk_i_33327 < hist_S_33321;
                         chk_i_33327++) {
                        int64_t hist_H_chk_33328 =
                                sdiv_up64(defunc_2_reduce_res_29171,
                                          sext_i32_i64(hist_S_33321));
                        CUdeviceptr kernel_arg_35872 = mem_32093.mem;
                        CUdeviceptr kernel_arg_35873 =
                                    defunc_1_map_res_subhistos_mem_33261.mem;
                        
                        if ((((((1 && num_groups_30657 != 0) && 1 != 0) && 1 !=
                               0) && seghist_group_sizze_30655 != 0) && 1 !=
                             0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = num_groups_30657;
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_35869[] = {&ctx->global_failure,
                                                         &numVert_28890,
                                                         &defunc_2_reduce_res_29171,
                                                         &num_groups_30657,
                                                         &num_subhistos_33260,
                                                         &chk_i_33327,
                                                         &hist_H_chk_33328,
                                                         &kernel_arg_35872,
                                                         &kernel_arg_35873};
                            int64_t time_start_35870 = 0, time_end_35871 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(ctx->log,
                                        "Launching %s with grid size (",
                                        "test_clusterWith.seghist_global_30660");
                                fprintf(ctx->log, "%ld",
                                        (long) num_groups_30657);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ") and block size (");
                                fprintf(ctx->log, "%ld",
                                        (long) seghist_group_sizze_30655);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ").\n");
                                time_start_35870 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->test_clusterWithziseghist_global_30660_runs,
                                                          &ctx->test_clusterWithziseghist_global_30660_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithziseghist_global_30660,
                                                                  grid[0],
                                                                  grid[1],
                                                                  grid[2],
                                                                  seghist_group_sizze_30655,
                                                                  1, 1, 0, NULL,
                                                                  kernel_args_35869,
                                                                  NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                                time_end_35871 = get_wall_time();
                                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                        "test_clusterWith.seghist_global_30660",
                                        time_end_35871 - time_start_35870);
                            }
                        }
                    }
                }
                if (num_subhistos_33260 == (int64_t) 1) {
                    if (memblock_set_device(ctx, &mem_32102,
                                            &defunc_1_map_res_subhistos_mem_33261,
                                            "defunc_1_map_res_subhistos_mem_33261") !=
                        0)
                        return 1;
                } else {
                    if (slt64(num_subhistos_33260 * (int64_t) 2,
                              seghist_group_sizze_30655)) {
                        int64_t segment_sizze_nonzzero_33340 =
                                smax64((int64_t) 1, num_subhistos_33260);
                        int64_t num_threads_33341 = num_groups_30657 *
                                seghist_group_sizze_30655;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegRed-small");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments",
                                    (long long) defunc_2_reduce_res_29171,
                                    '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size",
                                    (long long) num_subhistos_33260, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c",
                                    "segments_per_group",
                                    (long long) squot64(seghist_group_sizze_30655,
                                                        segment_sizze_nonzzero_33340),
                                    '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "required_groups",
                                    (long long) sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29171,
                                                                       squot64(seghist_group_sizze_30655,
                                                                               segment_sizze_nonzzero_33340))),
                                    '\n');
                        
                        unsigned int shared_sizze_35877 = (int64_t) 8 *
                                     seghist_group_sizze_30655;
                        CUdeviceptr kernel_arg_35879 = mem_32102.mem;
                        CUdeviceptr kernel_arg_35880 =
                                    defunc_1_map_res_subhistos_mem_33261.mem;
                        unsigned int shared_offset_35878 = 0;
                        
                        if ((((((1 && num_groups_30657 != 0) && 1 != 0) && 1 !=
                               0) && seghist_group_sizze_30655 != 0) && 1 !=
                             0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = num_groups_30657;
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_35874[] = {&ctx->global_failure,
                                                         &shared_offset_35878,
                                                         &defunc_2_reduce_res_29171,
                                                         &num_groups_30657,
                                                         &num_subhistos_33260,
                                                         &segment_sizze_nonzzero_33340,
                                                         &kernel_arg_35879,
                                                         &kernel_arg_35880};
                            int64_t time_start_35875 = 0, time_end_35876 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(ctx->log,
                                        "Launching %s with grid size (",
                                        "test_clusterWith.segred_small_33339");
                                fprintf(ctx->log, "%ld",
                                        (long) num_groups_30657);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ") and block size (");
                                fprintf(ctx->log, "%ld",
                                        (long) seghist_group_sizze_30655);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ").\n");
                                time_start_35875 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->test_clusterWithzisegred_small_33339_runs,
                                                          &ctx->test_clusterWithzisegred_small_33339_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_small_33339,
                                                                  grid[0],
                                                                  grid[1],
                                                                  grid[2],
                                                                  seghist_group_sizze_30655,
                                                                  1, 1, 0 +
                                                                  (shared_sizze_35877 +
                                                                   (8 -
                                                                    shared_sizze_35877 %
                                                                    8) % 8),
                                                                  NULL,
                                                                  kernel_args_35874,
                                                                  NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                                time_end_35876 = get_wall_time();
                                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                        "test_clusterWith.segred_small_33339",
                                        time_end_35876 - time_start_35875);
                            }
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                    } else {
                        int64_t groups_per_segment_33361 =
                                sdiv_up64(num_groups_30657, smax64((int64_t) 1,
                                                                   defunc_2_reduce_res_29171));
                        int64_t elements_per_thread_33362 =
                                sdiv_up64(num_subhistos_33260,
                                          seghist_group_sizze_30655 *
                                          groups_per_segment_33361);
                        int64_t virt_num_groups_33363 =
                                groups_per_segment_33361 *
                                defunc_2_reduce_res_29171;
                        int64_t num_threads_33364 = num_groups_30657 *
                                seghist_group_sizze_30655;
                        int64_t threads_per_segment_33365 =
                                groups_per_segment_33361 *
                                seghist_group_sizze_30655;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegRed-large");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments",
                                    (long long) defunc_2_reduce_res_29171,
                                    '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size",
                                    (long long) num_subhistos_33260, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "virt_num_groups",
                                    (long long) virt_num_groups_33363, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_groups",
                                    (long long) num_groups_30657, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "group_size",
                                    (long long) seghist_group_sizze_30655,
                                    '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "elems_per_thread",
                                    (long long) elements_per_thread_33362,
                                    '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c",
                                    "groups_per_segment",
                                    (long long) groups_per_segment_33361, '\n');
                        
                        struct memblock_device group_res_arr_mem_33366;
                        
                        group_res_arr_mem_33366.references = NULL;
                        if (memblock_alloc_device(ctx, &group_res_arr_mem_33366,
                                                  (int64_t) 8 *
                                                  (seghist_group_sizze_30655 *
                                                   virt_num_groups_33363),
                                                  "group_res_arr_mem_33366")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device
                        test_clusterWithzicounter_mem_33368 =
                        ctx->test_clusterWithzicounter_mem_33368;
                        unsigned int shared_sizze_35885 = 1;
                        unsigned int shared_sizze_35887 = (int64_t) 8 *
                                     seghist_group_sizze_30655;
                        CUdeviceptr kernel_arg_35889 = mem_32102.mem;
                        CUdeviceptr kernel_arg_35890 =
                                    defunc_1_map_res_subhistos_mem_33261.mem;
                        CUdeviceptr kernel_arg_35891 =
                                    group_res_arr_mem_33366.mem;
                        CUdeviceptr kernel_arg_35892 =
                                    test_clusterWithzicounter_mem_33368.mem;
                        unsigned int shared_offset_35886 = 0;
                        unsigned int shared_offset_35888 = 0 +
                                     (shared_sizze_35885 + (8 -
                                                            shared_sizze_35885 %
                                                            8) % 8);
                        
                        if ((((((1 && num_groups_30657 != 0) && 1 != 0) && 1 !=
                               0) && seghist_group_sizze_30655 != 0) && 1 !=
                             0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = num_groups_30657;
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_35882[] = {&ctx->global_failure,
                                                         &shared_offset_35886,
                                                         &shared_offset_35888,
                                                         &defunc_2_reduce_res_29171,
                                                         &num_groups_30657,
                                                         &num_subhistos_33260,
                                                         &groups_per_segment_33361,
                                                         &elements_per_thread_33362,
                                                         &virt_num_groups_33363,
                                                         &threads_per_segment_33365,
                                                         &kernel_arg_35889,
                                                         &kernel_arg_35890,
                                                         &kernel_arg_35891,
                                                         &kernel_arg_35892};
                            int64_t time_start_35883 = 0, time_end_35884 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(ctx->log,
                                        "Launching %s with grid size (",
                                        "test_clusterWith.segred_large_33339");
                                fprintf(ctx->log, "%ld",
                                        (long) num_groups_30657);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ") and block size (");
                                fprintf(ctx->log, "%ld",
                                        (long) seghist_group_sizze_30655);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ", ");
                                fprintf(ctx->log, "%ld", (long) 1);
                                fprintf(ctx->log, ").\n");
                                time_start_35883 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->test_clusterWithzisegred_large_33339_runs,
                                                          &ctx->test_clusterWithzisegred_large_33339_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_large_33339,
                                                                  grid[0],
                                                                  grid[1],
                                                                  grid[2],
                                                                  seghist_group_sizze_30655,
                                                                  1, 1, 0 +
                                                                  (shared_sizze_35885 +
                                                                   (8 -
                                                                    shared_sizze_35885 %
                                                                    8) % 8) +
                                                                  (shared_sizze_35887 +
                                                                   (8 -
                                                                    shared_sizze_35887 %
                                                                    8) % 8),
                                                                  NULL,
                                                                  kernel_args_35882,
                                                                  NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                                time_end_35884 = get_wall_time();
                                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                        "test_clusterWith.segred_large_33339",
                                        time_end_35884 - time_start_35883);
                            }
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                        if (memblock_unref_device(ctx, &group_res_arr_mem_33366,
                                                  "group_res_arr_mem_33366") !=
                            0)
                            return 1;
                    }
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t num_groups_30672;
            int32_t max_num_groups_33400;
            
            max_num_groups_33400 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30671;
            num_groups_30672 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(defunc_2_reduce_res_29171,
                                                                    segscan_group_sizze_30670),
                                                          sext_i32_i64(max_num_groups_33400))));
            
            struct memblock_device mem_32106;
            
            mem_32106.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32106,
                                      defunc_2_reduce_res_29171, "mem_32106")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32108;
            
            mem_32108.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32108, bytes_32101,
                                      "mem_32108")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, defunc_2_reduce_res_29171)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_33401;
                
                numThreads_33401 = sdiv_up64(defunc_2_reduce_res_29171,
                                             segscan_group_sizze_30670 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30670;
                
                int64_t numGroups_33402;
                
                numGroups_33402 = sdiv_up64(defunc_2_reduce_res_29171,
                                            segscan_group_sizze_30670 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_33403 =
                                       ctx->test_clusterWithziid_counter_mem_33403;
                struct memblock_device status_flags_mem_33405;
                
                status_flags_mem_33405.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_33405,
                                          numGroups_33402,
                                          "status_flags_mem_33405")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33407;
                
                aggregates_mem_33407.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33407,
                                          numGroups_33402,
                                          "aggregates_mem_33407")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33409;
                
                incprefixes_mem_33409.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33409,
                                          numGroups_33402,
                                          "incprefixes_mem_33409")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33411;
                
                aggregates_mem_33411.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33411,
                                          (int64_t) 8 * numGroups_33402,
                                          "aggregates_mem_33411")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33413;
                
                incprefixes_mem_33413.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33413,
                                          (int64_t) 8 * numGroups_33402,
                                          "incprefixes_mem_33413")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33405,
                                                 numGroups_33402, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_35897 = smax64(smax64((int64_t) 320,
                                                                sdiv_up64(segscan_group_sizze_30670,
                                                                          (int64_t) 8) *
                                                                (int64_t) 8 +
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30670),
                                                         smax64((int64_t) 9 *
                                                                segscan_group_sizze_30670,
                                                                (int64_t) 9 *
                                                                segscan_group_sizze_30670 *
                                                                (int64_t) 8));
                CUdeviceptr kernel_arg_35899 = mem_32102.mem;
                CUdeviceptr kernel_arg_35900 = mem_32106.mem;
                CUdeviceptr kernel_arg_35901 = mem_32108.mem;
                CUdeviceptr kernel_arg_35902 =
                            test_clusterWithziid_counter_mem_33403.mem;
                CUdeviceptr kernel_arg_35903 = status_flags_mem_33405.mem;
                CUdeviceptr kernel_arg_35904 = aggregates_mem_33407.mem;
                CUdeviceptr kernel_arg_35905 = incprefixes_mem_33409.mem;
                CUdeviceptr kernel_arg_35906 = aggregates_mem_33411.mem;
                CUdeviceptr kernel_arg_35907 = incprefixes_mem_33413.mem;
                unsigned int shared_offset_35898 = 0;
                
                if ((((((1 && sdiv_up64(defunc_2_reduce_res_29171,
                                        segscan_group_sizze_30670 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30670 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29171,
                                              segscan_group_sizze_30670 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35894[] = {&ctx->global_failure,
                                                 &shared_offset_35898,
                                                 &defunc_2_reduce_res_29171,
                                                 &kernel_arg_35899,
                                                 &kernel_arg_35900,
                                                 &kernel_arg_35901,
                                                 &kernel_arg_35902,
                                                 &kernel_arg_35903,
                                                 &kernel_arg_35904,
                                                 &kernel_arg_35905,
                                                 &kernel_arg_35906,
                                                 &kernel_arg_35907};
                    int64_t time_start_35895 = 0, time_end_35896 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30675");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(defunc_2_reduce_res_29171,
                                                 segscan_group_sizze_30670 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30670);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35895 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30675_runs,
                                                  &ctx->test_clusterWithzisegscan_30675_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30675,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30670,
                                                          1, 1, 0 +
                                                          (shared_sizze_35897 +
                                                           (8 -
                                                            shared_sizze_35897 %
                                                            8) % 8), NULL,
                                                          kernel_args_35894,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35896 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30675",
                                time_end_35896 - time_start_35895);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_33413,
                                          "incprefixes_mem_33413") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33411,
                                          "aggregates_mem_33411") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &incprefixes_mem_33409,
                                          "incprefixes_mem_33409") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33407,
                                          "aggregates_mem_33407") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_33405,
                                          "status_flags_mem_33405") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                return 1;
            
            int64_t num_groups_30680;
            int32_t max_num_groups_33533;
            
            max_num_groups_33533 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30679;
            num_groups_30680 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(defunc_2_reduce_res_29171,
                                                                    segscan_group_sizze_30678),
                                                          sext_i32_i64(max_num_groups_33533))));
            
            struct memblock_device mem_32111;
            
            mem_32111.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32111,
                                      defunc_2_reduce_res_29171, "mem_32111")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32113;
            
            mem_32113.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32113, bytes_32101,
                                      "mem_32113")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, defunc_2_reduce_res_29171)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_33534;
                
                numThreads_33534 = sdiv_up64(defunc_2_reduce_res_29171,
                                             segscan_group_sizze_30678 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30678;
                
                int64_t numGroups_33535;
                
                numGroups_33535 = sdiv_up64(defunc_2_reduce_res_29171,
                                            segscan_group_sizze_30678 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_33536 =
                                       ctx->test_clusterWithziid_counter_mem_33536;
                struct memblock_device status_flags_mem_33538;
                
                status_flags_mem_33538.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_33538,
                                          numGroups_33535,
                                          "status_flags_mem_33538")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33540;
                
                aggregates_mem_33540.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33540,
                                          numGroups_33535,
                                          "aggregates_mem_33540")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33542;
                
                incprefixes_mem_33542.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33542,
                                          numGroups_33535,
                                          "incprefixes_mem_33542")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33544;
                
                aggregates_mem_33544.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33544,
                                          (int64_t) 8 * numGroups_33535,
                                          "aggregates_mem_33544")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33546;
                
                incprefixes_mem_33546.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33546,
                                          (int64_t) 8 * numGroups_33535,
                                          "incprefixes_mem_33546")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33538,
                                                 numGroups_33535, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_35912 = smax64(smax64((int64_t) 320,
                                                                sdiv_up64(segscan_group_sizze_30678,
                                                                          (int64_t) 8) *
                                                                (int64_t) 8 +
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30678),
                                                         smax64((int64_t) 9 *
                                                                segscan_group_sizze_30678,
                                                                (int64_t) 9 *
                                                                segscan_group_sizze_30678 *
                                                                (int64_t) 8));
                CUdeviceptr kernel_arg_35914 = mem_32108.mem;
                CUdeviceptr kernel_arg_35915 = mem_32111.mem;
                CUdeviceptr kernel_arg_35916 = mem_32113.mem;
                CUdeviceptr kernel_arg_35917 =
                            test_clusterWithziid_counter_mem_33536.mem;
                CUdeviceptr kernel_arg_35918 = status_flags_mem_33538.mem;
                CUdeviceptr kernel_arg_35919 = aggregates_mem_33540.mem;
                CUdeviceptr kernel_arg_35920 = incprefixes_mem_33542.mem;
                CUdeviceptr kernel_arg_35921 = aggregates_mem_33544.mem;
                CUdeviceptr kernel_arg_35922 = incprefixes_mem_33546.mem;
                unsigned int shared_offset_35913 = 0;
                
                if ((((((1 && sdiv_up64(defunc_2_reduce_res_29171,
                                        segscan_group_sizze_30678 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30678 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29171,
                                              segscan_group_sizze_30678 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35909[] = {&ctx->global_failure,
                                                 &shared_offset_35913,
                                                 &defunc_2_reduce_res_29171,
                                                 &kernel_arg_35914,
                                                 &kernel_arg_35915,
                                                 &kernel_arg_35916,
                                                 &kernel_arg_35917,
                                                 &kernel_arg_35918,
                                                 &kernel_arg_35919,
                                                 &kernel_arg_35920,
                                                 &kernel_arg_35921,
                                                 &kernel_arg_35922};
                    int64_t time_start_35910 = 0, time_end_35911 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30683");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(defunc_2_reduce_res_29171,
                                                 segscan_group_sizze_30678 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30678);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35910 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30683_runs,
                                                  &ctx->test_clusterWithzisegscan_30683_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30683,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30678,
                                                          1, 1, 0 +
                                                          (shared_sizze_35912 +
                                                           (8 -
                                                            shared_sizze_35912 %
                                                            8) % 8), NULL,
                                                          kernel_args_35909,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35911 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30683",
                                time_end_35911 - time_start_35910);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_33546,
                                          "incprefixes_mem_33546") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33544,
                                          "aggregates_mem_33544") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &incprefixes_mem_33542,
                                          "incprefixes_mem_33542") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33540,
                                          "aggregates_mem_33540") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_33538,
                                          "status_flags_mem_33538") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                return 1;
            
            int64_t segmap_usable_groups_30741 =
                    sdiv_up64(defunc_2_reduce_res_29171,
                              segmap_group_sizze_30740);
            struct memblock_device mem_32116;
            
            mem_32116.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32116, bytes_32101,
                                      "mem_32116")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t bytes_32117 = (int64_t) 4 * defunc_2_reduce_res_29171;
            struct memblock_device mem_32118;
            
            mem_32118.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32118, bytes_32117,
                                      "mem_32118")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32120;
            
            mem_32120.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32120, bytes_32117,
                                      "mem_32120")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_35926 = mem_param_32074.mem;
            CUdeviceptr kernel_arg_35927 = mem_param_32079.mem;
            CUdeviceptr kernel_arg_35928 = mem_32097.mem;
            CUdeviceptr kernel_arg_35929 = mem_32108.mem;
            CUdeviceptr kernel_arg_35930 = mem_32113.mem;
            CUdeviceptr kernel_arg_35931 = mem_32116.mem;
            CUdeviceptr kernel_arg_35932 = mem_32118.mem;
            CUdeviceptr kernel_arg_35933 = mem_32120.mem;
            
            if ((((((1 && segmap_usable_groups_30741 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30740 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30741;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35923[] = {&ctx->global_failure,
                                             &ctx->failure_is_an_option,
                                             &ctx->global_failure_args,
                                             &numVert_28890, &maxSizze_29114,
                                             &defunc_2_reduce_res_29171,
                                             &kernel_arg_35926,
                                             &kernel_arg_35927,
                                             &kernel_arg_35928,
                                             &kernel_arg_35929,
                                             &kernel_arg_35930,
                                             &kernel_arg_35931,
                                             &kernel_arg_35932,
                                             &kernel_arg_35933};
                int64_t time_start_35924 = 0, time_end_35925 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30685");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30741);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30740);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35924 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30685_runs,
                                              &ctx->test_clusterWithzisegmap_30685_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30685,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30740,
                                                      1, 1, 0, NULL,
                                                      kernel_args_35923, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35925 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30685", time_end_35925 -
                            time_start_35924);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                return 1;
            
            struct memblock_device mem_32122;
            
            mem_32122.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32122, bytes_32101,
                                      "mem_32122")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_32122,
                                         defunc_2_reduce_res_29171, (int64_t) 0,
                                         (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool cond_29288 = defunc_2_reduce_res_29171 == (int64_t) 0;
            int32_t iters_29289;
            
            if (cond_29288) {
                iters_29289 = 0;
            } else {
                iters_29289 = 32;
            }
            
            bool loop_nonempty_29290 = slt32(0, iters_29289);
            int64_t i_29291 = sub64(defunc_2_reduce_res_29171, (int64_t) 1);
            bool x_29292 = sle64((int64_t) 0, i_29291);
            bool y_29293 = slt64(i_29291, defunc_2_reduce_res_29171);
            bool bounds_check_29294 = x_29292 && y_29293;
            bool loop_not_taken_29295 = !loop_nonempty_29290;
            bool protect_assert_disj_29296 = bounds_check_29294 ||
                 loop_not_taken_29295;
            bool index_certs_29297;
            
            if (!protect_assert_disj_29296) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", i_29291,
                              "] out of bounds for array of shape [",
                              defunc_2_reduce_res_29171, "].",
                              "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  /prelude/functional.fut:9:42-44\n   #7  src/cluster.fut:154:23-155:69\n   #8  src/cluster.fut:170:14-27\n   #9  src/cluster.fut:176:27-76\n   #10 src/cluster_test.fut:42:9-31\n   #11 src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            
            int64_t num_groups_30798;
            int32_t max_num_groups_33671;
            
            max_num_groups_33671 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30797;
            num_groups_30798 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(defunc_2_reduce_res_29171,
                                                                    segscan_group_sizze_30796),
                                                          sext_i32_i64(max_num_groups_33671))));
            
            int64_t segmap_usable_groups_30807 =
                    sdiv_up_safe64(defunc_2_reduce_res_29171,
                                   segmap_group_sizze_30806);
            struct memblock_device mem_32139;
            
            mem_32139.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32139, bytes_32101,
                                      "mem_32139")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32141;
            
            mem_32141.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32141, bytes_32101,
                                      "mem_32141")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32143;
            
            mem_32143.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32143, bytes_32101,
                                      "mem_32143")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32145;
            
            mem_32145.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32145, bytes_32101,
                                      "mem_32145")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32147;
            
            mem_32147.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32147, bytes_32117,
                                      "mem_32147")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device defunc_0_f_res_mem_32161;
            
            defunc_0_f_res_mem_32161.references = NULL;
            
            struct memblock_device defunc_0_f_res_mem_32166;
            
            defunc_0_f_res_mem_32166.references = NULL;
            
            struct memblock_device mem_param_32127;
            
            mem_param_32127.references = NULL;
            
            struct memblock_device mem_param_32132;
            
            mem_param_32132.references = NULL;
            if (memblock_set_device(ctx, &mem_param_32127, &mem_32116,
                                    "mem_32116") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_32132, &mem_32122,
                                    "mem_32122") != 0)
                return 1;
            for (int32_t i_29300 = 0; i_29300 < iters_29289; i_29300++) {
                int32_t defunc_2_radix_sort_step_arg_29303 = mul32(2, i_29300);
                int32_t defunc_0_get_bit_arg_29304 = add32(1,
                                                           defunc_2_radix_sort_step_arg_29303);
                int64_t i32_res_29305 =
                        sext_i32_i64(defunc_0_get_bit_arg_29304);
                int64_t i32_res_29306 =
                        sext_i32_i64(defunc_2_radix_sort_step_arg_29303);
                
                if (slt64((int64_t) 0, defunc_2_reduce_res_29171)) {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegScan");
                    
                    int64_t numThreads_33676;
                    
                    numThreads_33676 = sdiv_up64(defunc_2_reduce_res_29171,
                                                 segscan_group_sizze_30796 *
                                                 (int64_t) 9) *
                        segscan_group_sizze_30796;
                    
                    int64_t numGroups_33677;
                    
                    numGroups_33677 = sdiv_up64(defunc_2_reduce_res_29171,
                                                segscan_group_sizze_30796 *
                                                (int64_t) 9);
                    
                    struct memblock_device
                    test_clusterWithziid_counter_mem_33678 =
                    ctx->test_clusterWithziid_counter_mem_33678;
                    struct memblock_device status_flags_mem_33680;
                    
                    status_flags_mem_33680.references = NULL;
                    if (memblock_alloc_device(ctx, &status_flags_mem_33680,
                                              numGroups_33677,
                                              "status_flags_mem_33680")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_33682;
                    
                    aggregates_mem_33682.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_33682,
                                              (int64_t) 8 * numGroups_33677,
                                              "aggregates_mem_33682")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_33684;
                    
                    incprefixes_mem_33684.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_33684,
                                              (int64_t) 8 * numGroups_33677,
                                              "incprefixes_mem_33684")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_33686;
                    
                    aggregates_mem_33686.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_33686,
                                              (int64_t) 8 * numGroups_33677,
                                              "aggregates_mem_33686")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_33688;
                    
                    incprefixes_mem_33688.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_33688,
                                              (int64_t) 8 * numGroups_33677,
                                              "incprefixes_mem_33688")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_33690;
                    
                    aggregates_mem_33690.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_33690,
                                              (int64_t) 8 * numGroups_33677,
                                              "aggregates_mem_33690")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_33692;
                    
                    incprefixes_mem_33692.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_33692,
                                              (int64_t) 8 * numGroups_33677,
                                              "incprefixes_mem_33692")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_33694;
                    
                    aggregates_mem_33694.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_33694,
                                              (int64_t) 8 * numGroups_33677,
                                              "aggregates_mem_33694")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_33696;
                    
                    incprefixes_mem_33696.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_33696,
                                              (int64_t) 8 * numGroups_33677,
                                              "incprefixes_mem_33696")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx,
                                                     status_flags_mem_33680,
                                                     numGroups_33677,
                                                     (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    unsigned int shared_sizze_35938 =
                                 smax64(smax64((int64_t) 1056,
                                               sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                             segscan_group_sizze_30796,
                                                                             (int64_t) 8) *
                                                                   (int64_t) 8 +
                                                                   (int64_t) 8 *
                                                                   segscan_group_sizze_30796,
                                                                   (int64_t) 8) *
                                                         (int64_t) 8 +
                                                         (int64_t) 8 *
                                                         segscan_group_sizze_30796,
                                                         (int64_t) 8) *
                                               (int64_t) 8 + (int64_t) 8 *
                                               segscan_group_sizze_30796),
                                        smax64(smax64(smax64((int64_t) 9 *
                                                             segscan_group_sizze_30796 *
                                                             (int64_t) 8,
                                                             (int64_t) 9 *
                                                             segscan_group_sizze_30796 *
                                                             (int64_t) 8),
                                                      (int64_t) 9 *
                                                      segscan_group_sizze_30796 *
                                                      (int64_t) 8),
                                               (int64_t) 9 *
                                               segscan_group_sizze_30796 *
                                               (int64_t) 8));
                    CUdeviceptr kernel_arg_35940 = mem_param_32127.mem;
                    CUdeviceptr kernel_arg_35941 = mem_32139.mem;
                    CUdeviceptr kernel_arg_35942 = mem_32141.mem;
                    CUdeviceptr kernel_arg_35943 = mem_32143.mem;
                    CUdeviceptr kernel_arg_35944 = mem_32145.mem;
                    CUdeviceptr kernel_arg_35945 = mem_32147.mem;
                    CUdeviceptr kernel_arg_35946 =
                                test_clusterWithziid_counter_mem_33678.mem;
                    CUdeviceptr kernel_arg_35947 = status_flags_mem_33680.mem;
                    CUdeviceptr kernel_arg_35948 = aggregates_mem_33682.mem;
                    CUdeviceptr kernel_arg_35949 = incprefixes_mem_33684.mem;
                    CUdeviceptr kernel_arg_35950 = aggregates_mem_33686.mem;
                    CUdeviceptr kernel_arg_35951 = incprefixes_mem_33688.mem;
                    CUdeviceptr kernel_arg_35952 = aggregates_mem_33690.mem;
                    CUdeviceptr kernel_arg_35953 = incprefixes_mem_33692.mem;
                    CUdeviceptr kernel_arg_35954 = aggregates_mem_33694.mem;
                    CUdeviceptr kernel_arg_35955 = incprefixes_mem_33696.mem;
                    unsigned int shared_offset_35939 = 0;
                    
                    if ((((((1 && sdiv_up64(defunc_2_reduce_res_29171,
                                            segscan_group_sizze_30796 *
                                            (int64_t) 9) != 0) && 1 != 0) &&
                           1 != 0) && segscan_group_sizze_30796 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29171,
                                                  segscan_group_sizze_30796 *
                                                  (int64_t) 9);
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_35935[] = {&ctx->global_failure,
                                                     &shared_offset_35939,
                                                     &defunc_2_reduce_res_29171,
                                                     &i32_res_29305,
                                                     &i32_res_29306,
                                                     &kernel_arg_35940,
                                                     &kernel_arg_35941,
                                                     &kernel_arg_35942,
                                                     &kernel_arg_35943,
                                                     &kernel_arg_35944,
                                                     &kernel_arg_35945,
                                                     &kernel_arg_35946,
                                                     &kernel_arg_35947,
                                                     &kernel_arg_35948,
                                                     &kernel_arg_35949,
                                                     &kernel_arg_35950,
                                                     &kernel_arg_35951,
                                                     &kernel_arg_35952,
                                                     &kernel_arg_35953,
                                                     &kernel_arg_35954,
                                                     &kernel_arg_35955};
                        int64_t time_start_35936 = 0, time_end_35937 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(ctx->log, "Launching %s with grid size (",
                                    "test_clusterWith.segscan_30801");
                            fprintf(ctx->log, "%ld",
                                    (long) sdiv_up64(defunc_2_reduce_res_29171,
                                                     segscan_group_sizze_30796 *
                                                     (int64_t) 9));
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ") and block size (");
                            fprintf(ctx->log, "%ld",
                                    (long) segscan_group_sizze_30796);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ").\n");
                            time_start_35936 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->test_clusterWithzisegscan_30801_runs,
                                                      &ctx->test_clusterWithzisegscan_30801_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30801,
                                                              grid[0], grid[1],
                                                              grid[2],
                                                              segscan_group_sizze_30796,
                                                              1, 1, 0 +
                                                              (shared_sizze_35938 +
                                                               (8 -
                                                                shared_sizze_35938 %
                                                                8) % 8), NULL,
                                                              kernel_args_35935,
                                                              NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                            time_end_35937 = get_wall_time();
                            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                    "test_clusterWith.segscan_30801",
                                    time_end_35937 - time_start_35936);
                        }
                    }
                    if (memblock_unref_device(ctx, &incprefixes_mem_33696,
                                              "incprefixes_mem_33696") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_33694,
                                              "aggregates_mem_33694") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_33692,
                                              "incprefixes_mem_33692") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_33690,
                                              "aggregates_mem_33690") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_33688,
                                              "incprefixes_mem_33688") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_33686,
                                              "aggregates_mem_33686") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_33684,
                                              "incprefixes_mem_33684") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_33682,
                                              "aggregates_mem_33682") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &status_flags_mem_33680,
                                              "status_flags_mem_33680") != 0)
                        return 1;
                }
                
                int64_t read_res_35956;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35956,
                                                        mem_32139.mem +
                                                        i_29291 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t last_res_29361 = read_res_35956;
                int64_t read_res_35957;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35957,
                                                        mem_32141.mem +
                                                        i_29291 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t last_res_29362 = read_res_35957;
                int64_t read_res_35958;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_35958,
                                                        mem_32143.mem +
                                                        i_29291 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t last_res_29363 = read_res_35958;
                struct memblock_device mem_32149;
                
                mem_32149.references = NULL;
                if (memblock_alloc_device(ctx, &mem_32149, bytes_32101,
                                          "mem_32149")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_dev_to_dev_runs,
                                                  &ctx->copy_dev_to_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32149.mem + (int64_t) 0,
                                                    mem_param_32127.mem +
                                                    (int64_t) 0,
                                                    defunc_2_reduce_res_29171 *
                                                    (int64_t) 8));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                
                struct memblock_device mem_32151;
                
                mem_32151.references = NULL;
                if (memblock_alloc_device(ctx, &mem_32151, bytes_32101,
                                          "mem_32151")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_dev_to_dev_runs,
                                                  &ctx->copy_dev_to_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32151.mem + (int64_t) 0,
                                                    mem_param_32132.mem +
                                                    (int64_t) 0,
                                                    defunc_2_reduce_res_29171 *
                                                    (int64_t) 8));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_35962 = mem_param_32127.mem;
                CUdeviceptr kernel_arg_35963 = mem_param_32132.mem;
                CUdeviceptr kernel_arg_35964 = mem_32139.mem;
                CUdeviceptr kernel_arg_35965 = mem_32141.mem;
                CUdeviceptr kernel_arg_35966 = mem_32143.mem;
                CUdeviceptr kernel_arg_35967 = mem_32145.mem;
                CUdeviceptr kernel_arg_35968 = mem_32147.mem;
                CUdeviceptr kernel_arg_35969 = mem_32149.mem;
                CUdeviceptr kernel_arg_35970 = mem_32151.mem;
                
                if ((((((1 && segmap_usable_groups_30807 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_30806 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_30807;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35959[] = {&ctx->global_failure,
                                                 &defunc_2_reduce_res_29171,
                                                 &last_res_29361,
                                                 &last_res_29362,
                                                 &last_res_29363,
                                                 &kernel_arg_35962,
                                                 &kernel_arg_35963,
                                                 &kernel_arg_35964,
                                                 &kernel_arg_35965,
                                                 &kernel_arg_35966,
                                                 &kernel_arg_35967,
                                                 &kernel_arg_35968,
                                                 &kernel_arg_35969,
                                                 &kernel_arg_35970};
                    int64_t time_start_35960 = 0, time_end_35961 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segmap_30803");
                        fprintf(ctx->log, "%ld",
                                (long) segmap_usable_groups_30807);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segmap_group_sizze_30806);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35960 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegmap_30803_runs,
                                                  &ctx->test_clusterWithzisegmap_30803_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30803,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segmap_group_sizze_30806,
                                                          1, 1, 0, NULL,
                                                          kernel_args_35959,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35961 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segmap_30803",
                                time_end_35961 - time_start_35960);
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                struct memblock_device mem_param_tmp_33672;
                
                mem_param_tmp_33672.references = NULL;
                if (memblock_set_device(ctx, &mem_param_tmp_33672, &mem_32149,
                                        "mem_32149") != 0)
                    return 1;
                
                struct memblock_device mem_param_tmp_33673;
                
                mem_param_tmp_33673.references = NULL;
                if (memblock_set_device(ctx, &mem_param_tmp_33673, &mem_32151,
                                        "mem_32151") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_32127,
                                        &mem_param_tmp_33672,
                                        "mem_param_tmp_33672") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_32132,
                                        &mem_param_tmp_33673,
                                        "mem_param_tmp_33673") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_tmp_33673,
                                          "mem_param_tmp_33673") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_tmp_33672,
                                          "mem_param_tmp_33672") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32151, "mem_32151") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32149, "mem_32149") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &defunc_0_f_res_mem_32161,
                                    &mem_param_32127, "mem_param_32127") != 0)
                return 1;
            if (memblock_set_device(ctx, &defunc_0_f_res_mem_32166,
                                    &mem_param_32132, "mem_param_32132") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                return 1;
            
            int64_t segmap_usable_groups_30827 =
                    sdiv_up64(defunc_2_reduce_res_29171,
                              segmap_group_sizze_30826);
            struct memblock_device mem_32169;
            
            mem_32169.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32169, bytes_32101,
                                      "mem_32169")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32171;
            
            mem_32171.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32171, bytes_32117,
                                      "mem_32171")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32173;
            
            mem_32173.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32173, bytes_32117,
                                      "mem_32173")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_35974 = mem_32118.mem;
            CUdeviceptr kernel_arg_35975 = mem_32120.mem;
            CUdeviceptr kernel_arg_35976 = defunc_0_f_res_mem_32166.mem;
            CUdeviceptr kernel_arg_35977 = mem_32169.mem;
            CUdeviceptr kernel_arg_35978 = mem_32171.mem;
            CUdeviceptr kernel_arg_35979 = mem_32173.mem;
            
            if ((((((1 && segmap_usable_groups_30827 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30826 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30827;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35971[] = {&ctx->global_failure,
                                             &ctx->failure_is_an_option,
                                             &ctx->global_failure_args,
                                             &defunc_2_reduce_res_29171,
                                             &kernel_arg_35974,
                                             &kernel_arg_35975,
                                             &kernel_arg_35976,
                                             &kernel_arg_35977,
                                             &kernel_arg_35978,
                                             &kernel_arg_35979};
                int64_t time_start_35972 = 0, time_end_35973 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30809");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30827);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30826);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35972 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30809_runs,
                                              &ctx->test_clusterWithzisegmap_30809_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30809,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30826,
                                                      1, 1, 0, NULL,
                                                      kernel_args_35971, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35973 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30809", time_end_35973 -
                            time_start_35972);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                      "defunc_0_f_res_mem_32166") != 0)
                return 1;
            
            int64_t segmap_usable_groups_30854 =
                    sdiv_up64(defunc_2_reduce_res_29171,
                              segmap_group_sizze_30853);
            struct memblock_device mem_32176;
            
            mem_32176.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32176,
                                      defunc_2_reduce_res_29171, "mem_32176")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_35983 = mem_32169.mem;
            CUdeviceptr kernel_arg_35984 = mem_32176.mem;
            
            if ((((((1 && segmap_usable_groups_30854 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30853 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30854;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_35980[] = {&ctx->global_failure,
                                             &defunc_2_reduce_res_29171,
                                             &kernel_arg_35983,
                                             &kernel_arg_35984};
                int64_t time_start_35981 = 0, time_end_35982 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30843");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30854);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30853);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_35981 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30843_runs,
                                              &ctx->test_clusterWithzisegmap_30843_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30843,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30853,
                                                      1, 1, 0, NULL,
                                                      kernel_args_35980, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_35982 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30843", time_end_35982 -
                            time_start_35981);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                return 1;
            
            bool y_29411 = slt64((int64_t) 0, defunc_2_reduce_res_29171);
            bool index_certs_29412;
            
            if (!y_29411) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", (int64_t) 0,
                              "] out of bounds for array of shape [",
                              defunc_2_reduce_res_29171, "].",
                              "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:27:15-37\n   #2  /prelude/functional.fut:9:42-44\n   #3  src/cluster.fut:154:23-156:40\n   #4  src/cluster.fut:170:14-27\n   #5  src/cluster.fut:176:27-76\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            {
                bool write_tmp_35985 = 1;
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_to_dev_runs,
                                              &ctx->copy_scalar_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32176.mem +
                                                    (int64_t) 0 * sizeof(bool),
                                                    &write_tmp_35985,
                                                    sizeof(bool)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            
            int64_t num_groups_30864;
            int32_t max_num_groups_33904;
            
            max_num_groups_33904 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30863;
            num_groups_30864 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(defunc_2_reduce_res_29171,
                                                                    segscan_group_sizze_30862),
                                                          sext_i32_i64(max_num_groups_33904))));
            
            struct memblock_device mem_32179;
            
            mem_32179.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32179,
                                      defunc_2_reduce_res_29171, "mem_32179")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32181;
            
            mem_32181.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32181, bytes_32101,
                                      "mem_32181")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, defunc_2_reduce_res_29171)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_33905;
                
                numThreads_33905 = sdiv_up64(defunc_2_reduce_res_29171,
                                             segscan_group_sizze_30862 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30862;
                
                int64_t numGroups_33906;
                
                numGroups_33906 = sdiv_up64(defunc_2_reduce_res_29171,
                                            segscan_group_sizze_30862 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_33907 =
                                       ctx->test_clusterWithziid_counter_mem_33907;
                struct memblock_device status_flags_mem_33909;
                
                status_flags_mem_33909.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_33909,
                                          numGroups_33906,
                                          "status_flags_mem_33909")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33911;
                
                aggregates_mem_33911.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33911,
                                          numGroups_33906,
                                          "aggregates_mem_33911")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33913;
                
                incprefixes_mem_33913.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33913,
                                          numGroups_33906,
                                          "incprefixes_mem_33913")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_33915;
                
                aggregates_mem_33915.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_33915,
                                          (int64_t) 8 * numGroups_33906,
                                          "aggregates_mem_33915")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_33917;
                
                incprefixes_mem_33917.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_33917,
                                          (int64_t) 8 * numGroups_33906,
                                          "incprefixes_mem_33917")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_33909,
                                                 numGroups_33906, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_35990 = smax64(smax64((int64_t) 320,
                                                                sdiv_up64(segscan_group_sizze_30862,
                                                                          (int64_t) 8) *
                                                                (int64_t) 8 +
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30862),
                                                         smax64((int64_t) 9 *
                                                                segscan_group_sizze_30862,
                                                                (int64_t) 9 *
                                                                segscan_group_sizze_30862 *
                                                                (int64_t) 8));
                CUdeviceptr kernel_arg_35992 = mem_32176.mem;
                CUdeviceptr kernel_arg_35993 = mem_32179.mem;
                CUdeviceptr kernel_arg_35994 = mem_32181.mem;
                CUdeviceptr kernel_arg_35995 =
                            test_clusterWithziid_counter_mem_33907.mem;
                CUdeviceptr kernel_arg_35996 = status_flags_mem_33909.mem;
                CUdeviceptr kernel_arg_35997 = aggregates_mem_33911.mem;
                CUdeviceptr kernel_arg_35998 = incprefixes_mem_33913.mem;
                CUdeviceptr kernel_arg_35999 = aggregates_mem_33915.mem;
                CUdeviceptr kernel_arg_36000 = incprefixes_mem_33917.mem;
                unsigned int shared_offset_35991 = 0;
                
                if ((((((1 && sdiv_up64(defunc_2_reduce_res_29171,
                                        segscan_group_sizze_30862 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30862 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29171,
                                              segscan_group_sizze_30862 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_35987[] = {&ctx->global_failure,
                                                 &shared_offset_35991,
                                                 &defunc_2_reduce_res_29171,
                                                 &kernel_arg_35992,
                                                 &kernel_arg_35993,
                                                 &kernel_arg_35994,
                                                 &kernel_arg_35995,
                                                 &kernel_arg_35996,
                                                 &kernel_arg_35997,
                                                 &kernel_arg_35998,
                                                 &kernel_arg_35999,
                                                 &kernel_arg_36000};
                    int64_t time_start_35988 = 0, time_end_35989 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30867");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(defunc_2_reduce_res_29171,
                                                 segscan_group_sizze_30862 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30862);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_35988 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30867_runs,
                                                  &ctx->test_clusterWithzisegscan_30867_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30867,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30862,
                                                          1, 1, 0 +
                                                          (shared_sizze_35990 +
                                                           (8 -
                                                            shared_sizze_35990 %
                                                            8) % 8), NULL,
                                                          kernel_args_35987,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_35989 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30867",
                                time_end_35989 - time_start_35988);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_33917,
                                          "incprefixes_mem_33917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33915,
                                          "aggregates_mem_33915") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &incprefixes_mem_33913,
                                          "incprefixes_mem_33913") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_33911,
                                          "aggregates_mem_33911") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_33909,
                                          "status_flags_mem_33909") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                return 1;
            
            int64_t num_groups_30872;
            int32_t max_num_groups_34037;
            
            max_num_groups_34037 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30871;
            num_groups_30872 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(defunc_2_reduce_res_29171,
                                                                    segscan_group_sizze_30870),
                                                          sext_i32_i64(max_num_groups_34037))));
            
            struct memblock_device mem_32184;
            
            mem_32184.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32184, bytes_32101,
                                      "mem_32184")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, defunc_2_reduce_res_29171)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_34038;
                
                numThreads_34038 = sdiv_up64(defunc_2_reduce_res_29171,
                                             segscan_group_sizze_30870 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30870;
                
                int64_t numGroups_34039;
                
                numGroups_34039 = sdiv_up64(defunc_2_reduce_res_29171,
                                            segscan_group_sizze_30870 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_34040 =
                                       ctx->test_clusterWithziid_counter_mem_34040;
                struct memblock_device status_flags_mem_34042;
                
                status_flags_mem_34042.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_34042,
                                          numGroups_34039,
                                          "status_flags_mem_34042")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34044;
                
                aggregates_mem_34044.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34044,
                                          (int64_t) 8 * numGroups_34039,
                                          "aggregates_mem_34044")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34046;
                
                incprefixes_mem_34046.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34046,
                                          (int64_t) 8 * numGroups_34039,
                                          "incprefixes_mem_34046")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34042,
                                                 numGroups_34039, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_36005 = smax64(smax64((int64_t) 288,
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30870),
                                                         (int64_t) 9 *
                                                         segscan_group_sizze_30870 *
                                                         (int64_t) 8);
                CUdeviceptr kernel_arg_36007 = mem_32176.mem;
                CUdeviceptr kernel_arg_36008 = mem_32184.mem;
                CUdeviceptr kernel_arg_36009 =
                            test_clusterWithziid_counter_mem_34040.mem;
                CUdeviceptr kernel_arg_36010 = status_flags_mem_34042.mem;
                CUdeviceptr kernel_arg_36011 = aggregates_mem_34044.mem;
                CUdeviceptr kernel_arg_36012 = incprefixes_mem_34046.mem;
                unsigned int shared_offset_36006 = 0;
                
                if ((((((1 && sdiv_up64(defunc_2_reduce_res_29171,
                                        segscan_group_sizze_30870 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30870 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29171,
                                              segscan_group_sizze_30870 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36002[] = {&ctx->global_failure,
                                                 &shared_offset_36006,
                                                 &defunc_2_reduce_res_29171,
                                                 &kernel_arg_36007,
                                                 &kernel_arg_36008,
                                                 &kernel_arg_36009,
                                                 &kernel_arg_36010,
                                                 &kernel_arg_36011,
                                                 &kernel_arg_36012};
                    int64_t time_start_36003 = 0, time_end_36004 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30875");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(defunc_2_reduce_res_29171,
                                                 segscan_group_sizze_30870 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30870);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36003 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30875_runs,
                                                  &ctx->test_clusterWithzisegscan_30875_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30875,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30870,
                                                          1, 1, 0 +
                                                          (shared_sizze_36005 +
                                                           (8 -
                                                            shared_sizze_36005 %
                                                            8) % 8), NULL,
                                                          kernel_args_36002,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36004 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30875",
                                time_end_36004 - time_start_36003);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_34046,
                                          "incprefixes_mem_34046") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34044,
                                          "aggregates_mem_34044") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_34042,
                                          "status_flags_mem_34042") != 0)
                    return 1;
            }
            
            int64_t num_segments_29432;
            
            if (y_29411) {
                bool index_certs_29433;
                
                if (!bounds_check_29294) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", i_29291,
                                  "] out of bounds for array of shape [",
                                  defunc_2_reduce_res_29171, "].",
                                  "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:28:15-31\n   #4  /prelude/functional.fut:9:42-44\n   #5  src/cluster.fut:154:23-156:40\n   #6  src/cluster.fut:170:14-27\n   #7  src/cluster.fut:176:27-76\n   #8  src/cluster_test.fut:42:9-31\n   #9  src/cluster_test.fut:36:1-42:36\n");
                    if (memblock_unref_device(ctx, &mem_32184, "mem_32184") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32181, "mem_32181") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32179, "mem_32179") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32176, "mem_32176") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32173, "mem_32173") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32171, "mem_32171") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32169, "mem_32169") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32132,
                                              "mem_param_32132") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32127,
                                              "mem_param_32127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                              "defunc_0_f_res_mem_32166") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                              "defunc_0_f_res_mem_32161") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32147, "mem_32147") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32145, "mem_32145") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32143, "mem_32143") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32141, "mem_32141") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32139, "mem_32139") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32122, "mem_32122") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32120, "mem_32120") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32118, "mem_32118") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32116, "mem_32116") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32113, "mem_32113") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32111, "mem_32111") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32108, "mem_32108") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32106, "mem_32106") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &defunc_1_map_res_subhistos_mem_33261,
                                              "defunc_1_map_res_subhistos_mem_33261") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32102, "mem_32102") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                              "group_res_arr_mem_33232") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32084,
                                              "mem_param_32084") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32079,
                                              "mem_param_32079") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32074,
                                              "mem_param_32074") != 0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32257,
                                              "lifted_fromInit_res_mem_32257") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32252,
                                              "lifted_fromInit_res_mem_32252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32247,
                                              "lifted_fromInit_res_mem_32247") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32063, "mem_32063") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32061, "mem_32061") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32053,
                                              "mem_param_32053") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32048,
                                              "mem_param_32048") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32043,
                                              "mem_param_32043") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                              "clusterWith_res_mem_32275") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                              "clusterWith_res_mem_32270") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                              "clusterWith_res_mem_32265") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32260, "mem_32260") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32230, "mem_32230") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32097, "mem_32097") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32095, "mem_32095") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32093, "mem_32093") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                              "group_res_arr_mem_33035") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32038, "mem_32038") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32036, "mem_32036") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32033, "mem_32033") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32031, "mem_32031") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32022, "mem_32022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32016, "mem_32016") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32011, "mem_32011") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32008, "mem_32008") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32001, "mem_32001") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_31964,
                                              "mem_param_31964") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_31959,
                                              "mem_param_31959") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                              "defunc_0_f_res_mem_31998") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                              "defunc_0_f_res_mem_31993") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31954, "mem_31954") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_32442,
                                              "out_mem_32442") != 0)
                        return 1;
                    return 1;
                }
                
                int64_t read_res_36013;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36013,
                                                        mem_32184.mem +
                                                        i_29291 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t last_res_29434 = read_res_36013;
                
                num_segments_29432 = last_res_29434;
            } else {
                num_segments_29432 = (int64_t) 0;
            }
            
            bool bounds_invalid_upwards_29435 = slt64(num_segments_29432,
                                                      (int64_t) 0);
            bool valid_29436 = !bounds_invalid_upwards_29435;
            bool range_valid_c_29437;
            
            if (!valid_29436) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                              num_segments_29432, " is invalid.",
                              "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:28:15-31\n   #5  /prelude/functional.fut:9:42-44\n   #6  src/cluster.fut:154:23-156:40\n   #7  src/cluster.fut:170:14-27\n   #8  src/cluster.fut:176:27-76\n   #9  src/cluster_test.fut:42:9-31\n   #10 src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            
            int64_t bytes_32185 = (int64_t) 8 * num_segments_29432;
            struct memblock_device mem_32186;
            
            mem_32186.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32186, bytes_32185,
                                      "mem_32186")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_32186,
                                              num_segments_29432,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t segmap_group_sizze_30880;
            
            segmap_group_sizze_30880 =
                ctx->sizes.test_clusterWithzisegmap_group_sizze_30879;
            
            int64_t segmap_usable_groups_30881 =
                    sdiv_up64(defunc_2_reduce_res_29171,
                              segmap_group_sizze_30880);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_36017 = mem_32176.mem;
            CUdeviceptr kernel_arg_36018 = mem_32181.mem;
            CUdeviceptr kernel_arg_36019 = mem_32184.mem;
            CUdeviceptr kernel_arg_36020 = mem_32186.mem;
            
            if ((((((1 && segmap_usable_groups_30881 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30880 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30881;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36014[] = {&ctx->global_failure,
                                             &defunc_2_reduce_res_29171,
                                             &num_segments_29432,
                                             &kernel_arg_36017,
                                             &kernel_arg_36018,
                                             &kernel_arg_36019,
                                             &kernel_arg_36020};
                int64_t time_start_36015 = 0, time_end_36016 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30877");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30881);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30880);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36015 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30877_runs,
                                              &ctx->test_clusterWithzisegmap_30877_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30877,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30880,
                                                      1, 1, 0, NULL,
                                                      kernel_args_36014, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36016 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30877", time_end_36016 -
                            time_start_36015);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                return 1;
            
            int64_t num_groups_30886;
            int32_t max_num_groups_34124;
            
            max_num_groups_34124 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30885;
            num_groups_30886 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(num_segments_29432,
                                                                    segscan_group_sizze_30884),
                                                          sext_i32_i64(max_num_groups_34124))));
            
            struct memblock_device mem_32190;
            
            mem_32190.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32190, bytes_32185,
                                      "mem_32190")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, num_segments_29432)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_34125;
                
                numThreads_34125 = sdiv_up64(num_segments_29432,
                                             segscan_group_sizze_30884 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30884;
                
                int64_t numGroups_34126;
                
                numGroups_34126 = sdiv_up64(num_segments_29432,
                                            segscan_group_sizze_30884 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_34127 =
                                       ctx->test_clusterWithziid_counter_mem_34127;
                struct memblock_device status_flags_mem_34129;
                
                status_flags_mem_34129.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_34129,
                                          numGroups_34126,
                                          "status_flags_mem_34129")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34131;
                
                aggregates_mem_34131.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34131,
                                          (int64_t) 8 * numGroups_34126,
                                          "aggregates_mem_34131")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34133;
                
                incprefixes_mem_34133.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34133,
                                          (int64_t) 8 * numGroups_34126,
                                          "incprefixes_mem_34133")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34129,
                                                 numGroups_34126, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_36025 = smax64(smax64((int64_t) 288,
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30884),
                                                         (int64_t) 9 *
                                                         segscan_group_sizze_30884 *
                                                         (int64_t) 8);
                CUdeviceptr kernel_arg_36027 = mem_32186.mem;
                CUdeviceptr kernel_arg_36028 = mem_32190.mem;
                CUdeviceptr kernel_arg_36029 =
                            test_clusterWithziid_counter_mem_34127.mem;
                CUdeviceptr kernel_arg_36030 = status_flags_mem_34129.mem;
                CUdeviceptr kernel_arg_36031 = aggregates_mem_34131.mem;
                CUdeviceptr kernel_arg_36032 = incprefixes_mem_34133.mem;
                unsigned int shared_offset_36026 = 0;
                
                if ((((((1 && sdiv_up64(num_segments_29432,
                                        segscan_group_sizze_30884 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30884 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(num_segments_29432,
                                              segscan_group_sizze_30884 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36022[] = {&ctx->global_failure,
                                                 &shared_offset_36026,
                                                 &num_segments_29432,
                                                 &kernel_arg_36027,
                                                 &kernel_arg_36028,
                                                 &kernel_arg_36029,
                                                 &kernel_arg_36030,
                                                 &kernel_arg_36031,
                                                 &kernel_arg_36032};
                    int64_t time_start_36023 = 0, time_end_36024 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30889");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(num_segments_29432,
                                                 segscan_group_sizze_30884 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30884);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36023 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30889_runs,
                                                  &ctx->test_clusterWithzisegscan_30889_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30889,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30884,
                                                          1, 1, 0 +
                                                          (shared_sizze_36025 +
                                                           (8 -
                                                            shared_sizze_36025 %
                                                            8) % 8), NULL,
                                                          kernel_args_36022,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36024 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30889",
                                time_end_36024 - time_start_36023);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_34133,
                                          "incprefixes_mem_34133") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34131,
                                          "aggregates_mem_34131") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_34129,
                                          "status_flags_mem_34129") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                return 1;
            
            struct memblock_device mem_32192;
            
            mem_32192.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32192, bytes_32185,
                                      "mem_32192")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_34209;
            
            group_sizze_34209 = ctx->sizes.test_clusterWithzigroup_sizze_34209;
            
            int64_t num_groups_34210;
            
            num_groups_34210 = sdiv_up64(num_segments_29432, group_sizze_34209);
            
            CUdeviceptr kernel_arg_36036 = mem_32190.mem;
            CUdeviceptr kernel_arg_36037 = mem_32192.mem;
            
            if ((((((1 && num_groups_34210 != 0) && 1 != 0) && 1 != 0) &&
                  group_sizze_34209 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_34210;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36033[] = {&num_segments_29432,
                                             &kernel_arg_36036,
                                             &kernel_arg_36037};
                int64_t time_start_36034 = 0, time_end_36035 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.copy_34206");
                    fprintf(ctx->log, "%ld", (long) num_groups_34210);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) group_sizze_34209);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36034 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzicopy_34206_runs,
                                              &ctx->test_clusterWithzicopy_34206_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzicopy_34206,
                                                      grid[0], grid[1], grid[2],
                                                      group_sizze_34209, 1, 1,
                                                      0, NULL,
                                                      kernel_args_36033, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36035 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.copy_34206", time_end_36035 -
                            time_start_36034);
                }
            }
            if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                return 1;
            
            bool y_29452 = slt64((int64_t) 0, num_segments_29432);
            bool index_certs_29453;
            
            if (!y_29452) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", (int64_t) 0,
                              "] out of bounds for array of shape [",
                              num_segments_29432, "].",
                              "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:29:14-32\n   #2  /prelude/functional.fut:9:42-44\n   #3  src/cluster.fut:154:23-156:40\n   #4  src/cluster.fut:170:14-27\n   #5  src/cluster.fut:176:27-76\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            {
                int64_t write_tmp_36038 = (int64_t) 0;
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_to_dev_runs,
                                              &ctx->copy_scalar_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32192.mem +
                                                    (int64_t) 0 *
                                                    sizeof(int64_t),
                                                    &write_tmp_36038,
                                                    sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            
            int64_t segmap_usable_groups_30906 = sdiv_up64(num_segments_29432,
                                                           segmap_group_sizze_30905);
            struct memblock_device mem_32195;
            
            mem_32195.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32195, bytes_32185,
                                      "mem_32195")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t bytes_32196 = (int64_t) 4 * num_segments_29432;
            struct memblock_device mem_32197;
            
            mem_32197.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32197, bytes_32196,
                                      "mem_32197")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32199;
            
            mem_32199.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32199, bytes_32196,
                                      "mem_32199")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_36042 = mem_32171.mem;
            CUdeviceptr kernel_arg_36043 = mem_32173.mem;
            CUdeviceptr kernel_arg_36044 = mem_32192.mem;
            CUdeviceptr kernel_arg_36045 = mem_32195.mem;
            CUdeviceptr kernel_arg_36046 = mem_32197.mem;
            CUdeviceptr kernel_arg_36047 = mem_32199.mem;
            
            if ((((((1 && segmap_usable_groups_30906 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30905 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30906;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36039[] = {&ctx->global_failure,
                                             &ctx->failure_is_an_option,
                                             &ctx->global_failure_args,
                                             &defunc_2_reduce_res_29171,
                                             &num_segments_29432,
                                             &kernel_arg_36042,
                                             &kernel_arg_36043,
                                             &kernel_arg_36044,
                                             &kernel_arg_36045,
                                             &kernel_arg_36046,
                                             &kernel_arg_36047};
                int64_t time_start_36040 = 0, time_end_36041 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30891");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30906);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30905);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36040 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30891_runs,
                                              &ctx->test_clusterWithzisegmap_30891_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30891,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30905,
                                                      1, 1, 0, NULL,
                                                      kernel_args_36039, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36041 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30891", time_end_36041 -
                            time_start_36040);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                return 1;
            
            int64_t segmap_usable_groups_30930 = sdiv_up64(num_segments_29432,
                                                           segmap_group_sizze_30929);
            struct memblock_device mem_32202;
            
            mem_32202.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32202, num_segments_29432,
                                      "mem_32202")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_36051 = mem_32195.mem;
            CUdeviceptr kernel_arg_36052 = mem_32202.mem;
            
            if ((((((1 && segmap_usable_groups_30930 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30929 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30930;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36048[] = {&ctx->global_failure,
                                             &num_segments_29432,
                                             &kernel_arg_36051,
                                             &kernel_arg_36052};
                int64_t time_start_36049 = 0, time_end_36050 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30919");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30930);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30929);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36049 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30919_runs,
                                              &ctx->test_clusterWithzisegmap_30919_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30919,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30929,
                                                      1, 1, 0, NULL,
                                                      kernel_args_36048, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36050 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30919", time_end_36050 -
                            time_start_36049);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                return 1;
            
            bool index_certs_29472;
            
            if (!y_29452) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", (int64_t) 0,
                              "] out of bounds for array of shape [",
                              num_segments_29432, "].",
                              "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:60:15-41\n   #2  src/cluster.fut:158:8-43\n   #3  src/cluster.fut:170:14-27\n   #4  src/cluster.fut:176:27-76\n   #5  src/cluster_test.fut:42:9-31\n   #6  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            {
                bool write_tmp_36053 = 1;
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_to_dev_runs,
                                              &ctx->copy_scalar_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32202.mem +
                                                    (int64_t) 0 * sizeof(bool),
                                                    &write_tmp_36053,
                                                    sizeof(bool)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            
            int64_t num_groups_30940;
            int32_t max_num_groups_34221;
            
            max_num_groups_34221 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30939;
            num_groups_30940 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(num_segments_29432,
                                                                    segscan_group_sizze_30938),
                                                          sext_i32_i64(max_num_groups_34221))));
            
            struct memblock_device mem_32205;
            
            mem_32205.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32205, num_segments_29432,
                                      "mem_32205")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32207;
            
            mem_32207.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32207, bytes_32185,
                                      "mem_32207")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, num_segments_29432)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_34222;
                
                numThreads_34222 = sdiv_up64(num_segments_29432,
                                             segscan_group_sizze_30938 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30938;
                
                int64_t numGroups_34223;
                
                numGroups_34223 = sdiv_up64(num_segments_29432,
                                            segscan_group_sizze_30938 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_34224 =
                                       ctx->test_clusterWithziid_counter_mem_34224;
                struct memblock_device status_flags_mem_34226;
                
                status_flags_mem_34226.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_34226,
                                          numGroups_34223,
                                          "status_flags_mem_34226")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34228;
                
                aggregates_mem_34228.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34228,
                                          numGroups_34223,
                                          "aggregates_mem_34228")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34230;
                
                incprefixes_mem_34230.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34230,
                                          numGroups_34223,
                                          "incprefixes_mem_34230")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34232;
                
                aggregates_mem_34232.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34232,
                                          (int64_t) 8 * numGroups_34223,
                                          "aggregates_mem_34232")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34234;
                
                incprefixes_mem_34234.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34234,
                                          (int64_t) 8 * numGroups_34223,
                                          "incprefixes_mem_34234")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34226,
                                                 numGroups_34223, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_36058 = smax64(smax64((int64_t) 320,
                                                                sdiv_up64(segscan_group_sizze_30938,
                                                                          (int64_t) 8) *
                                                                (int64_t) 8 +
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30938),
                                                         smax64((int64_t) 9 *
                                                                segscan_group_sizze_30938,
                                                                (int64_t) 9 *
                                                                segscan_group_sizze_30938 *
                                                                (int64_t) 8));
                CUdeviceptr kernel_arg_36060 = mem_32202.mem;
                CUdeviceptr kernel_arg_36061 = mem_32205.mem;
                CUdeviceptr kernel_arg_36062 = mem_32207.mem;
                CUdeviceptr kernel_arg_36063 =
                            test_clusterWithziid_counter_mem_34224.mem;
                CUdeviceptr kernel_arg_36064 = status_flags_mem_34226.mem;
                CUdeviceptr kernel_arg_36065 = aggregates_mem_34228.mem;
                CUdeviceptr kernel_arg_36066 = incprefixes_mem_34230.mem;
                CUdeviceptr kernel_arg_36067 = aggregates_mem_34232.mem;
                CUdeviceptr kernel_arg_36068 = incprefixes_mem_34234.mem;
                unsigned int shared_offset_36059 = 0;
                
                if ((((((1 && sdiv_up64(num_segments_29432,
                                        segscan_group_sizze_30938 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30938 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(num_segments_29432,
                                              segscan_group_sizze_30938 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36055[] = {&ctx->global_failure,
                                                 &shared_offset_36059,
                                                 &num_segments_29432,
                                                 &kernel_arg_36060,
                                                 &kernel_arg_36061,
                                                 &kernel_arg_36062,
                                                 &kernel_arg_36063,
                                                 &kernel_arg_36064,
                                                 &kernel_arg_36065,
                                                 &kernel_arg_36066,
                                                 &kernel_arg_36067,
                                                 &kernel_arg_36068};
                    int64_t time_start_36056 = 0, time_end_36057 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30943");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(num_segments_29432,
                                                 segscan_group_sizze_30938 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30938);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36056 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30943_runs,
                                                  &ctx->test_clusterWithzisegscan_30943_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30943,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30938,
                                                          1, 1, 0 +
                                                          (shared_sizze_36058 +
                                                           (8 -
                                                            shared_sizze_36058 %
                                                            8) % 8), NULL,
                                                          kernel_args_36055,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36057 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30943",
                                time_end_36057 - time_start_36056);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_34234,
                                          "incprefixes_mem_34234") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34232,
                                          "aggregates_mem_34232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &incprefixes_mem_34230,
                                          "incprefixes_mem_34230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34228,
                                          "aggregates_mem_34228") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_34226,
                                          "status_flags_mem_34226") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_32205, "mem_32205") != 0)
                return 1;
            
            int64_t num_groups_30948;
            int32_t max_num_groups_34354;
            
            max_num_groups_34354 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30947;
            num_groups_30948 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(num_segments_29432,
                                                                    segscan_group_sizze_30946),
                                                          sext_i32_i64(max_num_groups_34354))));
            
            struct memblock_device mem_32210;
            
            mem_32210.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32210, bytes_32185,
                                      "mem_32210")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, num_segments_29432)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_34355;
                
                numThreads_34355 = sdiv_up64(num_segments_29432,
                                             segscan_group_sizze_30946 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30946;
                
                int64_t numGroups_34356;
                
                numGroups_34356 = sdiv_up64(num_segments_29432,
                                            segscan_group_sizze_30946 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_34357 =
                                       ctx->test_clusterWithziid_counter_mem_34357;
                struct memblock_device status_flags_mem_34359;
                
                status_flags_mem_34359.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_34359,
                                          numGroups_34356,
                                          "status_flags_mem_34359")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34361;
                
                aggregates_mem_34361.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34361,
                                          (int64_t) 8 * numGroups_34356,
                                          "aggregates_mem_34361")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34363;
                
                incprefixes_mem_34363.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34363,
                                          (int64_t) 8 * numGroups_34356,
                                          "incprefixes_mem_34363")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34359,
                                                 numGroups_34356, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_36073 = smax64(smax64((int64_t) 288,
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30946),
                                                         (int64_t) 9 *
                                                         segscan_group_sizze_30946 *
                                                         (int64_t) 8);
                CUdeviceptr kernel_arg_36075 = mem_32202.mem;
                CUdeviceptr kernel_arg_36076 = mem_32210.mem;
                CUdeviceptr kernel_arg_36077 =
                            test_clusterWithziid_counter_mem_34357.mem;
                CUdeviceptr kernel_arg_36078 = status_flags_mem_34359.mem;
                CUdeviceptr kernel_arg_36079 = aggregates_mem_34361.mem;
                CUdeviceptr kernel_arg_36080 = incprefixes_mem_34363.mem;
                unsigned int shared_offset_36074 = 0;
                
                if ((((((1 && sdiv_up64(num_segments_29432,
                                        segscan_group_sizze_30946 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30946 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(num_segments_29432,
                                              segscan_group_sizze_30946 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36070[] = {&ctx->global_failure,
                                                 &shared_offset_36074,
                                                 &num_segments_29432,
                                                 &kernel_arg_36075,
                                                 &kernel_arg_36076,
                                                 &kernel_arg_36077,
                                                 &kernel_arg_36078,
                                                 &kernel_arg_36079,
                                                 &kernel_arg_36080};
                    int64_t time_start_36071 = 0, time_end_36072 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30951");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(num_segments_29432,
                                                 segscan_group_sizze_30946 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30946);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36071 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30951_runs,
                                                  &ctx->test_clusterWithzisegscan_30951_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30951,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30946,
                                                          1, 1, 0 +
                                                          (shared_sizze_36073 +
                                                           (8 -
                                                            shared_sizze_36073 %
                                                            8) % 8), NULL,
                                                          kernel_args_36070,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36072 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30951",
                                time_end_36072 - time_start_36071);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_34363,
                                          "incprefixes_mem_34363") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34361,
                                          "aggregates_mem_34361") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_34359,
                                          "status_flags_mem_34359") != 0)
                    return 1;
            }
            
            int64_t num_segments_29493;
            
            if (y_29452) {
                int64_t i_29494 = sub64(num_segments_29432, (int64_t) 1);
                bool x_29495 = sle64((int64_t) 0, i_29494);
                bool y_29496 = slt64(i_29494, num_segments_29432);
                bool bounds_check_29497 = x_29495 && y_29496;
                bool index_certs_29498;
                
                if (!bounds_check_29497) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", i_29494,
                                  "] out of bounds for array of shape [",
                                  num_segments_29432, "].",
                                  "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:61:18-34\n   #4  src/cluster.fut:158:8-43\n   #5  src/cluster.fut:170:14-27\n   #6  src/cluster.fut:176:27-76\n   #7  src/cluster_test.fut:42:9-31\n   #8  src/cluster_test.fut:36:1-42:36\n");
                    if (memblock_unref_device(ctx, &mem_32210, "mem_32210") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32207, "mem_32207") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32205, "mem_32205") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32202, "mem_32202") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32199, "mem_32199") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32197, "mem_32197") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32195, "mem_32195") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32192, "mem_32192") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32190, "mem_32190") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32186, "mem_32186") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32184, "mem_32184") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32181, "mem_32181") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32179, "mem_32179") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32176, "mem_32176") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32173, "mem_32173") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32171, "mem_32171") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32169, "mem_32169") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32132,
                                              "mem_param_32132") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32127,
                                              "mem_param_32127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                              "defunc_0_f_res_mem_32166") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                              "defunc_0_f_res_mem_32161") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32147, "mem_32147") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32145, "mem_32145") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32143, "mem_32143") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32141, "mem_32141") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32139, "mem_32139") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32122, "mem_32122") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32120, "mem_32120") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32118, "mem_32118") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32116, "mem_32116") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32113, "mem_32113") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32111, "mem_32111") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32108, "mem_32108") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32106, "mem_32106") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &defunc_1_map_res_subhistos_mem_33261,
                                              "defunc_1_map_res_subhistos_mem_33261") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32102, "mem_32102") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                              "group_res_arr_mem_33232") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32084,
                                              "mem_param_32084") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32079,
                                              "mem_param_32079") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32074,
                                              "mem_param_32074") != 0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32257,
                                              "lifted_fromInit_res_mem_32257") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32252,
                                              "lifted_fromInit_res_mem_32252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &lifted_fromInit_res_mem_32247,
                                              "lifted_fromInit_res_mem_32247") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32063, "mem_32063") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32061, "mem_32061") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32053,
                                              "mem_param_32053") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32048,
                                              "mem_param_32048") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_32043,
                                              "mem_param_32043") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                              "clusterWith_res_mem_32275") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                              "clusterWith_res_mem_32270") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                              "clusterWith_res_mem_32265") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32260, "mem_32260") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32230, "mem_32230") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32097, "mem_32097") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32095, "mem_32095") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32093, "mem_32093") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                              "group_res_arr_mem_33035") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32038, "mem_32038") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32036, "mem_32036") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32033, "mem_32033") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32031, "mem_32031") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32022, "mem_32022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32016, "mem_32016") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32011, "mem_32011") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32008, "mem_32008") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_32001, "mem_32001") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_31964,
                                              "mem_param_31964") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_31959,
                                              "mem_param_31959") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                              "defunc_0_f_res_mem_31998") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                              "defunc_0_f_res_mem_31993") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31954, "mem_31954") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_32442,
                                              "out_mem_32442") != 0)
                        return 1;
                    return 1;
                }
                
                int64_t read_res_36081;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36081,
                                                        mem_32210.mem +
                                                        i_29494 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t last_res_29499 = read_res_36081;
                
                num_segments_29493 = last_res_29499;
            } else {
                num_segments_29493 = (int64_t) 0;
            }
            
            bool bounds_invalid_upwards_29500 = slt64(num_segments_29493,
                                                      (int64_t) 0);
            bool valid_29501 = !bounds_invalid_upwards_29500;
            bool range_valid_c_29502;
            
            if (!valid_29501) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                              num_segments_29493, " is invalid.",
                              "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:61:18-34\n   #5  src/cluster.fut:158:8-43\n   #6  src/cluster.fut:170:14-27\n   #7  src/cluster.fut:176:27-76\n   #8  src/cluster_test.fut:42:9-31\n   #9  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32210, "mem_32210") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32207, "mem_32207") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32205, "mem_32205") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            
            int64_t bytes_32211 = (int64_t) 8 * num_segments_29493;
            struct memblock_device mem_32212;
            
            mem_32212.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32212, bytes_32211,
                                      "mem_32212")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_32212,
                                              num_segments_29493,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t segmap_group_sizze_30956;
            
            segmap_group_sizze_30956 =
                ctx->sizes.test_clusterWithzisegmap_group_sizze_30955;
            
            int64_t segmap_usable_groups_30957 = sdiv_up64(num_segments_29432,
                                                           segmap_group_sizze_30956);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_36085 = mem_32202.mem;
            CUdeviceptr kernel_arg_36086 = mem_32207.mem;
            CUdeviceptr kernel_arg_36087 = mem_32210.mem;
            CUdeviceptr kernel_arg_36088 = mem_32212.mem;
            
            if ((((((1 && segmap_usable_groups_30957 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30956 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30957;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36082[] = {&ctx->global_failure,
                                             &num_segments_29432,
                                             &num_segments_29493,
                                             &kernel_arg_36085,
                                             &kernel_arg_36086,
                                             &kernel_arg_36087,
                                             &kernel_arg_36088};
                int64_t time_start_36083 = 0, time_end_36084 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30953");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30957);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30956);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36083 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30953_runs,
                                              &ctx->test_clusterWithzisegmap_30953_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30953,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30956,
                                                      1, 1, 0, NULL,
                                                      kernel_args_36082, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36084 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30953", time_end_36084 -
                            time_start_36083);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32207, "mem_32207") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32210, "mem_32210") != 0)
                return 1;
            
            int64_t num_groups_30962;
            int32_t max_num_groups_34441;
            
            max_num_groups_34441 =
                ctx->sizes.test_clusterWithzisegscan_num_groups_30961;
            num_groups_30962 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(num_segments_29493,
                                                                    segscan_group_sizze_30960),
                                                          sext_i32_i64(max_num_groups_34441))));
            
            struct memblock_device mem_32216;
            
            mem_32216.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32216, bytes_32211,
                                      "mem_32216")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, num_segments_29493)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t numThreads_34442;
                
                numThreads_34442 = sdiv_up64(num_segments_29493,
                                             segscan_group_sizze_30960 *
                                             (int64_t) 9) *
                    segscan_group_sizze_30960;
                
                int64_t numGroups_34443;
                
                numGroups_34443 = sdiv_up64(num_segments_29493,
                                            segscan_group_sizze_30960 *
                                            (int64_t) 9);
                
                struct memblock_device test_clusterWithziid_counter_mem_34444 =
                                       ctx->test_clusterWithziid_counter_mem_34444;
                struct memblock_device status_flags_mem_34446;
                
                status_flags_mem_34446.references = NULL;
                if (memblock_alloc_device(ctx, &status_flags_mem_34446,
                                          numGroups_34443,
                                          "status_flags_mem_34446")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device aggregates_mem_34448;
                
                aggregates_mem_34448.references = NULL;
                if (memblock_alloc_device(ctx, &aggregates_mem_34448,
                                          (int64_t) 8 * numGroups_34443,
                                          "aggregates_mem_34448")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device incprefixes_mem_34450;
                
                incprefixes_mem_34450.references = NULL;
                if (memblock_alloc_device(ctx, &incprefixes_mem_34450,
                                          (int64_t) 8 * numGroups_34443,
                                          "incprefixes_mem_34450")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34446,
                                                 numGroups_34443, (int8_t) 0) !=
                    0) {
                    err = 1;
                    goto cleanup;
                }
                
                unsigned int shared_sizze_36093 = smax64(smax64((int64_t) 288,
                                                                (int64_t) 8 *
                                                                segscan_group_sizze_30960),
                                                         (int64_t) 9 *
                                                         segscan_group_sizze_30960 *
                                                         (int64_t) 8);
                CUdeviceptr kernel_arg_36095 = mem_32212.mem;
                CUdeviceptr kernel_arg_36096 = mem_32216.mem;
                CUdeviceptr kernel_arg_36097 =
                            test_clusterWithziid_counter_mem_34444.mem;
                CUdeviceptr kernel_arg_36098 = status_flags_mem_34446.mem;
                CUdeviceptr kernel_arg_36099 = aggregates_mem_34448.mem;
                CUdeviceptr kernel_arg_36100 = incprefixes_mem_34450.mem;
                unsigned int shared_offset_36094 = 0;
                
                if ((((((1 && sdiv_up64(num_segments_29493,
                                        segscan_group_sizze_30960 *
                                        (int64_t) 9) != 0) && 1 != 0) && 1 !=
                       0) && segscan_group_sizze_30960 != 0) && 1 != 0) && 1 !=
                    0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = sdiv_up64(num_segments_29493,
                                              segscan_group_sizze_30960 *
                                              (int64_t) 9);
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36090[] = {&ctx->global_failure,
                                                 &shared_offset_36094,
                                                 &num_segments_29493,
                                                 &kernel_arg_36095,
                                                 &kernel_arg_36096,
                                                 &kernel_arg_36097,
                                                 &kernel_arg_36098,
                                                 &kernel_arg_36099,
                                                 &kernel_arg_36100};
                    int64_t time_start_36091 = 0, time_end_36092 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segscan_30965");
                        fprintf(ctx->log, "%ld",
                                (long) sdiv_up64(num_segments_29493,
                                                 segscan_group_sizze_30960 *
                                                 (int64_t) 9));
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segscan_group_sizze_30960);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36091 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegscan_30965_runs,
                                                  &ctx->test_clusterWithzisegscan_30965_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_30965,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segscan_group_sizze_30960,
                                                          1, 1, 0 +
                                                          (shared_sizze_36093 +
                                                           (8 -
                                                            shared_sizze_36093 %
                                                            8) % 8), NULL,
                                                          kernel_args_36090,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36092 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segscan_30965",
                                time_end_36092 - time_start_36091);
                    }
                }
                if (memblock_unref_device(ctx, &incprefixes_mem_34450,
                                          "incprefixes_mem_34450") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &aggregates_mem_34448,
                                          "aggregates_mem_34448") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &status_flags_mem_34446,
                                          "status_flags_mem_34446") != 0)
                    return 1;
            }
            
            struct memblock_device mem_32218;
            
            mem_32218.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32218, bytes_32211,
                                      "mem_32218")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_34526;
            
            group_sizze_34526 = ctx->sizes.test_clusterWithzigroup_sizze_34526;
            
            int64_t num_groups_34527;
            
            num_groups_34527 = sdiv_up64(num_segments_29493, group_sizze_34526);
            
            CUdeviceptr kernel_arg_36104 = mem_32216.mem;
            CUdeviceptr kernel_arg_36105 = mem_32218.mem;
            
            if ((((((1 && num_groups_34527 != 0) && 1 != 0) && 1 != 0) &&
                  group_sizze_34526 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_34527;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36101[] = {&num_segments_29493,
                                             &kernel_arg_36104,
                                             &kernel_arg_36105};
                int64_t time_start_36102 = 0, time_end_36103 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.copy_34523");
                    fprintf(ctx->log, "%ld", (long) num_groups_34527);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) group_sizze_34526);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36102 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzicopy_34523_runs,
                                              &ctx->test_clusterWithzicopy_34523_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzicopy_34523,
                                                      grid[0], grid[1], grid[2],
                                                      group_sizze_34526, 1, 1,
                                                      0, NULL,
                                                      kernel_args_36101, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36103 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.copy_34523", time_end_36103 -
                            time_start_36102);
                }
            }
            if (memblock_unref_device(ctx, &mem_32216, "mem_32216") != 0)
                return 1;
            
            bool y_29517 = slt64((int64_t) 0, num_segments_29493);
            bool index_certs_29518;
            
            if (!y_29517) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", (int64_t) 0,
                              "] out of bounds for array of shape [",
                              num_segments_29493, "].",
                              "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:62:17-38\n   #2  src/cluster.fut:158:8-43\n   #3  src/cluster.fut:170:14-27\n   #4  src/cluster.fut:176:27-76\n   #5  src/cluster_test.fut:42:9-31\n   #6  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32218, "mem_32218") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32216, "mem_32216") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32212, "mem_32212") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32210, "mem_32210") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32207, "mem_32207") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32205, "mem_32205") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            {
                int64_t write_tmp_36106 = (int64_t) 0;
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_to_dev_runs,
                                              &ctx->copy_scalar_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32218.mem +
                                                    (int64_t) 0 *
                                                    sizeof(int64_t),
                                                    &write_tmp_36106,
                                                    sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            
            struct memblock_device mem_32220;
            
            mem_32220.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32220, bytes_32025,
                                      "mem_32220")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_32220, numVert_28890,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32222;
            
            mem_32222.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32222, bytes_32025,
                                      "mem_32222")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_32222, numVert_28890,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t segmap_usable_groups_30971 = sdiv_up64(num_segments_29493,
                                                           segmap_group_sizze_30970);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            CUdeviceptr kernel_arg_36110 = mem_32197.mem;
            CUdeviceptr kernel_arg_36111 = mem_32212.mem;
            CUdeviceptr kernel_arg_36112 = mem_32218.mem;
            CUdeviceptr kernel_arg_36113 = mem_32220.mem;
            CUdeviceptr kernel_arg_36114 = mem_32222.mem;
            
            if ((((((1 && segmap_usable_groups_30971 != 0) && 1 != 0) && 1 !=
                   0) && segmap_group_sizze_30970 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = segmap_usable_groups_30971;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36107[] = {&ctx->global_failure,
                                             &ctx->failure_is_an_option,
                                             &ctx->global_failure_args,
                                             &numVert_28890,
                                             &num_segments_29432,
                                             &num_segments_29493,
                                             &kernel_arg_36110,
                                             &kernel_arg_36111,
                                             &kernel_arg_36112,
                                             &kernel_arg_36113,
                                             &kernel_arg_36114};
                int64_t time_start_36108 = 0, time_end_36109 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segmap_30967");
                    fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30971);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30970);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36108 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegmap_30967_runs,
                                              &ctx->test_clusterWithzisegmap_30967_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_30967,
                                                      grid[0], grid[1], grid[2],
                                                      segmap_group_sizze_30970,
                                                      1, 1, 0, NULL,
                                                      kernel_args_36107, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36109 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segmap_30967", time_end_36109 -
                            time_start_36108);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32212, "mem_32212") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32218, "mem_32218") != 0)
                return 1;
            
            int64_t replicate_arg_29532 = sub64(maxSizze_29114,
                                                num_segments_29432);
            bool bounds_invalid_upwards_29533 = slt64(replicate_arg_29532,
                                                      (int64_t) 0);
            bool valid_29534 = !bounds_invalid_upwards_29533;
            bool range_valid_c_29535;
            
            if (!valid_29534) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                              replicate_arg_29532, " is invalid.",
                              "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:43:34-50\n   #3  /prelude/functional.fut:9:42-44\n   #4  src/cluster.fut:170:14-40\n   #5  src/cluster.fut:176:27-76\n   #6  src/cluster_test.fut:42:9-31\n   #7  src/cluster_test.fut:36:1-42:36\n");
                if (memblock_unref_device(ctx, &mem_32222, "mem_32222") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32220, "mem_32220") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32218, "mem_32218") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32216, "mem_32216") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32212, "mem_32212") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32210, "mem_32210") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32207, "mem_32207") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32205, "mem_32205") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32132,
                                          "mem_param_32132") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32127,
                                          "mem_param_32127") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                          "defunc_0_f_res_mem_32166") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                          "defunc_0_f_res_mem_32161") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                    return 1;
                if (memblock_unref_device(ctx,
                                          &defunc_1_map_res_subhistos_mem_33261,
                                          "defunc_1_map_res_subhistos_mem_33261") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                          "group_res_arr_mem_33232") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32084,
                                          "mem_param_32084") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32079,
                                          "mem_param_32079") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32074,
                                          "mem_param_32074") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                          "lifted_fromInit_res_mem_32257") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                          "lifted_fromInit_res_mem_32252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                          "lifted_fromInit_res_mem_32247") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32053,
                                          "mem_param_32053") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32048,
                                          "mem_param_32048") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_32043,
                                          "mem_param_32043") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                          "clusterWith_res_mem_32275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                          "clusterWith_res_mem_32270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                          "clusterWith_res_mem_32265") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                          "group_res_arr_mem_33035") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31964,
                                          "mem_param_31964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_31959,
                                          "mem_param_31959") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                          "defunc_0_f_res_mem_31998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                          "defunc_0_f_res_mem_31993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_32442,
                                          "out_mem_32442") != 0)
                    return 1;
                return 1;
            }
            
            int64_t bytes_32224 = (int64_t) 4 * replicate_arg_29532;
            struct memblock_device mem_32225;
            
            mem_32225.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32225, bytes_32224,
                                      "mem_32225")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i32(ctx, mem_32225,
                                              replicate_arg_29532, 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_32227;
            
            mem_32227.references = NULL;
            if (memblock_alloc_device(ctx, &mem_32227, bytes_32062,
                                      "mem_32227")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_34533 = (int64_t) 0;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32227.mem + tmp_offs_34533 *
                                                (int64_t) 4, mem_32199.mem +
                                                (int64_t) 0,
                                                num_segments_29432 *
                                                (int64_t) 4));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_34533 += num_segments_29432;
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpy(mem_32227.mem + tmp_offs_34533 *
                                                (int64_t) 4, mem_32225.mem +
                                                (int64_t) 0,
                                                replicate_arg_29532 *
                                                (int64_t) 4));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_34533 += replicate_arg_29532;
            if (memblock_unref_device(ctx, &mem_32225, "mem_32225") != 0)
                return 1;
            
            struct memblock_device test_clusterWithzicounter_mem_34534 =
                                   ctx->test_clusterWithzicounter_mem_34534;
            struct memblock_device group_res_arr_mem_34536;
            
            group_res_arr_mem_34536.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_34536,
                                      segred_group_sizze_30974 *
                                      num_groups_30976,
                                      "group_res_arr_mem_34536")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_34538;
            
            num_threads_34538 = num_groups_30976 * segred_group_sizze_30974;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            unsigned int shared_sizze_36119 = segred_group_sizze_30974;
            unsigned int shared_sizze_36121 = 1;
            CUdeviceptr kernel_arg_36123 = mem_param_32084.mem;
            CUdeviceptr kernel_arg_36124 = mem_32220.mem;
            CUdeviceptr kernel_arg_36125 = mem_32230.mem;
            CUdeviceptr kernel_arg_36126 =
                        test_clusterWithzicounter_mem_34534.mem;
            CUdeviceptr kernel_arg_36127 = group_res_arr_mem_34536.mem;
            unsigned int shared_offset_36120 = 0;
            unsigned int shared_offset_36122 = 0 + (shared_sizze_36119 + (8 -
                                                                          shared_sizze_36119 %
                                                                          8) %
                                                    8);
            
            if ((((((1 && num_groups_30976 != 0) && 1 != 0) && 1 != 0) &&
                  segred_group_sizze_30974 != 0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = num_groups_30976;
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36116[] = {&ctx->global_failure,
                                             &shared_offset_36120,
                                             &shared_offset_36122,
                                             &numVert_28890, &num_groups_30976,
                                             &num_threads_34538,
                                             &kernel_arg_36123,
                                             &kernel_arg_36124,
                                             &kernel_arg_36125,
                                             &kernel_arg_36126,
                                             &kernel_arg_36127};
                int64_t time_start_36117 = 0, time_end_36118 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segred_nonseg_30981");
                    fprintf(ctx->log, "%ld", (long) num_groups_30976);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segred_group_sizze_30974);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36117 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegred_nonseg_30981_runs,
                                              &ctx->test_clusterWithzisegred_nonseg_30981_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30981,
                                                      grid[0], grid[1], grid[2],
                                                      segred_group_sizze_30974,
                                                      1, 1, 0 +
                                                      (shared_sizze_36119 + (8 -
                                                                             shared_sizze_36119 %
                                                                             8) %
                                                       8) +
                                                      (shared_sizze_36121 + (8 -
                                                                             shared_sizze_36121 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_36116, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36118 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segred_nonseg_30981",
                            time_end_36118 - time_start_36117);
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            bool read_res_36128;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_scalar_from_dev_runs,
                                              &ctx->copy_scalar_from_dev_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36128,
                                                    mem_32230.mem +
                                                    (int64_t) 0 * sizeof(bool),
                                                    sizeof(bool)));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            }
            if (futhark_context_sync(ctx) != 0)
                return 1;
            
            bool defunc_2_reduce_res_29538 = read_res_36128;
            bool lifted_checkEqual_res_29545;
            
            if (defunc_2_reduce_res_29538) {
                int64_t segred_group_sizze_30984;
                
                segred_group_sizze_30984 =
                    ctx->sizes.test_clusterWithzisegred_group_sizze_30983;
                
                int64_t num_groups_30986;
                int32_t max_num_groups_34564;
                
                max_num_groups_34564 =
                    ctx->sizes.test_clusterWithzisegred_num_groups_30985;
                num_groups_30986 = sext_i64_i32(smax64((int64_t) 1,
                                                       smin64(sdiv_up64(maxSizze_29114,
                                                                        segred_group_sizze_30984),
                                                              sext_i32_i64(max_num_groups_34564))));
                
                struct memblock_device mem_32233;
                
                mem_32233.references = NULL;
                if (memblock_alloc_device(ctx, &mem_32233, (int64_t) 1,
                                          "mem_32233")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device test_clusterWithzicounter_mem_34565 =
                                       ctx->test_clusterWithzicounter_mem_34565;
                struct memblock_device group_res_arr_mem_34567;
                
                group_res_arr_mem_34567.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_34567,
                                          segred_group_sizze_30984 *
                                          num_groups_30986,
                                          "group_res_arr_mem_34567")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t num_threads_34569;
                
                num_threads_34569 = num_groups_30986 * segred_group_sizze_30984;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                unsigned int shared_sizze_36133 = segred_group_sizze_30984;
                unsigned int shared_sizze_36135 = 1;
                CUdeviceptr kernel_arg_36137 = mem_param_32074.mem;
                CUdeviceptr kernel_arg_36138 = mem_32199.mem;
                CUdeviceptr kernel_arg_36139 = mem_32233.mem;
                CUdeviceptr kernel_arg_36140 =
                            test_clusterWithzicounter_mem_34565.mem;
                CUdeviceptr kernel_arg_36141 = group_res_arr_mem_34567.mem;
                unsigned int shared_offset_36134 = 0;
                unsigned int shared_offset_36136 = 0 + (shared_sizze_36133 +
                                                        (8 -
                                                         shared_sizze_36133 %
                                                         8) % 8);
                
                if ((((((1 && num_groups_30986 != 0) && 1 != 0) && 1 != 0) &&
                      segred_group_sizze_30984 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_30986;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36130[] = {&ctx->global_failure,
                                                 &shared_offset_36134,
                                                 &shared_offset_36136,
                                                 &maxSizze_29114,
                                                 &num_segments_29432,
                                                 &num_groups_30986,
                                                 &num_threads_34569,
                                                 &kernel_arg_36137,
                                                 &kernel_arg_36138,
                                                 &kernel_arg_36139,
                                                 &kernel_arg_36140,
                                                 &kernel_arg_36141};
                    int64_t time_start_36131 = 0, time_end_36132 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segred_nonseg_30991");
                        fprintf(ctx->log, "%ld", (long) num_groups_30986);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segred_group_sizze_30984);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36131 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegred_nonseg_30991_runs,
                                                  &ctx->test_clusterWithzisegred_nonseg_30991_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_30991,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segred_group_sizze_30984,
                                                          1, 1, 0 +
                                                          (shared_sizze_36133 +
                                                           (8 -
                                                            shared_sizze_36133 %
                                                            8) % 8) +
                                                          (shared_sizze_36135 +
                                                           (8 -
                                                            shared_sizze_36135 %
                                                            8) % 8), NULL,
                                                          kernel_args_36130,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36132 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segred_nonseg_30991",
                                time_end_36132 - time_start_36131);
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                bool read_res_36142;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36142,
                                                        mem_32233.mem +
                                                        (int64_t) 0 *
                                                        sizeof(bool),
                                                        sizeof(bool)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                bool defunc_2_reduce_res_29546 = read_res_36142;
                
                if (memblock_unref_device(ctx, &mem_32233, "mem_32233") != 0)
                    return 1;
                lifted_checkEqual_res_29545 = defunc_2_reduce_res_29546;
                if (memblock_unref_device(ctx, &group_res_arr_mem_34567,
                                          "group_res_arr_mem_34567") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32233, "mem_32233") != 0)
                    return 1;
            } else {
                lifted_checkEqual_res_29545 = 0;
            }
            if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                return 1;
            
            bool cond_29553 = !lifted_checkEqual_res_29545;
            bool loop_cond_29554;
            
            if (cond_29553) {
                int64_t segred_group_sizze_30994;
                
                segred_group_sizze_30994 =
                    ctx->sizes.test_clusterWithzisegred_group_sizze_30993;
                
                int64_t num_groups_30996;
                int32_t max_num_groups_34595;
                
                max_num_groups_34595 =
                    ctx->sizes.test_clusterWithzisegred_num_groups_30995;
                num_groups_30996 = sext_i64_i32(smax64((int64_t) 1,
                                                       smin64(sdiv_up64(numVert_28890,
                                                                        segred_group_sizze_30994),
                                                              sext_i32_i64(max_num_groups_34595))));
                
                struct memblock_device mem_32236;
                
                mem_32236.references = NULL;
                if (memblock_alloc_device(ctx, &mem_32236, (int64_t) 8,
                                          "mem_32236")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device test_clusterWithzicounter_mem_34596 =
                                       ctx->test_clusterWithzicounter_mem_34596;
                struct memblock_device group_res_arr_mem_34598;
                
                group_res_arr_mem_34598.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_34598,
                                          (int64_t) 8 *
                                          (segred_group_sizze_30994 *
                                           num_groups_30996),
                                          "group_res_arr_mem_34598")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t num_threads_34600;
                
                num_threads_34600 = num_groups_30996 * segred_group_sizze_30994;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                unsigned int shared_sizze_36147 = (int64_t) 8 *
                             segred_group_sizze_30994;
                unsigned int shared_sizze_36149 = 1;
                CUdeviceptr kernel_arg_36151 = mem_32220.mem;
                CUdeviceptr kernel_arg_36152 = mem_32236.mem;
                CUdeviceptr kernel_arg_36153 =
                            test_clusterWithzicounter_mem_34596.mem;
                CUdeviceptr kernel_arg_36154 = group_res_arr_mem_34598.mem;
                unsigned int shared_offset_36148 = 0;
                unsigned int shared_offset_36150 = 0 + (shared_sizze_36147 +
                                                        (8 -
                                                         shared_sizze_36147 %
                                                         8) % 8);
                
                if ((((((1 && num_groups_30996 != 0) && 1 != 0) && 1 != 0) &&
                      segred_group_sizze_30994 != 0) && 1 != 0) && 1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = num_groups_30996;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_36144[] = {&ctx->global_failure,
                                                 &shared_offset_36148,
                                                 &shared_offset_36150,
                                                 &numVert_28890,
                                                 &num_groups_30996,
                                                 &num_threads_34600,
                                                 &kernel_arg_36151,
                                                 &kernel_arg_36152,
                                                 &kernel_arg_36153,
                                                 &kernel_arg_36154};
                    int64_t time_start_36145 = 0, time_end_36146 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(ctx->log, "Launching %s with grid size (",
                                "test_clusterWith.segred_nonseg_31001");
                        fprintf(ctx->log, "%ld", (long) num_groups_30996);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ") and block size (");
                        fprintf(ctx->log, "%ld",
                                (long) segred_group_sizze_30994);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ", ");
                        fprintf(ctx->log, "%ld", (long) 1);
                        fprintf(ctx->log, ").\n");
                        time_start_36145 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->test_clusterWithzisegred_nonseg_31001_runs,
                                                  &ctx->test_clusterWithzisegred_nonseg_31001_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_31001,
                                                          grid[0], grid[1],
                                                          grid[2],
                                                          segred_group_sizze_30994,
                                                          1, 1, 0 +
                                                          (shared_sizze_36147 +
                                                           (8 -
                                                            shared_sizze_36147 %
                                                            8) % 8) +
                                                          (shared_sizze_36149 +
                                                           (8 -
                                                            shared_sizze_36149 %
                                                            8) % 8), NULL,
                                                          kernel_args_36144,
                                                          NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                        time_end_36146 = get_wall_time();
                        fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                "test_clusterWith.segred_nonseg_31001",
                                time_end_36146 - time_start_36145);
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t read_res_36155;
                
                {
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->copy_scalar_from_dev_runs,
                                                  &ctx->copy_scalar_from_dev_total_runtime);
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36155,
                                                        mem_32236.mem +
                                                        (int64_t) 0 *
                                                        sizeof(int64_t),
                                                        sizeof(int64_t)));
                    if (pevents != NULL)
                        CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                }
                if (futhark_context_sync(ctx) != 0)
                    return 1;
                
                int64_t defunc_2_reduce_res_29555 = read_res_36155;
                
                if (memblock_unref_device(ctx, &mem_32236, "mem_32236") != 0)
                    return 1;
                
                bool loop_cond_t_res_29560 = sle64(defunc_2_reduce_res_29555,
                                                   maxSizze_29114);
                
                loop_cond_29554 = loop_cond_t_res_29560;
                if (memblock_unref_device(ctx, &group_res_arr_mem_34598,
                                          "group_res_arr_mem_34598") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_32236, "mem_32236") != 0)
                    return 1;
            } else {
                loop_cond_29554 = 0;
            }
            
            struct memblock_device mem_param_tmp_33142;
            
            mem_param_tmp_33142.references = NULL;
            if (memblock_set_device(ctx, &mem_param_tmp_33142, &mem_32227,
                                    "mem_32227") != 0)
                return 1;
            
            struct memblock_device mem_param_tmp_33143;
            
            mem_param_tmp_33143.references = NULL;
            if (memblock_set_device(ctx, &mem_param_tmp_33143, &mem_32222,
                                    "mem_32222") != 0)
                return 1;
            
            struct memblock_device mem_param_tmp_33144;
            
            mem_param_tmp_33144.references = NULL;
            if (memblock_set_device(ctx, &mem_param_tmp_33144, &mem_32220,
                                    "mem_32220") != 0)
                return 1;
            
            bool loop_while_tmp_33145;
            
            loop_while_tmp_33145 = loop_cond_29554;
            if (memblock_set_device(ctx, &mem_param_32074, &mem_param_tmp_33142,
                                    "mem_param_tmp_33142") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_32079, &mem_param_tmp_33143,
                                    "mem_param_tmp_33143") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_32084, &mem_param_tmp_33144,
                                    "mem_param_tmp_33144") != 0)
                return 1;
            loop_while_29146 = loop_while_tmp_33145;
            if (memblock_unref_device(ctx, &mem_param_tmp_33144,
                                      "mem_param_tmp_33144") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_tmp_33143,
                                      "mem_param_tmp_33143") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_tmp_33142,
                                      "mem_param_tmp_33142") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_34536,
                                      "group_res_arr_mem_34536") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32227, "mem_32227") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32225, "mem_32225") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32222, "mem_32222") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32220, "mem_32220") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32218, "mem_32218") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32216, "mem_32216") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32212, "mem_32212") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32210, "mem_32210") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32207, "mem_32207") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32205, "mem_32205") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32202, "mem_32202") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32199, "mem_32199") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32197, "mem_32197") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32195, "mem_32195") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32192, "mem_32192") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32190, "mem_32190") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32186, "mem_32186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32184, "mem_32184") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32181, "mem_32181") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32179, "mem_32179") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32176, "mem_32176") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32173, "mem_32173") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32171, "mem_32171") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32169, "mem_32169") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32132,
                                      "mem_param_32132") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32127,
                                      "mem_param_32127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32166,
                                      "defunc_0_f_res_mem_32166") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_32161,
                                      "defunc_0_f_res_mem_32161") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32147, "mem_32147") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32145, "mem_32145") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32143, "mem_32143") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32141, "mem_32141") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32139, "mem_32139") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32122, "mem_32122") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32120, "mem_32120") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32118, "mem_32118") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32116, "mem_32116") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32113, "mem_32113") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32111, "mem_32111") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32108, "mem_32108") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32106, "mem_32106") != 0)
                return 1;
            if (memblock_unref_device(ctx,
                                      &defunc_1_map_res_subhistos_mem_33261,
                                      "defunc_1_map_res_subhistos_mem_33261") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32102, "mem_32102") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33232,
                                      "group_res_arr_mem_33232") != 0)
                return 1;
        }
        if (memblock_set_device(ctx, &lifted_fromInit_res_mem_32247,
                                &mem_param_32074, "mem_param_32074") != 0)
            return 1;
        if (memblock_set_device(ctx, &lifted_fromInit_res_mem_32252,
                                &mem_param_32079, "mem_param_32079") != 0)
            return 1;
        if (memblock_set_device(ctx, &lifted_fromInit_res_mem_32257,
                                &mem_param_32084, "mem_param_32084") != 0)
            return 1;
        lifted_fromInit_res_29142 = loop_while_29146;
        if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
            return 1;
        
        int64_t loopres_29564 = mul64((int64_t) 2, maxSizze_29114);
        struct memblock_device test_clusterWithzicounter_mem_34626 =
                               ctx->test_clusterWithzicounter_mem_34626;
        struct memblock_device group_res_arr_mem_34628;
        
        group_res_arr_mem_34628.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_34628, (int64_t) 8 *
                                  (segred_group_sizze_31004 * num_groups_31006),
                                  "group_res_arr_mem_34628")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_34630;
        
        num_threads_34630 = num_groups_31006 * segred_group_sizze_31004;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegRed");
        
        unsigned int shared_sizze_36160 = (int64_t) 8 *
                     segred_group_sizze_31004;
        unsigned int shared_sizze_36162 = 1;
        CUdeviceptr kernel_arg_36164 = lifted_fromInit_res_mem_32257.mem;
        CUdeviceptr kernel_arg_36165 = mem_32260.mem;
        CUdeviceptr kernel_arg_36166 = test_clusterWithzicounter_mem_34626.mem;
        CUdeviceptr kernel_arg_36167 = group_res_arr_mem_34628.mem;
        unsigned int shared_offset_36161 = 0;
        unsigned int shared_offset_36163 = 0 + (shared_sizze_36160 + (8 -
                                                                      shared_sizze_36160 %
                                                                      8) % 8);
        
        if ((((((1 && num_groups_31006 != 0) && 1 != 0) && 1 != 0) &&
              segred_group_sizze_31004 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = num_groups_31006;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36157[] = {&ctx->global_failure,
                                         &shared_offset_36161,
                                         &shared_offset_36163, &numVert_28890,
                                         &num_groups_31006, &num_threads_34630,
                                         &kernel_arg_36164, &kernel_arg_36165,
                                         &kernel_arg_36166, &kernel_arg_36167};
            int64_t time_start_36158 = 0, time_end_36159 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segred_nonseg_31011");
                fprintf(ctx->log, "%ld", (long) num_groups_31006);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segred_group_sizze_31004);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36158 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegred_nonseg_31011_runs,
                                          &ctx->test_clusterWithzisegred_nonseg_31011_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_31011,
                                                  grid[0], grid[1], grid[2],
                                                  segred_group_sizze_31004, 1,
                                                  1, 0 + (shared_sizze_36160 +
                                                          (8 -
                                                           shared_sizze_36160 %
                                                           8) % 8) +
                                                  (shared_sizze_36162 + (8 -
                                                                         shared_sizze_36162 %
                                                                         8) %
                                                   8), NULL, kernel_args_36157,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36159 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segred_nonseg_31011", time_end_36159 -
                        time_start_36158);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t read_res_36168;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36168, mem_32260.mem +
                                                (int64_t) 0 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t defunc_2_reduce_res_29565 = read_res_36168;
        bool cond_29570 = defunc_2_reduce_res_29565 == (int64_t) 0;
        bool loop_cond_f_res_29571 = slt64(loopres_29564,
                                           defunc_2_reduce_res_29565);
        bool x_29572 = !cond_29570;
        bool y_29573 = loop_cond_f_res_29571 && x_29572;
        bool loop_cond_29574 = cond_29570 || y_29573;
        int64_t loopz2081Uz2082Uz2086U_tmp_33068 = maxSizze_29114;
        int64_t ctx_param_ext_tmp_33069 = maxSizze_29114;
        int64_t ctx_param_ext_tmp_33070 = maxSizze_29114;
        struct memblock_device mem_param_tmp_33071;
        
        mem_param_tmp_33071.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_33071,
                                &lifted_fromInit_res_mem_32247,
                                "lifted_fromInit_res_mem_32247") != 0)
            return 1;
        
        struct memblock_device mem_param_tmp_33072;
        
        mem_param_tmp_33072.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_33072,
                                &lifted_fromInit_res_mem_32252,
                                "lifted_fromInit_res_mem_32252") != 0)
            return 1;
        
        struct memblock_device mem_param_tmp_33073;
        
        mem_param_tmp_33073.references = NULL;
        if (memblock_set_device(ctx, &mem_param_tmp_33073,
                                &lifted_fromInit_res_mem_32257,
                                "lifted_fromInit_res_mem_32257") != 0)
            return 1;
        
        bool loop_while_tmp_33074;
        
        loop_while_tmp_33074 = loop_cond_29574;
        
        int64_t maxSizze_tmp_33075;
        
        maxSizze_tmp_33075 = loopres_29564;
        loopz2081Uz2082Uz2086U_29112 = loopz2081Uz2082Uz2086U_tmp_33068;
        ctx_param_ext_32039 = ctx_param_ext_tmp_33069;
        ctx_param_ext_32042 = ctx_param_ext_tmp_33070;
        if (memblock_set_device(ctx, &mem_param_32043, &mem_param_tmp_33071,
                                "mem_param_tmp_33071") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32048, &mem_param_tmp_33072,
                                "mem_param_tmp_33072") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_32053, &mem_param_tmp_33073,
                                "mem_param_tmp_33073") != 0)
            return 1;
        loop_while_29113 = loop_while_tmp_33074;
        maxSizze_29114 = maxSizze_tmp_33075;
        if (memblock_unref_device(ctx, &mem_param_tmp_33073,
                                  "mem_param_tmp_33073") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_33072,
                                  "mem_param_tmp_33072") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_33071,
                                  "mem_param_tmp_33071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_34628,
                                  "group_res_arr_mem_34628") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32084, "mem_param_32084") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32079, "mem_param_32079") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32074, "mem_param_32074") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32257,
                                  "lifted_fromInit_res_mem_32257") != 0)
            return 1;
        if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32252,
                                  "lifted_fromInit_res_mem_32252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &lifted_fromInit_res_mem_32247,
                                  "lifted_fromInit_res_mem_32247") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32063, "mem_32063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32061, "mem_32061") != 0)
            return 1;
    }
    sizze_29106 = loopz2081Uz2082Uz2086U_29112;
    clusterWith_res_ixfn_32261 = ctx_param_ext_32039;
    clusterWith_res_ixfn_32264 = ctx_param_ext_32042;
    if (memblock_set_device(ctx, &clusterWith_res_mem_32265, &mem_param_32043,
                            "mem_param_32043") != 0)
        return 1;
    if (memblock_set_device(ctx, &clusterWith_res_mem_32270, &mem_param_32048,
                            "mem_param_32048") != 0)
        return 1;
    if (memblock_set_device(ctx, &clusterWith_res_mem_32275, &mem_param_32053,
                            "mem_param_32053") != 0)
        return 1;
    clusterWith_res_29107 = loop_while_29113;
    clusterWith_res_29108 = maxSizze_29114;
    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
        return 1;
    
    int64_t i32_res_29575 = sext_i32_i64(thres_28889);
    int64_t segscan_group_sizze_31014;
    
    segscan_group_sizze_31014 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_31013;
    
    int64_t num_groups_31016;
    int32_t max_num_groups_34656;
    
    max_num_groups_34656 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_31015;
    num_groups_31016 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(numVert_28890,
                                                            segscan_group_sizze_31014),
                                                  sext_i32_i64(max_num_groups_34656))));
    
    struct memblock_device mem_32278;
    
    mem_32278.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32278, bytes_32025, "mem_32278")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32280;
    
    mem_32280.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32280, bytes_32025, "mem_32280")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, numVert_28890)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_34657;
        
        numThreads_34657 = sdiv_up64(numVert_28890, segscan_group_sizze_31014 *
                                     (int64_t) 9) * segscan_group_sizze_31014;
        
        int64_t numGroups_34658;
        
        numGroups_34658 = sdiv_up64(numVert_28890, segscan_group_sizze_31014 *
                                    (int64_t) 9);
        
        struct memblock_device test_clusterWithziid_counter_mem_34659 =
                               ctx->test_clusterWithziid_counter_mem_34659;
        struct memblock_device status_flags_mem_34661;
        
        status_flags_mem_34661.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_34661, numGroups_34658,
                                  "status_flags_mem_34661")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_34663;
        
        aggregates_mem_34663.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_34663, (int64_t) 8 *
                                  numGroups_34658, "aggregates_mem_34663")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_34665;
        
        incprefixes_mem_34665.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_34665, (int64_t) 8 *
                                  numGroups_34658, "incprefixes_mem_34665")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34661,
                                         numGroups_34658, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36173 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_31014),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_31014 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36175 = clusterWith_res_mem_32275.mem;
        CUdeviceptr kernel_arg_36176 = mem_32278.mem;
        CUdeviceptr kernel_arg_36177 = mem_32280.mem;
        CUdeviceptr kernel_arg_36178 =
                    test_clusterWithziid_counter_mem_34659.mem;
        CUdeviceptr kernel_arg_36179 = status_flags_mem_34661.mem;
        CUdeviceptr kernel_arg_36180 = aggregates_mem_34663.mem;
        CUdeviceptr kernel_arg_36181 = incprefixes_mem_34665.mem;
        unsigned int shared_offset_36174 = 0;
        
        if ((((((1 && sdiv_up64(numVert_28890, segscan_group_sizze_31014 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_31014 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(numVert_28890, segscan_group_sizze_31014 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36170[] = {&ctx->global_failure,
                                         &shared_offset_36174, &numVert_28890,
                                         &i32_res_29575, &kernel_arg_36175,
                                         &kernel_arg_36176, &kernel_arg_36177,
                                         &kernel_arg_36178, &kernel_arg_36179,
                                         &kernel_arg_36180, &kernel_arg_36181};
            int64_t time_start_36171 = 0, time_end_36172 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segscan_31019");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(numVert_28890,
                                                          segscan_group_sizze_31014 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31014);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36171 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegscan_31019_runs,
                                          &ctx->test_clusterWithzisegscan_31019_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_31019,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_31014, 1,
                                                  1, 0 + (shared_sizze_36173 +
                                                          (8 -
                                                           shared_sizze_36173 %
                                                           8) % 8), NULL,
                                                  kernel_args_36170, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36172 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segscan_31019", time_end_36172 -
                        time_start_36171);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_34665,
                                  "incprefixes_mem_34665") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_34663,
                                  "aggregates_mem_34663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_34661,
                                  "status_flags_mem_34661") != 0)
            return 1;
    }
    
    int64_t last_index_29589 = numVert_28890 - (int64_t) 1;
    bool is_empty_29590 = numVert_28890 == (int64_t) 0;
    int64_t partition_sizze_29591;
    
    if (is_empty_29590) {
        partition_sizze_29591 = (int64_t) 0;
    } else {
        int64_t read_res_36182;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36182, mem_32278.mem +
                                                last_index_29589 *
                                                sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_offset_29592 = read_res_36182;
        
        partition_sizze_29591 = last_offset_29592;
    }
    
    struct memblock_device mem_32282;
    
    mem_32282.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32282, bytes_31949, "mem_32282")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_31024;
    
    segmap_group_sizze_31024 =
        ctx->sizes.test_clusterWithzisegmap_group_sizze_31023;
    
    int64_t segmap_usable_groups_31025 = sdiv_up64(numVert_28890,
                                                   segmap_group_sizze_31024);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36186 = mem_32038.mem;
    CUdeviceptr kernel_arg_36187 = mem_32278.mem;
    CUdeviceptr kernel_arg_36188 = mem_32280.mem;
    CUdeviceptr kernel_arg_36189 = mem_32282.mem;
    
    if ((((((1 && segmap_usable_groups_31025 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_31024 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_31025;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36183[] = {&ctx->global_failure, &numVert_28890,
                                     &kernel_arg_36186, &kernel_arg_36187,
                                     &kernel_arg_36188, &kernel_arg_36189};
        int64_t time_start_36184 = 0, time_end_36185 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_clusterWith.segmap_31021");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31025);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31024);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36184 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_clusterWithzisegmap_31021_runs,
                                      &ctx->test_clusterWithzisegmap_31021_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_31021,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_31024, 1, 1, 0,
                                              NULL, kernel_args_36183, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36185 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_clusterWith.segmap_31021", time_end_36185 -
                    time_start_36184);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
        return 1;
    
    bool empty_slice_29602 = partition_sizze_29591 == (int64_t) 0;
    int64_t m_29603 = sub64(partition_sizze_29591, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_29604 = sle64((int64_t) 0, m_29603);
    bool i_p_m_t_s_leq_w_29605 = slt64(m_29603, numVert_28890);
    bool i_lte_j_29606 = sle64((int64_t) 0, partition_sizze_29591);
    bool y_29607 = zzero_leq_i_p_m_t_s_29604 && i_p_m_t_s_leq_w_29605;
    bool y_29608 = i_lte_j_29606 && y_29607;
    bool ok_or_empty_29609 = empty_slice_29602 || y_29608;
    bool index_certs_29610;
    
    if (!ok_or_empty_29609) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [:", partition_sizze_29591,
                               "] out of bounds for array of shape [",
                               numVert_28890, "].",
                               "-> #0  /prelude/soacs.fut:155:6-16\n   #1  /prelude/functional.fut:9:42-44\n   #2  src/cluster.fut:180:21-181:46\n   #3  src/cluster_test.fut:42:9-31\n   #4  src/cluster_test.fut:36:1-42:36\n");
        if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32053, "mem_param_32053") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32048, "mem_param_32048") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_32043, "mem_param_32043") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                  "clusterWith_res_mem_32275") != 0)
            return 1;
        if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                  "clusterWith_res_mem_32270") != 0)
            return 1;
        if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                  "clusterWith_res_mem_32265") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                  "group_res_arr_mem_33035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                  "defunc_0_f_res_mem_31998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                  "defunc_0_f_res_mem_31993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    struct memblock_device mem_32285;
    
    mem_32285.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32285, (int64_t) 0, "mem_32285")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_32287;
    
    mem_32287.references = NULL;
    if (memblock_alloc_device(ctx, &mem_32287, (int64_t) 0, "mem_32287")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t sizze_29614;
    
    if (empty_slice_29602) {
        sizze_29614 = (int64_t) 0;
    } else {
        sizze_29614 = partition_sizze_29591;
    }
    
    int64_t segscan_group_sizze_31028;
    
    segscan_group_sizze_31028 =
        ctx->sizes.test_clusterWithzisegscan_group_sizze_31027;
    
    int64_t num_groups_31030;
    int32_t max_num_groups_34743;
    
    max_num_groups_34743 =
        ctx->sizes.test_clusterWithzisegscan_num_groups_31029;
    num_groups_31030 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(partition_sizze_29591,
                                                            segscan_group_sizze_31028),
                                                  sext_i32_i64(max_num_groups_34743))));
    
    int64_t segred_group_sizze_31036;
    
    segred_group_sizze_31036 =
        ctx->sizes.test_clusterWithzisegred_group_sizze_31035;
    
    int64_t num_groups_31038;
    int32_t max_num_groups_34744;
    
    max_num_groups_34744 = ctx->sizes.test_clusterWithzisegred_num_groups_31037;
    num_groups_31038 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(partition_sizze_29591,
                                                            segred_group_sizze_31036),
                                                  sext_i32_i64(max_num_groups_34744))));
    
    int64_t bytes_32289 = (int64_t) 8 * partition_sizze_29591;
    int64_t sizze_29615;
    int64_t clusterWith_res_ixfn_32320;
    struct memblock_device clusterWith_res_mem_32321;
    
    clusterWith_res_mem_32321.references = NULL;
    
    struct memblock_device clusterWith_res_mem_32323;
    
    clusterWith_res_mem_32323.references = NULL;
    
    struct memblock_device clusterWith_res_mem_32325;
    
    clusterWith_res_mem_32325.references = NULL;
    if (empty_slice_29602) {
        sizze_29615 = (int64_t) 0;
        clusterWith_res_ixfn_32320 = (int64_t) 0;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32321, &mem_32285,
                                "mem_32285") != 0)
            return 1;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32323, &mem_32287,
                                "mem_32287") != 0)
            return 1;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32325, &mem_32287,
                                "mem_32287") != 0)
            return 1;
    } else {
        struct memblock_device mem_32290;
        
        mem_32290.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32290, bytes_32289, "mem_32290")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_32292;
        
        mem_32292.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32292, bytes_32289, "mem_32292")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, partition_sizze_29591)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_34745;
            
            numThreads_34745 = sdiv_up64(partition_sizze_29591,
                                         segscan_group_sizze_31028 *
                                         (int64_t) 9) *
                segscan_group_sizze_31028;
            
            int64_t numGroups_34746;
            
            numGroups_34746 = sdiv_up64(partition_sizze_29591,
                                        segscan_group_sizze_31028 *
                                        (int64_t) 9);
            
            struct memblock_device test_clusterWithziid_counter_mem_34747 =
                                   ctx->test_clusterWithziid_counter_mem_34747;
            struct memblock_device status_flags_mem_34749;
            
            status_flags_mem_34749.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_34749,
                                      numGroups_34746,
                                      "status_flags_mem_34749")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_34751;
            
            aggregates_mem_34751.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_34751, (int64_t) 8 *
                                      numGroups_34746,
                                      "aggregates_mem_34751")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_34753;
            
            incprefixes_mem_34753.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_34753, (int64_t) 8 *
                                      numGroups_34746,
                                      "incprefixes_mem_34753")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_34749,
                                             numGroups_34746, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_36194 = smax64(smax64((int64_t) 288,
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31028),
                                                     (int64_t) 9 *
                                                     segscan_group_sizze_31028 *
                                                     (int64_t) 8);
            CUdeviceptr kernel_arg_36196 = clusterWith_res_mem_32275.mem;
            CUdeviceptr kernel_arg_36197 = mem_32282.mem;
            CUdeviceptr kernel_arg_36198 = mem_32290.mem;
            CUdeviceptr kernel_arg_36199 = mem_32292.mem;
            CUdeviceptr kernel_arg_36200 =
                        test_clusterWithziid_counter_mem_34747.mem;
            CUdeviceptr kernel_arg_36201 = status_flags_mem_34749.mem;
            CUdeviceptr kernel_arg_36202 = aggregates_mem_34751.mem;
            CUdeviceptr kernel_arg_36203 = incprefixes_mem_34753.mem;
            unsigned int shared_offset_36195 = 0;
            
            if ((((((1 && sdiv_up64(partition_sizze_29591,
                                    segscan_group_sizze_31028 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31028 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(partition_sizze_29591,
                                          segscan_group_sizze_31028 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36191[] = {&ctx->global_failure,
                                             &ctx->failure_is_an_option,
                                             &ctx->global_failure_args,
                                             &shared_offset_36195,
                                             &numVert_28890,
                                             &partition_sizze_29591,
                                             &kernel_arg_36196,
                                             &kernel_arg_36197,
                                             &kernel_arg_36198,
                                             &kernel_arg_36199,
                                             &kernel_arg_36200,
                                             &kernel_arg_36201,
                                             &kernel_arg_36202,
                                             &kernel_arg_36203};
                int64_t time_start_36192 = 0, time_end_36193 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segscan_31033");
                    fprintf(ctx->log, "%ld",
                            (long) sdiv_up64(partition_sizze_29591,
                                             segscan_group_sizze_31028 *
                                             (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31028);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36192 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegscan_31033_runs,
                                              &ctx->test_clusterWithzisegscan_31033_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_31033,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31028,
                                                      1, 1, 0 +
                                                      (shared_sizze_36194 + (8 -
                                                                             shared_sizze_36194 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_36191, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36193 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segscan_31033", time_end_36193 -
                            time_start_36192);
                }
            }
            ctx->failure_is_an_option = 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_34753,
                                      "incprefixes_mem_34753") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_34751,
                                      "aggregates_mem_34751") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_34749,
                                      "status_flags_mem_34749") != 0)
                return 1;
        }
        
        struct memblock_device mem_32295;
        
        mem_32295.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32295, (int64_t) 8, "mem_32295")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device test_clusterWithzicounter_mem_34826 =
                               ctx->test_clusterWithzicounter_mem_34826;
        struct memblock_device group_res_arr_mem_34828;
        
        group_res_arr_mem_34828.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_34828, (int64_t) 8 *
                                  (segred_group_sizze_31036 * num_groups_31038),
                                  "group_res_arr_mem_34828")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_34830;
        
        num_threads_34830 = num_groups_31038 * segred_group_sizze_31036;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegRed");
        
        unsigned int shared_sizze_36208 = (int64_t) 8 *
                     segred_group_sizze_31036;
        unsigned int shared_sizze_36210 = 1;
        CUdeviceptr kernel_arg_36212 = mem_32292.mem;
        CUdeviceptr kernel_arg_36213 = mem_32295.mem;
        CUdeviceptr kernel_arg_36214 = test_clusterWithzicounter_mem_34826.mem;
        CUdeviceptr kernel_arg_36215 = group_res_arr_mem_34828.mem;
        unsigned int shared_offset_36209 = 0;
        unsigned int shared_offset_36211 = 0 + (shared_sizze_36208 + (8 -
                                                                      shared_sizze_36208 %
                                                                      8) % 8);
        
        if ((((((1 && num_groups_31038 != 0) && 1 != 0) && 1 != 0) &&
              segred_group_sizze_31036 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = num_groups_31038;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36205[] = {&ctx->global_failure,
                                         &shared_offset_36209,
                                         &shared_offset_36211,
                                         &partition_sizze_29591,
                                         &num_groups_31038, &num_threads_34830,
                                         &kernel_arg_36212, &kernel_arg_36213,
                                         &kernel_arg_36214, &kernel_arg_36215};
            int64_t time_start_36206 = 0, time_end_36207 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segred_nonseg_31043");
                fprintf(ctx->log, "%ld", (long) num_groups_31038);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segred_group_sizze_31036);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36206 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegred_nonseg_31043_runs,
                                          &ctx->test_clusterWithzisegred_nonseg_31043_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_nonseg_31043,
                                                  grid[0], grid[1], grid[2],
                                                  segred_group_sizze_31036, 1,
                                                  1, 0 + (shared_sizze_36208 +
                                                          (8 -
                                                           shared_sizze_36208 %
                                                           8) % 8) +
                                                  (shared_sizze_36210 + (8 -
                                                                         shared_sizze_36210 %
                                                                         8) %
                                                   8), NULL, kernel_args_36205,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36207 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segred_nonseg_31043", time_end_36207 -
                        time_start_36206);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t read_res_36216;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36216, mem_32295.mem +
                                                (int64_t) 0 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t defunc_2_reduce_res_29634 = read_res_36216;
        
        if (memblock_unref_device(ctx, &mem_32295, "mem_32295") != 0)
            return 1;
        
        bool bounds_invalid_upwards_29639 = slt64(defunc_2_reduce_res_29634,
                                                  (int64_t) 0);
        bool valid_29640 = !bounds_invalid_upwards_29639;
        bool range_valid_c_29641;
        
        if (!valid_29640) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                          defunc_2_reduce_res_29634, " is invalid.",
                          "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  src/cluster.fut:51:14-32\n   #4  src/cluster.fut:184:10-74\n   #5  src/cluster_test.fut:42:9-31\n   #6  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &group_res_arr_mem_34828,
                                      "group_res_arr_mem_34828") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32295, "mem_32295") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32292, "mem_32292") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32290, "mem_32290") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32325,
                                      "clusterWith_res_mem_32325") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32323,
                                      "clusterWith_res_mem_32323") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32321,
                                      "clusterWith_res_mem_32321") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32287, "mem_32287") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32285, "mem_32285") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32053,
                                      "mem_param_32053") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32048,
                                      "mem_param_32048") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32043,
                                      "mem_param_32043") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                      "clusterWith_res_mem_32275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                      "clusterWith_res_mem_32270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                      "clusterWith_res_mem_32265") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                      "group_res_arr_mem_33035") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_32296 = (int64_t) 8 * defunc_2_reduce_res_29634;
        struct memblock_device mem_32297;
        
        mem_32297.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32297, bytes_32296, "mem_32297")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_32297,
                                          defunc_2_reduce_res_29634,
                                          (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t seghist_group_sizze_31046;
        
        seghist_group_sizze_31046 =
            ctx->sizes.test_clusterWithziseghist_group_sizze_31045;
        
        int64_t num_groups_31048;
        int32_t max_num_groups_34856;
        
        max_num_groups_34856 =
            ctx->sizes.test_clusterWithziseghist_num_groups_31047;
        num_groups_31048 = sext_i64_i32(smax64((int64_t) 1,
                                               smin64(sdiv_up64(partition_sizze_29591,
                                                                seghist_group_sizze_31046),
                                                      sext_i32_i64(max_num_groups_34856))));
        
        int32_t num_subhistos_34857;
        struct memblock_device defunc_1_map_res_subhistos_mem_34858;
        
        defunc_1_map_res_subhistos_mem_34858.references = NULL;
        
        int64_t h_34860;
        
        h_34860 = (int64_t) 8 * defunc_2_reduce_res_29634;
        
        int64_t seg_h_34861;
        
        seg_h_34861 = (int64_t) 8 * defunc_2_reduce_res_29634;
        if (!(seg_h_34861 == (int64_t) 0)) {
            int64_t hist_H_34862 = defunc_2_reduce_res_29634;
            int64_t hist_el_sizze_34863 = sdiv_up64(h_34860, hist_H_34862);
            int64_t hist_N_34864 = partition_sizze_29591;
            int32_t hist_RF_34865 = 1;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)",
                        (long long) sext_i64_i32(num_groups_31048 *
                        seghist_group_sizze_31046), '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Desired group size (B)",
                        (long long) seghist_group_sizze_31046, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_34862, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Input elements per histogram (N)",
                        (long long) hist_N_34864, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of segments",
                        (long long) (int64_t) 1, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Histogram element size (el_size)",
                        (long long) hist_el_sizze_34863, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)",
                        (long long) hist_RF_34865, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Memory per set of subhistograms per segment",
                        (long long) h_34860, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c",
                        "Memory per set of subhistograms times segments",
                        (long long) seg_h_34861, '\n');
            
            int32_t hist_L_34866;
            
            hist_L_34866 = ctx->cuda.max_shared_memory;
            
            int32_t max_group_sizze_34867;
            
            max_group_sizze_34867 = ctx->cuda.max_block_size;
            
            int64_t num_groups_34868;
            
            num_groups_34868 =
                sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_31048 *
                          seghist_group_sizze_31046)), max_group_sizze_34867);
            
            double hist_m_prime_34869;
            
            hist_m_prime_34869 =
                sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_34866,
                                                           hist_el_sizze_34863)),
                                      sdiv_up64(hist_N_34864,
                                                num_groups_34868))) /
                sitofp_i64_f64(hist_H_34862);
            
            int64_t hist_M0_34870;
            
            hist_M0_34870 = smax64((int64_t) 1,
                                   smin64(fptosi_f64_i64(hist_m_prime_34869),
                                          max_group_sizze_34867));
            
            int64_t hist_Nout_34871;
            
            hist_Nout_34871 = (int64_t) 1;
            
            int64_t hist_Nin_34872;
            
            hist_Nin_34872 = partition_sizze_29591;
            
            int64_t work_asymp_M_max_34873;
            
            work_asymp_M_max_34873 = squot64(hist_Nout_34871 * hist_N_34864,
                                             (int64_t) 2 * num_groups_34868 *
                                             hist_H_34862);
            
            int32_t hist_M_34874;
            
            hist_M_34874 = sext_i64_i32(smin64(hist_M0_34870,
                                               work_asymp_M_max_34873));
            
            int64_t hist_C_34875;
            
            hist_C_34875 = sdiv_up64(max_group_sizze_34867,
                                     sext_i32_i64(smax32(1, hist_M_34874)));
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local hist_M0",
                        (long long) hist_M0_34870, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local work asymp M max",
                        (long long) work_asymp_M_max_34873, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local C",
                        (long long) hist_C_34875, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local B",
                        (long long) max_group_sizze_34867, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local M",
                        (long long) hist_M_34874, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local memory needed",
                        (long long) (hist_H_34862 * hist_el_sizze_34863 *
                                     sext_i32_i64(hist_M_34874)), '\n');
            
            int64_t local_mem_needed_34876;
            
            local_mem_needed_34876 = hist_el_sizze_34863 *
                sext_i32_i64(hist_M_34874);
            
            int32_t hist_S_34877;
            
            hist_S_34877 = sext_i64_i32(sdiv_up64(hist_H_34862 *
                                                  local_mem_needed_34876,
                                                  hist_L_34866));
            if (sle64(hist_H_34862, hist_Nin_34872) &&
                (sle64(local_mem_needed_34876, hist_L_34866) &&
                 (sle32(hist_S_34877, 3) && (sle64(hist_C_34875,
                                                   max_group_sizze_34867) &&
                                             slt32(0, hist_M_34874))))) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "## Using local memory");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_34862, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_34874, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)",
                            (long long) hist_C_34875, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_34877, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Number of local subhistograms per group",
                            (long long) hist_M_34874, '\n');
                
                int64_t num_segments_34878;
                
                num_segments_34878 = (int64_t) 1;
                num_subhistos_34857 = num_groups_34868 * num_segments_34878;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c",
                            "Number of subhistograms in global memory",
                            (long long) num_subhistos_34857, '\n');
                if (num_subhistos_34857 == (int64_t) 1) {
                    if (memblock_set_device(ctx,
                                            &defunc_1_map_res_subhistos_mem_34858,
                                            &mem_32297, "mem_32297") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx,
                                              &defunc_1_map_res_subhistos_mem_34858,
                                              sext_i32_i64(num_subhistos_34857) *
                                              defunc_2_reduce_res_29634 *
                                              (int64_t) 8,
                                              "defunc_1_map_res_subhistos_mem_34858")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      defunc_1_map_res_subhistos_mem_34858,
                                                      num_subhistos_34857 *
                                                      defunc_2_reduce_res_29634,
                                                      (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_34858.mem +
                                                        (int64_t) 0,
                                                        mem_32297.mem +
                                                        (int64_t) 0,
                                                        defunc_2_reduce_res_29634 *
                                                        (int64_t) 8));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                    }
                }
                for (int32_t chk_i_34879 = 0; chk_i_34879 < hist_S_34877;
                     chk_i_34879++) {
                    int64_t num_segments_34880 = (int64_t) 1;
                    int64_t hist_H_chk_34881 =
                            sdiv_up64(defunc_2_reduce_res_29634,
                                      sext_i32_i64(hist_S_34877));
                    int64_t histo_sizze_34882 = hist_H_chk_34881;
                    int32_t init_per_thread_34883 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_34874) *
                                                   histo_sizze_34882,
                                                   max_group_sizze_34867));
                    unsigned int shared_sizze_36220 = (int64_t) 8 *
                                 (hist_M_34874 * hist_H_chk_34881);
                    CUdeviceptr kernel_arg_36222 = mem_32290.mem;
                    CUdeviceptr kernel_arg_36223 =
                                defunc_1_map_res_subhistos_mem_34858.mem;
                    unsigned int shared_offset_36221 = 0;
                    
                    if ((((((1 && num_groups_34868 != 0) && 1 != 0) && 1 !=
                           0) && max_group_sizze_34867 != 0) && 1 != 0) && 1 !=
                        0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = num_groups_34868;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_36217[] = {&ctx->global_failure,
                                                     &shared_offset_36221,
                                                     &partition_sizze_29591,
                                                     &defunc_2_reduce_res_29634,
                                                     &max_group_sizze_34867,
                                                     &num_groups_34868,
                                                     &hist_M_34874,
                                                     &chk_i_34879,
                                                     &num_segments_34880,
                                                     &hist_H_chk_34881,
                                                     &histo_sizze_34882,
                                                     &init_per_thread_34883,
                                                     &kernel_arg_36222,
                                                     &kernel_arg_36223};
                        int64_t time_start_36218 = 0, time_end_36219 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(ctx->log, "Launching %s with grid size (",
                                    "test_clusterWith.seghist_local_31051");
                            fprintf(ctx->log, "%ld", (long) num_groups_34868);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ") and block size (");
                            fprintf(ctx->log, "%ld",
                                    (long) max_group_sizze_34867);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ").\n");
                            time_start_36218 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->test_clusterWithziseghist_local_31051_runs,
                                                      &ctx->test_clusterWithziseghist_local_31051_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithziseghist_local_31051,
                                                              grid[0], grid[1],
                                                              grid[2],
                                                              max_group_sizze_34867,
                                                              1, 1, 0 +
                                                              (shared_sizze_36220 +
                                                               (8 -
                                                                shared_sizze_36220 %
                                                                8) % 8), NULL,
                                                              kernel_args_36217,
                                                              NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                            time_end_36219 = get_wall_time();
                            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                    "test_clusterWith.seghist_local_31051",
                                    time_end_36219 - time_start_36218);
                        }
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "## Using global memory");
                
                int64_t hist_H_34911;
                
                hist_H_34911 = defunc_2_reduce_res_29634;
                
                double hist_RF_34912;
                
                hist_RF_34912 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
                
                int32_t hist_el_sizze_34913;
                
                hist_el_sizze_34913 = 8;
                
                double hist_C_max_34914;
                
                hist_C_max_34914 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_31048 *
                           seghist_group_sizze_31046)),
                           sitofp_i32_f64(hist_H_34911) / 2.0);
                
                int32_t hist_M_min_34915;
                
                hist_M_min_34915 = smax32(1,
                                          sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_31048 *
                                          seghist_group_sizze_31046)) /
                                          hist_C_max_34914)));
                
                int32_t L2_sizze_34916;
                
                L2_sizze_34916 = ctx->sizes.test_clusterWithziL2_sizze_34916;
                
                double hist_RACE_exp_34917;
                
                hist_RACE_exp_34917 = fmax64(1.0, 0.75 * hist_RF_34912 / (64.0 /
                                                                          sitofp_i32_f64(hist_el_sizze_34913)));
                
                int32_t hist_S_34918;
                
                if (slt64(partition_sizze_29591, hist_H_34911)) {
                    hist_S_34918 = 1;
                } else {
                    hist_S_34918 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_34915) *
                                               hist_H_34911 *
                                               sext_i32_i64(hist_el_sizze_34913),
                                               fptosi_f64_i64(0.4 *
                                               sitofp_i32_f64(L2_sizze_34916) *
                                               hist_RACE_exp_34917)));
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c",
                            "Race expansion factor (RACE^exp)",
                            (double) hist_RACE_exp_34917, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_34918, '\n');
                
                int64_t hist_H_chk_34919;
                
                hist_H_chk_34919 = sdiv_up64(defunc_2_reduce_res_29634,
                                             sext_i32_i64(hist_S_34918));
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)",
                            (long long) hist_H_chk_34919, '\n');
                
                double hist_k_max_34920;
                
                hist_k_max_34920 = fmin64(0.4 *
                                          (sitofp_i32_f64(L2_sizze_34916) /
                                           sitofp_i32_f64(8)) *
                                          hist_RACE_exp_34917,
                                          sitofp_i32_f64(partition_sizze_29591)) /
                    sitofp_i32_f64(sext_i64_i32(num_groups_31048 *
                    seghist_group_sizze_31046));
                
                int64_t hist_u_34921;
                
                hist_u_34921 = (int64_t) 2;
                
                double hist_C_34922;
                
                hist_C_34922 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_31048 *
                           seghist_group_sizze_31046)),
                           sitofp_i32_f64(hist_u_34921 * hist_H_chk_34919) /
                           hist_k_max_34920);
                
                int32_t hist_M_34923;
                
                hist_M_34923 = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c",
                            "Elements/thread in L2 cache (k_max)",
                            (double) hist_k_max_34920, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_34923, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)",
                            (double) hist_C_34922, '\n');
                num_subhistos_34857 = sext_i32_i64(hist_M_34923);
                if (hist_M_34923 == 1) {
                    if (memblock_set_device(ctx,
                                            &defunc_1_map_res_subhistos_mem_34858,
                                            &mem_32297, "mem_32297") != 0)
                        return 1;
                } else {
                    if (num_subhistos_34857 == (int64_t) 1) {
                        if (memblock_set_device(ctx,
                                                &defunc_1_map_res_subhistos_mem_34858,
                                                &mem_32297, "mem_32297") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx,
                                                  &defunc_1_map_res_subhistos_mem_34858,
                                                  sext_i32_i64(num_subhistos_34857) *
                                                  defunc_2_reduce_res_29634 *
                                                  (int64_t) 8,
                                                  "defunc_1_map_res_subhistos_mem_34858")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          defunc_1_map_res_subhistos_mem_34858,
                                                          num_subhistos_34857 *
                                                          defunc_2_reduce_res_29634,
                                                          (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->copy_dev_to_dev_runs,
                                                          &ctx->copy_dev_to_dev_total_runtime);
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0],
                                                                   0));
                            }
                            CUDA_SUCCEED_OR_RETURN(cuMemcpy(defunc_1_map_res_subhistos_mem_34858.mem +
                                                            (int64_t) 0,
                                                            mem_32297.mem +
                                                            (int64_t) 0,
                                                            defunc_2_reduce_res_29634 *
                                                            (int64_t) 8));
                            if (pevents != NULL)
                                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1],
                                                                   0));
                        }
                    }
                }
                for (int32_t chk_i_34924 = 0; chk_i_34924 < hist_S_34918;
                     chk_i_34924++) {
                    int64_t hist_H_chk_34925 =
                            sdiv_up64(defunc_2_reduce_res_29634,
                                      sext_i32_i64(hist_S_34918));
                    CUdeviceptr kernel_arg_36227 = mem_32290.mem;
                    CUdeviceptr kernel_arg_36228 =
                                defunc_1_map_res_subhistos_mem_34858.mem;
                    
                    if ((((((1 && num_groups_31048 != 0) && 1 != 0) && 1 !=
                           0) && seghist_group_sizze_31046 != 0) && 1 != 0) &&
                        1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = num_groups_31048;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_36224[] = {&ctx->global_failure,
                                                     &partition_sizze_29591,
                                                     &defunc_2_reduce_res_29634,
                                                     &num_groups_31048,
                                                     &num_subhistos_34857,
                                                     &chk_i_34924,
                                                     &hist_H_chk_34925,
                                                     &kernel_arg_36227,
                                                     &kernel_arg_36228};
                        int64_t time_start_36225 = 0, time_end_36226 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(ctx->log, "Launching %s with grid size (",
                                    "test_clusterWith.seghist_global_31051");
                            fprintf(ctx->log, "%ld", (long) num_groups_31048);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ") and block size (");
                            fprintf(ctx->log, "%ld",
                                    (long) seghist_group_sizze_31046);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ").\n");
                            time_start_36225 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->test_clusterWithziseghist_global_31051_runs,
                                                      &ctx->test_clusterWithziseghist_global_31051_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithziseghist_global_31051,
                                                              grid[0], grid[1],
                                                              grid[2],
                                                              seghist_group_sizze_31046,
                                                              1, 1, 0, NULL,
                                                              kernel_args_36224,
                                                              NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                            time_end_36226 = get_wall_time();
                            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                    "test_clusterWith.seghist_global_31051",
                                    time_end_36226 - time_start_36225);
                        }
                    }
                }
            }
            if (num_subhistos_34857 == (int64_t) 1) {
                if (memblock_set_device(ctx, &mem_32297,
                                        &defunc_1_map_res_subhistos_mem_34858,
                                        "defunc_1_map_res_subhistos_mem_34858") !=
                    0)
                    return 1;
            } else {
                if (slt64(num_subhistos_34857 * (int64_t) 2,
                          seghist_group_sizze_31046)) {
                    int64_t segment_sizze_nonzzero_34937 = smax64((int64_t) 1,
                                                                  num_subhistos_34857);
                    int64_t num_threads_34938 = num_groups_31048 *
                            seghist_group_sizze_31046;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments",
                                (long long) defunc_2_reduce_res_29634, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_34857, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(seghist_group_sizze_31046,
                                                    segment_sizze_nonzzero_34937),
                                '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(defunc_2_reduce_res_29634,
                                                                   squot64(seghist_group_sizze_31046,
                                                                           segment_sizze_nonzzero_34937))),
                                '\n');
                    
                    unsigned int shared_sizze_36232 = (int64_t) 8 *
                                 seghist_group_sizze_31046;
                    CUdeviceptr kernel_arg_36234 = mem_32297.mem;
                    CUdeviceptr kernel_arg_36235 =
                                defunc_1_map_res_subhistos_mem_34858.mem;
                    unsigned int shared_offset_36233 = 0;
                    
                    if ((((((1 && num_groups_31048 != 0) && 1 != 0) && 1 !=
                           0) && seghist_group_sizze_31046 != 0) && 1 != 0) &&
                        1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = num_groups_31048;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_36229[] = {&ctx->global_failure,
                                                     &shared_offset_36233,
                                                     &defunc_2_reduce_res_29634,
                                                     &num_groups_31048,
                                                     &num_subhistos_34857,
                                                     &segment_sizze_nonzzero_34937,
                                                     &kernel_arg_36234,
                                                     &kernel_arg_36235};
                        int64_t time_start_36230 = 0, time_end_36231 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(ctx->log, "Launching %s with grid size (",
                                    "test_clusterWith.segred_small_34936");
                            fprintf(ctx->log, "%ld", (long) num_groups_31048);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ") and block size (");
                            fprintf(ctx->log, "%ld",
                                    (long) seghist_group_sizze_31046);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ").\n");
                            time_start_36230 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->test_clusterWithzisegred_small_34936_runs,
                                                      &ctx->test_clusterWithzisegred_small_34936_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_small_34936,
                                                              grid[0], grid[1],
                                                              grid[2],
                                                              seghist_group_sizze_31046,
                                                              1, 1, 0 +
                                                              (shared_sizze_36232 +
                                                               (8 -
                                                                shared_sizze_36232 %
                                                                8) % 8), NULL,
                                                              kernel_args_36229,
                                                              NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                            time_end_36231 = get_wall_time();
                            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                    "test_clusterWith.segred_small_34936",
                                    time_end_36231 - time_start_36230);
                        }
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                } else {
                    int64_t groups_per_segment_34958 =
                            sdiv_up64(num_groups_31048, smax64((int64_t) 1,
                                                               defunc_2_reduce_res_29634));
                    int64_t elements_per_thread_34959 =
                            sdiv_up64(num_subhistos_34857,
                                      seghist_group_sizze_31046 *
                                      groups_per_segment_34958);
                    int64_t virt_num_groups_34960 = groups_per_segment_34958 *
                            defunc_2_reduce_res_29634;
                    int64_t num_threads_34961 = num_groups_31048 *
                            seghist_group_sizze_31046;
                    int64_t threads_per_segment_34962 =
                            groups_per_segment_34958 *
                            seghist_group_sizze_31046;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments",
                                (long long) defunc_2_reduce_res_29634, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_34857, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_34960, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_groups",
                                (long long) num_groups_31048, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "group_size",
                                (long long) seghist_group_sizze_31046, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_34959, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_34958, '\n');
                    
                    struct memblock_device group_res_arr_mem_34963;
                    
                    group_res_arr_mem_34963.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_34963,
                                              (int64_t) 8 *
                                              (seghist_group_sizze_31046 *
                                               virt_num_groups_34960),
                                              "group_res_arr_mem_34963")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device test_clusterWithzicounter_mem_34965 =
                                           ctx->test_clusterWithzicounter_mem_34965;
                    unsigned int shared_sizze_36240 = 1;
                    unsigned int shared_sizze_36242 = (int64_t) 8 *
                                 seghist_group_sizze_31046;
                    CUdeviceptr kernel_arg_36244 = mem_32297.mem;
                    CUdeviceptr kernel_arg_36245 =
                                defunc_1_map_res_subhistos_mem_34858.mem;
                    CUdeviceptr kernel_arg_36246 = group_res_arr_mem_34963.mem;
                    CUdeviceptr kernel_arg_36247 =
                                test_clusterWithzicounter_mem_34965.mem;
                    unsigned int shared_offset_36241 = 0;
                    unsigned int shared_offset_36243 = 0 + (shared_sizze_36240 +
                                                            (8 -
                                                             shared_sizze_36240 %
                                                             8) % 8);
                    
                    if ((((((1 && num_groups_31048 != 0) && 1 != 0) && 1 !=
                           0) && seghist_group_sizze_31046 != 0) && 1 != 0) &&
                        1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = num_groups_31048;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_36237[] = {&ctx->global_failure,
                                                     &shared_offset_36241,
                                                     &shared_offset_36243,
                                                     &defunc_2_reduce_res_29634,
                                                     &num_groups_31048,
                                                     &num_subhistos_34857,
                                                     &groups_per_segment_34958,
                                                     &elements_per_thread_34959,
                                                     &virt_num_groups_34960,
                                                     &threads_per_segment_34962,
                                                     &kernel_arg_36244,
                                                     &kernel_arg_36245,
                                                     &kernel_arg_36246,
                                                     &kernel_arg_36247};
                        int64_t time_start_36238 = 0, time_end_36239 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(ctx->log, "Launching %s with grid size (",
                                    "test_clusterWith.segred_large_34936");
                            fprintf(ctx->log, "%ld", (long) num_groups_31048);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ") and block size (");
                            fprintf(ctx->log, "%ld",
                                    (long) seghist_group_sizze_31046);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ", ");
                            fprintf(ctx->log, "%ld", (long) 1);
                            fprintf(ctx->log, ").\n");
                            time_start_36238 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->test_clusterWithzisegred_large_34936_runs,
                                                      &ctx->test_clusterWithzisegred_large_34936_total_runtime);
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegred_large_34936,
                                                              grid[0], grid[1],
                                                              grid[2],
                                                              seghist_group_sizze_31046,
                                                              1, 1, 0 +
                                                              (shared_sizze_36240 +
                                                               (8 -
                                                                shared_sizze_36240 %
                                                                8) % 8) +
                                                              (shared_sizze_36242 +
                                                               (8 -
                                                                shared_sizze_36242 %
                                                                8) % 8), NULL,
                                                              kernel_args_36237,
                                                              NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                            time_end_36239 = get_wall_time();
                            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                                    "test_clusterWith.segred_large_34936",
                                    time_end_36239 - time_start_36238);
                        }
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_unref_device(ctx, &group_res_arr_mem_34963,
                                              "group_res_arr_mem_34963") != 0)
                        return 1;
                }
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_32290, "mem_32290") != 0)
            return 1;
        
        int64_t segscan_group_sizze_31061;
        
        segscan_group_sizze_31061 =
            ctx->sizes.test_clusterWithzisegscan_group_sizze_31060;
        
        int64_t num_groups_31063;
        int32_t max_num_groups_34997;
        
        max_num_groups_34997 =
            ctx->sizes.test_clusterWithzisegscan_num_groups_31062;
        num_groups_31063 = sext_i64_i32(smax64((int64_t) 1,
                                               smin64(sdiv_up64(defunc_2_reduce_res_29634,
                                                                segscan_group_sizze_31061),
                                                      sext_i32_i64(max_num_groups_34997))));
        
        struct memblock_device mem_32301;
        
        mem_32301.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32301, defunc_2_reduce_res_29634,
                                  "mem_32301")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_32303;
        
        mem_32303.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32303, bytes_32296, "mem_32303")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, defunc_2_reduce_res_29634)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_34998;
            
            numThreads_34998 = sdiv_up64(defunc_2_reduce_res_29634,
                                         segscan_group_sizze_31061 *
                                         (int64_t) 9) *
                segscan_group_sizze_31061;
            
            int64_t numGroups_34999;
            
            numGroups_34999 = sdiv_up64(defunc_2_reduce_res_29634,
                                        segscan_group_sizze_31061 *
                                        (int64_t) 9);
            
            struct memblock_device test_clusterWithziid_counter_mem_35000 =
                                   ctx->test_clusterWithziid_counter_mem_35000;
            struct memblock_device status_flags_mem_35002;
            
            status_flags_mem_35002.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_35002,
                                      numGroups_34999,
                                      "status_flags_mem_35002")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_35004;
            
            aggregates_mem_35004.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_35004,
                                      numGroups_34999,
                                      "aggregates_mem_35004")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_35006;
            
            incprefixes_mem_35006.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_35006,
                                      numGroups_34999,
                                      "incprefixes_mem_35006")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_35008;
            
            aggregates_mem_35008.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_35008, (int64_t) 8 *
                                      numGroups_34999,
                                      "aggregates_mem_35008")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_35010;
            
            incprefixes_mem_35010.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_35010, (int64_t) 8 *
                                      numGroups_34999,
                                      "incprefixes_mem_35010")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_35002,
                                             numGroups_34999, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_36252 = smax64(smax64((int64_t) 320,
                                                            sdiv_up64(segscan_group_sizze_31061,
                                                                      (int64_t) 8) *
                                                            (int64_t) 8 +
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31061),
                                                     smax64((int64_t) 9 *
                                                            segscan_group_sizze_31061,
                                                            (int64_t) 9 *
                                                            segscan_group_sizze_31061 *
                                                            (int64_t) 8));
            CUdeviceptr kernel_arg_36254 = mem_32297.mem;
            CUdeviceptr kernel_arg_36255 = mem_32301.mem;
            CUdeviceptr kernel_arg_36256 = mem_32303.mem;
            CUdeviceptr kernel_arg_36257 =
                        test_clusterWithziid_counter_mem_35000.mem;
            CUdeviceptr kernel_arg_36258 = status_flags_mem_35002.mem;
            CUdeviceptr kernel_arg_36259 = aggregates_mem_35004.mem;
            CUdeviceptr kernel_arg_36260 = incprefixes_mem_35006.mem;
            CUdeviceptr kernel_arg_36261 = aggregates_mem_35008.mem;
            CUdeviceptr kernel_arg_36262 = incprefixes_mem_35010.mem;
            unsigned int shared_offset_36253 = 0;
            
            if ((((((1 && sdiv_up64(defunc_2_reduce_res_29634,
                                    segscan_group_sizze_31061 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31061 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29634,
                                          segscan_group_sizze_31061 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36249[] = {&ctx->global_failure,
                                             &shared_offset_36253,
                                             &defunc_2_reduce_res_29634,
                                             &kernel_arg_36254,
                                             &kernel_arg_36255,
                                             &kernel_arg_36256,
                                             &kernel_arg_36257,
                                             &kernel_arg_36258,
                                             &kernel_arg_36259,
                                             &kernel_arg_36260,
                                             &kernel_arg_36261,
                                             &kernel_arg_36262};
                int64_t time_start_36250 = 0, time_end_36251 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segscan_31066");
                    fprintf(ctx->log, "%ld",
                            (long) sdiv_up64(defunc_2_reduce_res_29634,
                                             segscan_group_sizze_31061 *
                                             (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31061);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36250 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegscan_31066_runs,
                                              &ctx->test_clusterWithzisegscan_31066_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_31066,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31061,
                                                      1, 1, 0 +
                                                      (shared_sizze_36252 + (8 -
                                                                             shared_sizze_36252 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_36249, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36251 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segscan_31066", time_end_36251 -
                            time_start_36250);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_35010,
                                      "incprefixes_mem_35010") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_35008,
                                      "aggregates_mem_35008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_35006,
                                      "incprefixes_mem_35006") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_35004,
                                      "aggregates_mem_35004") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_35002,
                                      "status_flags_mem_35002") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_32297, "mem_32297") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32301, "mem_32301") != 0)
            return 1;
        
        int64_t segmap_group_sizze_31078;
        
        segmap_group_sizze_31078 =
            ctx->sizes.test_clusterWithzisegmap_group_sizze_31070;
        
        int64_t segmap_usable_groups_31079 =
                sdiv_up64(defunc_2_reduce_res_29634, segmap_group_sizze_31078);
        struct memblock_device mem_32306;
        
        mem_32306.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32306, defunc_2_reduce_res_29634,
                                  "mem_32306")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_36266 = mem_32303.mem;
        CUdeviceptr kernel_arg_36267 = mem_32306.mem;
        
        if ((((((1 && segmap_usable_groups_31079 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_31078 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_31079;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36263[] = {&ctx->global_failure,
                                         &defunc_2_reduce_res_29634,
                                         &kernel_arg_36266, &kernel_arg_36267};
            int64_t time_start_36264 = 0, time_end_36265 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segmap_31068");
                fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31079);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31078);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36264 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegmap_31068_runs,
                                          &ctx->test_clusterWithzisegmap_31068_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_31068,
                                                  grid[0], grid[1], grid[2],
                                                  segmap_group_sizze_31078, 1,
                                                  1, 0, NULL, kernel_args_36263,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36265 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segmap_31068", time_end_36265 -
                        time_start_36264);
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        bool y_29668 = slt64((int64_t) 0, defunc_2_reduce_res_29634);
        bool index_certs_29669;
        
        if (!y_29668) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", (int64_t) 0,
                                   "] out of bounds for array of shape [",
                                   defunc_2_reduce_res_29634, "].",
                                   "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:52:15-27\n   #2  src/cluster.fut:184:10-74\n   #3  src/cluster_test.fut:42:9-31\n   #4  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &mem_32306, "mem_32306") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32303, "mem_32303") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32301, "mem_32301") != 0)
                return 1;
            if (memblock_unref_device(ctx,
                                      &defunc_1_map_res_subhistos_mem_34858,
                                      "defunc_1_map_res_subhistos_mem_34858") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32297, "mem_32297") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_34828,
                                      "group_res_arr_mem_34828") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32295, "mem_32295") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32292, "mem_32292") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32290, "mem_32290") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32325,
                                      "clusterWith_res_mem_32325") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32323,
                                      "clusterWith_res_mem_32323") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32321,
                                      "clusterWith_res_mem_32321") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32287, "mem_32287") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32285, "mem_32285") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32053,
                                      "mem_param_32053") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32048,
                                      "mem_param_32048") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32043,
                                      "mem_param_32043") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                      "clusterWith_res_mem_32275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                      "clusterWith_res_mem_32270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                      "clusterWith_res_mem_32265") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                      "group_res_arr_mem_33035") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        {
            bool write_tmp_36268 = 1;
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_to_dev_runs,
                                          &ctx->copy_scalar_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32306.mem + (int64_t) 0 *
                                                sizeof(bool), &write_tmp_36268,
                                                sizeof(bool)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        
        int64_t segscan_group_sizze_31087;
        
        segscan_group_sizze_31087 =
            ctx->sizes.test_clusterWithzisegscan_group_sizze_31086;
        
        int64_t num_groups_31089;
        int32_t max_num_groups_35135;
        
        max_num_groups_35135 =
            ctx->sizes.test_clusterWithzisegscan_num_groups_31088;
        num_groups_31089 = sext_i64_i32(smax64((int64_t) 1,
                                               smin64(sdiv_up64(partition_sizze_29591,
                                                                segscan_group_sizze_31087),
                                                      sext_i32_i64(max_num_groups_35135))));
        
        struct memblock_device mem_32309;
        
        mem_32309.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32309, bytes_32289, "mem_32309")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, partition_sizze_29591)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_35136;
            
            numThreads_35136 = sdiv_up64(partition_sizze_29591,
                                         segscan_group_sizze_31087 *
                                         (int64_t) 9) *
                segscan_group_sizze_31087;
            
            int64_t numGroups_35137;
            
            numGroups_35137 = sdiv_up64(partition_sizze_29591,
                                        segscan_group_sizze_31087 *
                                        (int64_t) 9);
            
            struct memblock_device test_clusterWithziid_counter_mem_35138 =
                                   ctx->test_clusterWithziid_counter_mem_35138;
            struct memblock_device status_flags_mem_35140;
            
            status_flags_mem_35140.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_35140,
                                      numGroups_35137,
                                      "status_flags_mem_35140")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_35142;
            
            aggregates_mem_35142.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_35142, (int64_t) 8 *
                                      numGroups_35137,
                                      "aggregates_mem_35142")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_35144;
            
            incprefixes_mem_35144.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_35144, (int64_t) 8 *
                                      numGroups_35137,
                                      "incprefixes_mem_35144")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_35140,
                                             numGroups_35137, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_36273 = smax64(smax64((int64_t) 288,
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31087),
                                                     (int64_t) 9 *
                                                     segscan_group_sizze_31087 *
                                                     (int64_t) 8);
            CUdeviceptr kernel_arg_36275 = mem_32292.mem;
            CUdeviceptr kernel_arg_36276 = mem_32309.mem;
            CUdeviceptr kernel_arg_36277 =
                        test_clusterWithziid_counter_mem_35138.mem;
            CUdeviceptr kernel_arg_36278 = status_flags_mem_35140.mem;
            CUdeviceptr kernel_arg_36279 = aggregates_mem_35142.mem;
            CUdeviceptr kernel_arg_36280 = incprefixes_mem_35144.mem;
            unsigned int shared_offset_36274 = 0;
            
            if ((((((1 && sdiv_up64(partition_sizze_29591,
                                    segscan_group_sizze_31087 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31087 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(partition_sizze_29591,
                                          segscan_group_sizze_31087 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36270[] = {&ctx->global_failure,
                                             &shared_offset_36274,
                                             &partition_sizze_29591,
                                             &kernel_arg_36275,
                                             &kernel_arg_36276,
                                             &kernel_arg_36277,
                                             &kernel_arg_36278,
                                             &kernel_arg_36279,
                                             &kernel_arg_36280};
                int64_t time_start_36271 = 0, time_end_36272 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segscan_31092");
                    fprintf(ctx->log, "%ld",
                            (long) sdiv_up64(partition_sizze_29591,
                                             segscan_group_sizze_31087 *
                                             (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31087);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36271 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegscan_31092_runs,
                                              &ctx->test_clusterWithzisegscan_31092_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_31092,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31087,
                                                      1, 1, 0 +
                                                      (shared_sizze_36273 + (8 -
                                                                             shared_sizze_36273 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_36270, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36272 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segscan_31092", time_end_36272 -
                            time_start_36271);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_35144,
                                      "incprefixes_mem_35144") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_35142,
                                      "aggregates_mem_35142") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_35140,
                                      "status_flags_mem_35140") != 0)
                return 1;
        }
        
        struct memblock_device mem_32311;
        
        mem_32311.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32311, bytes_32289, "mem_32311")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t group_sizze_35220;
        
        group_sizze_35220 = ctx->sizes.test_clusterWithzigroup_sizze_35220;
        
        int64_t num_groups_35221;
        
        num_groups_35221 = sdiv_up64(partition_sizze_29591, group_sizze_35220);
        
        CUdeviceptr kernel_arg_36284 = mem_32309.mem;
        CUdeviceptr kernel_arg_36285 = mem_32311.mem;
        
        if ((((((1 && num_groups_35221 != 0) && 1 != 0) && 1 != 0) &&
              group_sizze_35220 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = num_groups_35221;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36281[] = {&partition_sizze_29591,
                                         &kernel_arg_36284, &kernel_arg_36285};
            int64_t time_start_36282 = 0, time_end_36283 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.copy_35217");
                fprintf(ctx->log, "%ld", (long) num_groups_35221);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) group_sizze_35220);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36282 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzicopy_35217_runs,
                                          &ctx->test_clusterWithzicopy_35217_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzicopy_35217,
                                                  grid[0], grid[1], grid[2],
                                                  group_sizze_35220, 1, 1, 0,
                                                  NULL, kernel_args_36281,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36283 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.copy_35217", time_end_36283 -
                        time_start_36282);
            }
        }
        if (memblock_unref_device(ctx, &mem_32309, "mem_32309") != 0)
            return 1;
        
        bool y_29679 = slt64((int64_t) 0, partition_sizze_29591);
        bool index_certs_29680;
        
        if (!y_29679) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", (int64_t) 0,
                                   "] out of bounds for array of shape [",
                                   partition_sizze_29591, "].",
                                   "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:54:17-33\n   #2  src/cluster.fut:184:10-74\n   #3  src/cluster_test.fut:42:9-31\n   #4  src/cluster_test.fut:36:1-42:36\n");
            if (memblock_unref_device(ctx, &mem_32311, "mem_32311") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32309, "mem_32309") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32306, "mem_32306") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32303, "mem_32303") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32301, "mem_32301") != 0)
                return 1;
            if (memblock_unref_device(ctx,
                                      &defunc_1_map_res_subhistos_mem_34858,
                                      "defunc_1_map_res_subhistos_mem_34858") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32297, "mem_32297") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_34828,
                                      "group_res_arr_mem_34828") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32295, "mem_32295") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32292, "mem_32292") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32290, "mem_32290") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32325,
                                      "clusterWith_res_mem_32325") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32323,
                                      "clusterWith_res_mem_32323") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32321,
                                      "clusterWith_res_mem_32321") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32287, "mem_32287") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32285, "mem_32285") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32053,
                                      "mem_param_32053") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32048,
                                      "mem_param_32048") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_32043,
                                      "mem_param_32043") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                                      "clusterWith_res_mem_32275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                                      "clusterWith_res_mem_32270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                                      "clusterWith_res_mem_32265") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                                      "group_res_arr_mem_33035") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31964,
                                      "mem_param_31964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_param_31959,
                                      "mem_param_31959") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                                      "defunc_0_f_res_mem_31998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                                      "defunc_0_f_res_mem_31993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        {
            int64_t write_tmp_36286 = (int64_t) 0;
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_to_dev_runs,
                                          &ctx->copy_scalar_to_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_32311.mem + (int64_t) 0 *
                                                sizeof(int64_t),
                                                &write_tmp_36286,
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        
        int64_t segscan_group_sizze_31095;
        
        segscan_group_sizze_31095 =
            ctx->sizes.test_clusterWithzisegscan_group_sizze_31094;
        
        int64_t num_groups_31097;
        int32_t max_num_groups_35222;
        
        max_num_groups_35222 =
            ctx->sizes.test_clusterWithzisegscan_num_groups_31096;
        num_groups_31097 = sext_i64_i32(smax64((int64_t) 1,
                                               smin64(sdiv_up64(defunc_2_reduce_res_29634,
                                                                segscan_group_sizze_31095),
                                                      sext_i32_i64(max_num_groups_35222))));
        
        struct memblock_device mem_32314;
        
        mem_32314.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32314, defunc_2_reduce_res_29634,
                                  "mem_32314")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_32316;
        
        mem_32316.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32316, bytes_32296, "mem_32316")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, defunc_2_reduce_res_29634)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t numThreads_35223;
            
            numThreads_35223 = sdiv_up64(defunc_2_reduce_res_29634,
                                         segscan_group_sizze_31095 *
                                         (int64_t) 9) *
                segscan_group_sizze_31095;
            
            int64_t numGroups_35224;
            
            numGroups_35224 = sdiv_up64(defunc_2_reduce_res_29634,
                                        segscan_group_sizze_31095 *
                                        (int64_t) 9);
            
            struct memblock_device test_clusterWithziid_counter_mem_35225 =
                                   ctx->test_clusterWithziid_counter_mem_35225;
            struct memblock_device status_flags_mem_35227;
            
            status_flags_mem_35227.references = NULL;
            if (memblock_alloc_device(ctx, &status_flags_mem_35227,
                                      numGroups_35224,
                                      "status_flags_mem_35227")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_35229;
            
            aggregates_mem_35229.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_35229,
                                      numGroups_35224,
                                      "aggregates_mem_35229")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_35231;
            
            incprefixes_mem_35231.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_35231,
                                      numGroups_35224,
                                      "incprefixes_mem_35231")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device aggregates_mem_35233;
            
            aggregates_mem_35233.references = NULL;
            if (memblock_alloc_device(ctx, &aggregates_mem_35233, (int64_t) 8 *
                                      numGroups_35224,
                                      "aggregates_mem_35233")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device incprefixes_mem_35235;
            
            incprefixes_mem_35235.references = NULL;
            if (memblock_alloc_device(ctx, &incprefixes_mem_35235, (int64_t) 8 *
                                      numGroups_35224,
                                      "incprefixes_mem_35235")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_35227,
                                             numGroups_35224, (int8_t) 0) !=
                0) {
                err = 1;
                goto cleanup;
            }
            
            unsigned int shared_sizze_36291 = smax64(smax64((int64_t) 320,
                                                            sdiv_up64(segscan_group_sizze_31095,
                                                                      (int64_t) 8) *
                                                            (int64_t) 8 +
                                                            (int64_t) 8 *
                                                            segscan_group_sizze_31095),
                                                     smax64((int64_t) 9 *
                                                            segscan_group_sizze_31095,
                                                            (int64_t) 9 *
                                                            segscan_group_sizze_31095 *
                                                            (int64_t) 8));
            CUdeviceptr kernel_arg_36293 = mem_32306.mem;
            CUdeviceptr kernel_arg_36294 = mem_32314.mem;
            CUdeviceptr kernel_arg_36295 = mem_32316.mem;
            CUdeviceptr kernel_arg_36296 =
                        test_clusterWithziid_counter_mem_35225.mem;
            CUdeviceptr kernel_arg_36297 = status_flags_mem_35227.mem;
            CUdeviceptr kernel_arg_36298 = aggregates_mem_35229.mem;
            CUdeviceptr kernel_arg_36299 = incprefixes_mem_35231.mem;
            CUdeviceptr kernel_arg_36300 = aggregates_mem_35233.mem;
            CUdeviceptr kernel_arg_36301 = incprefixes_mem_35235.mem;
            unsigned int shared_offset_36292 = 0;
            
            if ((((((1 && sdiv_up64(defunc_2_reduce_res_29634,
                                    segscan_group_sizze_31095 * (int64_t) 9) !=
                     0) && 1 != 0) && 1 != 0) && segscan_group_sizze_31095 !=
                  0) && 1 != 0) && 1 != 0) {
                int perm[3] = {0, 1, 2};
                
                if (1 >= 1 << 16) {
                    perm[1] = perm[0];
                    perm[0] = 1;
                }
                if (1 >= 1 << 16) {
                    perm[2] = perm[0];
                    perm[0] = 2;
                }
                
                size_t grid[3];
                
                grid[perm[0]] = sdiv_up64(defunc_2_reduce_res_29634,
                                          segscan_group_sizze_31095 *
                                          (int64_t) 9);
                grid[perm[1]] = 1;
                grid[perm[2]] = 1;
                
                void *kernel_args_36288[] = {&ctx->global_failure,
                                             &shared_offset_36292,
                                             &defunc_2_reduce_res_29634,
                                             &kernel_arg_36293,
                                             &kernel_arg_36294,
                                             &kernel_arg_36295,
                                             &kernel_arg_36296,
                                             &kernel_arg_36297,
                                             &kernel_arg_36298,
                                             &kernel_arg_36299,
                                             &kernel_arg_36300,
                                             &kernel_arg_36301};
                int64_t time_start_36289 = 0, time_end_36290 = 0;
                
                if (ctx->debugging) {
                    fprintf(ctx->log, "Launching %s with grid size (",
                            "test_clusterWith.segscan_31100");
                    fprintf(ctx->log, "%ld",
                            (long) sdiv_up64(defunc_2_reduce_res_29634,
                                             segscan_group_sizze_31095 *
                                             (int64_t) 9));
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ") and block size (");
                    fprintf(ctx->log, "%ld", (long) segscan_group_sizze_31095);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ", ");
                    fprintf(ctx->log, "%ld", (long) 1);
                    fprintf(ctx->log, ").\n");
                    time_start_36289 = get_wall_time();
                }
                
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->test_clusterWithzisegscan_31100_runs,
                                              &ctx->test_clusterWithzisegscan_31100_total_runtime);
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegscan_31100,
                                                      grid[0], grid[1], grid[2],
                                                      segscan_group_sizze_31095,
                                                      1, 1, 0 +
                                                      (shared_sizze_36291 + (8 -
                                                                             shared_sizze_36291 %
                                                                             8) %
                                                       8), NULL,
                                                      kernel_args_36288, NULL));
                if (pevents != NULL)
                    CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
                if (ctx->debugging) {
                    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                    time_end_36290 = get_wall_time();
                    fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                            "test_clusterWith.segscan_31100", time_end_36290 -
                            time_start_36289);
                }
            }
            if (memblock_unref_device(ctx, &incprefixes_mem_35235,
                                      "incprefixes_mem_35235") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_35233,
                                      "aggregates_mem_35233") != 0)
                return 1;
            if (memblock_unref_device(ctx, &incprefixes_mem_35231,
                                      "incprefixes_mem_35231") != 0)
                return 1;
            if (memblock_unref_device(ctx, &aggregates_mem_35229,
                                      "aggregates_mem_35229") != 0)
                return 1;
            if (memblock_unref_device(ctx, &status_flags_mem_35227,
                                      "status_flags_mem_35227") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_32306, "mem_32306") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32314, "mem_32314") != 0)
            return 1;
        
        int64_t segmap_group_sizze_31131;
        
        segmap_group_sizze_31131 =
            ctx->sizes.test_clusterWithzisegmap_group_sizze_31104;
        
        int64_t segmap_usable_groups_31132 =
                sdiv_up64(defunc_2_reduce_res_29634, segmap_group_sizze_31131);
        int64_t bytes_32318 = (int64_t) 4 * defunc_2_reduce_res_29634;
        struct memblock_device mem_32319;
        
        mem_32319.references = NULL;
        if (memblock_alloc_device(ctx, &mem_32319, bytes_32318, "mem_32319")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_36305 = clusterWith_res_mem_32265.mem;
        CUdeviceptr kernel_arg_36306 = clusterWith_res_mem_32270.mem;
        CUdeviceptr kernel_arg_36307 = mem_32282.mem;
        CUdeviceptr kernel_arg_36308 = mem_32303.mem;
        CUdeviceptr kernel_arg_36309 = mem_32316.mem;
        CUdeviceptr kernel_arg_36310 = mem_32319.mem;
        
        if ((((((1 && segmap_usable_groups_31132 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_31131 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_31132;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36302[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &numVert_28890, &sizze_29106,
                                         &partition_sizze_29591,
                                         &defunc_2_reduce_res_29634,
                                         &kernel_arg_36305, &kernel_arg_36306,
                                         &kernel_arg_36307, &kernel_arg_36308,
                                         &kernel_arg_36309, &kernel_arg_36310};
            int64_t time_start_36303 = 0, time_end_36304 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_clusterWith.segmap_31102");
                fprintf(ctx->log, "%ld", (long) segmap_usable_groups_31132);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segmap_group_sizze_31131);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36303 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_clusterWithzisegmap_31102_runs,
                                          &ctx->test_clusterWithzisegmap_31102_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_clusterWithzisegmap_31102,
                                                  grid[0], grid[1], grid[2],
                                                  segmap_group_sizze_31131, 1,
                                                  1, 0, NULL, kernel_args_36302,
                                                  NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36304 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_clusterWith.segmap_31102", time_end_36304 -
                        time_start_36303);
            }
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_32303, "mem_32303") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32316, "mem_32316") != 0)
            return 1;
        sizze_29615 = defunc_2_reduce_res_29634;
        clusterWith_res_ixfn_32320 = defunc_2_reduce_res_29634;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32321, &mem_32319,
                                "mem_32319") != 0)
            return 1;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32323, &mem_32311,
                                "mem_32311") != 0)
            return 1;
        if (memblock_set_device(ctx, &clusterWith_res_mem_32325, &mem_32292,
                                "mem_32292") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32319, "mem_32319") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32316, "mem_32316") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32314, "mem_32314") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32311, "mem_32311") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32309, "mem_32309") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32306, "mem_32306") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32303, "mem_32303") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32301, "mem_32301") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_1_map_res_subhistos_mem_34858,
                                  "defunc_1_map_res_subhistos_mem_34858") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32297, "mem_32297") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_34828,
                                  "group_res_arr_mem_34828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32295, "mem_32295") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32292, "mem_32292") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_32290, "mem_32290") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                              "clusterWith_res_mem_32265") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                              "clusterWith_res_mem_32270") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                              "clusterWith_res_mem_32275") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32285, "mem_32285") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32287, "mem_32287") != 0)
        return 1;
    out_arrsizze_32443 = sizze_29615;
    if (memblock_set_device(ctx, &out_mem_32442, &clusterWith_res_mem_32321,
                            "clusterWith_res_mem_32321") != 0)
        return 1;
    (*out_mem_p_35673).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_35673, &out_mem_32442,
                            "out_mem_32442") != 0)
        return 1;
    *out_out_arrsizze_35674 = out_arrsizze_32443;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32325,
                              "clusterWith_res_mem_32325") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32323,
                              "clusterWith_res_mem_32323") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32321,
                              "clusterWith_res_mem_32321") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32287, "mem_32287") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32285, "mem_32285") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32282, "mem_32282") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32280, "mem_32280") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32278, "mem_32278") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_32053, "mem_param_32053") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_32048, "mem_param_32048") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_32043, "mem_param_32043") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32275,
                              "clusterWith_res_mem_32275") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32270,
                              "clusterWith_res_mem_32270") != 0)
        return 1;
    if (memblock_unref_device(ctx, &clusterWith_res_mem_32265,
                              "clusterWith_res_mem_32265") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32260, "mem_32260") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32230, "mem_32230") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32100, "mem_32100") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32097, "mem_32097") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32095, "mem_32095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32093, "mem_32093") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_33035,
                              "group_res_arr_mem_33035") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32038, "mem_32038") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32036, "mem_32036") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32033, "mem_32033") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32031, "mem_32031") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32028, "mem_32028") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32026, "mem_32026") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32024, "mem_32024") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32022, "mem_32022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32018, "mem_32018") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32016, "mem_32016") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32013, "mem_32013") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32011, "mem_32011") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32008, "mem_32008") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32005, "mem_32005") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32003, "mem_32003") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_32001, "mem_32001") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_31964, "mem_param_31964") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_param_31959, "mem_param_31959") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31998,
                              "defunc_0_f_res_mem_31998") != 0)
        return 1;
    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_31993,
                              "defunc_0_f_res_mem_31993") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31979, "mem_31979") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31977, "mem_31977") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31975, "mem_31975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31973, "mem_31973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31954, "mem_31954") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_entry_test_elimDupesWith(struct futhark_context *ctx,
                                           struct memblock_device *out_mem_p_36311,
                                           int64_t *out_out_arrsizze_36312,
                                           struct memblock_device arr_mem_31946,
                                           int64_t implz2081U_28821)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    int64_t segmap_group_sizze_30397;
    
    segmap_group_sizze_30397 =
        ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30391;
    
    int64_t segmap_usable_groups_30398 = sdiv_up64(implz2081U_28821,
                                                   segmap_group_sizze_30397);
    int64_t bytes_31948 = (int64_t) 8 * implz2081U_28821;
    struct memblock_device mem_31949;
    
    mem_31949.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31949, bytes_31948, "mem_31949")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36316 = arr_mem_31946.mem;
    CUdeviceptr kernel_arg_36317 = mem_31949.mem;
    
    if ((((((1 && segmap_usable_groups_30398 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30397 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30398;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36313[] = {&ctx->global_failure, &implz2081U_28821,
                                     &kernel_arg_36316, &kernel_arg_36317};
        int64_t time_start_36314 = 0, time_end_36315 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_elimDupesWith.segmap_30389");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30398);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30397);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36314 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_elimDupesWithzisegmap_30389_runs,
                                      &ctx->test_elimDupesWithzisegmap_30389_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegmap_30389,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30397, 1, 1, 0,
                                              NULL, kernel_args_36313, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36315 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_elimDupesWith.segmap_30389", time_end_36315 -
                    time_start_36314);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_group_sizze_30413;
    
    segmap_group_sizze_30413 =
        ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30405;
    
    int64_t segmap_usable_groups_30414 = sdiv_up64(implz2081U_28821,
                                                   segmap_group_sizze_30413);
    struct memblock_device mem_31952;
    
    mem_31952.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31952, implz2081U_28821, "mem_31952")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36321 = mem_31949.mem;
    CUdeviceptr kernel_arg_36322 = mem_31952.mem;
    
    if ((((((1 && segmap_usable_groups_30414 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30413 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30414;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36318[] = {&ctx->global_failure, &implz2081U_28821,
                                     &kernel_arg_36321, &kernel_arg_36322};
        int64_t time_start_36319 = 0, time_end_36320 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_elimDupesWith.segmap_30403");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30414);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30413);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36319 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_elimDupesWithzisegmap_30403_runs,
                                      &ctx->test_elimDupesWithzisegmap_30403_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegmap_30403,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30413, 1, 1, 0,
                                              NULL, kernel_args_36318, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36320 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_elimDupesWith.segmap_30403", time_end_36320 -
                    time_start_36319);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
        return 1;
    
    bool y_28832 = slt64((int64_t) 0, implz2081U_28821);
    bool index_certs_28833;
    
    if (!y_28832) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               implz2081U_28821, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:27:15-37\n   #2  src/cluster_test.fut:57:1-51\n");
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_36323 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31952.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_36323,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_30422;
    
    segscan_group_sizze_30422 =
        ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30421;
    
    int64_t num_groups_30424;
    int32_t max_num_groups_32454;
    
    max_num_groups_32454 =
        ctx->sizes.test_elimDupesWithzisegscan_num_groups_30423;
    num_groups_30424 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28821,
                                                            segscan_group_sizze_30422),
                                                  sext_i32_i64(max_num_groups_32454))));
    
    struct memblock_device mem_31955;
    
    mem_31955.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31955, implz2081U_28821, "mem_31955")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31957;
    
    mem_31957.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31957, bytes_31948, "mem_31957")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28821)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32455;
        
        numThreads_32455 = sdiv_up64(implz2081U_28821,
                                     segscan_group_sizze_30422 * (int64_t) 9) *
            segscan_group_sizze_30422;
        
        int64_t numGroups_32456;
        
        numGroups_32456 = sdiv_up64(implz2081U_28821,
                                    segscan_group_sizze_30422 * (int64_t) 9);
        
        struct memblock_device test_elimDupesWithziid_counter_mem_32457 =
                               ctx->test_elimDupesWithziid_counter_mem_32457;
        struct memblock_device status_flags_mem_32459;
        
        status_flags_mem_32459.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32459, numGroups_32456,
                                  "status_flags_mem_32459")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32461;
        
        aggregates_mem_32461.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32461, numGroups_32456,
                                  "aggregates_mem_32461")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32463;
        
        incprefixes_mem_32463.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32463, numGroups_32456,
                                  "incprefixes_mem_32463")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32465;
        
        aggregates_mem_32465.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32465, (int64_t) 8 *
                                  numGroups_32456, "aggregates_mem_32465")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32467;
        
        incprefixes_mem_32467.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32467, (int64_t) 8 *
                                  numGroups_32456, "incprefixes_mem_32467")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32459,
                                         numGroups_32456, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36328 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_30422,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30422),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_30422,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_30422 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_36330 = mem_31952.mem;
        CUdeviceptr kernel_arg_36331 = mem_31955.mem;
        CUdeviceptr kernel_arg_36332 = mem_31957.mem;
        CUdeviceptr kernel_arg_36333 =
                    test_elimDupesWithziid_counter_mem_32457.mem;
        CUdeviceptr kernel_arg_36334 = status_flags_mem_32459.mem;
        CUdeviceptr kernel_arg_36335 = aggregates_mem_32461.mem;
        CUdeviceptr kernel_arg_36336 = incprefixes_mem_32463.mem;
        CUdeviceptr kernel_arg_36337 = aggregates_mem_32465.mem;
        CUdeviceptr kernel_arg_36338 = incprefixes_mem_32467.mem;
        unsigned int shared_offset_36329 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28821, segscan_group_sizze_30422 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30422 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28821,
                                      segscan_group_sizze_30422 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36325[] = {&ctx->global_failure,
                                         &shared_offset_36329,
                                         &implz2081U_28821, &kernel_arg_36330,
                                         &kernel_arg_36331, &kernel_arg_36332,
                                         &kernel_arg_36333, &kernel_arg_36334,
                                         &kernel_arg_36335, &kernel_arg_36336,
                                         &kernel_arg_36337, &kernel_arg_36338};
            int64_t time_start_36326 = 0, time_end_36327 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_elimDupesWith.segscan_30427");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28821,
                                                          segscan_group_sizze_30422 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30422);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36326 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_elimDupesWithzisegscan_30427_runs,
                                          &ctx->test_elimDupesWithzisegscan_30427_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegscan_30427,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30422, 1,
                                                  1, 0 + (shared_sizze_36328 +
                                                          (8 -
                                                           shared_sizze_36328 %
                                                           8) % 8), NULL,
                                                  kernel_args_36325, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36327 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_elimDupesWith.segscan_30427", time_end_36327 -
                        time_start_36326);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32467,
                                  "incprefixes_mem_32467") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32465,
                                  "aggregates_mem_32465") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_32463,
                                  "incprefixes_mem_32463") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32461,
                                  "aggregates_mem_32461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32459,
                                  "status_flags_mem_32459") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_31955, "mem_31955") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30430;
    
    segscan_group_sizze_30430 =
        ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30429;
    
    int64_t num_groups_30432;
    int32_t max_num_groups_32596;
    
    max_num_groups_32596 =
        ctx->sizes.test_elimDupesWithzisegscan_num_groups_30431;
    num_groups_30432 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28821,
                                                            segscan_group_sizze_30430),
                                                  sext_i32_i64(max_num_groups_32596))));
    
    struct memblock_device mem_31960;
    
    mem_31960.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31960, bytes_31948, "mem_31960")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28821)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32597;
        
        numThreads_32597 = sdiv_up64(implz2081U_28821,
                                     segscan_group_sizze_30430 * (int64_t) 9) *
            segscan_group_sizze_30430;
        
        int64_t numGroups_32598;
        
        numGroups_32598 = sdiv_up64(implz2081U_28821,
                                    segscan_group_sizze_30430 * (int64_t) 9);
        
        struct memblock_device test_elimDupesWithziid_counter_mem_32599 =
                               ctx->test_elimDupesWithziid_counter_mem_32599;
        struct memblock_device status_flags_mem_32601;
        
        status_flags_mem_32601.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32601, numGroups_32598,
                                  "status_flags_mem_32601")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32603;
        
        aggregates_mem_32603.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32603, (int64_t) 8 *
                                  numGroups_32598, "aggregates_mem_32603")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32605;
        
        incprefixes_mem_32605.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32605, (int64_t) 8 *
                                  numGroups_32598, "incprefixes_mem_32605")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32601,
                                         numGroups_32598, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36343 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30430),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30430 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36345 = mem_31952.mem;
        CUdeviceptr kernel_arg_36346 = mem_31960.mem;
        CUdeviceptr kernel_arg_36347 =
                    test_elimDupesWithziid_counter_mem_32599.mem;
        CUdeviceptr kernel_arg_36348 = status_flags_mem_32601.mem;
        CUdeviceptr kernel_arg_36349 = aggregates_mem_32603.mem;
        CUdeviceptr kernel_arg_36350 = incprefixes_mem_32605.mem;
        unsigned int shared_offset_36344 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28821, segscan_group_sizze_30430 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30430 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28821,
                                      segscan_group_sizze_30430 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36340[] = {&ctx->global_failure,
                                         &shared_offset_36344,
                                         &implz2081U_28821, &kernel_arg_36345,
                                         &kernel_arg_36346, &kernel_arg_36347,
                                         &kernel_arg_36348, &kernel_arg_36349,
                                         &kernel_arg_36350};
            int64_t time_start_36341 = 0, time_end_36342 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_elimDupesWith.segscan_30435");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28821,
                                                          segscan_group_sizze_30430 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30430);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36341 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_elimDupesWithzisegscan_30435_runs,
                                          &ctx->test_elimDupesWithzisegscan_30435_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegscan_30435,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30430, 1,
                                                  1, 0 + (shared_sizze_36343 +
                                                          (8 -
                                                           shared_sizze_36343 %
                                                           8) % 8), NULL,
                                                  kernel_args_36340, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36342 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_elimDupesWith.segscan_30435", time_end_36342 -
                        time_start_36341);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32605,
                                  "incprefixes_mem_32605") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32603,
                                  "aggregates_mem_32603") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32601,
                                  "status_flags_mem_32601") != 0)
            return 1;
    }
    
    int64_t num_segments_28854;
    
    if (y_28832) {
        int64_t i_28855 = sub64(implz2081U_28821, (int64_t) 1);
        bool x_28856 = sle64((int64_t) 0, i_28855);
        bool y_28857 = slt64(i_28855, implz2081U_28821);
        bool bounds_check_28858 = x_28856 && y_28857;
        bool index_certs_28859;
        
        if (!bounds_check_28858) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_28855,
                                   "] out of bounds for array of shape [",
                                   implz2081U_28821, "].",
                                   "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:28:15-31\n   #4  src/cluster_test.fut:57:1-51\n");
            if (memblock_unref_device(ctx, &mem_31960, "mem_31960") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31957, "mem_31957") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31955, "mem_31955") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_36351;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36351, mem_31960.mem +
                                                i_28855 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28860 = read_res_36351;
        
        num_segments_28854 = last_res_28860;
    } else {
        num_segments_28854 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_28861 = slt64(num_segments_28854, (int64_t) 0);
    bool valid_28862 = !bounds_invalid_upwards_28861;
    bool range_valid_c_28863;
    
    if (!valid_28862) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               num_segments_28854, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:28:15-31\n   #5  src/cluster_test.fut:57:1-51\n");
        if (memblock_unref_device(ctx, &mem_31960, "mem_31960") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31957, "mem_31957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31955, "mem_31955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_31961 = (int64_t) 8 * num_segments_28854;
    struct memblock_device mem_31962;
    
    mem_31962.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31962, bytes_31961, "mem_31962")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_31962, num_segments_28854,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30440;
    
    segmap_group_sizze_30440 =
        ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30439;
    
    int64_t segmap_usable_groups_30441 = sdiv_up64(implz2081U_28821,
                                                   segmap_group_sizze_30440);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36355 = mem_31952.mem;
    CUdeviceptr kernel_arg_36356 = mem_31957.mem;
    CUdeviceptr kernel_arg_36357 = mem_31960.mem;
    CUdeviceptr kernel_arg_36358 = mem_31962.mem;
    
    if ((((((1 && segmap_usable_groups_30441 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30440 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30441;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36352[] = {&ctx->global_failure, &implz2081U_28821,
                                     &num_segments_28854, &kernel_arg_36355,
                                     &kernel_arg_36356, &kernel_arg_36357,
                                     &kernel_arg_36358};
        int64_t time_start_36353 = 0, time_end_36354 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_elimDupesWith.segmap_30437");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30441);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30440);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36353 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_elimDupesWithzisegmap_30437_runs,
                                      &ctx->test_elimDupesWithzisegmap_30437_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegmap_30437,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30440, 1, 1, 0,
                                              NULL, kernel_args_36352, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36354 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_elimDupesWith.segmap_30437", time_end_36354 -
                    time_start_36353);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31957, "mem_31957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31960, "mem_31960") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30444;
    
    segscan_group_sizze_30444 =
        ctx->sizes.test_elimDupesWithzisegscan_group_sizze_30443;
    
    int64_t num_groups_30446;
    int32_t max_num_groups_32692;
    
    max_num_groups_32692 =
        ctx->sizes.test_elimDupesWithzisegscan_num_groups_30445;
    num_groups_30446 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(num_segments_28854,
                                                            segscan_group_sizze_30444),
                                                  sext_i32_i64(max_num_groups_32692))));
    
    struct memblock_device mem_31966;
    
    mem_31966.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31966, bytes_31961, "mem_31966")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, num_segments_28854)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32693;
        
        numThreads_32693 = sdiv_up64(num_segments_28854,
                                     segscan_group_sizze_30444 * (int64_t) 9) *
            segscan_group_sizze_30444;
        
        int64_t numGroups_32694;
        
        numGroups_32694 = sdiv_up64(num_segments_28854,
                                    segscan_group_sizze_30444 * (int64_t) 9);
        
        struct memblock_device test_elimDupesWithziid_counter_mem_32695 =
                               ctx->test_elimDupesWithziid_counter_mem_32695;
        struct memblock_device status_flags_mem_32697;
        
        status_flags_mem_32697.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32697, numGroups_32694,
                                  "status_flags_mem_32697")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32699;
        
        aggregates_mem_32699.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32699, (int64_t) 8 *
                                  numGroups_32694, "aggregates_mem_32699")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32701;
        
        incprefixes_mem_32701.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32701, (int64_t) 8 *
                                  numGroups_32694, "incprefixes_mem_32701")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32697,
                                         numGroups_32694, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36363 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30444),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30444 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36365 = mem_31962.mem;
        CUdeviceptr kernel_arg_36366 = mem_31966.mem;
        CUdeviceptr kernel_arg_36367 =
                    test_elimDupesWithziid_counter_mem_32695.mem;
        CUdeviceptr kernel_arg_36368 = status_flags_mem_32697.mem;
        CUdeviceptr kernel_arg_36369 = aggregates_mem_32699.mem;
        CUdeviceptr kernel_arg_36370 = incprefixes_mem_32701.mem;
        unsigned int shared_offset_36364 = 0;
        
        if ((((((1 && sdiv_up64(num_segments_28854, segscan_group_sizze_30444 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30444 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(num_segments_28854,
                                      segscan_group_sizze_30444 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36360[] = {&ctx->global_failure,
                                         &shared_offset_36364,
                                         &num_segments_28854, &kernel_arg_36365,
                                         &kernel_arg_36366, &kernel_arg_36367,
                                         &kernel_arg_36368, &kernel_arg_36369,
                                         &kernel_arg_36370};
            int64_t time_start_36361 = 0, time_end_36362 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_elimDupesWith.segscan_30449");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(num_segments_28854,
                                                          segscan_group_sizze_30444 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30444);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36361 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_elimDupesWithzisegscan_30449_runs,
                                          &ctx->test_elimDupesWithzisegscan_30449_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegscan_30449,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30444, 1,
                                                  1, 0 + (shared_sizze_36363 +
                                                          (8 -
                                                           shared_sizze_36363 %
                                                           8) % 8), NULL,
                                                  kernel_args_36360, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36362 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_elimDupesWith.segscan_30449", time_end_36362 -
                        time_start_36361);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32701,
                                  "incprefixes_mem_32701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32699,
                                  "aggregates_mem_32699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32697,
                                  "status_flags_mem_32697") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_31962, "mem_31962") != 0)
        return 1;
    
    struct memblock_device mem_31968;
    
    mem_31968.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31968, bytes_31961, "mem_31968")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t group_sizze_32777;
    
    group_sizze_32777 = ctx->sizes.test_elimDupesWithzigroup_sizze_32777;
    
    int64_t num_groups_32778;
    
    num_groups_32778 = sdiv_up64(num_segments_28854, group_sizze_32777);
    
    CUdeviceptr kernel_arg_36374 = mem_31966.mem;
    CUdeviceptr kernel_arg_36375 = mem_31968.mem;
    
    if ((((((1 && num_groups_32778 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32777 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32778;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36371[] = {&num_segments_28854, &kernel_arg_36374,
                                     &kernel_arg_36375};
        int64_t time_start_36372 = 0, time_end_36373 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_elimDupesWith.copy_32774");
            fprintf(ctx->log, "%ld", (long) num_groups_32778);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32777);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36372 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_elimDupesWithzicopy_32774_runs,
                                      &ctx->test_elimDupesWithzicopy_32774_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzicopy_32774,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32777, 1, 1, 0, NULL,
                                              kernel_args_36371, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36373 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_elimDupesWith.copy_32774", time_end_36373 -
                    time_start_36372);
        }
    }
    if (memblock_unref_device(ctx, &mem_31966, "mem_31966") != 0)
        return 1;
    
    bool y_28878 = slt64((int64_t) 0, num_segments_28854);
    bool index_certs_28879;
    
    if (!y_28878) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               num_segments_28854, "].",
                               "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:29:14-32\n   #2  src/cluster_test.fut:57:1-51\n");
        if (memblock_unref_device(ctx, &mem_31968, "mem_31968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31966, "mem_31966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31962, "mem_31962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31960, "mem_31960") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31957, "mem_31957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31955, "mem_31955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        int64_t write_tmp_36376 = (int64_t) 0;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31968.mem + (int64_t) 0 *
                                            sizeof(int64_t), &write_tmp_36376,
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segmap_group_sizze_30463;
    
    segmap_group_sizze_30463 =
        ctx->sizes.test_elimDupesWithzisegmap_group_sizze_30453;
    
    int64_t segmap_usable_groups_30464 = sdiv_up64(num_segments_28854,
                                                   segmap_group_sizze_30463);
    int64_t bytes_31970 = (int64_t) 4 * num_segments_28854;
    struct memblock_device mem_31971;
    
    mem_31971.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31971, bytes_31970, "mem_31971")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36380 = arr_mem_31946.mem;
    CUdeviceptr kernel_arg_36381 = mem_31968.mem;
    CUdeviceptr kernel_arg_36382 = mem_31971.mem;
    
    if ((((((1 && segmap_usable_groups_30464 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30463 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30464;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36377[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_28821, &num_segments_28854,
                                     &kernel_arg_36380, &kernel_arg_36381,
                                     &kernel_arg_36382};
        int64_t time_start_36378 = 0, time_end_36379 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_elimDupesWith.segmap_30451");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30464);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30463);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36378 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_elimDupesWithzisegmap_30451_runs,
                                      &ctx->test_elimDupesWithzisegmap_30451_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_elimDupesWithzisegmap_30451,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30463, 1, 1, 0,
                                              NULL, kernel_args_36377, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36379 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_elimDupesWith.segmap_30451", time_end_36379 -
                    time_start_36378);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31968, "mem_31968") != 0)
        return 1;
    out_arrsizze_32443 = num_segments_28854;
    if (memblock_set_device(ctx, &out_mem_32442, &mem_31971, "mem_31971") != 0)
        return 1;
    (*out_mem_p_36311).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_36311, &out_mem_32442,
                            "out_mem_32442") != 0)
        return 1;
    *out_out_arrsizze_36312 = out_arrsizze_32443;
    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31968, "mem_31968") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31966, "mem_31966") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31962, "mem_31962") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31960, "mem_31960") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31957, "mem_31957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31955, "mem_31955") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31952, "mem_31952") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31949, "mem_31949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_entry_test_mkSegsFromSort_segInd(struct futhark_context *ctx,
                                                   struct memblock_device *out_mem_p_36383,
                                                   struct memblock_device keys_mem_31946,
                                                   struct memblock_device values_mem_31947,
                                                   int64_t implz2081U_28671,
                                                   int64_t numKey_28672)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t segmap_group_sizze_30261;
    
    segmap_group_sizze_30261 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30255;
    
    int64_t segmap_usable_groups_30262 = sdiv_up64(implz2081U_28671,
                                                   segmap_group_sizze_30261);
    int64_t bytes_31949 = (int64_t) 8 * implz2081U_28671;
    struct memblock_device mem_31950;
    
    mem_31950.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31950, bytes_31949, "mem_31950")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36387 = keys_mem_31946.mem;
    CUdeviceptr kernel_arg_36388 = mem_31950.mem;
    
    if ((((((1 && segmap_usable_groups_30262 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30261 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30262;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36384[] = {&ctx->global_failure, &implz2081U_28671,
                                     &kernel_arg_36387, &kernel_arg_36388};
        int64_t time_start_36385 = 0, time_end_36386 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segInd.segmap_30253");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30262);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30261);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36385 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30253_runs,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30253_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegmap_30253,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30261, 1, 1, 0,
                                              NULL, kernel_args_36384, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36386 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segInd.segmap_30253", time_end_36386 -
                    time_start_36385);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_group_sizze_30277;
    
    segmap_group_sizze_30277 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30269;
    
    int64_t segmap_usable_groups_30278 = sdiv_up64(implz2081U_28671,
                                                   segmap_group_sizze_30277);
    struct memblock_device mem_31953;
    
    mem_31953.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31953, implz2081U_28671, "mem_31953")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36392 = mem_31950.mem;
    CUdeviceptr kernel_arg_36393 = mem_31953.mem;
    
    if ((((((1 && segmap_usable_groups_30278 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30277 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30278;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36389[] = {&ctx->global_failure, &implz2081U_28671,
                                     &kernel_arg_36392, &kernel_arg_36393};
        int64_t time_start_36390 = 0, time_end_36391 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segInd.segmap_30267");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30278);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30277);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36390 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30267_runs,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30267_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegmap_30267,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30277, 1, 1, 0,
                                              NULL, kernel_args_36389, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36391 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segInd.segmap_30267", time_end_36391 -
                    time_start_36390);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    
    bool y_28684 = slt64((int64_t) 0, implz2081U_28671);
    bool index_certs_28685;
    
    if (!y_28684) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               implz2081U_28671, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:60:15-41\n   #2  src/cluster_test.fut:16:4-39\n   #3  src/cluster_test.fut:15:1-16:47\n");
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_36394 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31953.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_36394,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_30286;
    
    segscan_group_sizze_30286 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30285;
    
    int64_t num_groups_30288;
    int32_t max_num_groups_32453;
    
    max_num_groups_32453 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30287;
    num_groups_30288 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28671,
                                                            segscan_group_sizze_30286),
                                                  sext_i32_i64(max_num_groups_32453))));
    
    struct memblock_device mem_31956;
    
    mem_31956.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31956, implz2081U_28671, "mem_31956")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31958;
    
    mem_31958.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31958, bytes_31949, "mem_31958")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28671)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32454;
        
        numThreads_32454 = sdiv_up64(implz2081U_28671,
                                     segscan_group_sizze_30286 * (int64_t) 9) *
            segscan_group_sizze_30286;
        
        int64_t numGroups_32455;
        
        numGroups_32455 = sdiv_up64(implz2081U_28671,
                                    segscan_group_sizze_30286 * (int64_t) 9);
        
        struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32456
                               =
                               ctx->test_mkSegsFromSort_segIndziid_counter_mem_32456;
        struct memblock_device status_flags_mem_32458;
        
        status_flags_mem_32458.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32458, numGroups_32455,
                                  "status_flags_mem_32458")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32460;
        
        aggregates_mem_32460.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32460, numGroups_32455,
                                  "aggregates_mem_32460")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32462;
        
        incprefixes_mem_32462.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32462, numGroups_32455,
                                  "incprefixes_mem_32462")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32464;
        
        aggregates_mem_32464.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32464, (int64_t) 8 *
                                  numGroups_32455, "aggregates_mem_32464")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32466;
        
        incprefixes_mem_32466.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32466, (int64_t) 8 *
                                  numGroups_32455, "incprefixes_mem_32466")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32458,
                                         numGroups_32455, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36399 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_30286,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30286),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_30286,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_30286 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_36401 = mem_31953.mem;
        CUdeviceptr kernel_arg_36402 = mem_31956.mem;
        CUdeviceptr kernel_arg_36403 = mem_31958.mem;
        CUdeviceptr kernel_arg_36404 =
                    test_mkSegsFromSort_segIndziid_counter_mem_32456.mem;
        CUdeviceptr kernel_arg_36405 = status_flags_mem_32458.mem;
        CUdeviceptr kernel_arg_36406 = aggregates_mem_32460.mem;
        CUdeviceptr kernel_arg_36407 = incprefixes_mem_32462.mem;
        CUdeviceptr kernel_arg_36408 = aggregates_mem_32464.mem;
        CUdeviceptr kernel_arg_36409 = incprefixes_mem_32466.mem;
        unsigned int shared_offset_36400 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28671, segscan_group_sizze_30286 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30286 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28671,
                                      segscan_group_sizze_30286 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36396[] = {&ctx->global_failure,
                                         &shared_offset_36400,
                                         &implz2081U_28671, &kernel_arg_36401,
                                         &kernel_arg_36402, &kernel_arg_36403,
                                         &kernel_arg_36404, &kernel_arg_36405,
                                         &kernel_arg_36406, &kernel_arg_36407,
                                         &kernel_arg_36408, &kernel_arg_36409};
            int64_t time_start_36397 = 0, time_end_36398 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segInd.segscan_30291");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28671,
                                                          segscan_group_sizze_30286 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30286);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36397 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30291_runs,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30291_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegscan_30291,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30286, 1,
                                                  1, 0 + (shared_sizze_36399 +
                                                          (8 -
                                                           shared_sizze_36399 %
                                                           8) % 8), NULL,
                                                  kernel_args_36396, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36398 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segInd.segscan_30291",
                        time_end_36398 - time_start_36397);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32466,
                                  "incprefixes_mem_32466") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32464,
                                  "aggregates_mem_32464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_32462,
                                  "incprefixes_mem_32462") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32460,
                                  "aggregates_mem_32460") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32458,
                                  "status_flags_mem_32458") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30294;
    
    segscan_group_sizze_30294 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30293;
    
    int64_t num_groups_30296;
    int32_t max_num_groups_32595;
    
    max_num_groups_32595 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30295;
    num_groups_30296 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28671,
                                                            segscan_group_sizze_30294),
                                                  sext_i32_i64(max_num_groups_32595))));
    
    struct memblock_device mem_31961;
    
    mem_31961.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31961, bytes_31949, "mem_31961")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28671)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32596;
        
        numThreads_32596 = sdiv_up64(implz2081U_28671,
                                     segscan_group_sizze_30294 * (int64_t) 9) *
            segscan_group_sizze_30294;
        
        int64_t numGroups_32597;
        
        numGroups_32597 = sdiv_up64(implz2081U_28671,
                                    segscan_group_sizze_30294 * (int64_t) 9);
        
        struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32598
                               =
                               ctx->test_mkSegsFromSort_segIndziid_counter_mem_32598;
        struct memblock_device status_flags_mem_32600;
        
        status_flags_mem_32600.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32600, numGroups_32597,
                                  "status_flags_mem_32600")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32602;
        
        aggregates_mem_32602.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32602, (int64_t) 8 *
                                  numGroups_32597, "aggregates_mem_32602")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32604;
        
        incprefixes_mem_32604.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32604, (int64_t) 8 *
                                  numGroups_32597, "incprefixes_mem_32604")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32600,
                                         numGroups_32597, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36414 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30294),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30294 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36416 = mem_31953.mem;
        CUdeviceptr kernel_arg_36417 = mem_31961.mem;
        CUdeviceptr kernel_arg_36418 =
                    test_mkSegsFromSort_segIndziid_counter_mem_32598.mem;
        CUdeviceptr kernel_arg_36419 = status_flags_mem_32600.mem;
        CUdeviceptr kernel_arg_36420 = aggregates_mem_32602.mem;
        CUdeviceptr kernel_arg_36421 = incprefixes_mem_32604.mem;
        unsigned int shared_offset_36415 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28671, segscan_group_sizze_30294 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30294 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28671,
                                      segscan_group_sizze_30294 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36411[] = {&ctx->global_failure,
                                         &shared_offset_36415,
                                         &implz2081U_28671, &kernel_arg_36416,
                                         &kernel_arg_36417, &kernel_arg_36418,
                                         &kernel_arg_36419, &kernel_arg_36420,
                                         &kernel_arg_36421};
            int64_t time_start_36412 = 0, time_end_36413 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segInd.segscan_30299");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28671,
                                                          segscan_group_sizze_30294 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30294);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36412 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30299_runs,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30299_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegscan_30299,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30294, 1,
                                                  1, 0 + (shared_sizze_36414 +
                                                          (8 -
                                                           shared_sizze_36414 %
                                                           8) % 8), NULL,
                                                  kernel_args_36411, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36413 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segInd.segscan_30299",
                        time_end_36413 - time_start_36412);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32604,
                                  "incprefixes_mem_32604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32602,
                                  "aggregates_mem_32602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32600,
                                  "status_flags_mem_32600") != 0)
            return 1;
    }
    
    int64_t num_segments_28706;
    
    if (y_28684) {
        int64_t i_28707 = sub64(implz2081U_28671, (int64_t) 1);
        bool x_28708 = sle64((int64_t) 0, i_28707);
        bool y_28709 = slt64(i_28707, implz2081U_28671);
        bool bounds_check_28710 = x_28708 && y_28709;
        bool index_certs_28711;
        
        if (!bounds_check_28710) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_28707,
                                   "] out of bounds for array of shape [",
                                   implz2081U_28671, "].",
                                   "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:61:18-34\n   #4  src/cluster_test.fut:16:4-39\n   #5  src/cluster_test.fut:15:1-16:47\n");
            if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_36422;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36422, mem_31961.mem +
                                                i_28707 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28712 = read_res_36422;
        
        num_segments_28706 = last_res_28712;
    } else {
        num_segments_28706 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_28713 = slt64(num_segments_28706, (int64_t) 0);
    bool valid_28714 = !bounds_invalid_upwards_28713;
    bool range_valid_c_28715;
    
    if (!valid_28714) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               num_segments_28706, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:61:18-34\n   #5  src/cluster_test.fut:16:4-39\n   #6  src/cluster_test.fut:15:1-16:47\n");
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_31962 = (int64_t) 8 * num_segments_28706;
    struct memblock_device mem_31963;
    
    mem_31963.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31963, bytes_31962, "mem_31963")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_31963, num_segments_28706,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30304;
    
    segmap_group_sizze_30304 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30303;
    
    int64_t segmap_usable_groups_30305 = sdiv_up64(implz2081U_28671,
                                                   segmap_group_sizze_30304);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36426 = mem_31953.mem;
    CUdeviceptr kernel_arg_36427 = mem_31958.mem;
    CUdeviceptr kernel_arg_36428 = mem_31961.mem;
    CUdeviceptr kernel_arg_36429 = mem_31963.mem;
    
    if ((((((1 && segmap_usable_groups_30305 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30304 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30305;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36423[] = {&ctx->global_failure, &implz2081U_28671,
                                     &num_segments_28706, &kernel_arg_36426,
                                     &kernel_arg_36427, &kernel_arg_36428,
                                     &kernel_arg_36429};
        int64_t time_start_36424 = 0, time_end_36425 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segInd.segmap_30301");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30305);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30304);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36424 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30301_runs,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30301_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegmap_30301,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30304, 1, 1, 0,
                                              NULL, kernel_args_36423, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36425 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segInd.segmap_30301", time_end_36425 -
                    time_start_36424);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30308;
    
    segscan_group_sizze_30308 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_group_sizze_30307;
    
    int64_t num_groups_30310;
    int32_t max_num_groups_32691;
    
    max_num_groups_32691 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegscan_num_groups_30309;
    num_groups_30310 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(num_segments_28706,
                                                            segscan_group_sizze_30308),
                                                  sext_i32_i64(max_num_groups_32691))));
    
    struct memblock_device mem_31967;
    
    mem_31967.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31967, bytes_31962, "mem_31967")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, num_segments_28706)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32692;
        
        numThreads_32692 = sdiv_up64(num_segments_28706,
                                     segscan_group_sizze_30308 * (int64_t) 9) *
            segscan_group_sizze_30308;
        
        int64_t numGroups_32693;
        
        numGroups_32693 = sdiv_up64(num_segments_28706,
                                    segscan_group_sizze_30308 * (int64_t) 9);
        
        struct memblock_device test_mkSegsFromSort_segIndziid_counter_mem_32694
                               =
                               ctx->test_mkSegsFromSort_segIndziid_counter_mem_32694;
        struct memblock_device status_flags_mem_32696;
        
        status_flags_mem_32696.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32696, numGroups_32693,
                                  "status_flags_mem_32696")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32698;
        
        aggregates_mem_32698.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32698, (int64_t) 8 *
                                  numGroups_32693, "aggregates_mem_32698")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32700;
        
        incprefixes_mem_32700.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32700, (int64_t) 8 *
                                  numGroups_32693, "incprefixes_mem_32700")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32696,
                                         numGroups_32693, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36434 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30308),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30308 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36436 = mem_31963.mem;
        CUdeviceptr kernel_arg_36437 = mem_31967.mem;
        CUdeviceptr kernel_arg_36438 =
                    test_mkSegsFromSort_segIndziid_counter_mem_32694.mem;
        CUdeviceptr kernel_arg_36439 = status_flags_mem_32696.mem;
        CUdeviceptr kernel_arg_36440 = aggregates_mem_32698.mem;
        CUdeviceptr kernel_arg_36441 = incprefixes_mem_32700.mem;
        unsigned int shared_offset_36435 = 0;
        
        if ((((((1 && sdiv_up64(num_segments_28706, segscan_group_sizze_30308 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30308 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(num_segments_28706,
                                      segscan_group_sizze_30308 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36431[] = {&ctx->global_failure,
                                         &shared_offset_36435,
                                         &num_segments_28706, &kernel_arg_36436,
                                         &kernel_arg_36437, &kernel_arg_36438,
                                         &kernel_arg_36439, &kernel_arg_36440,
                                         &kernel_arg_36441};
            int64_t time_start_36432 = 0, time_end_36433 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segInd.segscan_30313");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(num_segments_28706,
                                                          segscan_group_sizze_30308 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30308);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36432 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30313_runs,
                                          &ctx->test_mkSegsFromSort_segIndzisegscan_30313_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegscan_30313,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30308, 1,
                                                  1, 0 + (shared_sizze_36434 +
                                                          (8 -
                                                           shared_sizze_36434 %
                                                           8) % 8), NULL,
                                                  kernel_args_36431, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36433 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segInd.segscan_30313",
                        time_end_36433 - time_start_36432);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32700,
                                  "incprefixes_mem_32700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32698,
                                  "aggregates_mem_32698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32696,
                                  "status_flags_mem_32696") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
        return 1;
    
    struct memblock_device mem_31969;
    
    mem_31969.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31969, bytes_31962, "mem_31969")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t group_sizze_32776;
    
    group_sizze_32776 =
        ctx->sizes.test_mkSegsFromSort_segIndzigroup_sizze_32776;
    
    int64_t num_groups_32777;
    
    num_groups_32777 = sdiv_up64(num_segments_28706, group_sizze_32776);
    
    CUdeviceptr kernel_arg_36445 = mem_31967.mem;
    CUdeviceptr kernel_arg_36446 = mem_31969.mem;
    
    if ((((((1 && num_groups_32777 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32776 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32777;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36442[] = {&num_segments_28706, &kernel_arg_36445,
                                     &kernel_arg_36446};
        int64_t time_start_36443 = 0, time_end_36444 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segInd.copy_32773");
            fprintf(ctx->log, "%ld", (long) num_groups_32777);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32776);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36443 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segIndzicopy_32773_runs,
                                      &ctx->test_mkSegsFromSort_segIndzicopy_32773_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzicopy_32773,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32776, 1, 1, 0, NULL,
                                              kernel_args_36442, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36444 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segInd.copy_32773", time_end_36444 -
                    time_start_36443);
        }
    }
    if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
        return 1;
    
    bool y_28730 = slt64((int64_t) 0, num_segments_28706);
    bool index_certs_28731;
    
    if (!y_28730) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               num_segments_28706, "].",
                               "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:62:17-38\n   #2  src/cluster_test.fut:16:4-39\n   #3  src/cluster_test.fut:15:1-16:47\n");
        if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        int64_t write_tmp_36447 = (int64_t) 0;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31969.mem + (int64_t) 0 *
                                            sizeof(int64_t), &write_tmp_36447,
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    bool bounds_invalid_upwards_28733 = slt64(numKey_28672, (int64_t) 0);
    bool valid_28734 = !bounds_invalid_upwards_28733;
    bool range_valid_c_28735;
    
    if (!valid_28734) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               numKey_28672, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:65:14-36\n   #3  src/cluster_test.fut:16:4-39\n   #4  src/cluster_test.fut:15:1-16:47\n");
        if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_31970 = (int64_t) 8 * numKey_28672;
    struct memblock_device mem_31971;
    
    mem_31971.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31971, bytes_31970, "mem_31971")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_31971, numKey_28672,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30318;
    
    segmap_group_sizze_30318 =
        ctx->sizes.test_mkSegsFromSort_segIndzisegmap_group_sizze_30317;
    
    int64_t segmap_usable_groups_30319 = sdiv_up64(num_segments_28706,
                                                   segmap_group_sizze_30318);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36451 = keys_mem_31946.mem;
    CUdeviceptr kernel_arg_36452 = mem_31969.mem;
    CUdeviceptr kernel_arg_36453 = mem_31971.mem;
    
    if ((((((1 && segmap_usable_groups_30319 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30318 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30319;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36448[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_28671, &numKey_28672,
                                     &num_segments_28706, &kernel_arg_36451,
                                     &kernel_arg_36452, &kernel_arg_36453};
        int64_t time_start_36449 = 0, time_end_36450 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segInd.segmap_30315");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30319);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30318);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36449 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30315_runs,
                                      &ctx->test_mkSegsFromSort_segIndzisegmap_30315_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segIndzisegmap_30315,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30318, 1, 1, 0,
                                              NULL, kernel_args_36448, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36450 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segInd.segmap_30315", time_end_36450 -
                    time_start_36449);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_32442, &mem_31971, "mem_31971") != 0)
        return 1;
    (*out_mem_p_36383).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_36383, &out_mem_32442,
                            "out_mem_32442") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static
int futrts_entry_test_mkSegsFromSort_segSizze(struct futhark_context *ctx,
                                              struct memblock_device *out_mem_p_36454,
                                              struct memblock_device keys_mem_31946,
                                              struct memblock_device values_mem_31947,
                                              int64_t implz2081U_28746,
                                              int64_t numKey_28747)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t segmap_group_sizze_30329;
    
    segmap_group_sizze_30329 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30323;
    
    int64_t segmap_usable_groups_30330 = sdiv_up64(implz2081U_28746,
                                                   segmap_group_sizze_30329);
    int64_t bytes_31949 = (int64_t) 8 * implz2081U_28746;
    struct memblock_device mem_31950;
    
    mem_31950.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31950, bytes_31949, "mem_31950")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36458 = keys_mem_31946.mem;
    CUdeviceptr kernel_arg_36459 = mem_31950.mem;
    
    if ((((((1 && segmap_usable_groups_30330 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30329 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30330;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36455[] = {&ctx->global_failure, &implz2081U_28746,
                                     &kernel_arg_36458, &kernel_arg_36459};
        int64_t time_start_36456 = 0, time_end_36457 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segSize.segmap_30321");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30330);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30329);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36456 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30321_runs,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30321_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegmap_30321,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30329, 1, 1, 0,
                                              NULL, kernel_args_36455, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36457 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segSize.segmap_30321", time_end_36457 -
                    time_start_36456);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_group_sizze_30345;
    
    segmap_group_sizze_30345 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30337;
    
    int64_t segmap_usable_groups_30346 = sdiv_up64(implz2081U_28746,
                                                   segmap_group_sizze_30345);
    struct memblock_device mem_31953;
    
    mem_31953.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31953, implz2081U_28746, "mem_31953")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36463 = mem_31950.mem;
    CUdeviceptr kernel_arg_36464 = mem_31953.mem;
    
    if ((((((1 && segmap_usable_groups_30346 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30345 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30346;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36460[] = {&ctx->global_failure, &implz2081U_28746,
                                     &kernel_arg_36463, &kernel_arg_36464};
        int64_t time_start_36461 = 0, time_end_36462 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segSize.segmap_30335");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30346);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30345);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36461 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30335_runs,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30335_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegmap_30335,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30345, 1, 1, 0,
                                              NULL, kernel_args_36460, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36462 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segSize.segmap_30335", time_end_36462 -
                    time_start_36461);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    
    bool y_28759 = slt64((int64_t) 0, implz2081U_28746);
    bool index_certs_28760;
    
    if (!y_28759) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               implz2081U_28746, "].",
                               "-> #0  src/cluster.fut:14:3-49\n   #1  src/cluster.fut:60:15-41\n   #2  src/cluster_test.fut:25:4-39\n   #3  src/cluster_test.fut:24:1-25:48\n");
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        bool write_tmp_36465 = 1;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31953.mem + (int64_t) 0 *
                                            sizeof(bool), &write_tmp_36465,
                                            sizeof(bool)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    int64_t segscan_group_sizze_30354;
    
    segscan_group_sizze_30354 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30353;
    
    int64_t num_groups_30356;
    int32_t max_num_groups_32453;
    
    max_num_groups_32453 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30355;
    num_groups_30356 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28746,
                                                            segscan_group_sizze_30354),
                                                  sext_i32_i64(max_num_groups_32453))));
    
    struct memblock_device mem_31956;
    
    mem_31956.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31956, implz2081U_28746, "mem_31956")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_31958;
    
    mem_31958.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31958, bytes_31949, "mem_31958")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28746)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32454;
        
        numThreads_32454 = sdiv_up64(implz2081U_28746,
                                     segscan_group_sizze_30354 * (int64_t) 9) *
            segscan_group_sizze_30354;
        
        int64_t numGroups_32455;
        
        numGroups_32455 = sdiv_up64(implz2081U_28746,
                                    segscan_group_sizze_30354 * (int64_t) 9);
        
        struct memblock_device
        test_mkSegsFromSort_segSizzeziid_counter_mem_32456 =
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32456;
        struct memblock_device status_flags_mem_32458;
        
        status_flags_mem_32458.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32458, numGroups_32455,
                                  "status_flags_mem_32458")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32460;
        
        aggregates_mem_32460.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32460, numGroups_32455,
                                  "aggregates_mem_32460")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32462;
        
        incprefixes_mem_32462.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32462, numGroups_32455,
                                  "incprefixes_mem_32462")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32464;
        
        aggregates_mem_32464.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32464, (int64_t) 8 *
                                  numGroups_32455, "aggregates_mem_32464")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32466;
        
        incprefixes_mem_32466.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32466, (int64_t) 8 *
                                  numGroups_32455, "incprefixes_mem_32466")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32458,
                                         numGroups_32455, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36470 = smax64(smax64((int64_t) 320,
                                                        sdiv_up64(segscan_group_sizze_30354,
                                                                  (int64_t) 8) *
                                                        (int64_t) 8 +
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30354),
                                                 smax64((int64_t) 9 *
                                                        segscan_group_sizze_30354,
                                                        (int64_t) 9 *
                                                        segscan_group_sizze_30354 *
                                                        (int64_t) 8));
        CUdeviceptr kernel_arg_36472 = mem_31953.mem;
        CUdeviceptr kernel_arg_36473 = mem_31956.mem;
        CUdeviceptr kernel_arg_36474 = mem_31958.mem;
        CUdeviceptr kernel_arg_36475 =
                    test_mkSegsFromSort_segSizzeziid_counter_mem_32456.mem;
        CUdeviceptr kernel_arg_36476 = status_flags_mem_32458.mem;
        CUdeviceptr kernel_arg_36477 = aggregates_mem_32460.mem;
        CUdeviceptr kernel_arg_36478 = incprefixes_mem_32462.mem;
        CUdeviceptr kernel_arg_36479 = aggregates_mem_32464.mem;
        CUdeviceptr kernel_arg_36480 = incprefixes_mem_32466.mem;
        unsigned int shared_offset_36471 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28746, segscan_group_sizze_30354 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30354 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28746,
                                      segscan_group_sizze_30354 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36467[] = {&ctx->global_failure,
                                         &shared_offset_36471,
                                         &implz2081U_28746, &kernel_arg_36472,
                                         &kernel_arg_36473, &kernel_arg_36474,
                                         &kernel_arg_36475, &kernel_arg_36476,
                                         &kernel_arg_36477, &kernel_arg_36478,
                                         &kernel_arg_36479, &kernel_arg_36480};
            int64_t time_start_36468 = 0, time_end_36469 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segSize.segscan_30359");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28746,
                                                          segscan_group_sizze_30354 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30354);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36468 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30359_runs,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30359_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegscan_30359,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30354, 1,
                                                  1, 0 + (shared_sizze_36470 +
                                                          (8 -
                                                           shared_sizze_36470 %
                                                           8) % 8), NULL,
                                                  kernel_args_36467, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36469 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segSize.segscan_30359",
                        time_end_36469 - time_start_36468);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32466,
                                  "incprefixes_mem_32466") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32464,
                                  "aggregates_mem_32464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_32462,
                                  "incprefixes_mem_32462") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32460,
                                  "aggregates_mem_32460") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32458,
                                  "status_flags_mem_32458") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30362;
    
    segscan_group_sizze_30362 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30361;
    
    int64_t num_groups_30364;
    int32_t max_num_groups_32595;
    
    max_num_groups_32595 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30363;
    num_groups_30364 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(implz2081U_28746,
                                                            segscan_group_sizze_30362),
                                                  sext_i32_i64(max_num_groups_32595))));
    
    struct memblock_device mem_31961;
    
    mem_31961.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31961, bytes_31949, "mem_31961")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, implz2081U_28746)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32596;
        
        numThreads_32596 = sdiv_up64(implz2081U_28746,
                                     segscan_group_sizze_30362 * (int64_t) 9) *
            segscan_group_sizze_30362;
        
        int64_t numGroups_32597;
        
        numGroups_32597 = sdiv_up64(implz2081U_28746,
                                    segscan_group_sizze_30362 * (int64_t) 9);
        
        struct memblock_device
        test_mkSegsFromSort_segSizzeziid_counter_mem_32598 =
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32598;
        struct memblock_device status_flags_mem_32600;
        
        status_flags_mem_32600.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32600, numGroups_32597,
                                  "status_flags_mem_32600")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32602;
        
        aggregates_mem_32602.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32602, (int64_t) 8 *
                                  numGroups_32597, "aggregates_mem_32602")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32604;
        
        incprefixes_mem_32604.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32604, (int64_t) 8 *
                                  numGroups_32597, "incprefixes_mem_32604")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32600,
                                         numGroups_32597, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36485 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30362),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30362 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36487 = mem_31953.mem;
        CUdeviceptr kernel_arg_36488 = mem_31961.mem;
        CUdeviceptr kernel_arg_36489 =
                    test_mkSegsFromSort_segSizzeziid_counter_mem_32598.mem;
        CUdeviceptr kernel_arg_36490 = status_flags_mem_32600.mem;
        CUdeviceptr kernel_arg_36491 = aggregates_mem_32602.mem;
        CUdeviceptr kernel_arg_36492 = incprefixes_mem_32604.mem;
        unsigned int shared_offset_36486 = 0;
        
        if ((((((1 && sdiv_up64(implz2081U_28746, segscan_group_sizze_30362 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30362 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(implz2081U_28746,
                                      segscan_group_sizze_30362 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36482[] = {&ctx->global_failure,
                                         &shared_offset_36486,
                                         &implz2081U_28746, &kernel_arg_36487,
                                         &kernel_arg_36488, &kernel_arg_36489,
                                         &kernel_arg_36490, &kernel_arg_36491,
                                         &kernel_arg_36492};
            int64_t time_start_36483 = 0, time_end_36484 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segSize.segscan_30367");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(implz2081U_28746,
                                                          segscan_group_sizze_30362 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30362);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36483 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30367_runs,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30367_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegscan_30367,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30362, 1,
                                                  1, 0 + (shared_sizze_36485 +
                                                          (8 -
                                                           shared_sizze_36485 %
                                                           8) % 8), NULL,
                                                  kernel_args_36482, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36484 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segSize.segscan_30367",
                        time_end_36484 - time_start_36483);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32604,
                                  "incprefixes_mem_32604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32602,
                                  "aggregates_mem_32602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32600,
                                  "status_flags_mem_32600") != 0)
            return 1;
    }
    
    int64_t num_segments_28781;
    
    if (y_28759) {
        int64_t i_28782 = sub64(implz2081U_28746, (int64_t) 1);
        bool x_28783 = sle64((int64_t) 0, i_28782);
        bool y_28784 = slt64(i_28782, implz2081U_28746);
        bool bounds_check_28785 = x_28783 && y_28784;
        bool index_certs_28786;
        
        if (!bounds_check_28785) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_28782,
                                   "] out of bounds for array of shape [",
                                   implz2081U_28746, "].",
                                   "-> #0  /prelude/array.fut:26:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  src/cluster.fut:18:3-46\n   #3  src/cluster.fut:61:18-34\n   #4  src/cluster_test.fut:25:4-39\n   #5  src/cluster_test.fut:24:1-25:48\n");
            if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_36493;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(&read_res_36493, mem_31961.mem +
                                                i_28782 * sizeof(int64_t),
                                                sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t last_res_28787 = read_res_36493;
        
        num_segments_28781 = last_res_28787;
    } else {
        num_segments_28781 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_28788 = slt64(num_segments_28781, (int64_t) 0);
    bool valid_28789 = !bounds_invalid_upwards_28788;
    bool range_valid_c_28790;
    
    if (!valid_28789) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               num_segments_28781, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  src/cluster.fut:18:3-46\n   #4  src/cluster.fut:61:18-34\n   #5  src/cluster_test.fut:25:4-39\n   #6  src/cluster_test.fut:24:1-25:48\n");
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_31962 = (int64_t) 8 * num_segments_28781;
    struct memblock_device mem_31963;
    
    mem_31963.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31963, bytes_31962, "mem_31963")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_31963, num_segments_28781,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30372;
    
    segmap_group_sizze_30372 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30371;
    
    int64_t segmap_usable_groups_30373 = sdiv_up64(implz2081U_28746,
                                                   segmap_group_sizze_30372);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36497 = mem_31953.mem;
    CUdeviceptr kernel_arg_36498 = mem_31958.mem;
    CUdeviceptr kernel_arg_36499 = mem_31961.mem;
    CUdeviceptr kernel_arg_36500 = mem_31963.mem;
    
    if ((((((1 && segmap_usable_groups_30373 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30372 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30373;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36494[] = {&ctx->global_failure, &implz2081U_28746,
                                     &num_segments_28781, &kernel_arg_36497,
                                     &kernel_arg_36498, &kernel_arg_36499,
                                     &kernel_arg_36500};
        int64_t time_start_36495 = 0, time_end_36496 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segSize.segmap_30369");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30373);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30372);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36495 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30369_runs,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30369_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegmap_30369,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30372, 1, 1, 0,
                                              NULL, kernel_args_36494, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36496 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segSize.segmap_30369", time_end_36496 -
                    time_start_36495);
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
        return 1;
    
    int64_t segscan_group_sizze_30376;
    
    segscan_group_sizze_30376 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_group_sizze_30375;
    
    int64_t num_groups_30378;
    int32_t max_num_groups_32691;
    
    max_num_groups_32691 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegscan_num_groups_30377;
    num_groups_30378 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(num_segments_28781,
                                                            segscan_group_sizze_30376),
                                                  sext_i32_i64(max_num_groups_32691))));
    
    struct memblock_device mem_31967;
    
    mem_31967.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31967, bytes_31962, "mem_31967")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, num_segments_28781)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t numThreads_32692;
        
        numThreads_32692 = sdiv_up64(num_segments_28781,
                                     segscan_group_sizze_30376 * (int64_t) 9) *
            segscan_group_sizze_30376;
        
        int64_t numGroups_32693;
        
        numGroups_32693 = sdiv_up64(num_segments_28781,
                                    segscan_group_sizze_30376 * (int64_t) 9);
        
        struct memblock_device
        test_mkSegsFromSort_segSizzeziid_counter_mem_32694 =
        ctx->test_mkSegsFromSort_segSizzeziid_counter_mem_32694;
        struct memblock_device status_flags_mem_32696;
        
        status_flags_mem_32696.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_32696, numGroups_32693,
                                  "status_flags_mem_32696")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_32698;
        
        aggregates_mem_32698.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_32698, (int64_t) 8 *
                                  numGroups_32693, "aggregates_mem_32698")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_32700;
        
        incprefixes_mem_32700.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_32700, (int64_t) 8 *
                                  numGroups_32693, "incprefixes_mem_32700")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_32696,
                                         numGroups_32693, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_36505 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_30376),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_30376 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_36507 = mem_31963.mem;
        CUdeviceptr kernel_arg_36508 = mem_31967.mem;
        CUdeviceptr kernel_arg_36509 =
                    test_mkSegsFromSort_segSizzeziid_counter_mem_32694.mem;
        CUdeviceptr kernel_arg_36510 = status_flags_mem_32696.mem;
        CUdeviceptr kernel_arg_36511 = aggregates_mem_32698.mem;
        CUdeviceptr kernel_arg_36512 = incprefixes_mem_32700.mem;
        unsigned int shared_offset_36506 = 0;
        
        if ((((((1 && sdiv_up64(num_segments_28781, segscan_group_sizze_30376 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_30376 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(num_segments_28781,
                                      segscan_group_sizze_30376 * (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_36502[] = {&ctx->global_failure,
                                         &shared_offset_36506,
                                         &num_segments_28781, &kernel_arg_36507,
                                         &kernel_arg_36508, &kernel_arg_36509,
                                         &kernel_arg_36510, &kernel_arg_36511,
                                         &kernel_arg_36512};
            int64_t time_start_36503 = 0, time_end_36504 = 0;
            
            if (ctx->debugging) {
                fprintf(ctx->log, "Launching %s with grid size (",
                        "test_mkSegsFromSort_segSize.segscan_30381");
                fprintf(ctx->log, "%ld", (long) sdiv_up64(num_segments_28781,
                                                          segscan_group_sizze_30376 *
                                                          (int64_t) 9));
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ") and block size (");
                fprintf(ctx->log, "%ld", (long) segscan_group_sizze_30376);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ", ");
                fprintf(ctx->log, "%ld", (long) 1);
                fprintf(ctx->log, ").\n");
                time_start_36503 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30381_runs,
                                          &ctx->test_mkSegsFromSort_segSizzezisegscan_30381_total_runtime);
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegscan_30381,
                                                  grid[0], grid[1], grid[2],
                                                  segscan_group_sizze_30376, 1,
                                                  1, 0 + (shared_sizze_36505 +
                                                          (8 -
                                                           shared_sizze_36505 %
                                                           8) % 8), NULL,
                                                  kernel_args_36502, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED_FATAL(cuCtxSynchronize());
                time_end_36504 = get_wall_time();
                fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                        "test_mkSegsFromSort_segSize.segscan_30381",
                        time_end_36504 - time_start_36503);
            }
        }
        if (memblock_unref_device(ctx, &incprefixes_mem_32700,
                                  "incprefixes_mem_32700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_32698,
                                  "aggregates_mem_32698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_32696,
                                  "status_flags_mem_32696") != 0)
            return 1;
    }
    
    struct memblock_device mem_31969;
    
    mem_31969.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31969, bytes_31962, "mem_31969")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t group_sizze_32776;
    
    group_sizze_32776 =
        ctx->sizes.test_mkSegsFromSort_segSizzezigroup_sizze_32776;
    
    int64_t num_groups_32777;
    
    num_groups_32777 = sdiv_up64(num_segments_28781, group_sizze_32776);
    
    CUdeviceptr kernel_arg_36516 = mem_31967.mem;
    CUdeviceptr kernel_arg_36517 = mem_31969.mem;
    
    if ((((((1 && num_groups_32777 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_32776 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_32777;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36513[] = {&num_segments_28781, &kernel_arg_36516,
                                     &kernel_arg_36517};
        int64_t time_start_36514 = 0, time_end_36515 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segSize.copy_32773");
            fprintf(ctx->log, "%ld", (long) num_groups_32777);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) group_sizze_32776);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36514 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segSizzezicopy_32773_runs,
                                      &ctx->test_mkSegsFromSort_segSizzezicopy_32773_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezicopy_32773,
                                              grid[0], grid[1], grid[2],
                                              group_sizze_32776, 1, 1, 0, NULL,
                                              kernel_args_36513, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36515 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segSize.copy_32773", time_end_36515 -
                    time_start_36514);
        }
    }
    if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
        return 1;
    
    bool y_28805 = slt64((int64_t) 0, num_segments_28781);
    bool index_certs_28806;
    
    if (!y_28805) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", (int64_t) 0,
                               "] out of bounds for array of shape [",
                               num_segments_28781, "].",
                               "-> #0  src/cluster.fut:23:6-27\n   #1  src/cluster.fut:62:17-38\n   #2  src/cluster_test.fut:25:4-39\n   #3  src/cluster_test.fut:24:1-25:48\n");
        if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    {
        int64_t write_tmp_36518 = (int64_t) 0;
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_scalar_to_dev_runs,
                                      &ctx->copy_scalar_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(mem_31969.mem + (int64_t) 0 *
                                            sizeof(int64_t), &write_tmp_36518,
                                            sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    
    bool bounds_invalid_upwards_28808 = slt64(numKey_28747, (int64_t) 0);
    bool valid_28809 = !bounds_invalid_upwards_28808;
    bool range_valid_c_28810;
    
    if (!valid_28809) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               numKey_28747, " is invalid.",
                               "-> #0  /prelude/array.fut:90:3-10\n   #1  /prelude/array.fut:108:18-23\n   #2  src/cluster.fut:65:14-36\n   #3  src/cluster_test.fut:25:4-39\n   #4  src/cluster_test.fut:24:1-25:48\n");
        if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_31970 = (int64_t) 8 * numKey_28747;
    struct memblock_device mem_31971;
    
    mem_31971.references = NULL;
    if (memblock_alloc_device(ctx, &mem_31971, bytes_31970, "mem_31971")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_31971, numKey_28747,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_30386;
    
    segmap_group_sizze_30386 =
        ctx->sizes.test_mkSegsFromSort_segSizzezisegmap_group_sizze_30385;
    
    int64_t segmap_usable_groups_30387 = sdiv_up64(num_segments_28781,
                                                   segmap_group_sizze_30386);
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    CUdeviceptr kernel_arg_36522 = keys_mem_31946.mem;
    CUdeviceptr kernel_arg_36523 = mem_31963.mem;
    CUdeviceptr kernel_arg_36524 = mem_31969.mem;
    CUdeviceptr kernel_arg_36525 = mem_31971.mem;
    
    if ((((((1 && segmap_usable_groups_30387 != 0) && 1 != 0) && 1 != 0) &&
          segmap_group_sizze_30386 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segmap_usable_groups_30387;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_36519[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &implz2081U_28746, &numKey_28747,
                                     &num_segments_28781, &kernel_arg_36522,
                                     &kernel_arg_36523, &kernel_arg_36524,
                                     &kernel_arg_36525};
        int64_t time_start_36520 = 0, time_end_36521 = 0;
        
        if (ctx->debugging) {
            fprintf(ctx->log, "Launching %s with grid size (",
                    "test_mkSegsFromSort_segSize.segmap_30383");
            fprintf(ctx->log, "%ld", (long) segmap_usable_groups_30387);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ") and block size (");
            fprintf(ctx->log, "%ld", (long) segmap_group_sizze_30386);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ", ");
            fprintf(ctx->log, "%ld", (long) 1);
            fprintf(ctx->log, ").\n");
            time_start_36520 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30383_runs,
                                      &ctx->test_mkSegsFromSort_segSizzezisegmap_30383_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuLaunchKernel(ctx->test_mkSegsFromSort_segSizzezisegmap_30383,
                                              grid[0], grid[1], grid[2],
                                              segmap_group_sizze_30386, 1, 1, 0,
                                              NULL, kernel_args_36519, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED_FATAL(cuCtxSynchronize());
            time_end_36521 = get_wall_time();
            fprintf(ctx->log, "Kernel %s runtime: %ldus\n",
                    "test_mkSegsFromSort_segSize.segmap_30383", time_end_36521 -
                    time_start_36520);
        }
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_32442, &mem_31971, "mem_31971") != 0)
        return 1;
    (*out_mem_p_36454).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_36454, &out_mem_32442,
                            "out_mem_32442") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31971, "mem_31971") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31969, "mem_31969") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31967, "mem_31967") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31963, "mem_31963") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31961, "mem_31961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31958, "mem_31958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31956, "mem_31956") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31953, "mem_31953") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_31950, "mem_31950") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_32442, "out_mem_32442") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_host_to_dev_runs,
                                      &ctx->copy_host_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(arr->mem.mem + 0, data + 0,
                                            (size_t) dim0 * 8));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(arr->mem.mem + 0, data + offset,
                                        (size_t) dim0 * 8));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_host_runs,
                                      &ctx->copy_dev_to_host_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(data + 0, arr->mem.mem + 0,
                                            (size_t) arr->shape[0] * 8));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return 0;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                      struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const
                                          int32_t *data, int64_t dim0)
{
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr =
                          (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * 4, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_host_to_dev_runs,
                                      &ctx->copy_host_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(arr->mem.mem + 0, data + 0,
                                            (size_t) dim0 * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0)
{
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr =
                          (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * 4, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(arr->mem.mem + 0, data + offset,
                                        (size_t) dim0 * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx,
                          struct futhark_i32_1d *arr, int32_t *data)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_host_runs,
                                      &ctx->copy_dev_to_host_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(data + 0, arr->mem.mem + 0,
                                            (size_t) arr->shape[0] * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return 0;
}
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx,
                                      struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx,
                                    struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_2d {
    struct memblock_device mem;
    int64_t shape[2];
} ;
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0,
                                          int64_t dim1)
{
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr =
                          (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) (dim0 * dim1) * 4,
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_host_to_dev_runs,
                                      &ctx->copy_host_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(arr->mem.mem + 0, data + 0,
                                            (size_t) (dim0 * dim1) * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0, int64_t dim1)
{
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr =
                          (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) (dim0 * dim1) * 4,
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpy(arr->mem.mem + 0, data + offset,
                                        (size_t) (dim0 * dim1) * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_2d(struct futhark_context *ctx,
                          struct futhark_f32_2d *arr, float *data)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_host_runs,
                                      &ctx->copy_dev_to_host_total_runtime);
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(data + 0, arr->mem.mem + 0,
                                            (size_t) (arr->shape[0] *
                                                      arr->shape[1]) * 4));
        if (pevents != NULL)
            CUDA_SUCCEED_FATAL(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return 0;
}
CUdeviceptr futhark_values_raw_f32_2d(struct futhark_context *ctx,
                                      struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx,
                                    struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_test_ballQuery(struct futhark_context *ctx,
                                 struct futhark_i32_1d **out0, const float in0,
                                 const struct futhark_f32_2d *in1, const
                                 struct futhark_i32_1d *in2)
{
    struct memblock_device pos_mem_31946;
    
    pos_mem_31946.references = NULL;
    
    struct memblock_device labels_mem_31947;
    
    labels_mem_31947.references = NULL;
    
    int64_t implz2081U_29737;
    float radius_29738;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    radius_29738 = in0;
    pos_mem_31946 = in1->mem;
    implz2081U_29737 = in1->shape[0];
    labels_mem_31947 = in2->mem;
    implz2081U_29737 = in2->shape[0];
    if (!(true && ((implz2081U_29737 == in1->shape[0] && 3 == in1->shape[1]) &&
                   implz2081U_29737 == in2->shape[0]))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_entry_test_ballQuery(ctx, &out_mem_32442,
                                          &out_arrsizze_32443, pos_mem_31946,
                                          labels_mem_31947, implz2081U_29737,
                                          radius_29738);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) !=
                NULL);
            (*out0)->mem = out_mem_32442;
            (*out0)->shape[0] = out_arrsizze_32443;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test_clusterWith(struct futhark_context *ctx,
                                   struct futhark_i32_1d **out0, const
                                   int32_t in0, const int64_t in1, const
                                   struct futhark_i32_1d *in2, const
                                   struct futhark_i32_1d *in3)
{
    struct memblock_device graph_from_mem_31946;
    
    graph_from_mem_31946.references = NULL;
    
    struct memblock_device graph_to_mem_31947;
    
    graph_to_mem_31947.references = NULL;
    
    int64_t implz2081U_28888;
    int32_t thres_28889;
    int64_t numVert_28890;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    thres_28889 = in0;
    numVert_28890 = in1;
    graph_from_mem_31946 = in2->mem;
    implz2081U_28888 = in2->shape[0];
    graph_to_mem_31947 = in3->mem;
    implz2081U_28888 = in3->shape[0];
    if (!(true && (true && (implz2081U_28888 == in2->shape[0] &&
                            implz2081U_28888 == in3->shape[0])))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_entry_test_clusterWith(ctx, &out_mem_32442,
                                            &out_arrsizze_32443,
                                            graph_from_mem_31946,
                                            graph_to_mem_31947,
                                            implz2081U_28888, thres_28889,
                                            numVert_28890);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) !=
                NULL);
            (*out0)->mem = out_mem_32442;
            (*out0)->shape[0] = out_arrsizze_32443;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test_elimDupesWith(struct futhark_context *ctx,
                                     struct futhark_i32_1d **out0, const
                                     struct futhark_i32_1d *in0)
{
    struct memblock_device arr_mem_31946;
    
    arr_mem_31946.references = NULL;
    
    int64_t implz2081U_28821;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int64_t out_arrsizze_32443;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr_mem_31946 = in0->mem;
    implz2081U_28821 = in0->shape[0];
    if (!(implz2081U_28821 == in0->shape[0])) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_entry_test_elimDupesWith(ctx, &out_mem_32442,
                                              &out_arrsizze_32443,
                                              arr_mem_31946, implz2081U_28821);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) !=
                NULL);
            (*out0)->mem = out_mem_32442;
            (*out0)->shape[0] = out_arrsizze_32443;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test_mkSegsFromSort_segInd(struct futhark_context *ctx,
                                             struct futhark_i64_1d **out0, const
                                             int64_t in0, const
                                             struct futhark_i32_1d *in1, const
                                             struct futhark_i32_1d *in2)
{
    struct memblock_device keys_mem_31946;
    
    keys_mem_31946.references = NULL;
    
    struct memblock_device values_mem_31947;
    
    values_mem_31947.references = NULL;
    
    int64_t implz2081U_28671;
    int64_t numKey_28672;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    numKey_28672 = in0;
    keys_mem_31946 = in1->mem;
    implz2081U_28671 = in1->shape[0];
    values_mem_31947 = in2->mem;
    implz2081U_28671 = in2->shape[0];
    if (!(true && (implz2081U_28671 == in1->shape[0] && implz2081U_28671 ==
                   in2->shape[0]))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_entry_test_mkSegsFromSort_segInd(ctx, &out_mem_32442,
                                                      keys_mem_31946,
                                                      values_mem_31947,
                                                      implz2081U_28671,
                                                      numKey_28672);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out0)->mem = out_mem_32442;
            (*out0)->shape[0] = numKey_28672;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test_mkSegsFromSort_segSize(struct futhark_context *ctx,
                                              struct futhark_i64_1d **out0,
                                              const int64_t in0, const
                                              struct futhark_i32_1d *in1, const
                                              struct futhark_i32_1d *in2)
{
    struct memblock_device keys_mem_31946;
    
    keys_mem_31946.references = NULL;
    
    struct memblock_device values_mem_31947;
    
    values_mem_31947.references = NULL;
    
    int64_t implz2081U_28746;
    int64_t numKey_28747;
    struct memblock_device out_mem_32442;
    
    out_mem_32442.references = NULL;
    
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    numKey_28747 = in0;
    keys_mem_31946 = in1->mem;
    implz2081U_28746 = in1->shape[0];
    values_mem_31947 = in2->mem;
    implz2081U_28746 = in2->shape[0];
    if (!(true && (implz2081U_28746 == in1->shape[0] && implz2081U_28746 ==
                   in2->shape[0]))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_entry_test_mkSegsFromSort_segSizze(ctx, &out_mem_32442,
                                                        keys_mem_31946,
                                                        values_mem_31947,
                                                        implz2081U_28746,
                                                        numKey_28747);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out0)->mem = out_mem_32442;
            (*out0)->shape[0] = numKey_28747;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
